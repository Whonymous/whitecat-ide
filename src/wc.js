var $jscomp={scope:{},checkStringArgs:function(e,d,f){if(null==e){throw new TypeError("The 'this' value for String.prototype."+f+" must not be null or undefined")}if(d instanceof RegExp){throw new TypeError("First argument to String.prototype."+f+" must not be a regular expression")}return e+""}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(e,d,f){if(f.get||f.set){throw new TypeError("ES3 does not support getters and setters.")}e!=Array.prototype&&e!=Object.prototype&&(e[d]=f.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(g,f,j,i){if(f){j=$jscomp.global;g=g.split(".");for(i=0;i<g.length-1;i++){var h=g[i];h in j||(j[h]={});j=j[h]}g=g[g.length-1];i=j[g];f=f(i);f!=i&&null!=f&&$jscomp.defineProperty(j,g,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("String.prototype.repeat",function(b){return b?b:function(e){var c=$jscomp.checkStringArgs(this,null,"repeat");if(0>e||1342177279<e){throw new RangeError("Invalid count value")}e|=0;for(var f="";e;){if(e&1&&(f+=c),e>>>=1){c+=c}}return f}},"es6-impl","es3");$jscomp.findInternal=function(h,g,l){h instanceof String&&(h=String(h));for(var k=h.length,j=0;j<k;j++){var i=h[j];if(g.call(l,i,j,h)){return{i:j,v:i}}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(b){return b?b:function(d,e){return $jscomp.findInternal(this,d,e).i}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(d,e){return $jscomp.findInternal(this,d,e).v}},"es6-impl","es3");$jscomp.polyfill("Math.sign",function(b){return b?b:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}},"es6-impl","es3");$jscomp.polyfill("String.prototype.endsWith",function(b){return b?b:function(g,j){var d=$jscomp.checkStringArgs(this,g,"endsWith");g+="";void 0===j&&(j=d.length);for(var i=Math.max(0,Math.min(j|0,d.length)),h=g.length;0<h&&0<i;){if(d[--i]!=g[--h]){return !1}}return 0>=h}},"es6-impl","es3");$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(i,n){var d=$jscomp.checkStringArgs(this,i,"startsWith");i+="";for(var m=d.length,l=i.length,k=Math.max(0,Math.min(n|0,d.length)),j=0;j<l&&k<m;){if(d[k++]!=i[j++]){return !1}}return j>=l}},"es6-impl","es3");var COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(b){return void 0!==b};goog.exportPath_=function(f,e,h){f=f.split(".");h=h||goog.global;f[0] in h||!h.execScript||h.execScript("var "+f[0]);for(var g;f.length&&(g=f.shift());){!f.length&&goog.isDef(e)?h[g]=e:h=h[g]?h[g]:h[g]={}}};goog.define=function(e,d){var f=d;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,e)?f=goog.global.CLOSURE_UNCOMPILED_DEFINES[e]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,e)&&(f=goog.global.CLOSURE_DEFINES[e]));goog.exportPath_(e,f)};goog.DEBUG=!1;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(b){if(goog.isInModuleLoader_()){throw Error("goog.provide can not be used within a goog.module.")}if(!COMPILED&&goog.isProvided_(b)){throw Error('Namespace "'+b+'" already declared.')}goog.constructNamespace_(b)};goog.constructNamespace_=function(e,d){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var f=e;(f=f.substring(0,f.lastIndexOf(".")))&&!goog.getObjectByName(f);){goog.implicitNamespaces_[f]=!0}}goog.exportPath_(e,d)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;goog.module=function(b){if(!goog.isString(b)||!b||-1==b.search(goog.VALID_MODULE_RE_)){throw Error("Invalid module identifier")}if(!goog.isInModuleLoader_()){throw Error("Module "+b+" has been loaded incorrectly.")}if(goog.moduleLoaderState_.moduleName){throw Error("goog.module may only be called once per module.")}goog.moduleLoaderState_.moduleName=b;if(!COMPILED){if(goog.isProvided_(b)){throw Error('Namespace "'+b+'" already declared.')}delete goog.implicitNamespaces_[b]}};goog.module.get=function(b){return goog.module.getInternal_(b)};goog.module.getInternal_=function(b){if(!COMPILED){return goog.isProvided_(b)?b in goog.loadedModules_?goog.loadedModules_[b]:goog.getObjectByName(b):null}};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_()){throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module")}if(!COMPILED&&!goog.moduleLoaderState_.moduleName){throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.")}goog.moduleLoaderState_.declareLegacyNamespace=!0};goog.setTestOnly=function(b){if(goog.DISALLOW_TEST_ONLY_CODE){throw b=b||"",Error("Importing test-only code into non-debug environment"+(b?": "+b:"."))}};goog.forwardDeclare=function(b){};COMPILED||(goog.isProvided_=function(b){return b in goog.loadedModules_||!goog.implicitNamespaces_[b]&&goog.isDefAndNotNull(goog.getObjectByName(b))},goog.implicitNamespaces_={"goog.module":!0});goog.getObjectByName=function(g,f){for(var j=g.split("."),i=f||goog.global,h;h=j.shift();){if(goog.isDefAndNotNull(i[h])){i=i[h]}else{return null}}return i};goog.globalize=function(f,e){var h=e||goog.global,g;for(g in f){h[g]=f[g]}};goog.addDependency=function(i,h,n,m){if(goog.DEPENDENCIES_ENABLED){var l;i=i.replace(/\\/g,"/");var k=goog.dependencies_;m&&"boolean"!==typeof m||(m=m?{module:"goog"}:{});for(var j=0;l=h[j];j++){k.nameToPath[l]=i,k.loadFlags[i]=m}for(m=0;h=n[m];m++){i in k.requires||(k.requires[i]={}),k.requires[i][h]=!0}}};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(b){goog.global.console&&goog.global.console.error(b)};goog.require=function(d){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(d);if(goog.isProvided_(d)){return goog.isInModuleLoader_()?goog.module.getInternal_(d):null}if(goog.ENABLE_DEBUG_LOADER){var c=goog.getPathFromDeps_(d);if(c){return goog.writeScripts_(c),null}}d="goog.require could not find: "+d;goog.logToConsole_(d);throw Error(d)}};goog.basePath="";goog.nullFunction=function(){};goog.abstractMethod=function(){throw Error("unimplemented abstract method")};goog.addSingletonGetter=function(b){b.getInstance=function(){if(b.instance_){return b.instance_}goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=b);return b.instance_=new b}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;goog.TRANSPILE="detect";goog.TRANSPILER="transpile.js";goog.DEPENDENCIES_ENABLED&&(goog.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var b=goog.global.document;return null!=b&&"write" in b},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH)){goog.basePath=goog.global.CLOSURE_BASE_PATH}else{if(goog.inHtmlDocument_()){for(var f=goog.global.document.getElementsByTagName("SCRIPT"),e=f.length-1;0<=e;--e){var h=f[e].src,g=h.lastIndexOf("?"),g=-1==g?h.length:g;if("base.js"==h.substr(g-7,7)){goog.basePath=h.substr(0,g-7);break}}}}},goog.importScript_=function(d,c){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(d,c)&&(goog.dependencies_.written[d]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.importProcessedScript_=function(e,d,f){goog.importScript_("",'goog.retrieveAndExec_("'+e+'", '+d+", "+f+");")},goog.queuedModules_=[],goog.wrapModule_=function(d,c){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(c+"\n//# sourceURL="+d+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+c+"\n;return exports});\n//# sourceURL="+d+"\n"},goog.loadQueuedModules_=function(){var e=goog.queuedModules_.length;if(0<e){var d=goog.queuedModules_;goog.queuedModules_=[];for(var f=0;f<e;f++){goog.maybeProcessDeferredPath_(d[f])}}},goog.maybeProcessDeferredDep_=function(b){goog.isDeferredModule_(b)&&goog.allDepsAreAvailable_(b)&&(b=goog.getPathFromDeps_(b),goog.maybeProcessDeferredPath_(goog.basePath+b))},goog.isDeferredModule_=function(d){var c=(d=goog.getPathFromDeps_(d))&&goog.dependencies_.loadFlags[d]||{};return d&&("goog"==c.module||goog.needsTranspile_(c.lang))?goog.basePath+d in goog.dependencies_.deferred:!1},goog.allDepsAreAvailable_=function(d){if((d=goog.getPathFromDeps_(d))&&d in goog.dependencies_.requires){for(var c in goog.dependencies_.requires[d]){if(!goog.isProvided_(c)&&!goog.isDeferredModule_(c)){return !1}}}return !0},goog.maybeProcessDeferredPath_=function(d){if(d in goog.dependencies_.deferred){var c=goog.dependencies_.deferred[d];delete goog.dependencies_.deferred[d];goog.globalEval(c)}},goog.loadModuleFromUrl=function(b){goog.retrieveAndExec_(b,!0,!1)},goog.loadModule=function(f){var e=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};var h;if(goog.isFunction(f)){h=f.call(goog.global,{})}else{if(goog.isString(f)){h=goog.loadModuleFromSource_.call(goog.global,f)}else{throw Error("Invalid module definition")}}var g=goog.moduleLoaderState_.moduleName;if(!goog.isString(g)||!g){throw Error('Invalid module name "'+g+'"')}goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(g,h):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(h);goog.loadedModules_[g]=h}finally{goog.moduleLoaderState_=e}},goog.loadModuleFromSource_=function(a){eval(a);return{}},goog.writeScriptSrcNode_=function(b){goog.global.document.write('<script type="text/javascript" src="'+b+'">\x3c/script>')},goog.appendScriptSrcNode_=function(e){var d=goog.global.document,f=d.createElement("script");f.type="text/javascript";f.src=e;f.defer=!1;f.async=!1;d.head.appendChild(f)},goog.writeScriptTag_=function(f,e){if(goog.inHtmlDocument_()){var h=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==h.readyState){if(/\bdeps.js$/.test(f)){return !1}throw Error('Cannot write "'+f+'" after document load')}if(void 0===e){if(goog.IS_OLD_IE_){var g=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ";h.write('<script type="text/javascript" src="'+f+'"'+g+">\x3c/script>")}else{goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(f):goog.writeScriptSrcNode_(f)}}else{h.write('<script type="text/javascript">'+e+"\x3c/script>")}return !0}return !1},goog.needsTranspile_=function(a){if("always"==goog.TRANSPILE){return !0}if("never"==goog.TRANSPILE){return !1}if(!goog.transpiledLanguages_){goog.transpiledLanguages_={es5:!0,es6:!0,"es6-impl":!0};try{goog.transpiledLanguages_.es5=eval("[1,].length!=1"),eval('(()=>{"use strict";let a={};const X=class{constructor(){}x(z){return new Map([...arguments]).get(z[0])==3}};return new X().x([a,3])})()')&&(goog.transpiledLanguages_["es6-impl"]=!1),eval('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')&&(goog.transpiledLanguages_.es6=!1)}catch(b){}}return !!goog.transpiledLanguages_[a]},goog.transpiledLanguages_=null,goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(d,c){"complete"==d.readyState&&goog.lastNonModuleScriptIndex_==c&&goog.loadQueuedModules_();return !0},goog.writeScripts_=function(r){function q(b){if(!(b in n.written||b in n.visited)){n.visited[b]=!0;if(b in n.requires){for(var c in n.requires[b]){if(!goog.isProvided_(c)){if(c in n.nameToPath){q(n.nameToPath[c])}else{throw Error("Undefined nameToPath for "+c)}}}}b in o||(o[b]=!0,p.push(b))}}var p=[],o={},n=goog.dependencies_;q(r);for(r=0;r<p.length;r++){var m=p[r];goog.dependencies_.written[m]=!0}var l=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(r=0;r<p.length;r++){if(m=p[r]){var j=n.loadFlags[m]||{},i=goog.needsTranspile_(j.lang);"goog"==j.module||i?goog.importProcessedScript_(goog.basePath+m,"goog"==j.module,i):goog.importScript_(goog.basePath+m)}else{throw goog.moduleLoaderState_=l,Error("Undefined script input")}}goog.moduleLoaderState_=l},goog.getPathFromDeps_=function(b){return b in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[b]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));goog.normalizePath_=function(d){d=d.split("/");for(var c=0;c<d.length;){"."==d[c]?d.splice(c,1):c&&".."==d[c]&&d[c-1]&&".."!=d[c-1]?d.splice(--c,2):c++}return d.join("/")};goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC){return goog.global.CLOSURE_LOAD_FILE_SYNC(e)}try{var d=new goog.global.XMLHttpRequest;d.open("get",e,!1);d.send();return 0==d.status||200==d.status?d.responseText:null}catch(f){return null}};goog.retrieveAndExec_=function(h,g,l){if(!COMPILED){var k=h;h=goog.normalizePath_(h);var j=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,i=goog.loadFileSync_(h);if(null==i){throw Error('Load of "'+h+'" failed')}l&&(i=goog.transpile_.call(goog.global,i,h));i=g?goog.wrapModule_(h,i):i+("\n//# sourceURL="+h);goog.IS_OLD_IE_?(goog.dependencies_.deferred[k]=i,goog.queuedModules_.push(k)):j(h,i)}};goog.transpile_=function(a,b){var c=goog.global.$jscomp;c||(goog.global.$jscomp=c={});var d=c.transpile;if(!d){var e=goog.basePath+goog.TRANSPILER,f=goog.loadFileSync_(e);f&&(eval(f+"\n//# sourceURL="+e),c=goog.global.$jscomp,d=c.transpile)}d||(d=c.transpile=function(a,b){goog.logToConsole_(b+" requires transpilation but no transpiler was found.");return a});return d(a,b)};goog.typeOf=function(e){var d=typeof e;if("object"==d){if(e){if(e instanceof Array){return"array"}if(e instanceof Object){return d}var f=Object.prototype.toString.call(e);if("[object Window]"==f){return"object"}if("[object Array]"==f||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice")){return"array"}if("[object Function]"==f||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call")){return"function"}}else{return"null"}}else{if("function"==d&&"undefined"==typeof e.call){return"object"}}return d};goog.isNull=function(b){return null===b};goog.isDefAndNotNull=function(b){return null!=b};goog.isArray=function(b){return"array"==goog.typeOf(b)};goog.isArrayLike=function(d){var c=goog.typeOf(d);return"array"==c||"object"==c&&"number"==typeof d.length};goog.isDateLike=function(b){return goog.isObject(b)&&"function"==typeof b.getFullYear};goog.isString=function(b){return"string"==typeof b};goog.isBoolean=function(b){return"boolean"==typeof b};goog.isNumber=function(b){return"number"==typeof b};goog.isFunction=function(b){return"function"==goog.typeOf(b)};goog.isObject=function(d){var c=typeof d;return"object"==c&&null!=d||"function"==c};goog.getUid=function(b){return b[goog.UID_PROPERTY_]||(b[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(b){return !!b[goog.UID_PROPERTY_]};goog.removeUid=function(d){null!==d&&"removeAttribute" in d&&d.removeAttribute(goog.UID_PROPERTY_);try{delete d[goog.UID_PROPERTY_]}catch(c){}};goog.UID_PROPERTY_="closure_uid_"+(1000000000*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(e){var d=goog.typeOf(e);if("object"==d||"array"==d){if(e.clone){return e.clone()}var d="array"==d?[]:{},f;for(f in e){d[f]=goog.cloneObject(e[f])}return d}return e};goog.bindNative_=function(e,d,f){return e.call.apply(e.bind,arguments)};goog.bindJs_=function(f,e,h){if(!f){throw Error()}if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var a=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(a,g);return f.apply(e,a)}}return function(){return f.apply(e,arguments)}};goog.bind=function(e,d,f){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};goog.partial=function(e,d){var f=Array.prototype.slice.call(arguments,1);return function(){var a=f.slice();a.push.apply(a,arguments);return e.apply(this,a)}};goog.mixin=function(e,d){for(var f in d){e[f]=d[f]}};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return +new Date};goog.globalEval=function(a){if(goog.global.execScript){goog.global.execScript(a,"JavaScript")}else{if(goog.global.eval){if(null==goog.evalWorksForGlobals_){if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(d){}goog.evalWorksForGlobals_=!0}else{goog.evalWorksForGlobals_=!1}}if(goog.evalWorksForGlobals_){goog.global.eval(a)}else{var b=goog.global.document,c=b.createElement("SCRIPT");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);b.body.removeChild(c)}}else{throw Error("goog.globalEval not available")}}};goog.evalWorksForGlobals_=null;goog.getCssName=function(f,e){var h=function(b){return goog.cssNameMapping_[b]||b},g=function(i){i=i.split("-");for(var c=[],j=0;j<i.length;j++){c.push(h(i[j]))}return c.join("-")},g=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?h:g:function(b){return b};return e?f+"-"+g(e):g(f)};goog.setCssNameMapping=function(d,c){goog.cssNameMapping_=d;goog.cssNameMappingStyle_=c};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(d,c){c&&(d=d.replace(/\{\$([^}]+)}/g,function(b,e){return null!=c&&e in c?c[e]:b}));return d};goog.getMsgWithFallback=function(d,c){return d};goog.exportSymbol=function(e,d,f){goog.exportPath_(e,d,f)};goog.exportProperty=function(e,d,f){e[d]=f};goog.inherits=function(e,d){function f(){}f.prototype=d.prototype;e.superClass_=d.prototype;e.prototype=new f;e.prototype.constructor=e;e.base=function(b,j,g){for(var i=Array(arguments.length-2),h=2;h<arguments.length;h++){i[h-2]=arguments[h]}return d.prototype[j].apply(b,i)}};goog.base=function(i,h,n){var m=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!m){throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C")}if(m.superClass_){for(var l=Array(arguments.length-1),k=1;k<arguments.length;k++){l[k-1]=arguments[k]}return m.superClass_.constructor.apply(i,l)}l=Array(arguments.length-2);for(k=2;k<arguments.length;k++){l[k-2]=arguments[k]}for(var k=!1,j=i.constructor;j;j=j.superClass_&&j.superClass_.constructor){if(j.prototype[h]===m){k=!0}else{if(k){return j.prototype[h].apply(i,l)}}}if(i[h]===m){return i.constructor.prototype[h].apply(i,l)}throw Error("goog.base called from a method of one name to a method of a different name")};goog.scope=function(b){if(goog.isInModuleLoader_()){throw Error("goog.scope is not supported within a goog.module.")}b.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);goog.defineClass=function(f,e){var h=e.constructor,g=e.statics;h&&h!=Object.prototype.constructor||(h=function(){throw Error("cannot instantiate an interface (no constructor defined).")});h=goog.defineClass.createSealingConstructor_(h,f);f&&goog.inherits(h,f);delete e.constructor;delete e.statics;goog.defineClass.applyProperties_(h.prototype,e);null!=g&&(g instanceof Function?g(h):goog.defineClass.applyProperties_(h,g));return h};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;goog.defineClass.createSealingConstructor_=function(f,e){if(!goog.defineClass.SEAL_CLASS_INSTANCES){return f}var h=!goog.defineClass.isUnsealable_(e),g=function(){var a=f.apply(this,arguments)||this;a[goog.UID_PROPERTY_]=a[goog.UID_PROPERTY_];this.constructor===g&&h&&Object.seal instanceof Function&&Object.seal(a);return a};return g};goog.defineClass.isUnsealable_=function(b){return b&&b.prototype&&b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");goog.defineClass.applyProperties_=function(f,e){for(var h in e){Object.prototype.hasOwnProperty.call(e,h)&&(f[h]=e[h])}for(var g=0;g<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;g++){h=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[g],Object.prototype.hasOwnProperty.call(e,h)&&(f[h]=e[h])}};goog.tagUnsealableClass=function(b){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";goog.debug={};goog.debug.Error=function(d){if(Error.captureStackTrace){Error.captureStackTrace(this,goog.debug.Error)}else{var c=Error().stack;c&&(this.stack=c)}d&&(this.message=String(d));this.reportErrorToServer=!0};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.dom={};goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.string={};goog.string.DETECT_DOUBLE_ESCAPING=!1;goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1;goog.string.Unicode={NBSP:"\u00a0"};goog.string.startsWith=function(d,c){return 0==d.lastIndexOf(c,0)};goog.string.endsWith=function(e,d){var f=e.length-d.length;return 0<=f&&e.indexOf(d,f)==f};goog.string.caseInsensitiveStartsWith=function(d,c){return 0==goog.string.caseInsensitiveCompare(c,d.substr(0,c.length))};goog.string.caseInsensitiveEndsWith=function(d,c){return 0==goog.string.caseInsensitiveCompare(c,d.substr(d.length-c.length,c.length))};goog.string.caseInsensitiveEquals=function(d,c){return d.toLowerCase()==c.toLowerCase()};goog.string.subs=function(g,f){for(var j=g.split("%s"),i="",h=Array.prototype.slice.call(arguments,1);h.length&&1<j.length;){i+=j.shift()+h.shift()}return i+j.join("%s")};goog.string.collapseWhitespace=function(b){return b.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmptyOrWhitespace=function(b){return/^[\s\xa0]*$/.test(b)};goog.string.isEmptyString=function(b){return 0==b.length};goog.string.isEmpty=goog.string.isEmptyOrWhitespace;goog.string.isEmptyOrWhitespaceSafe=function(b){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(b))};goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe;goog.string.isBreakingWhitespace=function(b){return !/[^\t\n\r ]/.test(b)};goog.string.isAlpha=function(b){return !/[^a-zA-Z]/.test(b)};goog.string.isNumeric=function(b){return !/[^0-9]/.test(b)};goog.string.isAlphaNumeric=function(b){return !/[^a-zA-Z0-9]/.test(b)};goog.string.isSpace=function(b){return" "==b};goog.string.isUnicodeChar=function(b){return 1==b.length&&" "<=b&&"~">=b||"\u0080"<=b&&"\ufffd">=b};goog.string.stripNewlines=function(b){return b.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(b){return b.replace(/(\r\n|\r|\n)/g,"\n")};goog.string.normalizeWhitespace=function(b){return b.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(b){return b.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(b){return b.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(b){return b.trim()}:function(b){return b.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};goog.string.trimLeft=function(b){return b.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(b){return b.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(f,e){var h=String(f).toLowerCase(),g=String(e).toLowerCase();return h<g?-1:h==g?0:1};goog.string.numberAwareCompare_=function(j,i,p){if(j==i){return 0}if(!j){return -1}if(!i){return 1}for(var o=j.toLowerCase().match(p),n=i.toLowerCase().match(p),m=Math.min(o.length,n.length),l=0;l<m;l++){p=o[l];var k=n[l];if(p!=k){return j=parseInt(p,10),!isNaN(j)&&(i=parseInt(k,10),!isNaN(i)&&j-i)?j-i:p<k?-1:1}}return o.length!=n.length?o.length-n.length:j<i?-1:1};goog.string.intAwareCompare=function(d,c){return goog.string.numberAwareCompare_(d,c,/\d+|\D+/g)};goog.string.floatAwareCompare=function(d,c){return goog.string.numberAwareCompare_(d,c,/\d+|\.\d+|\D+/g)};goog.string.numerateCompare=goog.string.floatAwareCompare;goog.string.urlEncode=function(b){return encodeURIComponent(String(b))};goog.string.urlDecode=function(b){return decodeURIComponent(b.replace(/\+/g," "))};goog.string.newLineToBr=function(d,c){return d.replace(/(\r\n|\r|\n)/g,c?"<br />":"<br>")};goog.string.htmlEscape=function(d,c){if(c){d=d.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(d=d.replace(goog.string.E_RE_,"&#101;"))}else{if(!goog.string.ALL_RE_.test(d)){return d}-1!=d.indexOf("&")&&(d=d.replace(goog.string.AMP_RE_,"&amp;"));-1!=d.indexOf("<")&&(d=d.replace(goog.string.LT_RE_,"&lt;"));-1!=d.indexOf(">")&&(d=d.replace(goog.string.GT_RE_,"&gt;"));-1!=d.indexOf('"')&&(d=d.replace(goog.string.QUOT_RE_,"&quot;"));-1!=d.indexOf("'")&&(d=d.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;"));-1!=d.indexOf("\x00")&&(d=d.replace(goog.string.NULL_RE_,"&#0;"));goog.string.DETECT_DOUBLE_ESCAPING&&-1!=d.indexOf("e")&&(d=d.replace(goog.string.E_RE_,"&#101;"))}return d};goog.string.AMP_RE_=/&/g;goog.string.LT_RE_=/</g;goog.string.GT_RE_=/>/g;goog.string.QUOT_RE_=/"/g;goog.string.SINGLE_QUOTE_RE_=/'/g;goog.string.NULL_RE_=/\x00/g;goog.string.E_RE_=/e/g;goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/;goog.string.unescapeEntities=function(b){return goog.string.contains(b,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document" in goog.global?goog.string.unescapeEntitiesUsingDom_(b):goog.string.unescapePureXmlEntities_(b):b};goog.string.unescapeEntitiesWithDocument=function(d,c){return goog.string.contains(d,"&")?goog.string.unescapeEntitiesUsingDom_(d,c):d};goog.string.unescapeEntitiesUsingDom_=function(f,e){var h={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},g;g=e?e.createElement("div"):goog.global.document.createElement("div");return f.replace(goog.string.HTML_ENTITY_PATTERN_,function(d,c){var j=h[d];if(j){return j}if("#"==c.charAt(0)){var i=Number("0"+c.substr(1));isNaN(i)||(j=String.fromCharCode(i))}j||(g.innerHTML=d+" ",j=g.firstChild.nodeValue.slice(0,-1));return h[d]=j})};goog.string.unescapePureXmlEntities_=function(b){return b.replace(/&([^;]+);/g,function(e,f){switch(f){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==f.charAt(0)){var d=Number("0"+f.substr(1));if(!isNaN(d)){return String.fromCharCode(d)}}return e}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(d,c){return goog.string.newLineToBr(d.replace(/  /g," &#160;"),c)};goog.string.preserveSpaces=function(b){return b.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)};goog.string.stripQuotes=function(g,f){for(var j=f.length,i=0;i<j;i++){var h=1==j?f:f.charAt(i);if(g.charAt(0)==h&&g.charAt(g.length-1)==h){return g.substring(1,g.length-1)}}return g};goog.string.truncate=function(e,d,f){f&&(e=goog.string.unescapeEntities(e));e.length>d&&(e=e.substring(0,d-3)+"...");f&&(e=goog.string.htmlEscape(e));return e};goog.string.truncateMiddle=function(g,f,j,i){j&&(g=goog.string.unescapeEntities(g));if(i&&g.length>f){i>f&&(i=f);var h=g.length-i;g=g.substring(0,f-i)+"..."+g.substring(h)}else{g.length>f&&(i=Math.floor(f/2),h=g.length-i,g=g.substring(0,i+f%2)+"..."+g.substring(h))}j&&(g=goog.string.htmlEscape(g));return g};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\","<":"<"};goog.string.jsEscapeCache_={"'":"\\'"};goog.string.quote=function(g){g=String(g);for(var f=['"'],j=0;j<g.length;j++){var i=g.charAt(j),h=i.charCodeAt(0);f[j+1]=goog.string.specialEscapeChars_[i]||(31<h&&127>h?i:goog.string.escapeChar(i))}f.push('"');return f.join("")};goog.string.escapeString=function(e){for(var d=[],f=0;f<e.length;f++){d[f]=goog.string.escapeChar(e.charAt(f))}return d.join("")};goog.string.escapeChar=function(e){if(e in goog.string.jsEscapeCache_){return goog.string.jsEscapeCache_[e]}if(e in goog.string.specialEscapeChars_){return goog.string.jsEscapeCache_[e]=goog.string.specialEscapeChars_[e]}var d,f=e.charCodeAt(0);if(31<f&&127>f){d=e}else{if(256>f){if(d="\\x",16>f||256<f){d+="0"}}else{d="\\u",4096>f&&(d+="0")}d+=f.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[e]=d};goog.string.contains=function(d,c){return -1!=d.indexOf(c)};goog.string.caseInsensitiveContains=function(d,c){return goog.string.contains(d.toLowerCase(),c.toLowerCase())};goog.string.countOf=function(d,c){return d&&c?d.split(c).length-1:0};goog.string.removeAt=function(f,e,h){var g=f;0<=e&&e<f.length&&0<h&&(g=f.substr(0,e)+f.substr(e+h,f.length-e-h));return g};goog.string.remove=function(e,d){var f=new RegExp(goog.string.regExpEscape(d),"");return e.replace(f,"")};goog.string.removeAll=function(e,d){var f=new RegExp(goog.string.regExpEscape(d),"g");return e.replace(f,"")};goog.string.regExpEscape=function(b){return String(b).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=String.prototype.repeat?function(d,c){return d.repeat(c)}:function(d,c){return Array(c+1).join(d)};goog.string.padNumber=function(e,d,f){e=goog.isDef(f)?e.toFixed(f):String(e);f=e.indexOf(".");-1==f&&(f=e.length);return goog.string.repeat("0",Math.max(0,d-f))+e};goog.string.makeSafe=function(b){return null==b?"":String(b)};goog.string.buildString=function(b){return Array.prototype.join.call(arguments,"")};goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)};goog.string.compareVersions=function(B,A){for(var z=0,y=goog.string.trim(String(B)).split("."),x=goog.string.trim(String(A)).split("."),w=Math.max(y.length,x.length),v=0;0==z&&v<w;v++){var u=y[v]||"",t=x[v]||"",o=RegExp("(\\d*)(\\D*)","g"),j=RegExp("(\\d*)(\\D*)","g");do{var s=o.exec(u)||["","",""],r=j.exec(t)||["","",""];if(0==s[0].length&&0==r[0].length){break}var z=0==s[1].length?0:parseInt(s[1],10),i=0==r[1].length?0:parseInt(r[1],10),z=goog.string.compareElements_(z,i)||goog.string.compareElements_(0==s[2].length,0==r[2].length)||goog.string.compareElements_(s[2],r[2])}while(0==z)}return z};goog.string.compareElements_=function(d,c){return d<c?-1:d>c?1:0};goog.string.hashCode=function(e){for(var d=0,f=0;f<e.length;++f){d=31*d+e.charCodeAt(f)>>>0}return d};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};goog.string.toNumber=function(d){var c=Number(d);return 0==c&&goog.string.isEmptyOrWhitespace(d)?NaN:c};goog.string.isLowerCamelCase=function(b){return/^[a-z]+([A-Z][a-z]*)*$/.test(b)};goog.string.isUpperCamelCase=function(b){return/^([A-Z][a-z]*)+$/.test(b)};goog.string.toCamelCase=function(b){return String(b).replace(/\-([a-z])/g,function(d,e){return e.toUpperCase()})};goog.string.toSelectorCase=function(b){return String(b).replace(/([A-Z])/g,"-$1").toLowerCase()};goog.string.toTitleCase=function(e,d){var f=goog.isString(d)?goog.string.regExpEscape(d):"\\s";return e.replace(new RegExp("(^"+(f?"|["+f+"]+":"")+")([a-z])","g"),function(h,g,i){return g+i.toUpperCase()})};goog.string.capitalize=function(b){return String(b.charAt(0)).toUpperCase()+String(b.substr(1)).toLowerCase()};goog.string.parseInt=function(b){isFinite(b)&&(b=String(b));return goog.isString(b)?/^\s*-?0x/i.test(b)?parseInt(b,16):parseInt(b,10):NaN};goog.string.splitLimit=function(f,e,h){f=f.split(e);for(var g=[];0<h&&f.length;){g.push(f.shift()),h--}f.length&&g.push(f.join(e));return g};goog.string.lastComponent=function(g,f){if(f){"string"==typeof f&&(f=[f])}else{return g}for(var j=-1,i=0;i<f.length;i++){if(""!=f[i]){var h=g.lastIndexOf(f[i]);h>j&&(j=h)}}return -1==j?g:g.slice(j+1)};goog.string.editDistance=function(h,g){var l=[],k=[];if(h==g){return 0}if(!h.length||!g.length){return Math.max(h.length,g.length)}for(var j=0;j<g.length+1;j++){l[j]=j}for(j=0;j<h.length;j++){k[0]=j+1;for(var i=0;i<g.length;i++){k[i+1]=Math.min(k[i]+1,l[i+1]+1,l[i]+Number(h[j]!=g[i]))}for(i=0;i<l.length;i++){l[i]=k[i]}}return k[g.length]};goog.asserts={};goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(d,c){c.unshift(d);goog.debug.Error.call(this,goog.string.subs.apply(null,c));c.shift();this.messagePattern=d};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.DEFAULT_ERROR_HANDLER=function(b){throw b};goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER;goog.asserts.doAssertFailure_=function(h,g,l,k){var j="Assertion failed";if(l){var j=j+(": "+l),i=k}else{h&&(j+=": "+h,i=g)}h=new goog.asserts.AssertionError(""+j,i||[]);goog.asserts.errorHandler_(h)};goog.asserts.setErrorHandler=function(b){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=b)};goog.asserts.assert=function(e,d,f){goog.asserts.ENABLE_ASSERTS&&!e&&goog.asserts.doAssertFailure_("",null,d,Array.prototype.slice.call(arguments,2));return e};goog.asserts.fail=function(d,c){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(d?": "+d:""),Array.prototype.slice.call(arguments,1)))};goog.asserts.assertNumber=function(e,d,f){goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(e)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],d,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertString=function(e,d,f){goog.asserts.ENABLE_ASSERTS&&!goog.isString(e)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],d,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertFunction=function(e,d,f){goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(e)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],d,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertObject=function(e,d,f){goog.asserts.ENABLE_ASSERTS&&!goog.isObject(e)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],d,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertArray=function(e,d,f){goog.asserts.ENABLE_ASSERTS&&!goog.isArray(e)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],d,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertBoolean=function(e,d,f){goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(e)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],d,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertElement=function(e,d,f){!goog.asserts.ENABLE_ASSERTS||goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],d,Array.prototype.slice.call(arguments,2));return e};goog.asserts.assertInstanceof=function(f,e,h,g){!goog.asserts.ENABLE_ASSERTS||f instanceof e||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(e),goog.asserts.getType_(f)],h,Array.prototype.slice.call(arguments,3));return f};goog.asserts.assertObjectPrototypeIsIntact=function(){for(var b in Object.prototype){goog.asserts.fail(b+" should not be enumerable in Object.prototype.")}};goog.asserts.getType_=function(b){return b instanceof Function?b.displayName||b.name||"unknown type name":b instanceof Object?b.constructor.displayName||b.constructor.name||Object.prototype.toString.call(b):null===b?"null":typeof b};goog.debug.entryPointRegistry={};goog.debug.EntryPointMonitor=function(){};goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];goog.debug.entryPointRegistry.monitorsMayExist_=!1;goog.debug.entryPointRegistry.register=function(e){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=e;if(goog.debug.entryPointRegistry.monitorsMayExist_){for(var d=goog.debug.entryPointRegistry.monitors_,f=0;f<d.length;f++){e(goog.bind(d[f].wrap,d[f]))}}};goog.debug.entryPointRegistry.monitorAll=function(e){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var d=goog.bind(e.wrap,e),f=0;f<goog.debug.entryPointRegistry.refList_.length;f++){goog.debug.entryPointRegistry.refList_[f](d)}goog.debug.entryPointRegistry.monitors_.push(e)};goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(e){var d=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(e==d[d.length-1],"Only the most recent monitor can be unwrapped.");e=goog.bind(e.unwrap,e);for(var f=0;f<goog.debug.entryPointRegistry.refList_.length;f++){goog.debug.entryPointRegistry.refList_[f](e)}d.length--};goog.array={};goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE;goog.array.ASSUME_NATIVE_FUNCTIONS=!1;goog.array.peek=function(b){return b[b.length-1]};goog.array.last=goog.array.peek;goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(e,d,f){goog.asserts.assert(null!=e.length);return Array.prototype.indexOf.call(e,d,f)}:function(e,d,f){f=null==f?0:0>f?Math.max(0,e.length+f):f;if(goog.isString(e)){return goog.isString(d)&&1==d.length?e.indexOf(d,f):-1}for(;f<e.length;f++){if(f in e&&e[f]===d){return f}}return -1};goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(e,d,f){goog.asserts.assert(null!=e.length);return Array.prototype.lastIndexOf.call(e,d,null==f?e.length-1:f)}:function(e,d,f){f=null==f?e.length-1:f;0>f&&(f=Math.max(0,e.length+f));if(goog.isString(e)){return goog.isString(d)&&1==d.length?e.lastIndexOf(d,f):-1}for(;0<=f;f--){if(f in e&&e[f]===d){return f}}return -1};goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(e,d,f){goog.asserts.assert(null!=e.length);Array.prototype.forEach.call(e,d,f)}:function(h,g,l){for(var k=h.length,j=goog.isString(h)?h.split(""):h,i=0;i<k;i++){i in j&&g.call(l,j[i],i,h)}};goog.array.forEachRight=function(g,f,j){for(var i=g.length,h=goog.isString(g)?g.split(""):g,i=i-1;0<=i;--i){i in h&&f.call(j,h[i],i,g)}};goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(e,d,f){goog.asserts.assert(null!=e.length);return Array.prototype.filter.call(e,d,f)}:function(r,q,p){for(var o=r.length,n=[],m=0,l=goog.isString(r)?r.split(""):r,j=0;j<o;j++){if(j in l){var i=l[j];q.call(p,i,j,r)&&(n[m++]=i)}}return n};goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(e,d,f){goog.asserts.assert(null!=e.length);return Array.prototype.map.call(e,d,f)}:function(i,h,n){for(var m=i.length,l=Array(m),k=goog.isString(i)?i.split(""):i,j=0;j<m;j++){j in k&&(l[j]=h.call(n,k[j],j,i))}return l};goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(f,e,h,g){goog.asserts.assert(null!=f.length);g&&(e=goog.bind(e,g));return Array.prototype.reduce.call(f,e,h)}:function(g,f,j,i){var h=j;goog.array.forEach(g,function(b,a){h=f.call(i,h,b,a,g)});return h};goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(f,e,h,g){goog.asserts.assert(null!=f.length);goog.asserts.assert(null!=e);g&&(e=goog.bind(e,g));return Array.prototype.reduceRight.call(f,e,h)}:function(g,f,j,i){var h=j;goog.array.forEachRight(g,function(b,a){h=f.call(i,h,b,a,g)});return h};goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(e,d,f){goog.asserts.assert(null!=e.length);return Array.prototype.some.call(e,d,f)}:function(h,g,l){for(var k=h.length,j=goog.isString(h)?h.split(""):h,i=0;i<k;i++){if(i in j&&g.call(l,j[i],i,h)){return !0}}return !1};goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(e,d,f){goog.asserts.assert(null!=e.length);return Array.prototype.every.call(e,d,f)}:function(h,g,l){for(var k=h.length,j=goog.isString(h)?h.split(""):h,i=0;i<k;i++){if(i in j&&!g.call(l,j[i],i,h)){return !1}}return !0};goog.array.count=function(f,e,h){var g=0;goog.array.forEach(f,function(b,d,c){e.call(h,b,d,c)&&++g},h);return g};goog.array.find=function(e,d,f){d=goog.array.findIndex(e,d,f);return 0>d?null:goog.isString(e)?e.charAt(d):e[d]};goog.array.findIndex=function(h,g,l){for(var k=h.length,j=goog.isString(h)?h.split(""):h,i=0;i<k;i++){if(i in j&&g.call(l,j[i],i,h)){return i}}return -1};goog.array.findRight=function(e,d,f){d=goog.array.findIndexRight(e,d,f);return 0>d?null:goog.isString(e)?e.charAt(d):e[d]};goog.array.findIndexRight=function(g,f,j){for(var i=g.length,h=goog.isString(g)?g.split(""):g,i=i-1;0<=i;i--){if(i in h&&f.call(j,h[i],i,g)){return i}}return -1};goog.array.contains=function(d,c){return 0<=goog.array.indexOf(d,c)};goog.array.isEmpty=function(b){return 0==b.length};goog.array.clear=function(d){if(!goog.isArray(d)){for(var c=d.length-1;0<=c;c--){delete d[c]}}d.length=0};goog.array.insert=function(d,c){goog.array.contains(d,c)||d.push(c)};goog.array.insertAt=function(e,d,f){goog.array.splice(e,f,0,d)};goog.array.insertArrayAt=function(e,d,f){goog.partial(goog.array.splice,e,f,0).apply(null,d)};goog.array.insertBefore=function(f,e,h){var g;2==arguments.length||0>(g=goog.array.indexOf(f,h))?f.push(e):goog.array.insertAt(f,e,g)};goog.array.remove=function(f,e){var h=goog.array.indexOf(f,e),g;(g=0<=h)&&goog.array.removeAt(f,h);return g};goog.array.removeLast=function(e,d){var f=goog.array.lastIndexOf(e,d);return 0<=f?(goog.array.removeAt(e,f),!0):!1};goog.array.removeAt=function(d,c){goog.asserts.assert(null!=d.length);return 1==Array.prototype.splice.call(d,c,1).length};goog.array.removeIf=function(e,d,f){d=goog.array.findIndex(e,d,f);return 0<=d?(goog.array.removeAt(e,d),!0):!1};goog.array.removeAllIf=function(f,e,h){var g=0;goog.array.forEachRight(f,function(b,a){e.call(h,b,a,f)&&goog.array.removeAt(f,a)&&g++});return g};goog.array.concat=function(b){return Array.prototype.concat.apply(Array.prototype,arguments)};goog.array.join=function(b){return Array.prototype.concat.apply(Array.prototype,arguments)};goog.array.toArray=function(f){var e=f.length;if(0<e){for(var h=Array(e),g=0;g<e;g++){h[g]=f[g]}return h}return[]};goog.array.clone=goog.array.toArray;goog.array.extend=function(i,h){for(var n=1;n<arguments.length;n++){var m=arguments[n];if(goog.isArrayLike(m)){var l=i.length||0,k=m.length||0;i.length=l+k;for(var j=0;j<k;j++){i[l+j]=m[j]}}else{i.push(m)}}};goog.array.splice=function(f,e,h,g){goog.asserts.assert(null!=f.length);return Array.prototype.splice.apply(f,goog.array.slice(arguments,1))};goog.array.slice=function(e,d,f){goog.asserts.assert(null!=e.length);return 2>=arguments.length?Array.prototype.slice.call(e,d):Array.prototype.slice.call(e,d,f)};goog.array.removeDuplicates=function(j,i,p){i=i||j;var o=function(b){return goog.isObject(b)?"o"+goog.getUid(b):(typeof b).charAt(0)+b};p=p||o;for(var o={},n=0,m=0;m<j.length;){var l=j[m++],k=p(l);Object.prototype.hasOwnProperty.call(o,k)||(o[k]=!0,i[n++]=l)}i.length=n};goog.array.binarySearch=function(e,d,f){return goog.array.binarySearch_(e,f||goog.array.defaultCompare,!1,d)};goog.array.binarySelect=function(e,d,f){return goog.array.binarySearch_(e,d,!0,void 0,f)};goog.array.binarySearch_=function(t,s,r,q,p){for(var o=0,m=t.length,l;o<m;){var j=o+m>>1,i;i=r?s.call(p,t[j],j,t):s(q,t[j]);0<i?o=j+1:(m=j,l=!i)}return l?o:~o};goog.array.sort=function(d,c){d.sort(c||goog.array.defaultCompare)};goog.array.stableSort=function(g,f){for(var j=Array(g.length),i=0;i<g.length;i++){j[i]={index:i,value:g[i]}}var h=f||goog.array.defaultCompare;goog.array.sort(j,function(d,c){return h(d.value,c.value)||d.index-c.index});for(i=0;i<g.length;i++){g[i]=j[i].value}};goog.array.sortByKey=function(f,e,h){var g=h||goog.array.defaultCompare;goog.array.sort(f,function(b,d){return g(e(b),e(d))})};goog.array.sortObjectsByKey=function(e,d,f){goog.array.sortByKey(e,function(b){return b[d]},f)};goog.array.isSorted=function(g,f,j){f=f||goog.array.defaultCompare;for(var i=1;i<g.length;i++){var h=f(g[i-1],g[i]);if(0<h||0==h&&j){return !1}}return !0};goog.array.equals=function(g,f,j){if(!goog.isArrayLike(g)||!goog.isArrayLike(f)||g.length!=f.length){return !1}var i=g.length;j=j||goog.array.defaultCompareEquality;for(var h=0;h<i;h++){if(!j(g[h],f[h])){return !1}}return !0};goog.array.compare3=function(h,g,l){l=l||goog.array.defaultCompare;for(var k=Math.min(h.length,g.length),j=0;j<k;j++){var i=l(h[j],g[j]);if(0!=i){return i}}return goog.array.defaultCompare(h.length,g.length)};goog.array.defaultCompare=function(d,c){return d>c?1:d<c?-1:0};goog.array.inverseDefaultCompare=function(d,c){return -goog.array.defaultCompare(d,c)};goog.array.defaultCompareEquality=function(d,c){return d===c};goog.array.binaryInsert=function(e,d,f){f=goog.array.binarySearch(e,d,f);return 0>f?(goog.array.insertAt(e,d,-(f+1)),!0):!1};goog.array.binaryRemove=function(e,d,f){d=goog.array.binarySearch(e,d,f);return 0<=d?goog.array.removeAt(e,d):!1};goog.array.bucket=function(i,h,n){for(var m={},l=0;l<i.length;l++){var k=i[l],j=h.call(n,k,l,i);goog.isDef(j)&&(m[j]||(m[j]=[])).push(k)}return m};goog.array.toObject=function(f,e,h){var g={};goog.array.forEach(f,function(b,a){g[e.call(h,b,a,f)]=b});return g};goog.array.range=function(h,g,l){var k=[],j=0,i=h;l=l||1;void 0!==g&&(j=h,i=g);if(0>l*(i-j)){return[]}if(0<l){for(h=j;h<i;h+=l){k.push(h)}}else{for(h=j;h>i;h+=l){k.push(h)}}return k};goog.array.repeat=function(f,e){for(var h=[],g=0;g<e;g++){h[g]=f}return h};goog.array.flatten=function(i){for(var h=[],n=0;n<arguments.length;n++){var m=arguments[n];if(goog.isArray(m)){for(var l=0;l<m.length;l+=8192){for(var k=goog.array.slice(m,l,l+8192),k=goog.array.flatten.apply(null,k),j=0;j<k.length;j++){h.push(k[j])}}}else{h.push(m)}}return h};goog.array.rotate=function(d,c){goog.asserts.assert(null!=d.length);d.length&&(c%=d.length,0<c?Array.prototype.unshift.apply(d,d.splice(-c,c)):0>c&&Array.prototype.push.apply(d,d.splice(0,-c)));return d};goog.array.moveItem=function(e,d,f){goog.asserts.assert(0<=d&&d<e.length);goog.asserts.assert(0<=f&&f<e.length);d=Array.prototype.splice.call(e,d,1);Array.prototype.splice.call(e,f,0,d[0])};goog.array.zip=function(h){if(!arguments.length){return[]}for(var g=[],l=arguments[0].length,k=1;k<arguments.length;k++){arguments[k].length<l&&(l=arguments[k].length)}for(k=0;k<l;k++){for(var j=[],i=0;i<arguments.length;i++){j.push(arguments[i][k])}g.push(j)}return g};goog.array.shuffle=function(h,g){for(var l=g||Math.random,k=h.length-1;0<k;k--){var j=Math.floor(l()*(k+1)),i=h[k];h[k]=h[j];h[j]=i}};goog.array.copyByIndex=function(e,d){var f=[];goog.array.forEach(d,function(a){f.push(e[a])});return f};goog.array.concatMap=function(e,d,f){return goog.array.concat.apply([],goog.array.map(e,d,f))};goog.labs={};goog.labs.userAgent={};goog.labs.userAgent.util={};goog.labs.userAgent.util.getNativeUserAgentString_=function(){var b=goog.labs.userAgent.util.getNavigator_();return b&&(b=b.userAgent)?b:""};goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator};goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_();goog.labs.userAgent.util.setUserAgent=function(b){goog.labs.userAgent.util.userAgent_=b||goog.labs.userAgent.util.getNativeUserAgentString_()};goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_};goog.labs.userAgent.util.matchUserAgent=function(d){var c=goog.labs.userAgent.util.getUserAgent();return goog.string.contains(c,d)};goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(d){var c=goog.labs.userAgent.util.getUserAgent();return goog.string.caseInsensitiveContains(c,d)};goog.labs.userAgent.util.extractVersionTuples=function(f){for(var e=RegExp("(\\w[\\w ]+)/([^\\s]+)\\s*(?:\\((.*?)\\))?","g"),h=[],g;g=e.exec(f);){h.push([g[1],g[2],g[3]||void 0])}return h};goog.object={};goog.object.is=function(d,c){return d===c?0!==d||1/d===1/c:d!==d&&c!==c};goog.object.forEach=function(f,e,h){for(var g in f){e.call(h,f[g],g,f)}};goog.object.filter=function(g,f,j){var i={},h;for(h in g){f.call(j,g[h],h,g)&&(i[h]=g[h])}return i};goog.object.map=function(g,f,j){var i={},h;for(h in g){i[h]=f.call(j,g[h],h,g)}return i};goog.object.some=function(f,e,h){for(var g in f){if(e.call(h,f[g],g,f)){return !0}}return !1};goog.object.every=function(f,e,h){for(var g in f){if(!e.call(h,f[g],g,f)){return !1}}return !0};goog.object.getCount=function(e){var d=0,f;for(f in e){d++}return d};goog.object.getAnyKey=function(d){for(var c in d){return c}};goog.object.getAnyValue=function(d){for(var c in d){return d[c]}};goog.object.contains=function(d,c){return goog.object.containsValue(d,c)};goog.object.getValues=function(f){var e=[],h=0,g;for(g in f){e[h++]=f[g]}return e};goog.object.getKeys=function(f){var e=[],h=0,g;for(g in f){e[h++]=g}return e};goog.object.getValueByKeys=function(f,e){for(var h=goog.isArrayLike(e),g=h?e:arguments,h=h?0:1;h<g.length&&(f=f[g[h]],goog.isDef(f));h++){}return f};goog.object.containsKey=function(d,c){return null!==d&&c in d};goog.object.containsValue=function(e,d){for(var f in e){if(e[f]==d){return !0}}return !1};goog.object.findKey=function(f,e,h){for(var g in f){if(e.call(h,f[g],g,f)){return g}}};goog.object.findValue=function(e,d,f){return(d=goog.object.findKey(e,d,f))&&e[d]};goog.object.isEmpty=function(d){for(var c in d){return !1}return !0};goog.object.clear=function(d){for(var c in d){delete d[c]}};goog.object.remove=function(e,d){var f;(f=d in e)&&delete e[d];return f};goog.object.add=function(e,d,f){if(null!==e&&d in e){throw Error('The object already contains the key "'+d+'"')}goog.object.set(e,d,f)};goog.object.get=function(e,d,f){return null!==e&&d in e?e[d]:f};goog.object.set=function(e,d,f){e[d]=f};goog.object.setIfUndefined=function(e,d,f){return d in e?e[d]:e[d]=f};goog.object.setWithReturnValueIfNotSet=function(e,d,f){if(d in e){return e[d]}f=f();return e[d]=f};goog.object.equals=function(e,d){for(var f in e){if(!(f in d)||e[f]!==d[f]){return !1}}for(f in d){if(!(f in e)){return !1}}return !0};goog.object.clone=function(e){var d={},f;for(f in e){d[f]=e[f]}return d};goog.object.unsafeClone=function(e){var d=goog.typeOf(e);if("object"==d||"array"==d){if(goog.isFunction(e.clone)){return e.clone()}var d="array"==d?[]:{},f;for(f in e){d[f]=goog.object.unsafeClone(e[f])}return d}return e};goog.object.transpose=function(e){var d={},f;for(f in e){d[e[f]]=f}return d};goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");goog.object.extend=function(h,g){for(var l,k,j=1;j<arguments.length;j++){k=arguments[j];for(l in k){h[l]=k[l]}for(var i=0;i<goog.object.PROTOTYPE_FIELDS_.length;i++){l=goog.object.PROTOTYPE_FIELDS_[i],Object.prototype.hasOwnProperty.call(k,l)&&(h[l]=k[l])}}};goog.object.create=function(f){var e=arguments.length;if(1==e&&goog.isArray(arguments[0])){return goog.object.create.apply(null,arguments[0])}if(e%2){throw Error("Uneven number of arguments")}for(var h={},g=0;g<e;g+=2){h[arguments[g]]=arguments[g+1]}return h};goog.object.createSet=function(f){var e=arguments.length;if(1==e&&goog.isArray(arguments[0])){return goog.object.createSet.apply(null,arguments[0])}for(var h={},g=0;g<e;g++){h[arguments[g]]=!0}return h};goog.object.createImmutableView=function(d){var c=d;Object.isFrozen&&!Object.isFrozen(d)&&(c=Object.create(d),Object.freeze(c));return c};goog.object.isImmutableView=function(b){return !!Object.isFrozen&&Object.isFrozen(b)};goog.labs.userAgent.browser={};goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")};goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")};goog.labs.userAgent.browser.matchEdge_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")};goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")};goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdge_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))};goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")};goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")};goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchEdge_()};goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())};goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_;goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_;goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdge_;goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_;goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_;goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_;goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_;goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_;goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_;goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")};goog.labs.userAgent.browser.getVersion=function(){function f(b){b=goog.array.find(b,g);return h[b]||""}var e=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE()){return goog.labs.userAgent.browser.getIEVersion_(e)}var e=goog.labs.userAgent.util.extractVersionTuples(e),h={};goog.array.forEach(e,function(b){h[b[0]]=b[1]});var g=goog.partial(goog.object.containsKey,h);return goog.labs.userAgent.browser.isOpera()?f(["Version","Opera"]):goog.labs.userAgent.browser.isEdge()?f(["Edge"]):goog.labs.userAgent.browser.isChrome()?f(["Chrome","CriOS"]):(e=e[2])&&e[1]||""};goog.labs.userAgent.browser.isVersionOrHigher=function(b){return 0<=goog.string.compareVersions(goog.labs.userAgent.browser.getVersion(),b)};goog.labs.userAgent.browser.getIEVersion_=function(e){var d=/rv: *([\d\.]*)/.exec(e);if(d&&d[1]){return d[1]}var d="",f=/MSIE +([\d\.]+)/.exec(e);if(f&&f[1]){if(e=/Trident\/(\d.\d)/.exec(e),"7.0"==f[1]){if(e&&e[1]){switch(e[1]){case"4.0":d="8.0";break;case"5.0":d="9.0";break;case"6.0":d="10.0";break;case"7.0":d="11.0"}}else{d="7.0"}}else{d=f[1]}}return d};goog.labs.userAgent.engine={};goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")};goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")};goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")};goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()};goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()};goog.labs.userAgent.engine.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent();if(e){var e=goog.labs.userAgent.util.extractVersionTuples(e),d=goog.labs.userAgent.engine.getEngineTuple_(e);if(d){return"Gecko"==d[0]?goog.labs.userAgent.engine.getVersionForKey_(e,"Firefox"):d[1]}var e=e[0],f;if(e&&(f=e[2])&&(f=/Trident\/([^\s;]+)/.exec(f))){return f[1]}}return""};goog.labs.userAgent.engine.getEngineTuple_=function(e){if(!goog.labs.userAgent.engine.isEdge()){return e[1]}for(var d=0;d<e.length;d++){var f=e[d];if("Edge"==f[0]){return f}}};goog.labs.userAgent.engine.isVersionOrHigher=function(b){return 0<=goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),b)};goog.labs.userAgent.engine.getVersionForKey_=function(e,d){var f=goog.array.find(e,function(b){return d==b[0]});return f&&f[1]||""};goog.labs.userAgent.platform={};goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")};goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")};goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")};goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")};goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()};goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")};goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")};goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")};goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")};goog.labs.userAgent.platform.getVersion=function(){var d=goog.labs.userAgent.util.getUserAgent(),c="";goog.labs.userAgent.platform.isWindows()?(c=/Windows (?:NT|Phone) ([0-9.]+)/,c=(d=c.exec(d))?d[1]:"0.0"):goog.labs.userAgent.platform.isIos()?(c=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/,c=(d=c.exec(d))&&d[1].replace(/_/g,".")):goog.labs.userAgent.platform.isMacintosh()?(c=/Mac OS X ([0-9_.]+)/,c=(d=c.exec(d))?d[1].replace(/_/g,"."):"10"):goog.labs.userAgent.platform.isAndroid()?(c=/Android\s+([^\);]+)(\)|;)/,c=(d=c.exec(d))&&d[1]):goog.labs.userAgent.platform.isChromeOS()&&(c=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/,c=(d=c.exec(d))&&d[1]);return c||""};goog.labs.userAgent.platform.isVersionOrHigher=function(b){return 0<=goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),b)};goog.userAgent={};goog.userAgent.ASSUME_IE=!1;goog.userAgent.ASSUME_EDGE=!1;goog.userAgent.ASSUME_GECKO=!1;goog.userAgent.ASSUME_WEBKIT=!1;goog.userAgent.ASSUME_MOBILE_WEBKIT=!1;goog.userAgent.ASSUME_OPERA=!1;goog.userAgent.ASSUME_ANY_VERSION=!1;goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()};goog.userAgent.getNavigator=function(){return goog.global.navigator||null};goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera();goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE();goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge();goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE;goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko();goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit();goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")};goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_();goog.userAgent.SAFARI=goog.userAgent.WEBKIT;goog.userAgent.determinePlatform_=function(){var b=goog.userAgent.getNavigator();return b&&b.platform||""};goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.userAgent.ASSUME_MAC=!1;goog.userAgent.ASSUME_WINDOWS=!1;goog.userAgent.ASSUME_LINUX=!1;goog.userAgent.ASSUME_X11=!1;goog.userAgent.ASSUME_ANDROID=!1;goog.userAgent.ASSUME_IPHONE=!1;goog.userAgent.ASSUME_IPAD=!1;goog.userAgent.ASSUME_IPOD=!1;goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD;goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh();goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows();goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()};goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_();goog.userAgent.isX11_=function(){var b=goog.userAgent.getNavigator();return !!b&&goog.string.contains(b.appVersion||"","X11")};goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_();goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid();goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone();goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad();goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod();goog.userAgent.determineVersion_=function(){var d="",c=goog.userAgent.getVersionRegexResult_();c&&(d=c?c[1]:"");return goog.userAgent.IE&&(c=goog.userAgent.getDocumentMode_(),null!=c&&c>parseFloat(d))?String(c):d};goog.userAgent.getVersionRegexResult_=function(){var b=goog.userAgent.getUserAgentString();if(goog.userAgent.GECKO){return/rv\:([^\);]+)(\)|;)/.exec(b)}if(goog.userAgent.EDGE){return/Edge\/([\d\.]+)/.exec(b)}if(goog.userAgent.IE){return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(b)}if(goog.userAgent.WEBKIT){return/WebKit\/(\S+)/.exec(b)}if(goog.userAgent.OPERA){return/(?:Version)[ \/]?(\S+)/.exec(b)}};goog.userAgent.getDocumentMode_=function(){var b=goog.global.document;return b?b.documentMode:void 0};goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(d,c){return goog.string.compareVersions(d,c)};goog.userAgent.isVersionOrHigherCache_={};goog.userAgent.isVersionOrHigher=function(b){return goog.userAgent.ASSUME_ANY_VERSION||goog.userAgent.isVersionOrHigherCache_[b]||(goog.userAgent.isVersionOrHigherCache_[b]=0<=goog.string.compareVersions(goog.userAgent.VERSION,b))};goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher;goog.userAgent.isDocumentModeOrHigher=function(b){return Number(goog.userAgent.DOCUMENT_MODE)>=b};goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher;goog.userAgent.DOCUMENT_MODE=function(){var d=goog.global.document,c=goog.userAgent.getDocumentMode_();if(d&&goog.userAgent.IE){return c||("CSS1Compat"==d.compatMode?parseInt(goog.userAgent.VERSION,10):5)}}();goog.events={};goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("8")||goog.userAgent.OPERA&&goog.userAgent.isVersionOrHigher("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("8")||goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart" in goog.global||!!(goog.global.document&&document.documentElement&&"ontouchstart" in document.documentElement)||!(!goog.global.navigator||!goog.global.navigator.msMaxTouchPoints)};goog.disposable={};goog.disposable.IDisposable=function(){};goog.disposable.IDisposable.prototype.dispose=goog.abstractMethod;goog.disposable.IDisposable.prototype.isDisposed=goog.abstractMethod;goog.Disposable=function(){goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&(goog.Disposable.INCLUDE_STACK_ON_CREATION&&(this.creationStack=Error().stack),goog.Disposable.instances_[goog.getUid(this)]=this);this.disposed_=this.disposed_;this.onDisposeCallbacks_=this.onDisposeCallbacks_};goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2};goog.Disposable.MONITORING_MODE=0;goog.Disposable.INCLUDE_STACK_ON_CREATION=!0;goog.Disposable.instances_={};goog.Disposable.getUndisposedObjects=function(){var d=[],c;for(c in goog.Disposable.instances_){goog.Disposable.instances_.hasOwnProperty(c)&&d.push(goog.Disposable.instances_[Number(c)])}return d};goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=!1;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;goog.Disposable.prototype.dispose=function(){if(!this.disposed_&&(this.disposed_=!0,this.disposeInternal(),goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF)){var b=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(b)){throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call")}delete goog.Disposable.instances_[b]}};goog.Disposable.prototype.registerDisposable=function(b){this.addOnDisposeCallback(goog.partial(goog.dispose,b))};goog.Disposable.prototype.addOnDisposeCallback=function(d,c){this.disposed_?d.call(c):(this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]),this.onDisposeCallbacks_.push(goog.isDef(c)?goog.bind(d,c):d))};goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_){for(;this.onDisposeCallbacks_.length;){this.onDisposeCallbacks_.shift()()}}};goog.Disposable.isDisposed=function(b){return b&&"function"==typeof b.isDisposed?b.isDisposed():!1};goog.dispose=function(b){b&&"function"==typeof b.dispose&&b.dispose()};goog.disposeAll=function(f){for(var e=0,h=arguments.length;e<h;++e){var g=arguments[e];goog.isArrayLike(g)?goog.disposeAll.apply(null,g):goog.dispose(g)}};goog.events.EventId=function(b){this.id=b};goog.events.EventId.prototype.toString=function(){return this.id};goog.events.Event=function(d,c){this.type=d instanceof goog.events.EventId?String(d):d;this.currentTarget=this.target=c;this.defaultPrevented=this.propagationStopped_=!1;this.returnValue_=!0};goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0};goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0;this.returnValue_=!1};goog.events.Event.stopPropagation=function(b){b.stopPropagation()};goog.events.Event.preventDefault=function(b){b.preventDefault()};goog.events.getVendorPrefixedName_=function(b){return goog.userAgent.WEBKIT?"webkit"+b:goog.userAgent.OPERA?"o"+b.toLowerCase():b.toLowerCase()};goog.events.EventType={CLICK:"click",RIGHTCLICK:"rightclick",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTSTART:"selectstart",WHEEL:"wheel",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:goog.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:goog.userAgent.IE?"focusout":"DOMFocusOut",CHANGE:"change",RESET:"reset",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONSOLEMESSAGE:"consolemessage",CONTEXTMENU:"contextmenu",DOMCONTENTLOADED:"DOMContentLoaded",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",ORIENTATIONCHANGE:"orientationchange",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",TIMEUPDATE:"timeupdate",UNLOAD:"unload",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",ANIMATIONSTART:goog.events.getVendorPrefixedName_("AnimationStart"),ANIMATIONEND:goog.events.getVendorPrefixedName_("AnimationEnd"),ANIMATIONITERATION:goog.events.getVendorPrefixedName_("AnimationIteration"),TRANSITIONEND:goog.events.getVendorPrefixedName_("TransitionEnd"),POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERCANCEL:"pointercancel",POINTERMOVE:"pointermove",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERENTER:"MSPointerEnter",MSPOINTERHOVER:"MSPointerHover",MSPOINTERLEAVE:"MSPointerLeave",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROUT:"MSPointerOut",MSPOINTEROVER:"MSPointerOver",MSPOINTERUP:"MSPointerUp",TEXT:"text",TEXTINPUT:"textInput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",EXIT:"exit",LOADABORT:"loadabort",LOADCOMMIT:"loadcommit",LOADREDIRECT:"loadredirect",LOADSTART:"loadstart",LOADSTOP:"loadstop",RESPONSIVE:"responsive",SIZECHANGED:"sizechanged",UNRESPONSIVE:"unresponsive",VISIBILITYCHANGE:"visibilitychange",STORAGE:"storage",DOMSUBTREEMODIFIED:"DOMSubtreeModified",DOMNODEINSERTED:"DOMNodeInserted",DOMNODEREMOVED:"DOMNodeRemoved",DOMNODEREMOVEDFROMDOCUMENT:"DOMNodeRemovedFromDocument",DOMNODEINSERTEDINTODOCUMENT:"DOMNodeInsertedIntoDocument",DOMATTRMODIFIED:"DOMAttrModified",DOMCHARACTERDATAMODIFIED:"DOMCharacterDataModified",BEFOREPRINT:"beforeprint",AFTERPRINT:"afterprint"};goog.reflect={};goog.reflect.object=function(d,c){return c};goog.reflect.objectProperty=function(d,c){return d};goog.reflect.sinkValue=function(b){goog.reflect.sinkValue[" "](b);return b};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(e,d){try{return goog.reflect.sinkValue(e[d]),!0}catch(f){}return !1};goog.reflect.cache=function(f,e,h,g){g=g?g(e):e;return Object.prototype.hasOwnProperty.call(f,g)?f[g]:f[g]=h(e)};goog.events.BrowserEvent=function(d,c){goog.events.Event.call(this,d?d.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.charCode=this.keyCode=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.platformModifierKey=!1;this.event_=null;d&&this.init(d,c)};goog.inherits(goog.events.BrowserEvent,goog.events.Event);goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};goog.events.BrowserEvent.IEButtonMap=[1,4,2];goog.events.BrowserEvent.prototype.init=function(g,f){var j=this.type=g.type,i=g.changedTouches?g.changedTouches[0]:null;this.target=g.target||g.srcElement;this.currentTarget=f;var h=g.relatedTarget;h?goog.userAgent.GECKO&&(goog.reflect.canAccessProperty(h,"nodeName")||(h=null)):j==goog.events.EventType.MOUSEOVER?h=g.fromElement:j==goog.events.EventType.MOUSEOUT&&(h=g.toElement);this.relatedTarget=h;goog.isNull(i)?(this.offsetX=goog.userAgent.WEBKIT||void 0!==g.offsetX?g.offsetX:g.layerX,this.offsetY=goog.userAgent.WEBKIT||void 0!==g.offsetY?g.offsetY:g.layerY,this.clientX=void 0!==g.clientX?g.clientX:g.pageX,this.clientY=void 0!==g.clientY?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0);this.button=g.button;this.keyCode=g.keyCode||0;this.charCode=g.charCode||("keypress"==j?g.keyCode:0);this.ctrlKey=g.ctrlKey;this.altKey=g.altKey;this.shiftKey=g.shiftKey;this.metaKey=g.metaKey;this.platformModifierKey=goog.userAgent.MAC?g.metaKey:g.ctrlKey;this.state=g.state;this.event_=g;g.defaultPrevented&&this.preventDefault()};goog.events.BrowserEvent.prototype.isButton=function(b){return goog.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==b:"click"==this.type?b==goog.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&goog.events.BrowserEvent.IEButtonMap[b])};goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)};goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0};goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var d=this.event_;if(d.preventDefault){d.preventDefault()}else{if(d.returnValue=!1,goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT){try{if(d.ctrlKey||112<=d.keyCode&&123>=d.keyCode){d.keyCode=-1}}catch(c){}}}};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.Listenable=function(){};goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1000000*Math.random()|0);goog.events.Listenable.addImplementation=function(b){b.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=!0};goog.events.Listenable.isImplementedBy=function(b){return !(!b||!b[goog.events.Listenable.IMPLEMENTED_BY_PROP])};goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;goog.events.ListenableKey.reserveKey=function(){return ++goog.events.ListenableKey.counter_};goog.events.Listener=function(h,g,l,k,j,i){goog.events.Listener.ENABLE_MONITORING&&(this.creationStack=Error().stack);this.listener=h;this.proxy=g;this.src=l;this.type=k;this.capture=!!j;this.handler=i;this.key=goog.events.ListenableKey.reserveKey();this.removed=this.callOnce=!1};goog.events.Listener.ENABLE_MONITORING=!1;goog.events.Listener.prototype.markAsRemoved=function(){this.removed=!0;this.handler=this.src=this.proxy=this.listener=null};goog.events.ListenerMap=function(b){this.src=b;this.listeners={};this.typeCount_=0};goog.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_};goog.events.ListenerMap.prototype.getListenerCount=function(){var d=0,c;for(c in this.listeners){d+=this.listeners[c].length}return d};goog.events.ListenerMap.prototype.add=function(i,h,n,m,l){var k=i.toString();i=this.listeners[k];i||(i=this.listeners[k]=[],this.typeCount_++);var j=goog.events.ListenerMap.findListenerIndex_(i,h,m,l);-1<j?(h=i[j],n||(h.callOnce=!1)):(h=new goog.events.Listener(h,null,this.src,k,!!m,l),h.callOnce=n,i.push(h));return h};goog.events.ListenerMap.prototype.remove=function(g,f,j,i){g=g.toString();if(!(g in this.listeners)){return !1}var h=this.listeners[g];f=goog.events.ListenerMap.findListenerIndex_(h,f,j,i);return -1<f?(h[f].markAsRemoved(),goog.array.removeAt(h,f),0==h.length&&(delete this.listeners[g],this.typeCount_--),!0):!1};goog.events.ListenerMap.prototype.removeByKey=function(e){var d=e.type;if(!(d in this.listeners)){return !1}var f=goog.array.remove(this.listeners[d],e);f&&(e.markAsRemoved(),0==this.listeners[d].length&&(delete this.listeners[d],this.typeCount_--));return f};goog.events.ListenerMap.prototype.removeAll=function(g){g=g&&g.toString();var f=0,j;for(j in this.listeners){if(!g||j==g){for(var i=this.listeners[j],h=0;h<i.length;h++){++f,i[h].markAsRemoved()}delete this.listeners[j];this.typeCount_--}}return f};goog.events.ListenerMap.prototype.getListeners=function(h,g){var l=this.listeners[h.toString()],k=[];if(l){for(var j=0;j<l.length;++j){var i=l[j];i.capture==g&&k.push(i)}}return k};goog.events.ListenerMap.prototype.getListener=function(g,f,j,i){g=this.listeners[g.toString()];var h=-1;g&&(h=goog.events.ListenerMap.findListenerIndex_(g,f,j,i));return -1<h?g[h]:null};goog.events.ListenerMap.prototype.hasListener=function(g,f){var j=goog.isDef(g),i=j?g.toString():"",h=goog.isDef(f);return goog.object.some(this.listeners,function(b,c){for(var d=0;d<b.length;++d){if(!(j&&b[d].type!=i||h&&b[d].capture!=f)){return !0}}return !1})};goog.events.ListenerMap.findListenerIndex_=function(h,g,l,k){for(var j=0;j<h.length;++j){var i=h[j];if(!i.removed&&i.listener==g&&i.capture==!!l&&i.handler==k){return j}}return -1};goog.events.LISTENER_MAP_PROP_="closure_lm_"+(1000000*Math.random()|0);goog.events.onString_="on";goog.events.onStringMap_={};goog.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2};goog.events.CAPTURE_SIMULATION_MODE=2;goog.events.listenerCountEstimate_=0;goog.events.listen=function(h,g,l,k,j){if(goog.isArray(g)){for(var i=0;i<g.length;i++){goog.events.listen(h,g[i],l,k,j)}return null}l=goog.events.wrapListener(l);return goog.events.Listenable.isImplementedBy(h)?h.listen(g,l,k,j):goog.events.listen_(h,g,l,!1,k,j)};goog.events.listen_=function(j,i,p,o,n,m){if(!i){throw Error("Invalid event type")}var l=!!n;if(l&&!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_FAIL){return goog.asserts.fail("Can not register capture listener in IE8-."),null}if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_SILENT){return null}}var k=goog.events.getListenerMap_(j);k||(j[goog.events.LISTENER_MAP_PROP_]=k=new goog.events.ListenerMap(j));p=k.add(i,p,o,n,m);if(p.proxy){return p}o=goog.events.getProxy();p.proxy=o;o.src=j;o.listener=p;if(j.addEventListener){j.addEventListener(i.toString(),o,l)}else{if(j.attachEvent){j.attachEvent(goog.events.getOnString_(i.toString()),o)}else{throw Error("addEventListener and attachEvent are unavailable.")}}goog.events.listenerCountEstimate_++;return p};goog.events.getProxy=function(){var d=goog.events.handleBrowserEvent_,c=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(a){return d.call(c.src,c.listener,a)}:function(a){a=d.call(c.src,c.listener,a);if(!a){return a}};return c};goog.events.listenOnce=function(h,g,l,k,j){if(goog.isArray(g)){for(var i=0;i<g.length;i++){goog.events.listenOnce(h,g[i],l,k,j)}return null}l=goog.events.wrapListener(l);return goog.events.Listenable.isImplementedBy(h)?h.listenOnce(g,l,k,j):goog.events.listen_(h,g,l,!0,k,j)};goog.events.listenWithWrapper=function(g,f,j,i,h){f.listen(g,j,i,h)};goog.events.unlisten=function(h,g,l,k,j){if(goog.isArray(g)){for(var i=0;i<g.length;i++){goog.events.unlisten(h,g[i],l,k,j)}return null}l=goog.events.wrapListener(l);if(goog.events.Listenable.isImplementedBy(h)){return h.unlisten(g,l,k,j)}if(!h){return !1}k=!!k;if(h=goog.events.getListenerMap_(h)){if(g=h.getListener(g,l,k,j)){return goog.events.unlistenByKey(g)}}return !1};goog.events.unlistenByKey=function(f){if(goog.isNumber(f)||!f||f.removed){return !1}var e=f.src;if(goog.events.Listenable.isImplementedBy(e)){return e.unlistenByKey(f)}var h=f.type,g=f.proxy;e.removeEventListener?e.removeEventListener(h,g,f.capture):e.detachEvent&&e.detachEvent(goog.events.getOnString_(h),g);goog.events.listenerCountEstimate_--;(h=goog.events.getListenerMap_(e))?(h.removeByKey(f),0==h.getTypeCount()&&(h.src=null,e[goog.events.LISTENER_MAP_PROP_]=null)):f.markAsRemoved();return !0};goog.events.unlistenWithWrapper=function(g,f,j,i,h){f.unlisten(g,j,i,h)};goog.events.removeAll=function(j,i){if(!j){return 0}if(goog.events.Listenable.isImplementedBy(j)){return j.removeAllListeners(i)}var p=goog.events.getListenerMap_(j);if(!p){return 0}var o=0,n=i&&i.toString(),m;for(m in p.listeners){if(!n||m==n){for(var l=p.listeners[m].concat(),k=0;k<l.length;++k){goog.events.unlistenByKey(l[k])&&++o}}}return o};goog.events.getListeners=function(e,d,f){return goog.events.Listenable.isImplementedBy(e)?e.getListeners(d,f):e?(e=goog.events.getListenerMap_(e))?e.getListeners(d,f):[]:[]};goog.events.getListener=function(g,f,j,i,h){j=goog.events.wrapListener(j);i=!!i;return goog.events.Listenable.isImplementedBy(g)?g.getListener(f,j,i,h):g?(g=goog.events.getListenerMap_(g))?g.getListener(f,j,i,h):null:null};goog.events.hasListener=function(e,d,f){if(goog.events.Listenable.isImplementedBy(e)){return e.hasListener(d,f)}e=goog.events.getListenerMap_(e);return !!e&&e.hasListener(d,f)};goog.events.expose=function(e){var d=[],f;for(f in e){e[f]&&e[f].id?d.push(f+" = "+e[f]+" ("+e[f].id+")"):d.push(f+" = "+e[f])}return d.join("\n")};goog.events.getOnString_=function(b){return b in goog.events.onStringMap_?goog.events.onStringMap_[b]:goog.events.onStringMap_[b]=goog.events.onString_+b};goog.events.fireListeners=function(f,e,h,g){return goog.events.Listenable.isImplementedBy(f)?f.fireListeners(e,h,g):goog.events.fireListeners_(f,e,h,g)};goog.events.fireListeners_=function(h,g,l,k){var j=!0;if(h=goog.events.getListenerMap_(h)){if(g=h.listeners[g.toString()]){for(g=g.concat(),h=0;h<g.length;h++){var i=g[h];i&&i.capture==l&&!i.removed&&(i=goog.events.fireListener(i,k),j=j&&!1!==i)}}}return j};goog.events.fireListener=function(f,e){var h=f.listener,g=f.handler||f.src;f.callOnce&&goog.events.unlistenByKey(f);return h.call(g,e)};goog.events.getTotalListenerCount=function(){return goog.events.listenerCountEstimate_};goog.events.dispatchEvent=function(d,c){goog.asserts.assert(goog.events.Listenable.isImplementedBy(d),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance.");return d.dispatchEvent(c)};goog.events.protectBrowserEventEntryPoint=function(b){goog.events.handleBrowserEvent_=b.protectEntryPoint(goog.events.handleBrowserEvent_)};goog.events.handleBrowserEvent_=function(j,i){if(j.removed){return !0}if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var p=i||goog.getObjectByName("window.event"),o=new goog.events.BrowserEvent(p,this),n=!0;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.ON){if(!goog.events.isMarkedIeEvent_(p)){goog.events.markIeEvent_(p);for(var p=[],m=o.currentTarget;m;m=m.parentNode){p.push(m)}for(var m=j.type,l=p.length-1;!o.propagationStopped_&&0<=l;l--){o.currentTarget=p[l];var k=goog.events.fireListeners_(p[l],m,!0,o),n=n&&k}for(l=0;!o.propagationStopped_&&l<p.length;l++){o.currentTarget=p[l],k=goog.events.fireListeners_(p[l],m,!1,o),n=n&&k}}}else{n=goog.events.fireListener(j,o)}return n}return goog.events.fireListener(j,new goog.events.BrowserEvent(i,this))};goog.events.markIeEvent_=function(e){var d=!1;if(0==e.keyCode){try{e.keyCode=-1;return}catch(f){d=!0}}if(d||void 0==e.returnValue){e.returnValue=!0}};goog.events.isMarkedIeEvent_=function(b){return 0>b.keyCode||void 0!=b.returnValue};goog.events.uniqueIdCounter_=0;goog.events.getUniqueId=function(b){return b+"_"+goog.events.uniqueIdCounter_++};goog.events.getListenerMap_=function(b){b=b[goog.events.LISTENER_MAP_PROP_];return b instanceof goog.events.ListenerMap?b:null};goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1000000000*Math.random()>>>0);goog.events.wrapListener=function(b){goog.asserts.assert(b,"Listener can not be null.");if(goog.isFunction(b)){return b}goog.asserts.assert(b.handleEvent,"An object listener must have handleEvent method.");b[goog.events.LISTENER_WRAPPER_PROP_]||(b[goog.events.LISTENER_WRAPPER_PROP_]=function(a){return b.handleEvent(a)});return b[goog.events.LISTENER_WRAPPER_PROP_]};goog.debug.entryPointRegistry.register(function(b){goog.events.handleBrowserEvent_=b(goog.events.handleBrowserEvent_)});goog.math={};goog.math.randomInt=function(b){return Math.floor(Math.random()*b)};goog.math.uniformRandom=function(d,c){return d+Math.random()*(c-d)};goog.math.clamp=function(e,d,f){return Math.min(Math.max(e,d),f)};goog.math.modulo=function(e,d){var f=e%d;return 0>f*d?f+d:f};goog.math.lerp=function(e,d,f){return e+f*(d-e)};goog.math.nearlyEquals=function(e,d,f){return Math.abs(e-d)<=(f||0.000001)};goog.math.standardAngle=function(b){return goog.math.modulo(b,360)};goog.math.standardAngleInRadians=function(b){return goog.math.modulo(b,2*Math.PI)};goog.math.toRadians=function(b){return b*Math.PI/180};goog.math.toDegrees=function(b){return 180*b/Math.PI};goog.math.angleDx=function(d,c){return c*Math.cos(goog.math.toRadians(d))};goog.math.angleDy=function(d,c){return c*Math.sin(goog.math.toRadians(d))};goog.math.angle=function(f,e,h,g){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(g-e,h-f)))};goog.math.angleDifference=function(e,d){var f=goog.math.standardAngle(d)-goog.math.standardAngle(e);180<f?f-=360:-180>=f&&(f=360+f);return f};goog.math.sign=Math.sign||function(b){return 0<b?1:0>b?-1:b};goog.math.longestCommonSubsequence=function(t,s,r,q){r=r||function(d,c){return d==c};q=q||function(a,d){return t[a]};for(var p=t.length,o=s.length,m=[],l=0;l<p+1;l++){m[l]=[],m[l][0]=0}for(var j=0;j<o+1;j++){m[0][j]=0}for(l=1;l<=p;l++){for(j=1;j<=o;j++){r(t[l-1],s[j-1])?m[l][j]=m[l-1][j-1]+1:m[l][j]=Math.max(m[l-1][j],m[l][j-1])}}for(var i=[],l=p,j=o;0<l&&0<j;){r(t[l-1],s[j-1])?(i.unshift(q(l-1,j-1)),l--,j--):m[l-1][j]>m[l][j-1]?l--:j--}return i};goog.math.sum=function(b){return goog.array.reduce(arguments,function(d,e){return d+e},0)};goog.math.average=function(b){return goog.math.sum.apply(null,arguments)/arguments.length};goog.math.sampleVariance=function(e){var d=arguments.length;if(2>d){return 0}var f=goog.math.average.apply(null,arguments);return goog.math.sum.apply(null,goog.array.map(arguments,function(b){return Math.pow(b-f,2)}))/(d-1)};goog.math.standardDeviation=function(b){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))};goog.math.isInt=function(b){return isFinite(b)&&0==b%1};goog.math.isFiniteNumber=function(b){return isFinite(b)&&!isNaN(b)};goog.math.isNegativeZero=function(b){return 0==b&&0>1/b};goog.math.log10Floor=function(d){if(0<d){var c=Math.round(Math.log(d)*Math.LOG10E);return c-(parseFloat("1e"+c)>d?1:0)}return 0==d?-Infinity:NaN};goog.math.safeFloor=function(d,c){goog.asserts.assert(!goog.isDef(c)||0<c);return Math.floor(d+(c||2e-15))};goog.math.safeCeil=function(d,c){goog.asserts.assert(!goog.isDef(c)||0<c);return Math.ceil(d-(c||2e-15))};goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentModeOrHigher(9)||goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE,LEGACY_IE_RANGES:goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)};goog.dom.TagName={A:"A",ABBR:"ABBR",ACRONYM:"ACRONYM",ADDRESS:"ADDRESS",APPLET:"APPLET",AREA:"AREA",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",B:"B",BASE:"BASE",BASEFONT:"BASEFONT",BDI:"BDI",BDO:"BDO",BIG:"BIG",BLOCKQUOTE:"BLOCKQUOTE",BODY:"BODY",BR:"BR",BUTTON:"BUTTON",CANVAS:"CANVAS",CAPTION:"CAPTION",CENTER:"CENTER",CITE:"CITE",CODE:"CODE",COL:"COL",COLGROUP:"COLGROUP",COMMAND:"COMMAND",DATA:"DATA",DATALIST:"DATALIST",DD:"DD",DEL:"DEL",DETAILS:"DETAILS",DFN:"DFN",DIALOG:"DIALOG",DIR:"DIR",DIV:"DIV",DL:"DL",DT:"DT",EM:"EM",EMBED:"EMBED",FIELDSET:"FIELDSET",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FONT:"FONT",FOOTER:"FOOTER",FORM:"FORM",FRAME:"FRAME",FRAMESET:"FRAMESET",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEAD:"HEAD",HEADER:"HEADER",HGROUP:"HGROUP",HR:"HR",HTML:"HTML",I:"I",IFRAME:"IFRAME",IMG:"IMG",INPUT:"INPUT",INS:"INS",ISINDEX:"ISINDEX",KBD:"KBD",KEYGEN:"KEYGEN",LABEL:"LABEL",LEGEND:"LEGEND",LI:"LI",LINK:"LINK",MAP:"MAP",MARK:"MARK",MATH:"MATH",MENU:"MENU",META:"META",METER:"METER",NAV:"NAV",NOFRAMES:"NOFRAMES",NOSCRIPT:"NOSCRIPT",OBJECT:"OBJECT",OL:"OL",OPTGROUP:"OPTGROUP",OPTION:"OPTION",OUTPUT:"OUTPUT",P:"P",PARAM:"PARAM",PRE:"PRE",PROGRESS:"PROGRESS",Q:"Q",RP:"RP",RT:"RT",RUBY:"RUBY",S:"S",SAMP:"SAMP",SCRIPT:"SCRIPT",SECTION:"SECTION",SELECT:"SELECT",SMALL:"SMALL",SOURCE:"SOURCE",SPAN:"SPAN",STRIKE:"STRIKE",STRONG:"STRONG",STYLE:"STYLE",SUB:"SUB",SUMMARY:"SUMMARY",SUP:"SUP",SVG:"SVG",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TEMPLATE:"TEMPLATE",TEXTAREA:"TEXTAREA",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",TIME:"TIME",TITLE:"TITLE",TR:"TR",TRACK:"TRACK",TT:"TT",U:"U",UL:"UL",VAR:"VAR",VIDEO:"VIDEO",WBR:"WBR"};goog.dom.tags={};goog.dom.tags.VOID_TAGS_={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};goog.dom.tags.isVoidTag=function(b){return !0===goog.dom.tags.VOID_TAGS_[b]};goog.string.TypedString=function(){};goog.string.Const=function(){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_="";this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_};goog.string.Const.prototype.implementsGoogStringTypedString=!0;goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_};goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"};goog.string.Const.unwrap=function(b){if(b instanceof goog.string.Const&&b.constructor===goog.string.Const&&b.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_){return b.stringConstValueWithSecurityContract__googStringSecurityPrivate_}goog.asserts.fail("expected object of type Const, got '"+b+"'");return"type_error:Const"};goog.string.Const.from=function(b){return goog.string.Const.create__googStringSecurityPrivate_(b)};goog.string.Const.TYPE_MARKER_={};goog.string.Const.create__googStringSecurityPrivate_=function(d){var c=new goog.string.Const;c.stringConstValueWithSecurityContract__googStringSecurityPrivate_=d;return c};goog.html={};goog.html.SafeStyle=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="";this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeStyle.prototype.implementsGoogStringTypedString=!0;goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeStyle.fromConstant=function(b){b=goog.string.Const.unwrap(b);if(0===b.length){return goog.html.SafeStyle.EMPTY}goog.html.SafeStyle.checkStyle_(b);goog.asserts.assert(goog.string.endsWith(b,";"),"Last character of style string is not ';': "+b);goog.asserts.assert(goog.string.contains(b,":"),"Style string must contain at least one ':', to specify a \"name: value\" pair: "+b);return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(b)};goog.html.SafeStyle.checkStyle_=function(b){goog.asserts.assert(!/[<>]/.test(b),"Forbidden characters in style string: "+b)};goog.html.SafeStyle.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_};goog.DEBUG&&(goog.html.SafeStyle.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"});goog.html.SafeStyle.unwrap=function(b){if(b instanceof goog.html.SafeStyle&&b.constructor===goog.html.SafeStyle&&b.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_){return b.privateDoNotAccessOrElseSafeStyleWrappedValue_}goog.asserts.fail("expected object of type SafeStyle, got '"+b+"' of type "+goog.typeOf(b));return"type_error:SafeStyle"};goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse=function(b){return(new goog.html.SafeStyle).initSecurityPrivateDoNotAccessOrElse_(b)};goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_=function(b){this.privateDoNotAccessOrElseSafeStyleWrappedValue_=b;return this};goog.html.SafeStyle.EMPTY=goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse("");goog.html.SafeStyle.INNOCUOUS_STRING="zClosurez";goog.html.SafeStyle.create=function(f){var e="",h;for(h in f){if(!/^[-_a-zA-Z0-9]+$/.test(h)){throw Error("Name allows only [-_a-zA-Z0-9], got: "+h)}var g=f[h];null!=g&&(g instanceof goog.string.Const?(g=goog.string.Const.unwrap(g),goog.asserts.assert(!/[{;}]/.test(g),"Value does not allow [{;}].")):goog.html.SafeStyle.VALUE_RE_.test(g)?goog.html.SafeStyle.hasBalancedQuotes_(g)||(goog.asserts.fail("String value requires balanced quotes, got: "+g),g=goog.html.SafeStyle.INNOCUOUS_STRING):(goog.asserts.fail("String value allows only [-,.\"'%_!# a-zA-Z0-9], rgb() and rgba(), got: "+g),g=goog.html.SafeStyle.INNOCUOUS_STRING),e+=h+":"+g+";")}if(!e){return goog.html.SafeStyle.EMPTY}goog.html.SafeStyle.checkStyle_(e);return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(e)};goog.html.SafeStyle.hasBalancedQuotes_=function(g){for(var f=!0,j=!0,i=0;i<g.length;i++){var h=g.charAt(i);"'"==h&&j?f=!f:'"'==h&&f&&(j=!j)}return f&&j};goog.html.SafeStyle.VALUE_RE_=/^([-,."'%_!# a-zA-Z0-9]+|(?:rgb|hsl)a?\([0-9.%, ]+\))$/;goog.html.SafeStyle.concat=function(e){var d="",f=function(b){goog.isArray(b)?goog.array.forEach(b,f):d+=goog.html.SafeStyle.unwrap(b)};goog.array.forEach(arguments,f);return d?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(d):goog.html.SafeStyle.EMPTY};goog.html.SafeStyleSheet=function(){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_="";this.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString=!0;goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeStyleSheet.concat=function(e){var d="",f=function(b){goog.isArray(b)?goog.array.forEach(b,f):d+=goog.html.SafeStyleSheet.unwrap(b)};goog.array.forEach(arguments,f);return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(d)};goog.html.SafeStyleSheet.fromConstant=function(b){b=goog.string.Const.unwrap(b);if(0===b.length){return goog.html.SafeStyleSheet.EMPTY}goog.asserts.assert(!goog.string.contains(b,"<"),"Forbidden '<' character in style sheet string: "+b);return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(b)};goog.html.SafeStyleSheet.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_};goog.DEBUG&&(goog.html.SafeStyleSheet.prototype.toString=function(){return"SafeStyleSheet{"+this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_+"}"});goog.html.SafeStyleSheet.unwrap=function(b){if(b instanceof goog.html.SafeStyleSheet&&b.constructor===goog.html.SafeStyleSheet&&b.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_){return b.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_}goog.asserts.fail("expected object of type SafeStyleSheet, got '"+b+"' of type "+goog.typeOf(b));return"type_error:SafeStyleSheet"};goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse=function(b){return(new goog.html.SafeStyleSheet).initSecurityPrivateDoNotAccessOrElse_(b)};goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_=function(b){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=b;return this};goog.html.SafeStyleSheet.EMPTY=goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse("");goog.fs={};goog.fs.url={};goog.fs.url.createObjectUrl=function(b){return goog.fs.url.getUrlObject_().createObjectURL(b)};goog.fs.url.revokeObjectUrl=function(b){goog.fs.url.getUrlObject_().revokeObjectURL(b)};goog.fs.url.getUrlObject_=function(){var b=goog.fs.url.findUrlObject_();if(null!=b){return b}throw Error("This browser doesn't seem to support blob URLs")};goog.fs.url.findUrlObject_=function(){return goog.isDef(goog.global.URL)&&goog.isDef(goog.global.URL.createObjectURL)?goog.global.URL:goog.isDef(goog.global.webkitURL)&&goog.isDef(goog.global.webkitURL.createObjectURL)?goog.global.webkitURL:goog.isDef(goog.global.createObjectURL)?goog.global:null};goog.fs.url.browserSupportsObjectUrls=function(){return null!=goog.fs.url.findUrlObject_()};goog.i18n={};goog.i18n.bidi={};goog.i18n.bidi.FORCE_RTL=!1;goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ps"==goog.LOCALE.substring(0,2).toLowerCase()||"sd"==goog.LOCALE.substring(0,2).toLowerCase()||"ug"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))||3<=goog.LOCALE.length&&"ckb"==goog.LOCALE.substring(0,3).toLowerCase()&&(3==goog.LOCALE.length||"-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4));goog.i18n.bidi.Format={LRE:"\u202a",RLE:"\u202b",PDF:"\u202c",LRM:"\u200e",RLM:"\u200f"};goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0};goog.i18n.bidi.RIGHT="right";goog.i18n.bidi.LEFT="left";goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT;goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT;goog.i18n.bidi.toDir=function(d,c){return"number"==typeof d?0<d?goog.i18n.bidi.Dir.LTR:0>d?goog.i18n.bidi.Dir.RTL:c?null:goog.i18n.bidi.Dir.NEUTRAL:null==d?null:d?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.ltrChars_="A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff";goog.i18n.bidi.rtlChars_="\u0591-\u06ef\u06fa-\u07ff\u200f\ufb1d-\ufdff\ufe70-\ufefc";goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g;goog.i18n.bidi.stripHtmlIfNeeded_=function(d,c){return c?d.replace(goog.i18n.bidi.htmlSkipReg_,""):d};goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.hasAnyRtl=function(d,c){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(d,c))};goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl;goog.i18n.bidi.hasAnyLtr=function(d,c){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(d,c))};goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.isRtlChar=function(b){return goog.i18n.bidi.rtlRe_.test(b)};goog.i18n.bidi.isLtrChar=function(b){return goog.i18n.bidi.ltrRe_.test(b)};goog.i18n.bidi.isNeutralChar=function(b){return !goog.i18n.bidi.isLtrChar(b)&&!goog.i18n.bidi.isRtlChar(b)};goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.startsWithRtl=function(d,c){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(d,c))};goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl;goog.i18n.bidi.startsWithLtr=function(d,c){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(d,c))};goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr;goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/;goog.i18n.bidi.isNeutralText=function(d,c){d=goog.i18n.bidi.stripHtmlIfNeeded_(d,c);return goog.i18n.bidi.isRequiredLtrRe_.test(d)||!goog.i18n.bidi.hasAnyLtr(d)&&!goog.i18n.bidi.hasAnyRtl(d)};goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$");goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$");goog.i18n.bidi.endsWithLtr=function(d,c){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(d,c))};goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr;goog.i18n.bidi.endsWithRtl=function(d,c){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(d,c))};goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl;goog.i18n.bidi.rtlLocalesRe_=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;goog.i18n.bidi.isRtlLanguage=function(b){return goog.i18n.bidi.rtlLocalesRe_.test(b)};goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g;goog.i18n.bidi.guardBracketInText=function(e,d){var f=(void 0===d?goog.i18n.bidi.hasAnyRtl(e):d)?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return e.replace(goog.i18n.bidi.bracketGuardTextRe_,f+"$&"+f)};goog.i18n.bidi.enforceRtlInHtml=function(b){return"<"==b.charAt(0)?b.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+b+"</span>"};goog.i18n.bidi.enforceRtlInText=function(b){return goog.i18n.bidi.Format.RLE+b+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.enforceLtrInHtml=function(b){return"<"==b.charAt(0)?b.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+b+"</span>"};goog.i18n.bidi.enforceLtrInText=function(b){return goog.i18n.bidi.Format.LRE+b+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g;goog.i18n.bidi.leftRe_=/left/gi;goog.i18n.bidi.rightRe_=/right/gi;goog.i18n.bidi.tempRe_=/%%%%/g;goog.i18n.bidi.mirrorCSS=function(b){return b.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)};goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g;goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g;goog.i18n.bidi.normalizeHebrewQuote=function(b){return b.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1\u05f4").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1\u05f3")};goog.i18n.bidi.wordSeparatorRe_=/\s+/;goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/;goog.i18n.bidi.rtlDetectionThreshold_=0.4;goog.i18n.bidi.estimateDirection=function(j,i){for(var p=0,o=0,n=!1,m=goog.i18n.bidi.stripHtmlIfNeeded_(j,i).split(goog.i18n.bidi.wordSeparatorRe_),l=0;l<m.length;l++){var k=m[l];goog.i18n.bidi.startsWithRtl(k)?(p++,o++):goog.i18n.bidi.isRequiredLtrRe_.test(k)?n=!0:goog.i18n.bidi.hasAnyLtr(k)?o++:goog.i18n.bidi.hasNumeralsRe_.test(k)&&(n=!0)}return 0==o?n?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:p/o>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.detectRtlDirectionality=function(d,c){return goog.i18n.bidi.estimateDirection(d,c)==goog.i18n.bidi.Dir.RTL};goog.i18n.bidi.setElementDirAndAlign=function(d,c){d&&(c=goog.i18n.bidi.toDir(c))&&(d.style.textAlign=c==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,d.dir=c==goog.i18n.bidi.Dir.RTL?"rtl":"ltr")};goog.i18n.bidi.setElementDirByTextDirectionality=function(d,c){switch(goog.i18n.bidi.estimateDirection(c)){case goog.i18n.bidi.Dir.LTR:d.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:d.dir="rtl";break;default:d.removeAttribute("dir")}};goog.i18n.bidi.DirectionalString=function(){};goog.html.SafeUrl=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez";goog.html.SafeUrl.prototype.implementsGoogStringTypedString=!0;goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_};goog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.SafeUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR};goog.DEBUG&&(goog.html.SafeUrl.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"});goog.html.SafeUrl.unwrap=function(b){if(b instanceof goog.html.SafeUrl&&b.constructor===goog.html.SafeUrl&&b.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_){return b.privateDoNotAccessOrElseSafeHtmlWrappedValue_}goog.asserts.fail("expected object of type SafeUrl, got '"+b+"' of type "+goog.typeOf(b));return"type_error:SafeUrl"};goog.html.SafeUrl.fromConstant=function(b){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(b))};goog.html.SAFE_MIME_TYPE_PATTERN_=/^(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm))$/i;goog.html.SafeUrl.fromBlob=function(b){b=goog.html.SAFE_MIME_TYPE_PATTERN_.test(b.type)?goog.fs.url.createObjectUrl(b):goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(b)};goog.html.DATA_URL_PATTERN_=/^data:([^;,]*);base64,[a-z0-9+\/]+=*$/i;goog.html.SafeUrl.fromDataUrl=function(d){var c=d.match(goog.html.DATA_URL_PATTERN_),c=c&&goog.html.SAFE_MIME_TYPE_PATTERN_.test(c[1]);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(c?d:goog.html.SafeUrl.INNOCUOUS_STRING)};goog.html.SafeUrl.fromTelUrl=function(b){goog.string.caseInsensitiveStartsWith(b,"tel:")||(b=goog.html.SafeUrl.INNOCUOUS_STRING);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(b)};goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/i;goog.html.SafeUrl.sanitize=function(b){if(b instanceof goog.html.SafeUrl){return b}b=b.implementsGoogStringTypedString?b.getTypedStringValue():String(b);goog.html.SAFE_URL_PATTERN_.test(b)||(b=goog.html.SafeUrl.INNOCUOUS_STRING);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(b)};goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(d){var c=new goog.html.SafeUrl;c.privateDoNotAccessOrElseSafeHtmlWrappedValue_=d;return c};goog.html.SafeUrl.ABOUT_BLANK=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse("about:blank");goog.html.TrustedResourceUrl=function(){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_="";this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=!0;goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_};goog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.TrustedResourceUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR};goog.DEBUG&&(goog.html.TrustedResourceUrl.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"});goog.html.TrustedResourceUrl.unwrap=function(b){if(b instanceof goog.html.TrustedResourceUrl&&b.constructor===goog.html.TrustedResourceUrl&&b.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_){return b.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_}goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+b+"' of type "+goog.typeOf(b));return"type_error:TrustedResourceUrl"};goog.html.TrustedResourceUrl.fromConstant=function(b){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(b))};goog.html.TrustedResourceUrl.fromConstants=function(e){for(var d="",f=0;f<e.length;f++){d+=goog.string.Const.unwrap(e[f])}return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(d)};goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(d){var c=new goog.html.TrustedResourceUrl;c.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=d;return c};goog.html.SafeHtml=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;this.dir_=null};goog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.SafeHtml.prototype.getDirection=function(){return this.dir_};goog.html.SafeHtml.prototype.implementsGoogStringTypedString=!0;goog.html.SafeHtml.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_};goog.DEBUG&&(goog.html.SafeHtml.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"});goog.html.SafeHtml.unwrap=function(b){if(b instanceof goog.html.SafeHtml&&b.constructor===goog.html.SafeHtml&&b.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_){return b.privateDoNotAccessOrElseSafeHtmlWrappedValue_}goog.asserts.fail("expected object of type SafeHtml, got '"+b+"' of type "+goog.typeOf(b));return"type_error:SafeHtml"};goog.html.SafeHtml.htmlEscape=function(d){if(d instanceof goog.html.SafeHtml){return d}var c=null;d.implementsGoogI18nBidiDirectionalString&&(c=d.getDirection());d=d.implementsGoogStringTypedString?d.getTypedStringValue():String(d);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.htmlEscape(d),c)};goog.html.SafeHtml.htmlEscapePreservingNewlines=function(b){if(b instanceof goog.html.SafeHtml){return b}b=goog.html.SafeHtml.htmlEscape(b);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.newLineToBr(goog.html.SafeHtml.unwrap(b)),b.getDirection())};goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces=function(b){if(b instanceof goog.html.SafeHtml){return b}b=goog.html.SafeHtml.htmlEscape(b);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.whitespaceEscape(goog.html.SafeHtml.unwrap(b)),b.getDirection())};goog.html.SafeHtml.from=goog.html.SafeHtml.htmlEscape;goog.html.SafeHtml.VALID_NAMES_IN_TAG_=/^[a-zA-Z0-9-]+$/;goog.html.SafeHtml.URL_ATTRIBUTES_={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0};goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_={APPLET:!0,BASE:!0,EMBED:!0,IFRAME:!0,LINK:!0,MATH:!0,META:!0,OBJECT:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0};goog.html.SafeHtml.create=function(e,d,f){goog.html.SafeHtml.verifyTagName(e);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(e,d,f)};goog.html.SafeHtml.verifyTagName=function(b){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(b)){throw Error("Invalid tag name <"+b+">.")}if(b.toUpperCase() in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_){throw Error("Tag name <"+b+"> is not allowed for SafeHtml.")}};goog.html.SafeHtml.createIframe=function(g,f,j,i){g&&goog.html.TrustedResourceUrl.unwrap(g);var h={};h.src=g||null;h.srcdoc=f&&goog.html.SafeHtml.unwrap(f);g=goog.html.SafeHtml.combineAttributes(h,{sandbox:""},j);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",g,i)};goog.html.SafeHtml.createSandboxIframe=function(g,f,j,i){if(!goog.html.SafeHtml.canUseSandboxIframe()){throw Error("The browser does not support sandboxed iframes.")}var h={};h.src=g?goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(g)):null;h.srcdoc=f||null;h.sandbox="";g=goog.html.SafeHtml.combineAttributes(h,{},j);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",g,i)};goog.html.SafeHtml.canUseSandboxIframe=function(){return goog.global.HTMLIFrameElement&&"sandbox" in goog.global.HTMLIFrameElement.prototype};goog.html.SafeHtml.createScriptSrc=function(e,d){goog.html.TrustedResourceUrl.unwrap(e);var f=goog.html.SafeHtml.combineAttributes({src:e},{},d);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",f)};goog.html.SafeHtml.createStyle=function(g,f){var j=goog.html.SafeHtml.combineAttributes({type:"text/css"},{},f),i="";g=goog.array.concat(g);for(var h=0;h<g.length;h++){i+=goog.html.SafeStyleSheet.unwrap(g[h])}i=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(i,goog.i18n.bidi.Dir.NEUTRAL);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",j,i)};goog.html.SafeHtml.createMetaRefresh=function(e,d){var f=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(e));(goog.labs.userAgent.browser.isIE()||goog.labs.userAgent.browser.isEdge())&&goog.string.contains(f,";")&&(f="'"+f.replace(/'/g,"%27")+"'");return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("meta",{"http-equiv":"refresh",content:(d||0)+"; url="+f})};goog.html.SafeHtml.getAttrNameAndValue_=function(e,d,f){if(f instanceof goog.string.Const){f=goog.string.Const.unwrap(f)}else{if("style"==d.toLowerCase()){f=goog.html.SafeHtml.getStyleValue_(f)}else{if(/^on/i.test(d)){throw Error('Attribute "'+d+'" requires goog.string.Const value, "'+f+'" given.')}if(d.toLowerCase() in goog.html.SafeHtml.URL_ATTRIBUTES_){if(f instanceof goog.html.TrustedResourceUrl){f=goog.html.TrustedResourceUrl.unwrap(f)}else{if(f instanceof goog.html.SafeUrl){f=goog.html.SafeUrl.unwrap(f)}else{if(goog.isString(f)){f=goog.html.SafeUrl.sanitize(f).getTypedStringValue()}else{throw Error('Attribute "'+d+'" on tag "'+e+'" requires goog.html.SafeUrl, goog.string.Const, or string, value "'+f+'" given.')}}}}}}f.implementsGoogStringTypedString&&(f=f.getTypedStringValue());goog.asserts.assert(goog.isString(f)||goog.isNumber(f),"String or number value expected, got "+typeof f+" with value: "+f);return d+'="'+goog.string.htmlEscape(String(f))+'"'};goog.html.SafeHtml.getStyleValue_=function(b){if(!goog.isObject(b)){throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof b+" given: "+b)}b instanceof goog.html.SafeStyle||(b=goog.html.SafeStyle.create(b));return goog.html.SafeStyle.unwrap(b)};goog.html.SafeHtml.createWithDir=function(f,e,h,g){e=goog.html.SafeHtml.create(e,h,g);e.dir_=f;return e};goog.html.SafeHtml.concat=function(f){var e=goog.i18n.bidi.Dir.NEUTRAL,h="",g=function(b){goog.isArray(b)?goog.array.forEach(b,g):(b=goog.html.SafeHtml.htmlEscape(b),h+=goog.html.SafeHtml.unwrap(b),b=b.getDirection(),e==goog.i18n.bidi.Dir.NEUTRAL?e=b:b!=goog.i18n.bidi.Dir.NEUTRAL&&e!=b&&(e=null))};goog.array.forEach(arguments,g);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(h,e)};goog.html.SafeHtml.concatWithDir=function(e,d){var f=goog.html.SafeHtml.concat(goog.array.slice(arguments,1));f.dir_=e;return f};goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse=function(d,c){return(new goog.html.SafeHtml).initSecurityPrivateDoNotAccessOrElse_(d,c)};goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_=function(d,c){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=d;this.dir_=c;return this};goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse=function(g,f,j){var i=null,h;h="<"+g+goog.html.SafeHtml.stringifyAttributes(g,f);goog.isDefAndNotNull(j)?goog.isArray(j)||(j=[j]):j=[];goog.dom.tags.isVoidTag(g.toLowerCase())?(goog.asserts.assert(!j.length,"Void tag <"+g+"> does not allow content."),h+=">"):(i=goog.html.SafeHtml.concat(j),h+=">"+goog.html.SafeHtml.unwrap(i)+"</"+g+">",i=i.getDirection());(g=f&&f.dir)&&(i=/^(ltr|rtl|auto)$/i.test(g)?goog.i18n.bidi.Dir.NEUTRAL:null);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(h,i)};goog.html.SafeHtml.stringifyAttributes=function(g,f){var j="";if(f){for(var i in f){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(i)){throw Error('Invalid attribute name "'+i+'".')}var h=f[i];goog.isDefAndNotNull(h)&&(j+=" "+goog.html.SafeHtml.getAttrNameAndValue_(g,i,h))}}return j};goog.html.SafeHtml.combineAttributes=function(h,g,l){var k={},j;for(j in h){goog.asserts.assert(j.toLowerCase()==j,"Must be lower case"),k[j]=h[j]}for(j in g){goog.asserts.assert(j.toLowerCase()==j,"Must be lower case"),k[j]=g[j]}for(j in l){var i=j.toLowerCase();if(i in h){throw Error('Cannot override "'+i+'" attribute, got "'+j+'" with value "'+l[j]+'"')}i in g&&delete k[i];k[j]=l[j]}return k};goog.html.SafeHtml.DOCTYPE_HTML=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>",goog.i18n.bidi.Dir.NEUTRAL);goog.html.SafeHtml.EMPTY=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("",goog.i18n.bidi.Dir.NEUTRAL);goog.html.SafeHtml.BR=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<br>",goog.i18n.bidi.Dir.NEUTRAL);goog.dom.safe={};goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"};goog.dom.safe.insertAdjacentHtml=function(e,d,f){e.insertAdjacentHTML(d,goog.html.SafeHtml.unwrap(f))};goog.dom.safe.setInnerHtml=function(d,c){d.innerHTML=goog.html.SafeHtml.unwrap(c)};goog.dom.safe.setOuterHtml=function(d,c){d.outerHTML=goog.html.SafeHtml.unwrap(c)};goog.dom.safe.documentWrite=function(d,c){d.write(goog.html.SafeHtml.unwrap(c))};goog.dom.safe.setAnchorHref=function(e,d){var f;f=d instanceof goog.html.SafeUrl?d:goog.html.SafeUrl.sanitize(d);e.href=goog.html.SafeUrl.unwrap(f)};goog.dom.safe.setImageSrc=function(e,d){var f;f=d instanceof goog.html.SafeUrl?d:goog.html.SafeUrl.sanitize(d);e.src=goog.html.SafeUrl.unwrap(f)};goog.dom.safe.setEmbedSrc=function(d,c){d.src=goog.html.TrustedResourceUrl.unwrap(c)};goog.dom.safe.setFrameSrc=function(d,c){d.src=goog.html.TrustedResourceUrl.unwrap(c)};goog.dom.safe.setIframeSrc=function(d,c){d.src=goog.html.TrustedResourceUrl.unwrap(c)};goog.dom.safe.setLinkHrefAndRel=function(e,d,f){e.rel=f;goog.string.caseInsensitiveContains(f,"stylesheet")?(goog.asserts.assert(d instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"'),e.href=goog.html.TrustedResourceUrl.unwrap(d)):e.href=d instanceof goog.html.TrustedResourceUrl?goog.html.TrustedResourceUrl.unwrap(d):d instanceof goog.html.SafeUrl?goog.html.SafeUrl.unwrap(d):goog.html.SafeUrl.sanitize(d).getTypedStringValue()};goog.dom.safe.setObjectData=function(d,c){d.data=goog.html.TrustedResourceUrl.unwrap(c)};goog.dom.safe.setScriptSrc=function(d,c){d.src=goog.html.TrustedResourceUrl.unwrap(c)};goog.dom.safe.setLocationHref=function(e,d){var f;f=d instanceof goog.html.SafeUrl?d:goog.html.SafeUrl.sanitize(d);e.href=goog.html.SafeUrl.unwrap(f)};goog.dom.safe.openInWindow=function(g,f,j,i,h){g=g instanceof goog.html.SafeUrl?g:goog.html.SafeUrl.sanitize(g);return(f||window).open(goog.html.SafeUrl.unwrap(g),j?goog.string.Const.unwrap(j):"",i,h)};goog.html.SafeScript=function(){this.privateDoNotAccessOrElseSafeScriptWrappedValue_="";this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeScript.prototype.implementsGoogStringTypedString=!0;goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeScript.fromConstant=function(b){b=goog.string.Const.unwrap(b);return 0===b.length?goog.html.SafeScript.EMPTY:goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(b)};goog.html.SafeScript.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_};goog.DEBUG&&(goog.html.SafeScript.prototype.toString=function(){return"SafeScript{"+this.privateDoNotAccessOrElseSafeScriptWrappedValue_+"}"});goog.html.SafeScript.unwrap=function(b){if(b instanceof goog.html.SafeScript&&b.constructor===goog.html.SafeScript&&b.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_){return b.privateDoNotAccessOrElseSafeScriptWrappedValue_}goog.asserts.fail("expected object of type SafeScript, got '"+b+"' of type "+goog.typeOf(b));return"type_error:SafeScript"};goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse=function(b){return(new goog.html.SafeScript).initSecurityPrivateDoNotAccessOrElse_(b)};goog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_=function(b){this.privateDoNotAccessOrElseSafeScriptWrappedValue_=b;return this};goog.html.SafeScript.EMPTY=goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse("");goog.html.uncheckedconversions={};goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract=function(e,d,f){goog.asserts.assertString(goog.string.Const.unwrap(e),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(e)),"must provide non-empty justification");return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(d,f||null)};goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract=function(d,c){goog.asserts.assertString(goog.string.Const.unwrap(d),"must provide justification");goog.asserts.assert(!goog.string.isEmpty(goog.string.Const.unwrap(d)),"must provide non-empty justification");return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(c)};goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract=function(d,c){goog.asserts.assertString(goog.string.Const.unwrap(d),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(d)),"must provide non-empty justification");return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(c)};goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract=function(d,c){goog.asserts.assertString(goog.string.Const.unwrap(d),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(d)),"must provide non-empty justification");return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(c)};goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract=function(d,c){goog.asserts.assertString(goog.string.Const.unwrap(d),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(d)),"must provide non-empty justification");return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(c)};goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract=function(d,c){goog.asserts.assertString(goog.string.Const.unwrap(d),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(d)),"must provide non-empty justification");return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(c)};goog.math.Coordinate=function(d,c){this.x=goog.isDef(d)?d:0;this.y=goog.isDef(c)?c:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};goog.DEBUG&&(goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"});goog.math.Coordinate.equals=function(d,c){return d==c?!0:d&&c?d.x==c.x&&d.y==c.y:!1};goog.math.Coordinate.distance=function(f,e){var h=f.x-e.x,g=f.y-e.y;return Math.sqrt(h*h+g*g)};goog.math.Coordinate.magnitude=function(b){return Math.sqrt(b.x*b.x+b.y*b.y)};goog.math.Coordinate.azimuth=function(b){return goog.math.angle(0,0,b.x,b.y)};goog.math.Coordinate.squaredDistance=function(f,e){var h=f.x-e.x,g=f.y-e.y;return h*h+g*g};goog.math.Coordinate.difference=function(d,c){return new goog.math.Coordinate(d.x-c.x,d.y-c.y)};goog.math.Coordinate.sum=function(d,c){return new goog.math.Coordinate(d.x+c.x,d.y+c.y)};goog.math.Coordinate.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};goog.math.Coordinate.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};goog.math.Coordinate.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};goog.math.Coordinate.prototype.translate=function(d,c){d instanceof goog.math.Coordinate?(this.x+=d.x,this.y+=d.y):(this.x+=Number(d),goog.isNumber(c)&&(this.y+=c));return this};goog.math.Coordinate.prototype.scale=function(e,d){var f=goog.isNumber(d)?d:e;this.x*=e;this.y*=f;return this};goog.math.Coordinate.prototype.rotateRadians=function(i,h){var n=h||new goog.math.Coordinate(0,0),m=this.x,l=this.y,k=Math.cos(i),j=Math.sin(i);this.x=(m-n.x)*k-(l-n.y)*j+n.x;this.y=(m-n.x)*j+(l-n.y)*k+n.y};goog.math.Coordinate.prototype.rotateDegrees=function(d,c){this.rotateRadians(goog.math.toRadians(d),c)};goog.math.Size=function(d,c){this.width=d;this.height=c};goog.math.Size.equals=function(d,c){return d==c?!0:d&&c?d.width==c.width&&d.height==c.height:!1};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};goog.DEBUG&&(goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"});goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)};goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)};goog.math.Size.prototype.area=function(){return this.width*this.height};goog.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)};goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height};goog.math.Size.prototype.isEmpty=function(){return !this.area()};goog.math.Size.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Size.prototype.fitsInside=function(b){return this.width<=b.width&&this.height<=b.height};goog.math.Size.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Size.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Size.prototype.scale=function(e,d){var f=goog.isNumber(d)?d:e;this.width*=e;this.height*=f;return this};goog.math.Size.prototype.scaleToCover=function(b){b=this.aspectRatio()<=b.aspectRatio()?b.width/this.width:b.height/this.height;return this.scale(b)};goog.math.Size.prototype.scaleToFit=function(b){b=this.aspectRatio()>b.aspectRatio()?b.width/this.width:b.height/this.height;return this.scale(b)};goog.dom.ASSUME_QUIRKS_MODE=!1;goog.dom.ASSUME_STANDARDS_MODE=!1;goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;goog.dom.getDomHelper=function(b){return b?new goog.dom.DomHelper(goog.dom.getOwnerDocument(b)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)};goog.dom.getDocument=function(){return document};goog.dom.getElement=function(b){return goog.dom.getElementHelper_(document,b)};goog.dom.getElementHelper_=function(d,c){return goog.isString(c)?d.getElementById(c):c};goog.dom.getRequiredElement=function(b){return goog.dom.getRequiredElementHelper_(document,b)};goog.dom.getRequiredElementHelper_=function(e,d){goog.asserts.assertString(d);var f=goog.dom.getElementHelper_(e,d);return f=goog.asserts.assertElement(f,"No element found with id: "+d)};goog.dom.$=goog.dom.getElement;goog.dom.getElementsByTagNameAndClass=function(e,d,f){return goog.dom.getElementsByTagNameAndClass_(document,e,d,f)};goog.dom.getElementsByClass=function(e,d){var f=d||document;return goog.dom.canUseQuerySelector_(f)?f.querySelectorAll("."+e):goog.dom.getElementsByTagNameAndClass_(document,"*",e,d)};goog.dom.getElementByClass=function(e,d){var f=d||document;return(f.getElementsByClassName?f.getElementsByClassName(e)[0]:goog.dom.canUseQuerySelector_(f)?f.querySelector("."+e):goog.dom.getElementsByTagNameAndClass_(document,"*",e,d)[0])||null};goog.dom.getRequiredElementByClass=function(e,d){var f=goog.dom.getElementByClass(e,d);return goog.asserts.assert(f,"No element found with className: "+e)};goog.dom.canUseQuerySelector_=function(b){return !(!b.querySelectorAll||!b.querySelector)};goog.dom.getElementsByTagNameAndClass_=function(i,h,n,m){i=m||i;h=h&&"*"!=h?h.toUpperCase():"";if(goog.dom.canUseQuerySelector_(i)&&(h||n)){return i.querySelectorAll(h+(n?"."+n:""))}if(n&&i.getElementsByClassName){i=i.getElementsByClassName(n);if(h){m={};for(var l=0,k=0,j;j=i[k];k++){h==j.nodeName&&(m[l++]=j)}m.length=l;return m}return i}i=i.getElementsByTagName(h||"*");if(n){m={};for(k=l=0;j=i[k];k++){h=j.className,"function"==typeof h.split&&goog.array.contains(h.split(/\s+/),n)&&(m[l++]=j)}m.length=l;return m}return i};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;goog.dom.setProperties=function(d,c){goog.object.forEach(c,function(a,e){"style"==e?d.style.cssText=a:"class"==e?d.className=a:"for"==e?d.htmlFor=a:goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(e)?d.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[e],a):goog.string.startsWith(e,"aria-")||goog.string.startsWith(e,"data-")?d.setAttribute(e,a):d[e]=a})};goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};goog.dom.getViewportSize=function(b){return goog.dom.getViewportSize_(b||window)};goog.dom.getViewportSize_=function(b){b=b.document;b=goog.dom.isCss1CompatMode_(b)?b.documentElement:b.body;return new goog.math.Size(b.clientWidth,b.clientHeight)};goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeightForWindow=function(b){return goog.dom.getDocumentHeight_(b)};goog.dom.getDocumentHeight_=function(g){var f=g.document,j=0;if(f){var j=f.body,i=f.documentElement;if(!i||!j){return 0}g=goog.dom.getViewportSize_(g).height;if(goog.dom.isCss1CompatMode_(f)&&i.scrollHeight){j=i.scrollHeight!=g?i.scrollHeight:i.offsetHeight}else{var f=i.scrollHeight,h=i.offsetHeight;i.clientHeight!=h&&(f=j.scrollHeight,h=j.offsetHeight);j=f>g?f>h?f:h:f<h?f:h}}return j};goog.dom.getPageScroll=function(b){return goog.dom.getDomHelper((b||goog.global||window).document).getDocumentScroll()};goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};goog.dom.getDocumentScroll_=function(d){var c=goog.dom.getDocumentScrollElement_(d);d=goog.dom.getWindow_(d);return goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&d.pageYOffset!=c.scrollTop?new goog.math.Coordinate(c.scrollLeft,c.scrollTop):new goog.math.Coordinate(d.pageXOffset||c.scrollLeft,d.pageYOffset||c.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};goog.dom.getDocumentScrollElement_=function(b){return b.scrollingElement?b.scrollingElement:!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(b)?b.documentElement:b.body||b.documentElement};goog.dom.getWindow=function(b){return b?goog.dom.getWindow_(b):window};goog.dom.getWindow_=function(b){return b.parentWindow||b.defaultView};goog.dom.createDom=function(e,d,f){return goog.dom.createDom_(document,arguments)};goog.dom.createDom_=function(g,f){var j=f[0],i=f[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&i&&(i.name||i.type)){j=["<",j];i.name&&j.push(' name="',goog.string.htmlEscape(i.name),'"');if(i.type){j.push(' type="',goog.string.htmlEscape(i.type),'"');var h={};goog.object.extend(h,i);delete h.type;i=h}j.push(">");j=j.join("")}j=g.createElement(j);i&&(goog.isString(i)?j.className=i:goog.isArray(i)?j.className=i.join(" "):goog.dom.setProperties(j,i));2<f.length&&goog.dom.append_(g,j,f,2);return j};goog.dom.append_=function(h,g,l,k){function j(a){a&&g.appendChild(goog.isString(a)?h.createTextNode(a):a)}for(;k<l.length;k++){var i=l[k];goog.isArrayLike(i)&&!goog.dom.isNodeLike(i)?goog.array.forEach(goog.dom.isNodeList(i)?goog.array.toArray(i):i,j):j(i)}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(b){return document.createElement(b)};goog.dom.createTextNode=function(b){return document.createTextNode(String(b))};goog.dom.createTable=function(e,d,f){return goog.dom.createTable_(document,e,d,!!f)};goog.dom.createTable_=function(t,s,r,q){for(var p=t.createElement("TABLE"),o=p.appendChild(t.createElement("TBODY")),m=0;m<s;m++){for(var l=t.createElement("TR"),j=0;j<r;j++){var i=t.createElement("TD");q&&goog.dom.setTextContent(i,goog.string.Unicode.NBSP);l.appendChild(i)}o.appendChild(l)}return p};goog.dom.constHtmlToNode=function(d){var c=goog.array.map(arguments,goog.string.Const.unwrap),c=goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Constant HTML string, that gets turned into a Node later, so it will be automatically balanced."),c.join(""));return goog.dom.safeHtmlToNode(c)};goog.dom.safeHtmlToNode=function(b){return goog.dom.safeHtmlToNode_(document,b)};goog.dom.safeHtmlToNode_=function(e,d){var f=e.createElement("DIV");goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT?(goog.dom.safe.setInnerHtml(f,goog.html.SafeHtml.concat(goog.html.SafeHtml.BR,d)),f.removeChild(f.firstChild)):goog.dom.safe.setInnerHtml(f,d);return goog.dom.childrenToNode_(e,f)};goog.dom.childrenToNode_=function(e,d){if(1==d.childNodes.length){return d.removeChild(d.firstChild)}for(var f=e.createDocumentFragment();d.firstChild;){f.appendChild(d.firstChild)}return f};goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};goog.dom.isCss1CompatMode_=function(b){return goog.dom.COMPAT_MODE_KNOWN_?goog.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==b.compatMode};goog.dom.canHaveChildren=function(b){if(b.nodeType!=goog.dom.NodeType.ELEMENT){return !1}switch(b.tagName){case"APPLET":case"AREA":case"BASE":case"BR":case"COL":case"COMMAND":case"EMBED":case"FRAME":case"HR":case"IMG":case"INPUT":case"IFRAME":case"ISINDEX":case"KEYGEN":case"LINK":case"NOFRAMES":case"NOSCRIPT":case"META":case"OBJECT":case"PARAM":case"SCRIPT":case"SOURCE":case"STYLE":case"TRACK":case"WBR":return !1}return !0};goog.dom.appendChild=function(d,c){d.appendChild(c)};goog.dom.append=function(d,c){goog.dom.append_(goog.dom.getOwnerDocument(d),d,arguments,1)};goog.dom.removeChildren=function(d){for(var c;c=d.firstChild;){d.removeChild(c)}};goog.dom.insertSiblingBefore=function(d,c){c.parentNode&&c.parentNode.insertBefore(d,c)};goog.dom.insertSiblingAfter=function(d,c){c.parentNode&&c.parentNode.insertBefore(d,c.nextSibling)};goog.dom.insertChildAt=function(e,d,f){e.insertBefore(d,e.childNodes[f]||null)};goog.dom.removeNode=function(b){return b&&b.parentNode?b.parentNode.removeChild(b):null};goog.dom.replaceNode=function(e,d){var f=d.parentNode;f&&f.replaceChild(e,d)};goog.dom.flattenElement=function(e){var d,f=e.parentNode;if(f&&f.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(e.removeNode){return e.removeNode(!1)}for(;d=e.firstChild;){f.insertBefore(d,e)}return goog.dom.removeNode(e)}};goog.dom.getChildren=function(b){return goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=b.children?b.children:goog.array.filter(b.childNodes,function(c){return c.nodeType==goog.dom.NodeType.ELEMENT})};goog.dom.getFirstElementChild=function(b){return goog.isDef(b.firstElementChild)?b.firstElementChild:goog.dom.getNextElementNode_(b.firstChild,!0)};goog.dom.getLastElementChild=function(b){return goog.isDef(b.lastElementChild)?b.lastElementChild:goog.dom.getNextElementNode_(b.lastChild,!1)};goog.dom.getNextElementSibling=function(b){return goog.isDef(b.nextElementSibling)?b.nextElementSibling:goog.dom.getNextElementNode_(b.nextSibling,!0)};goog.dom.getPreviousElementSibling=function(b){return goog.isDef(b.previousElementSibling)?b.previousElementSibling:goog.dom.getNextElementNode_(b.previousSibling,!1)};goog.dom.getNextElementNode_=function(d,c){for(;d&&d.nodeType!=goog.dom.NodeType.ELEMENT;){d=c?d.nextSibling:d.previousSibling}return d};goog.dom.getNextNode=function(b){if(!b){return null}if(b.firstChild){return b.firstChild}for(;b&&!b.nextSibling;){b=b.parentNode}return b?b.nextSibling:null};goog.dom.getPreviousNode=function(b){if(!b){return null}if(!b.previousSibling){return b.parentNode}for(b=b.previousSibling;b&&b.lastChild;){b=b.lastChild}return b};goog.dom.isNodeLike=function(b){return goog.isObject(b)&&0<b.nodeType};goog.dom.isElement=function(b){return goog.isObject(b)&&b.nodeType==goog.dom.NodeType.ELEMENT};goog.dom.isWindow=function(b){return goog.isObject(b)&&b.window==b};goog.dom.getParentElement=function(d){var c;if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY&&!(goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("9")&&!goog.userAgent.isVersionOrHigher("10")&&goog.global.SVGElement&&d instanceof goog.global.SVGElement)&&(c=d.parentElement)){return c}c=d.parentNode;return goog.dom.isElement(c)?c:null};goog.dom.contains=function(d,c){if(!d||!c){return !1}if(d.contains&&c.nodeType==goog.dom.NodeType.ELEMENT){return d==c||d.contains(c)}if("undefined"!=typeof d.compareDocumentPosition){return d==c||!!(d.compareDocumentPosition(c)&16)}for(;c&&d!=c;){c=c.parentNode}return c==d};goog.dom.compareNodeOrder=function(h,g){if(h==g){return 0}if(h.compareDocumentPosition){return h.compareDocumentPosition(g)&2?1:-1}if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(h.nodeType==goog.dom.NodeType.DOCUMENT){return -1}if(g.nodeType==goog.dom.NodeType.DOCUMENT){return 1}}if("sourceIndex" in h||h.parentNode&&"sourceIndex" in h.parentNode){var l=h.nodeType==goog.dom.NodeType.ELEMENT,k=g.nodeType==goog.dom.NodeType.ELEMENT;if(l&&k){return h.sourceIndex-g.sourceIndex}var j=h.parentNode,i=g.parentNode;return j==i?goog.dom.compareSiblingOrder_(h,g):!l&&goog.dom.contains(j,g)?-1*goog.dom.compareParentsDescendantNodeIe_(h,g):!k&&goog.dom.contains(i,h)?goog.dom.compareParentsDescendantNodeIe_(g,h):(l?h.sourceIndex:j.sourceIndex)-(k?g.sourceIndex:i.sourceIndex)}k=goog.dom.getOwnerDocument(h);l=k.createRange();l.selectNode(h);l.collapse(!0);k=k.createRange();k.selectNode(g);k.collapse(!0);return l.compareBoundaryPoints(goog.global.Range.START_TO_END,k)};goog.dom.compareParentsDescendantNodeIe_=function(f,e){var h=f.parentNode;if(h==e){return -1}for(var g=e;g.parentNode!=h;){g=g.parentNode}return goog.dom.compareSiblingOrder_(g,f)};goog.dom.compareSiblingOrder_=function(e,d){for(var f=d;f=f.previousSibling;){if(f==e){return -1}}return 1};goog.dom.findCommonAncestor=function(j){var i,p=arguments.length;if(!p){return null}if(1==p){return arguments[0]}var o=[],n=Infinity;for(i=0;i<p;i++){for(var m=[],l=arguments[i];l;){m.unshift(l),l=l.parentNode}o.push(m);n=Math.min(n,m.length)}m=null;for(i=0;i<n;i++){for(var l=o[0][i],k=1;k<p;k++){if(l!=o[k][i]){return m}}m=l}return m};goog.dom.getOwnerDocument=function(b){goog.asserts.assert(b,"Node cannot be null or undefined.");return b.nodeType==goog.dom.NodeType.DOCUMENT?b:b.ownerDocument||b.document};goog.dom.getFrameContentDocument=function(b){return b.contentDocument||b.contentWindow.document};goog.dom.getFrameContentWindow=function(d){try{return d.contentWindow||(d.contentDocument?goog.dom.getWindow(d.contentDocument):null)}catch(c){}return null};goog.dom.setTextContent=function(e,d){goog.asserts.assert(null!=e,"goog.dom.setTextContent expects a non-null value for node");if("textContent" in e){e.textContent=d}else{if(e.nodeType==goog.dom.NodeType.TEXT){e.data=d}else{if(e.firstChild&&e.firstChild.nodeType==goog.dom.NodeType.TEXT){for(;e.lastChild!=e.firstChild;){e.removeChild(e.lastChild)}e.firstChild.data=d}else{goog.dom.removeChildren(e);var f=goog.dom.getOwnerDocument(e);e.appendChild(f.createTextNode(String(d)))}}}};goog.dom.getOuterHtml=function(d){goog.asserts.assert(null!==d,"goog.dom.getOuterHtml expects a non-null value for element");if("outerHTML" in d){return d.outerHTML}var c=goog.dom.getOwnerDocument(d).createElement("DIV");c.appendChild(d.cloneNode(!0));return c.innerHTML};goog.dom.findNode=function(e,d){var f=[];return goog.dom.findNodes_(e,d,f,!0)?f[0]:void 0};goog.dom.findNodes=function(e,d){var f=[];goog.dom.findNodes_(e,d,f,!1);return f};goog.dom.findNodes_=function(f,e,h,g){if(null!=f){for(f=f.firstChild;f;){if(e(f)&&(h.push(f),g)||goog.dom.findNodes_(f,e,h,g)){return !0}f=f.nextSibling}}return !1};goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1};goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"};goog.dom.isFocusableTabIndex=function(b){return goog.dom.hasSpecifiedTabIndex_(b)&&goog.dom.isTabIndexFocusable_(b)};goog.dom.setFocusableTabIndex=function(d,c){c?d.tabIndex=0:(d.tabIndex=-1,d.removeAttribute("tabIndex"))};goog.dom.isFocusable=function(d){var c;return(c=goog.dom.nativelySupportsFocus_(d)?!d.disabled&&(!goog.dom.hasSpecifiedTabIndex_(d)||goog.dom.isTabIndexFocusable_(d)):goog.dom.isFocusableTabIndex(d))&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(d):c};goog.dom.hasSpecifiedTabIndex_=function(b){b=b.getAttributeNode("tabindex");return goog.isDefAndNotNull(b)&&b.specified};goog.dom.isTabIndexFocusable_=function(b){b=b.tabIndex;return goog.isNumber(b)&&0<=b&&32768>b};goog.dom.nativelySupportsFocus_=function(b){return"A"==b.tagName||"INPUT"==b.tagName||"TEXTAREA"==b.tagName||"SELECT"==b.tagName||"BUTTON"==b.tagName};goog.dom.hasNonZeroBoundingRect_=function(b){b=!goog.isFunction(b.getBoundingClientRect)||goog.userAgent.IE&&null==b.parentElement?{height:b.offsetHeight,width:b.offsetWidth}:b.getBoundingClientRect();return goog.isDefAndNotNull(b)&&0<b.height&&0<b.width};goog.dom.getTextContent=function(d){if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&null!==d&&"innerText" in d){d=goog.string.canonicalizeNewlines(d.innerText)}else{var c=[];goog.dom.getTextContent_(d,c,!0);d=c.join("")}d=d.replace(/ \xAD /g," ").replace(/\xAD/g,"");d=d.replace(/\u200B/g,"");goog.dom.BrowserFeature.CAN_USE_INNER_TEXT||(d=d.replace(/ +/g," "));" "!=d&&(d=d.replace(/^\s*/,""));return d};goog.dom.getRawTextContent=function(d){var c=[];goog.dom.getTextContent_(d,c,!1);return c.join("")};goog.dom.getTextContent_=function(e,d,f){if(!(e.nodeName in goog.dom.TAGS_TO_IGNORE_)){if(e.nodeType==goog.dom.NodeType.TEXT){f?d.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):d.push(e.nodeValue)}else{if(e.nodeName in goog.dom.PREDEFINED_TAG_VALUES_){d.push(goog.dom.PREDEFINED_TAG_VALUES_[e.nodeName])}else{for(e=e.firstChild;e;){goog.dom.getTextContent_(e,d,f),e=e.nextSibling}}}}};goog.dom.getNodeTextLength=function(b){return goog.dom.getTextContent(b).length};goog.dom.getNodeTextOffset=function(g,f){for(var j=f||goog.dom.getOwnerDocument(g).body,i=[];g&&g!=j;){for(var h=g;h=h.previousSibling;){i.unshift(goog.dom.getTextContent(h))}g=g.parentNode}return goog.string.trimLeft(i.join("")).replace(/ +/g," ").length};goog.dom.getNodeAtOffset=function(h,g,l){h=[h];for(var k=0,j=null;0<h.length&&k<g;){if(j=h.pop(),!(j.nodeName in goog.dom.TAGS_TO_IGNORE_)){if(j.nodeType==goog.dom.NodeType.TEXT){var i=j.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," "),k=k+i.length}else{if(j.nodeName in goog.dom.PREDEFINED_TAG_VALUES_){k+=goog.dom.PREDEFINED_TAG_VALUES_[j.nodeName].length}else{for(i=j.childNodes.length-1;0<=i;i--){h.push(j.childNodes[i])}}}}}goog.isObject(l)&&(l.remainder=j?j.nodeValue.length+g-k-1:0,l.node=j);return j};goog.dom.isNodeList=function(b){if(b&&"number"==typeof b.length){if(goog.isObject(b)){return"function"==typeof b.item||"string"==typeof b.item}if(goog.isFunction(b)){return"function"==typeof b.item}}return !1};goog.dom.getAncestorByTagNameAndClass=function(g,f,j,i){if(!f&&!j){return null}var h=f?f.toUpperCase():null;return goog.dom.getAncestor(g,function(b){return(!h||b.nodeName==h)&&(!j||goog.isString(b.className)&&goog.array.contains(b.className.split(/\s+/),j))},!0,i)};goog.dom.getAncestorByClass=function(e,d,f){return goog.dom.getAncestorByTagNameAndClass(e,null,d,f)};goog.dom.getAncestor=function(f,e,h,g){h||(f=f.parentNode);for(h=0;f&&(null==g||h<=g);){goog.asserts.assert("parentNode"!=f.name);if(e(f)){return f}f=f.parentNode;h++}return null};goog.dom.getActiveElement=function(d){try{return d&&d.activeElement}catch(c){}return null};goog.dom.getPixelRatio=function(){var b=goog.dom.getWindow();return goog.isDef(b.devicePixelRatio)?b.devicePixelRatio:b.matchMedia?goog.dom.matchesPixelRatio_(0.75)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(3)||1:1};goog.dom.matchesPixelRatio_=function(b){return goog.dom.getWindow().matchMedia("(-webkit-min-device-pixel-ratio: "+b+"),(min--moz-device-pixel-ratio: "+b+"),(min-resolution: "+b+"dppx)").matches?b:0};goog.dom.DomHelper=function(b){this.document_=b||goog.global.document||document};goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;goog.dom.DomHelper.prototype.setDocument=function(b){this.document_=b};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(b){return goog.dom.getElementHelper_(this.document_,b)};goog.dom.DomHelper.prototype.getRequiredElement=function(b){return goog.dom.getRequiredElementHelper_(this.document_,b)};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(e,d,f){return goog.dom.getElementsByTagNameAndClass_(this.document_,e,d,f)};goog.dom.DomHelper.prototype.getElementsByClass=function(d,c){return goog.dom.getElementsByClass(d,c||this.document_)};goog.dom.DomHelper.prototype.getElementByClass=function(d,c){return goog.dom.getElementByClass(d,c||this.document_)};goog.dom.DomHelper.prototype.getRequiredElementByClass=function(d,c){return goog.dom.getRequiredElementByClass(d,c||this.document_)};goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(b){return goog.dom.getViewportSize(b||this.getWindow())};goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.DomHelper.prototype.createDom=function(e,d,f){return goog.dom.createDom_(this.document_,arguments)};goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(b){return this.document_.createElement(b)};goog.dom.DomHelper.prototype.createTextNode=function(b){return this.document_.createTextNode(String(b))};goog.dom.DomHelper.prototype.createTable=function(e,d,f){return goog.dom.createTable_(this.document_,e,d,!!f)};goog.dom.DomHelper.prototype.safeHtmlToNode=function(b){return goog.dom.safeHtmlToNode_(this.document_,b)};goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};goog.dom.DomHelper.prototype.getActiveElement=function(b){return goog.dom.getActiveElement(b||this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.isElement=goog.dom.isElement;goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow;goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder;goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex;goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex;goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable;goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset;goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;goog.dom.vendor={};goog.dom.vendor.getVendorJsPrefix=function(){return goog.userAgent.WEBKIT?"Webkit":goog.userAgent.GECKO?"Moz":goog.userAgent.IE?"ms":goog.userAgent.OPERA?"O":null};goog.dom.vendor.getVendorPrefix=function(){return goog.userAgent.WEBKIT?"-webkit":goog.userAgent.GECKO?"-moz":goog.userAgent.IE?"-ms":goog.userAgent.OPERA?"-o":null};goog.dom.vendor.getPrefixedPropertyName=function(e,d){if(d&&e in d){return e}var f=goog.dom.vendor.getVendorJsPrefix();return f?(f=f.toLowerCase(),f+=goog.string.toTitleCase(e),!goog.isDef(d)||f in d?f:null):null};goog.dom.vendor.getPrefixedEventType=function(b){return((goog.dom.vendor.getVendorJsPrefix()||"")+b).toLowerCase()};goog.html.legacyconversions={};goog.html.legacyconversions.safeHtmlFromString=function(b){goog.html.legacyconversions.reportCallback_();return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(b,null)};goog.html.legacyconversions.safeStyleFromString=function(b){goog.html.legacyconversions.reportCallback_();return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(b)};goog.html.legacyconversions.safeStyleSheetFromString=function(b){goog.html.legacyconversions.reportCallback_();return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(b)};goog.html.legacyconversions.safeUrlFromString=function(b){goog.html.legacyconversions.reportCallback_();return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(b)};goog.html.legacyconversions.trustedResourceUrlFromString=function(b){goog.html.legacyconversions.reportCallback_();return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(b)};goog.html.legacyconversions.reportCallback_=goog.nullFunction;goog.html.legacyconversions.setReportCallback=function(b){goog.html.legacyconversions.reportCallback_=b};goog.math.Box=function(f,e,h,g){this.top=f;this.right=e;this.bottom=h;this.left=g};goog.math.Box.boundingBox=function(e){for(var d=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x),f=1;f<arguments.length;f++){d.expandToIncludeCoordinate(arguments[f])}return d};goog.math.Box.prototype.getWidth=function(){return this.right-this.left};goog.math.Box.prototype.getHeight=function(){return this.bottom-this.top};goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)};goog.DEBUG&&(goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"});goog.math.Box.prototype.contains=function(b){return goog.math.Box.contains(this,b)};goog.math.Box.prototype.expand=function(f,e,h,g){goog.isObject(f)?(this.top-=f.top,this.right+=f.right,this.bottom+=f.bottom,this.left-=f.left):(this.top-=f,this.right+=Number(e),this.bottom+=Number(h),this.left-=Number(g));return this};goog.math.Box.prototype.expandToInclude=function(b){this.left=Math.min(this.left,b.left);this.top=Math.min(this.top,b.top);this.right=Math.max(this.right,b.right);this.bottom=Math.max(this.bottom,b.bottom)};goog.math.Box.prototype.expandToIncludeCoordinate=function(b){this.top=Math.min(this.top,b.y);this.right=Math.max(this.right,b.x);this.bottom=Math.max(this.bottom,b.y);this.left=Math.min(this.left,b.x)};goog.math.Box.equals=function(d,c){return d==c?!0:d&&c?d.top==c.top&&d.right==c.right&&d.bottom==c.bottom&&d.left==c.left:!1};goog.math.Box.contains=function(d,c){return d&&c?c instanceof goog.math.Box?c.left>=d.left&&c.right<=d.right&&c.top>=d.top&&c.bottom<=d.bottom:c.x>=d.left&&c.x<=d.right&&c.y>=d.top&&c.y<=d.bottom:!1};goog.math.Box.relativePositionX=function(d,c){return c.x<d.left?c.x-d.left:c.x>d.right?c.x-d.right:0};goog.math.Box.relativePositionY=function(d,c){return c.y<d.top?c.y-d.top:c.y>d.bottom?c.y-d.bottom:0};goog.math.Box.distance=function(f,e){var h=goog.math.Box.relativePositionX(f,e),g=goog.math.Box.relativePositionY(f,e);return Math.sqrt(h*h+g*g)};goog.math.Box.intersects=function(d,c){return d.left<=c.right&&c.left<=d.right&&d.top<=c.bottom&&c.top<=d.bottom};goog.math.Box.intersectsWithPadding=function(e,d,f){return e.left<=d.right+f&&d.left<=e.right+f&&e.top<=d.bottom+f&&d.top<=e.bottom+f};goog.math.Box.prototype.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};goog.math.Box.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};goog.math.Box.prototype.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};goog.math.Box.prototype.translate=function(d,c){d instanceof goog.math.Coordinate?(this.left+=d.x,this.right+=d.x,this.top+=d.y,this.bottom+=d.y):(goog.asserts.assertNumber(d),this.left+=d,this.right+=d,goog.isNumber(c)&&(this.top+=c,this.bottom+=c));return this};goog.math.Box.prototype.scale=function(e,d){var f=goog.isNumber(d)?d:e;this.left*=e;this.right*=e;this.top*=f;this.bottom*=f;return this};goog.math.IRect=function(){};goog.math.Rect=function(f,e,h,g){this.left=f;this.top=e;this.width=h;this.height=g};goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)};goog.math.Rect.prototype.toBox=function(){return new goog.math.Box(this.top,this.left+this.width,this.top+this.height,this.left)};goog.math.Rect.createFromPositionAndSize=function(d,c){return new goog.math.Rect(d.x,d.y,c.width,c.height)};goog.math.Rect.createFromBox=function(b){return new goog.math.Rect(b.left,b.top,b.right-b.left,b.bottom-b.top)};goog.DEBUG&&(goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"});goog.math.Rect.equals=function(d,c){return d==c?!0:d&&c?d.left==c.left&&d.width==c.width&&d.top==c.top&&d.height==c.height:!1};goog.math.Rect.prototype.intersection=function(f){var e=Math.max(this.left,f.left),h=Math.min(this.left+this.width,f.left+f.width);if(e<=h){var g=Math.max(this.top,f.top);f=Math.min(this.top+this.height,f.top+f.height);if(g<=f){return this.left=e,this.top=g,this.width=h-e,this.height=f-g,!0}}return !1};goog.math.Rect.intersection=function(h,g){var l=Math.max(h.left,g.left),k=Math.min(h.left+h.width,g.left+g.width);if(l<=k){var j=Math.max(h.top,g.top),i=Math.min(h.top+h.height,g.top+g.height);if(j<=i){return new goog.math.Rect(l,j,k-l,i-j)}}return null};goog.math.Rect.intersects=function(d,c){return d.left<=c.left+c.width&&c.left<=d.left+d.width&&d.top<=c.top+c.height&&c.top<=d.top+d.height};goog.math.Rect.prototype.intersects=function(b){return goog.math.Rect.intersects(this,b)};goog.math.Rect.difference=function(r,q){var p=goog.math.Rect.intersection(r,q);if(!p||!p.height||!p.width){return[r.clone()]}var p=[],o=r.top,n=r.height,m=r.left+r.width,l=r.top+r.height,j=q.left+q.width,i=q.top+q.height;q.top>r.top&&(p.push(new goog.math.Rect(r.left,r.top,r.width,q.top-r.top)),o=q.top,n-=q.top-r.top);i<l&&(p.push(new goog.math.Rect(r.left,i,r.width,l-i)),n=i-o);q.left>r.left&&p.push(new goog.math.Rect(r.left,o,q.left-r.left,n));j<m&&p.push(new goog.math.Rect(j,o,m-j,n));return p};goog.math.Rect.prototype.difference=function(b){return goog.math.Rect.difference(this,b)};goog.math.Rect.prototype.boundingRect=function(e){var d=Math.max(this.left+this.width,e.left+e.width),f=Math.max(this.top+this.height,e.top+e.height);this.left=Math.min(this.left,e.left);this.top=Math.min(this.top,e.top);this.width=d-this.left;this.height=f-this.top};goog.math.Rect.boundingRect=function(e,d){if(!e||!d){return null}var f=new goog.math.Rect(e.left,e.top,e.width,e.height);f.boundingRect(d);return f};goog.math.Rect.prototype.contains=function(b){return b instanceof goog.math.Coordinate?b.x>=this.left&&b.x<=this.left+this.width&&b.y>=this.top&&b.y<=this.top+this.height:this.left<=b.left&&this.left+this.width>=b.left+b.width&&this.top<=b.top&&this.top+this.height>=b.top+b.height};goog.math.Rect.prototype.squaredDistance=function(d){var c=d.x<this.left?this.left-d.x:Math.max(d.x-(this.left+this.width),0);d=d.y<this.top?this.top-d.y:Math.max(d.y-(this.top+this.height),0);return c*c+d*d};goog.math.Rect.prototype.distance=function(b){return Math.sqrt(this.squaredDistance(b))};goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)};goog.math.Rect.prototype.getTopLeft=function(){return new goog.math.Coordinate(this.left,this.top)};goog.math.Rect.prototype.getCenter=function(){return new goog.math.Coordinate(this.left+this.width/2,this.top+this.height/2)};goog.math.Rect.prototype.getBottomRight=function(){return new goog.math.Coordinate(this.left+this.width,this.top+this.height)};goog.math.Rect.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Rect.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Rect.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Rect.prototype.translate=function(d,c){d instanceof goog.math.Coordinate?(this.left+=d.x,this.top+=d.y):(this.left+=goog.asserts.assertNumber(d),goog.isNumber(c)&&(this.top+=c));return this};goog.math.Rect.prototype.scale=function(e,d){var f=goog.isNumber(d)?d:e;this.left*=e;this.width*=e;this.top*=f;this.height*=f;return this};goog.style={};goog.style.setStyle=function(f,e,h){if(goog.isString(e)){goog.style.setStyle_(f,h,e)}else{for(var g in e){goog.style.setStyle_(f,e[g],g)}}};goog.style.setStyle_=function(e,d,f){(f=goog.style.getVendorJsStyleName_(e,f))&&(e.style[f]=d)};goog.style.styleNameCache_={};goog.style.getVendorJsStyleName_=function(f,e){var h=goog.style.styleNameCache_[e];if(!h){var g=goog.string.toCamelCase(e),h=g;void 0===f.style[g]&&(g=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(g),void 0!==f.style[g]&&(h=g));goog.style.styleNameCache_[e]=h}return h};goog.style.getVendorStyleName_=function(e,d){var f=goog.string.toCamelCase(d);return void 0===e.style[f]&&(f=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(f),void 0!==e.style[f])?goog.dom.vendor.getVendorPrefix()+"-"+d:d};goog.style.getStyle=function(e,d){var f=e.style[goog.string.toCamelCase(d)];return"undefined"!==typeof f?f:e.style[goog.style.getVendorJsStyleName_(e,d)]||""};goog.style.getComputedStyle=function(e,d){var f=goog.dom.getOwnerDocument(e);return f.defaultView&&f.defaultView.getComputedStyle&&(f=f.defaultView.getComputedStyle(e,null))?f[d]||f.getPropertyValue(d)||"":""};goog.style.getCascadedStyle=function(d,c){return d.currentStyle?d.currentStyle[c]:null};goog.style.getStyle_=function(d,c){return goog.style.getComputedStyle(d,c)||goog.style.getCascadedStyle(d,c)||d.style&&d.style[c]};goog.style.getComputedBoxSizing=function(b){return goog.style.getStyle_(b,"boxSizing")||goog.style.getStyle_(b,"MozBoxSizing")||goog.style.getStyle_(b,"WebkitBoxSizing")||null};goog.style.getComputedPosition=function(b){return goog.style.getStyle_(b,"position")};goog.style.getBackgroundColor=function(b){return goog.style.getStyle_(b,"backgroundColor")};goog.style.getComputedOverflowX=function(b){return goog.style.getStyle_(b,"overflowX")};goog.style.getComputedOverflowY=function(b){return goog.style.getStyle_(b,"overflowY")};goog.style.getComputedZIndex=function(b){return goog.style.getStyle_(b,"zIndex")};goog.style.getComputedTextAlign=function(b){return goog.style.getStyle_(b,"textAlign")};goog.style.getComputedCursor=function(b){return goog.style.getStyle_(b,"cursor")};goog.style.getComputedTransform=function(d){var c=goog.style.getVendorStyleName_(d,"transform");return goog.style.getStyle_(d,c)||goog.style.getStyle_(d,"transform")};goog.style.setPosition=function(f,e,h){var g;e instanceof goog.math.Coordinate?(g=e.x,e=e.y):(g=e,e=h);f.style.left=goog.style.getPixelStyleValue_(g,!1);f.style.top=goog.style.getPixelStyleValue_(e,!1)};goog.style.getPosition=function(b){return new goog.math.Coordinate(b.offsetLeft,b.offsetTop)};goog.style.getClientViewportElement=function(b){b=b?goog.dom.getOwnerDocument(b):goog.dom.getDocument();return !goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||goog.dom.getDomHelper(b).isCss1CompatMode()?b.documentElement:b.body};goog.style.getViewportPageOffset=function(d){var c=d.body;d=d.documentElement;return new goog.math.Coordinate(c.scrollLeft||d.scrollLeft,c.scrollTop||d.scrollTop)};goog.style.getBoundingClientRect_=function(e){var d;try{d=e.getBoundingClientRect()}catch(f){return{left:0,top:0,right:0,bottom:0}}goog.userAgent.IE&&e.ownerDocument.body&&(e=e.ownerDocument,d.left-=e.documentElement.clientLeft+e.body.clientLeft,d.top-=e.documentElement.clientTop+e.body.clientTop);return d};goog.style.getOffsetParent=function(f){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(8)){return goog.asserts.assert(f&&"offsetParent" in f),f.offsetParent}var e=goog.dom.getOwnerDocument(f),h=goog.style.getStyle_(f,"position"),g="fixed"==h||"absolute"==h;for(f=f.parentNode;f&&f!=e;f=f.parentNode){if(f.nodeType==goog.dom.NodeType.DOCUMENT_FRAGMENT&&f.host&&(f=f.host),h=goog.style.getStyle_(f,"position"),g=g&&"static"==h&&f!=e.documentElement&&f!=e.body,!g&&(f.scrollWidth>f.clientWidth||f.scrollHeight>f.clientHeight||"fixed"==h||"absolute"==h||"relative"==h)){return f}}return null};goog.style.getVisibleRectForElement=function(j){for(var i=new goog.math.Box(0,Infinity,Infinity,0),p=goog.dom.getDomHelper(j),o=p.getDocument().body,n=p.getDocument().documentElement,m=p.getDocumentScrollElement();j=goog.style.getOffsetParent(j);){if(!(goog.userAgent.IE&&0==j.clientWidth||goog.userAgent.WEBKIT&&0==j.clientHeight&&j==o)&&j!=o&&j!=n&&"visible"!=goog.style.getStyle_(j,"overflow")){var l=goog.style.getPageOffset(j),k=goog.style.getClientLeftTop(j);l.x+=k.x;l.y+=k.y;i.top=Math.max(i.top,l.y);i.right=Math.min(i.right,l.x+j.clientWidth);i.bottom=Math.min(i.bottom,l.y+j.clientHeight);i.left=Math.max(i.left,l.x)}}o=m.scrollLeft;m=m.scrollTop;i.left=Math.max(i.left,o);i.top=Math.max(i.top,m);p=p.getViewportSize();i.right=Math.min(i.right,o+p.width);i.bottom=Math.min(i.bottom,m+p.height);return 0<=i.top&&0<=i.left&&i.bottom>i.top&&i.right>i.left?i:null};goog.style.getContainerOffsetToScrollInto=function(i,h,n){var m=h||goog.dom.getDocumentScrollElement(),l=goog.style.getPageOffset(i),k=goog.style.getPageOffset(m),j=goog.style.getBorderBox(m);m==goog.dom.getDocumentScrollElement()?(h=l.x-m.scrollLeft,l=l.y-m.scrollTop,goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(10)&&(h+=j.left,l+=j.top)):(h=l.x-k.x-j.left,l=l.y-k.y-j.top);j=m.clientWidth-i.offsetWidth;i=m.clientHeight-i.offsetHeight;k=m.scrollLeft;m=m.scrollTop;n?(k+=h-j/2,m+=l-i/2):(k+=Math.min(h,Math.max(h-j,0)),m+=Math.min(l,Math.max(l-i,0)));return new goog.math.Coordinate(k,m)};goog.style.scrollIntoContainerView=function(e,d,f){d=d||goog.dom.getDocumentScrollElement();e=goog.style.getContainerOffsetToScrollInto(e,d,f);d.scrollLeft=e.x;d.scrollTop=e.y};goog.style.getClientLeftTop=function(b){return new goog.math.Coordinate(b.clientLeft,b.clientTop)};goog.style.getPageOffset=function(f){var e=goog.dom.getOwnerDocument(f);goog.asserts.assertObject(f,"Parameter is required");var h=new goog.math.Coordinate(0,0),g=goog.style.getClientViewportElement(e);if(f==g){return h}f=goog.style.getBoundingClientRect_(f);e=goog.dom.getDomHelper(e).getDocumentScroll();h.x=f.left+e.x;h.y=f.top+e.y;return h};goog.style.getPageOffsetLeft=function(b){return goog.style.getPageOffset(b).x};goog.style.getPageOffsetTop=function(b){return goog.style.getPageOffset(b).y};goog.style.getFramedPageOffset=function(h,g){var l=new goog.math.Coordinate(0,0),k=goog.dom.getWindow(goog.dom.getOwnerDocument(h));if(!goog.reflect.canAccessProperty(k,"parent")){return l}var j=h;do{var i=k==g?goog.style.getPageOffset(j):goog.style.getClientPositionForElement_(goog.asserts.assert(j));l.x+=i.x;l.y+=i.y}while(k&&k!=g&&k!=k.parent&&(j=k.frameElement)&&(k=k.parent));return l};goog.style.translateRectForAnotherFrame=function(f,e,h){if(e.getDocument()!=h.getDocument()){var g=e.getDocument().body;h=goog.style.getFramedPageOffset(g,h.getWindow());h=goog.math.Coordinate.difference(h,goog.style.getPageOffset(g));!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||e.isCss1CompatMode()||(h=goog.math.Coordinate.difference(h,e.getDocumentScroll()));f.left+=h.x;f.top+=h.y}};goog.style.getRelativePosition=function(f,e){var h=goog.style.getClientPosition(f),g=goog.style.getClientPosition(e);return new goog.math.Coordinate(h.x-g.x,h.y-g.y)};goog.style.getClientPositionForElement_=function(b){b=goog.style.getBoundingClientRect_(b);return new goog.math.Coordinate(b.left,b.top)};goog.style.getClientPosition=function(b){goog.asserts.assert(b);if(b.nodeType==goog.dom.NodeType.ELEMENT){return goog.style.getClientPositionForElement_(b)}b=b.changedTouches?b.changedTouches[0]:b;return new goog.math.Coordinate(b.clientX,b.clientY)};goog.style.setPageOffset=function(f,e,h){var g=goog.style.getPageOffset(f);e instanceof goog.math.Coordinate&&(h=e.y,e=e.x);e=goog.asserts.assertNumber(e)-g.x;goog.style.setPosition(f,f.offsetLeft+e,f.offsetTop+(Number(h)-g.y))};goog.style.setSize=function(e,d,f){if(d instanceof goog.math.Size){f=d.height,d=d.width}else{if(void 0==f){throw Error("missing height argument")}}goog.style.setWidth(e,d);goog.style.setHeight(e,f)};goog.style.getPixelStyleValue_=function(d,c){"number"==typeof d&&(d=(c?Math.round(d):d)+"px");return d};goog.style.setHeight=function(d,c){d.style.height=goog.style.getPixelStyleValue_(c,!0)};goog.style.setWidth=function(d,c){d.style.width=goog.style.getPixelStyleValue_(c,!0)};goog.style.getSize=function(b){return goog.style.evaluateWithTemporaryDisplay_(goog.style.getSizeWithDisplay_,b)};goog.style.evaluateWithTemporaryDisplay_=function(i,h){if("none"!=goog.style.getStyle_(h,"display")){return i(h)}var n=h.style,m=n.display,l=n.visibility,k=n.position;n.visibility="hidden";n.position="absolute";n.display="inline";var j=i(h);n.display=m;n.position=k;n.visibility=l;return j};goog.style.getSizeWithDisplay_=function(f){var e=f.offsetWidth,h=f.offsetHeight,g=goog.userAgent.WEBKIT&&!e&&!h;return goog.isDef(e)&&!g||!f.getBoundingClientRect?new goog.math.Size(e,h):(f=goog.style.getBoundingClientRect_(f),new goog.math.Size(f.right-f.left,f.bottom-f.top))};goog.style.getTransformedSize=function(b){if(!b.getBoundingClientRect){return null}b=goog.style.evaluateWithTemporaryDisplay_(goog.style.getBoundingClientRect_,b);return new goog.math.Size(b.right-b.left,b.bottom-b.top)};goog.style.getBounds=function(d){var c=goog.style.getPageOffset(d);d=goog.style.getSize(d);return new goog.math.Rect(c.x,c.y,d.width,d.height)};goog.style.toCamelCase=function(b){return goog.string.toCamelCase(String(b))};goog.style.toSelectorCase=function(b){return goog.string.toSelectorCase(b)};goog.style.getOpacity=function(d){goog.asserts.assert(d);var c=d.style;d="";"opacity" in c?d=c.opacity:"MozOpacity" in c?d=c.MozOpacity:"filter" in c&&(c=c.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(d=String(c[1]/100));return""==d?d:Number(d)};goog.style.setOpacity=function(e,d){goog.asserts.assert(e);var f=e.style;"opacity" in f?f.opacity=d:"MozOpacity" in f?f.MozOpacity=d:"filter" in f&&(f.filter=""===d?"":"alpha(opacity="+100*Number(d)+")")};goog.style.setTransparentBackgroundImage=function(e,d){var f=e.style;goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?f.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+d+'", sizingMethod="crop")':(f.backgroundImage="url("+d+")",f.backgroundPosition="top left",f.backgroundRepeat="no-repeat")};goog.style.clearTransparentBackgroundImage=function(b){b=b.style;"filter" in b?b.filter="":b.backgroundImage="none"};goog.style.showElement=function(d,c){goog.style.setElementShown(d,c)};goog.style.setElementShown=function(d,c){d.style.display=c?"":"none"};goog.style.isElementShown=function(b){return"none"!=b.style.display};goog.style.installStyles=function(d,c){return goog.style.installSafeStyleSheet(goog.html.legacyconversions.safeStyleSheetFromString(d),c)};goog.style.installSafeStyleSheet=function(g,f){var j=goog.dom.getDomHelper(f),i,h=j.getDocument();goog.userAgent.IE&&h.createStyleSheet?(i=h.createStyleSheet(),goog.style.setSafeStyleSheet(i,g)):(h=j.getElementsByTagNameAndClass("HEAD")[0],h||(i=j.getElementsByTagNameAndClass("BODY")[0],h=j.createDom("HEAD"),i.parentNode.insertBefore(h,i)),i=j.createDom("STYLE"),goog.style.setSafeStyleSheet(i,g),j.appendChild(h,i));return i};goog.style.uninstallStyles=function(b){goog.dom.removeNode(b.ownerNode||b.owningElement||b)};goog.style.setStyles=function(d,c){goog.style.setSafeStyleSheet(d,goog.html.legacyconversions.safeStyleSheetFromString(c))};goog.style.setSafeStyleSheet=function(e,d){var f=goog.html.SafeStyleSheet.unwrap(d);goog.userAgent.IE&&goog.isDef(e.cssText)?e.cssText=f:goog.dom.setTextContent(e,f)};goog.style.setPreWrap=function(b){b=b.style;goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=goog.userAgent.GECKO?"-moz-pre-wrap":"pre-wrap"};goog.style.setInlineBlock=function(b){b=b.style;b.position="relative";goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(b.zoom="1",b.display="inline"):b.display="inline-block"};goog.style.isRightToLeft=function(b){return"rtl"==goog.style.getStyle_(b,"direction")};goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT||goog.userAgent.EDGE?"WebkitUserSelect":null;goog.style.isUnselectable=function(b){return goog.style.unselectableStyle_?"none"==b.style[goog.style.unselectableStyle_].toLowerCase():goog.userAgent.IE||goog.userAgent.OPERA?"on"==b.getAttribute("unselectable"):!1};goog.style.setUnselectable=function(g,f,j){j=j?null:g.getElementsByTagName("*");var i=goog.style.unselectableStyle_;if(i){if(f=f?"none":"",g.style&&(g.style[i]=f),j){g=0;for(var h;h=j[g];g++){h.style&&(h.style[i]=f)}}}else{if(goog.userAgent.IE||goog.userAgent.OPERA){if(f=f?"on":"",g.setAttribute("unselectable",f),j){for(g=0;h=j[g];g++){h.setAttribute("unselectable",f)}}}}};goog.style.getBorderBoxSize=function(b){return new goog.math.Size(b.offsetWidth,b.offsetHeight)};goog.style.setBorderBoxSize=function(g,f){var j=goog.dom.getOwnerDocument(g),i=goog.dom.getDomHelper(j).isCss1CompatMode();if(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10")||i&&goog.userAgent.isVersionOrHigher("8")){goog.style.setBoxSizingSize_(g,f,"border-box")}else{if(j=g.style,i){var i=goog.style.getPaddingBox(g),h=goog.style.getBorderBox(g);j.pixelWidth=f.width-h.left-i.left-i.right-h.right;j.pixelHeight=f.height-h.top-i.top-i.bottom-h.bottom}else{j.pixelWidth=f.width,j.pixelHeight=f.height}}};goog.style.getContentBoxSize=function(e){var d=goog.dom.getOwnerDocument(e),f=goog.userAgent.IE&&e.currentStyle;if(f&&goog.dom.getDomHelper(d).isCss1CompatMode()&&"auto"!=f.width&&"auto"!=f.height&&!f.boxSizing){return d=goog.style.getIePixelValue_(e,f.width,"width","pixelWidth"),e=goog.style.getIePixelValue_(e,f.height,"height","pixelHeight"),new goog.math.Size(d,e)}f=goog.style.getBorderBoxSize(e);d=goog.style.getPaddingBox(e);e=goog.style.getBorderBox(e);return new goog.math.Size(f.width-e.left-d.left-d.right-e.right,f.height-e.top-d.top-d.bottom-e.bottom)};goog.style.setContentBoxSize=function(g,f){var j=goog.dom.getOwnerDocument(g),i=goog.dom.getDomHelper(j).isCss1CompatMode();if(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10")||i&&goog.userAgent.isVersionOrHigher("8")){goog.style.setBoxSizingSize_(g,f,"content-box")}else{if(j=g.style,i){j.pixelWidth=f.width,j.pixelHeight=f.height}else{var i=goog.style.getPaddingBox(g),h=goog.style.getBorderBox(g);j.pixelWidth=f.width+h.left+i.left+i.right+h.right;j.pixelHeight=f.height+h.top+i.top+i.bottom+h.bottom}}};goog.style.setBoxSizingSize_=function(e,d,f){e=e.style;goog.userAgent.GECKO?e.MozBoxSizing=f:goog.userAgent.WEBKIT?e.WebkitBoxSizing=f:e.boxSizing=f;e.width=Math.max(d.width,0)+"px";e.height=Math.max(d.height,0)+"px"};goog.style.getIePixelValue_=function(h,g,l,k){if(/^\d+px?$/.test(g)){return parseInt(g,10)}var j=h.style[l],i=h.runtimeStyle[l];h.runtimeStyle[l]=h.currentStyle[l];h.style[l]=g;g=h.style[k];h.style[l]=j;h.runtimeStyle[l]=i;return g};goog.style.getIePixelDistance_=function(e,d){var f=goog.style.getCascadedStyle(e,d);return f?goog.style.getIePixelValue_(e,f,"left","pixelLeft"):0};goog.style.getBox_=function(h,g){if(goog.userAgent.IE){var l=goog.style.getIePixelDistance_(h,g+"Left"),k=goog.style.getIePixelDistance_(h,g+"Right"),j=goog.style.getIePixelDistance_(h,g+"Top"),i=goog.style.getIePixelDistance_(h,g+"Bottom");return new goog.math.Box(j,k,i,l)}l=goog.style.getComputedStyle(h,g+"Left");k=goog.style.getComputedStyle(h,g+"Right");j=goog.style.getComputedStyle(h,g+"Top");i=goog.style.getComputedStyle(h,g+"Bottom");return new goog.math.Box(parseFloat(j),parseFloat(k),parseFloat(i),parseFloat(l))};goog.style.getPaddingBox=function(b){return goog.style.getBox_(b,"padding")};goog.style.getMarginBox=function(b){return goog.style.getBox_(b,"margin")};goog.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6};goog.style.getIePixelBorder_=function(e,d){if("none"==goog.style.getCascadedStyle(e,d+"Style")){return 0}var f=goog.style.getCascadedStyle(e,d+"Width");return f in goog.style.ieBorderWidthKeywords_?goog.style.ieBorderWidthKeywords_[f]:goog.style.getIePixelValue_(e,f,"left","pixelLeft")};goog.style.getBorderBox=function(f){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){var e=goog.style.getIePixelBorder_(f,"borderLeft"),h=goog.style.getIePixelBorder_(f,"borderRight"),g=goog.style.getIePixelBorder_(f,"borderTop");f=goog.style.getIePixelBorder_(f,"borderBottom");return new goog.math.Box(g,h,f,e)}e=goog.style.getComputedStyle(f,"borderLeftWidth");h=goog.style.getComputedStyle(f,"borderRightWidth");g=goog.style.getComputedStyle(f,"borderTopWidth");f=goog.style.getComputedStyle(f,"borderBottomWidth");return new goog.math.Box(parseFloat(g),parseFloat(h),parseFloat(f),parseFloat(e))};goog.style.getFontFamily=function(f){var e=goog.dom.getOwnerDocument(f),h="";if(e.body.createTextRange&&goog.dom.contains(e,f)){e=e.body.createTextRange();e.moveToElementText(f);try{h=e.queryCommandValue("FontName")}catch(g){h=""}}h||(h=goog.style.getStyle_(f,"fontFamily"));f=h.split(",");1<f.length&&(h=f[0]);return goog.string.stripQuotes(h,"\"'")};goog.style.lengthUnitRegex_=/[^\d]+$/;goog.style.getLengthUnits=function(b){return(b=b.match(goog.style.lengthUnitRegex_))&&b[0]||null};goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,"in":1,mm:1,pc:1,pt:1};goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1};goog.style.getFontSize=function(e){var d=goog.style.getStyle_(e,"fontSize"),f=goog.style.getLengthUnits(d);if(d&&"px"==f){return parseInt(d,10)}if(goog.userAgent.IE){if(String(f) in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_){return goog.style.getIePixelValue_(e,d,"left","pixelLeft")}if(e.parentNode&&e.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&String(f) in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_){return e=e.parentNode,f=goog.style.getStyle_(e,"fontSize"),goog.style.getIePixelValue_(e,d==f?"1em":d,"left","pixelLeft")}}f=goog.dom.createDom("SPAN",{style:"visibility:hidden;position:absolute;line-height:0;padding:0;margin:0;border:0;height:1em;"});goog.dom.appendChild(e,f);d=f.offsetHeight;goog.dom.removeNode(f);return d};goog.style.parseStyleAttribute=function(d){var c={};goog.array.forEach(d.split(/\s*;\s*/),function(b){var e=b.match(/\s*([\w-]+)\s*\:(.+)/);e&&(b=e[1],e=goog.string.trim(e[2]),c[goog.string.toCamelCase(b.toLowerCase())]=e)});return c};goog.style.toStyleAttribute=function(d){var c=[];goog.object.forEach(d,function(b,e){c.push(goog.string.toSelectorCase(e),":",b,";")});return c.join("")};goog.style.setFloat=function(d,c){d.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=c};goog.style.getFloat=function(b){return b.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""};goog.style.getScrollbarWidth=function(d){var c=goog.dom.createElement("DIV");d&&(c.className=d);c.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px";d=goog.dom.createElement("DIV");goog.style.setSize(d,"200px","200px");c.appendChild(d);goog.dom.appendChild(goog.dom.getDocument().body,c);d=c.offsetWidth-c.clientWidth;goog.dom.removeNode(c);return d};goog.style.MATRIX_TRANSLATION_REGEX_=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;goog.style.getCssTranslation=function(b){b=goog.style.getComputedTransform(b);return b?(b=b.match(goog.style.MATRIX_TRANSLATION_REGEX_))?new goog.math.Coordinate(parseFloat(b[1]),parseFloat(b[2])):new goog.math.Coordinate(0,0):new goog.math.Coordinate(0,0)};goog.Thenable=function(){};goog.Thenable.prototype.then=function(e,d,f){};goog.Thenable.IMPLEMENTED_BY_PROP="$goog_Thenable";goog.Thenable.addImplementation=function(b){goog.exportProperty(b.prototype,"then",b.prototype.then);COMPILED?b.prototype[goog.Thenable.IMPLEMENTED_BY_PROP]=!0:b.prototype.$goog_Thenable=!0};goog.Thenable.isImplementedBy=function(d){if(!d){return !1}try{return COMPILED?!!d[goog.Thenable.IMPLEMENTED_BY_PROP]:!!d.$goog_Thenable}catch(c){return !1}};goog.async={};goog.async.FreeList=function(e,d,f){this.limit_=f;this.create_=e;this.reset_=d;this.occupants_=0;this.head_=null};goog.async.FreeList.prototype.get=function(){var b;0<this.occupants_?(this.occupants_--,b=this.head_,this.head_=b.next,b.next=null):b=this.create_();return b};goog.async.FreeList.prototype.put=function(b){this.reset_(b);this.occupants_<this.limit_&&(this.occupants_++,b.next=this.head_,this.head_=b)};goog.async.FreeList.prototype.occupants=function(){return this.occupants_};goog.async.WorkQueue=function(){this.workTail_=this.workHead_=null};goog.async.WorkQueue.DEFAULT_MAX_UNUSED=100;goog.async.WorkQueue.freelist_=new goog.async.FreeList(function(){return new goog.async.WorkItem},function(b){b.reset()},goog.async.WorkQueue.DEFAULT_MAX_UNUSED);goog.async.WorkQueue.prototype.add=function(e,d){var f=this.getUnusedItem_();f.set(e,d);this.workTail_?this.workTail_.next=f:(goog.asserts.assert(!this.workHead_),this.workHead_=f);this.workTail_=f};goog.async.WorkQueue.prototype.remove=function(){var b=null;this.workHead_&&(b=this.workHead_,this.workHead_=this.workHead_.next,this.workHead_||(this.workTail_=null),b.next=null);return b};goog.async.WorkQueue.prototype.returnUnused=function(b){goog.async.WorkQueue.freelist_.put(b)};goog.async.WorkQueue.prototype.getUnusedItem_=function(){return goog.async.WorkQueue.freelist_.get()};goog.async.WorkItem=function(){this.next=this.scope=this.fn=null};goog.async.WorkItem.prototype.set=function(d,c){this.fn=d;this.scope=c;this.next=null};goog.async.WorkItem.prototype.reset=function(){this.next=this.scope=this.fn=null};goog.functions={};goog.functions.constant=function(b){return function(){return b}};goog.functions.FALSE=goog.functions.constant(!1);goog.functions.TRUE=goog.functions.constant(!0);goog.functions.NULL=goog.functions.constant(null);goog.functions.identity=function(d,c){return d};goog.functions.error=function(b){return function(){throw Error(b)}};goog.functions.fail=function(b){return function(){throw b}};goog.functions.lock=function(d,c){c=c||0;return function(){return d.apply(this,Array.prototype.slice.call(arguments,0,c))}};goog.functions.nth=function(b){return function(){return arguments[b]}};goog.functions.partialRight=function(e,d){var f=Array.prototype.slice.call(arguments,1);return function(){var a=Array.prototype.slice.call(arguments);a.push.apply(a,f);return e.apply(this,a)}};goog.functions.withReturnValue=function(d,c){return goog.functions.sequence(d,goog.functions.constant(c))};goog.functions.equalTo=function(d,c){return function(a){return c?d==a:d===a}};goog.functions.compose=function(f,e){var h=arguments,g=h.length;return function(){var d;g&&(d=h[g-1].apply(this,arguments));for(var c=g-2;0<=c;c--){d=h[c].call(this,d)}return d}};goog.functions.sequence=function(e){var d=arguments,f=d.length;return function(){for(var b,c=0;c<f;c++){b=d[c].apply(this,arguments)}return b}};goog.functions.and=function(e){var d=arguments,f=d.length;return function(){for(var b=0;b<f;b++){if(!d[b].apply(this,arguments)){return !1}}return !0}};goog.functions.or=function(e){var d=arguments,f=d.length;return function(){for(var b=0;b<f;b++){if(d[b].apply(this,arguments)){return !0}}return !1}};goog.functions.not=function(b){return function(){return !b.apply(this,arguments)}};goog.functions.create=function(e,d){var f=function(){};f.prototype=e.prototype;f=new f;e.apply(f,Array.prototype.slice.call(arguments,1));return f};goog.functions.CACHE_RETURN_VALUE=!0;goog.functions.cacheReturnValue=function(e){var d=!1,f;return function(){if(!goog.functions.CACHE_RETURN_VALUE){return e()}d||(f=e(),d=!0);return f}};goog.functions.once=function(d){var c=d;return function(){if(c){var b=c;c=null;b()}}};goog.functions.debounce=function(f,e,h){h&&(f=goog.bind(f,h));var g=null;return function(b){goog.global.clearTimeout(g);var a=arguments;g=goog.global.setTimeout(function(){f.apply(null,a)},e)}};goog.functions.throttle=function(j,i,p){p&&(j=goog.bind(j,p));var o=null,n=!1,m=[],l=function(){o=null;n&&(n=!1,k())},k=function(){o=goog.global.setTimeout(l,i);j.apply(null,m)};return function(b){m=arguments;o?n=!0:k()}};goog.async.throwException=function(b){goog.global.setTimeout(function(){throw b},0)};goog.async.nextTick=function(f,e,h){var g=f;e&&(g=goog.bind(f,e));g=goog.async.nextTick.wrapCallback_(g);goog.isFunction(goog.global.setImmediate)&&(h||goog.async.nextTick.useSetImmediate_())?goog.global.setImmediate(g):(goog.async.nextTick.setImmediate_||(goog.async.nextTick.setImmediate_=goog.async.nextTick.getSetImmediateEmulator_()),goog.async.nextTick.setImmediate_(g))};goog.async.nextTick.useSetImmediate_=function(){return goog.global.Window&&goog.global.Window.prototype&&!goog.labs.userAgent.browser.isEdge()&&goog.global.Window.prototype.setImmediate==goog.global.setImmediate?!1:!0};goog.async.nextTick.getSetImmediateEmulator_=function(){var f=goog.global.MessageChannel;"undefined"===typeof f&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!goog.labs.userAgent.engine.isPresto()&&(f=function(){var j=document.createElement("IFRAME");j.style.display="none";j.src="";document.documentElement.appendChild(j);var i=j.contentWindow,j=i.document;j.open();j.write("");j.close();var l="callImmediate"+Math.random(),k="file:"==i.location.protocol?"*":i.location.protocol+"//"+i.location.host,j=goog.bind(function(b){if(("*"==k||b.origin==k)&&b.data==l){this.port1.onmessage()}},this);i.addEventListener("message",j,!1);this.port1={};this.port2={postMessage:function(){i.postMessage(l,k)}}});if("undefined"!==typeof f&&!goog.labs.userAgent.browser.isIE()){var e=new f,h={},g=h;e.port1.onmessage=function(){if(goog.isDef(h.next)){h=h.next;var b=h.cb;h.cb=null;b()}};return function(b){g.next={cb:b};g=g.next;e.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange" in document.createElement("SCRIPT")?function(d){var c=document.createElement("SCRIPT");c.onreadystatechange=function(){c.onreadystatechange=null;c.parentNode.removeChild(c);c=null;d();d=null};document.documentElement.appendChild(c)}:function(b){goog.global.setTimeout(b,0)}};goog.async.nextTick.wrapCallback_=goog.functions.identity;goog.debug.entryPointRegistry.register(function(b){goog.async.nextTick.wrapCallback_=b});goog.async.run=function(d,c){goog.async.run.schedule_||goog.async.run.initializeRunner_();goog.async.run.workQueueScheduled_||(goog.async.run.schedule_(),goog.async.run.workQueueScheduled_=!0);goog.async.run.workQueue_.add(d,c)};goog.async.run.initializeRunner_=function(){if(goog.global.Promise&&goog.global.Promise.resolve){var b=goog.global.Promise.resolve(void 0);goog.async.run.schedule_=function(){b.then(goog.async.run.processWorkQueue)}}else{goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue)}}};goog.async.run.forceNextTick=function(b){goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue);b&&b(goog.async.run.processWorkQueue)}};goog.async.run.workQueueScheduled_=!1;goog.async.run.workQueue_=new goog.async.WorkQueue;goog.DEBUG&&(goog.async.run.resetQueue=function(){goog.async.run.workQueueScheduled_=!1;goog.async.run.workQueue_=new goog.async.WorkQueue});goog.async.run.processWorkQueue=function(){for(var d;d=goog.async.run.workQueue_.remove();){try{d.fn.call(d.scope)}catch(c){goog.async.throwException(c)}goog.async.run.workQueue_.returnUnused(d)}goog.async.run.workQueueScheduled_=!1};goog.promise={};goog.promise.Resolver=function(){};goog.Promise=function(f,e){this.state_=goog.Promise.State_.PENDING;this.result_=void 0;this.callbackEntriesTail_=this.callbackEntries_=this.parent_=null;this.executing_=!1;0<goog.Promise.UNHANDLED_REJECTION_DELAY?this.unhandledRejectionId_=0:0==goog.Promise.UNHANDLED_REJECTION_DELAY&&(this.hadUnhandledRejection_=!1);goog.Promise.LONG_STACK_TRACES&&(this.stack_=[],this.addStackTrace_(Error("created")),this.currentStep_=0);if(f!=goog.nullFunction){try{var h=this;f.call(e,function(b){h.resolve_(goog.Promise.State_.FULFILLED,b)},function(b){if(goog.DEBUG&&!(b instanceof goog.Promise.CancellationError)){try{if(b instanceof Error){throw b}throw Error("Promise rejected.")}catch(c){}}h.resolve_(goog.Promise.State_.REJECTED,b)})}catch(g){this.resolve_(goog.Promise.State_.REJECTED,g)}}};goog.Promise.LONG_STACK_TRACES=!1;goog.Promise.UNHANDLED_REJECTION_DELAY=0;goog.Promise.State_={PENDING:0,BLOCKED:1,FULFILLED:2,REJECTED:3};goog.Promise.CallbackEntry_=function(){this.next=this.context=this.onRejected=this.onFulfilled=this.child=null;this.always=!1};goog.Promise.CallbackEntry_.prototype.reset=function(){this.context=this.onRejected=this.onFulfilled=this.child=null;this.always=!1};goog.Promise.DEFAULT_MAX_UNUSED=100;goog.Promise.freelist_=new goog.async.FreeList(function(){return new goog.Promise.CallbackEntry_},function(b){b.reset()},goog.Promise.DEFAULT_MAX_UNUSED);goog.Promise.getCallbackEntry_=function(f,e,h){var g=goog.Promise.freelist_.get();g.onFulfilled=f;g.onRejected=e;g.context=h;return g};goog.Promise.returnEntry_=function(b){goog.Promise.freelist_.put(b)};goog.Promise.resolve=function(d){if(d instanceof goog.Promise){return d}var c=new goog.Promise(goog.nullFunction);c.resolve_(goog.Promise.State_.FULFILLED,d);return c};goog.Promise.reject=function(b){return new goog.Promise(function(a,d){d(b)})};goog.Promise.resolveThen_=function(e,d,f){goog.Promise.maybeThen_(e,d,f,null)||goog.async.run(goog.partial(d,e))};goog.Promise.race=function(b){return new goog.Promise(function(a,h){b.length||a(void 0);for(var g=0,f;g<b.length;g++){f=b[g],goog.Promise.resolveThen_(f,a,h)}})};goog.Promise.all=function(b){return new goog.Promise(function(a,p){var o=b.length,n=[];if(o){for(var m=function(d,e){o--;n[d]=e;0==o&&a(n)},l=function(c){p(c)},j=0,i;j<b.length;j++){i=b[j],goog.Promise.resolveThen_(i,goog.partial(m,j),l)}}else{a(n)}})};goog.Promise.allSettled=function(b){return new goog.Promise(function(a,n){var m=b.length,l=[];if(m){for(var k=function(d,g,e){m--;l[d]=g?{fulfilled:!0,value:e}:{fulfilled:!1,reason:e};0==m&&a(l)},j=0,i;j<b.length;j++){i=b[j],goog.Promise.resolveThen_(i,goog.partial(k,j,!0),goog.partial(k,j,!1))}}else{a(l)}})};goog.Promise.firstFulfilled=function(b){return new goog.Promise(function(a,p){var o=b.length,n=[];if(o){for(var m=function(c){a(c)},l=function(d,c){o--;n[d]=c;0==o&&p(n)},j=0,i;j<b.length;j++){i=b[j],goog.Promise.resolveThen_(i,m,goog.partial(l,j))}}else{a(void 0)}})};goog.Promise.withResolver=function(){var e,d,f=new goog.Promise(function(b,a){e=b;d=a});return new goog.Promise.Resolver_(f,e,d)};goog.Promise.prototype.then=function(e,d,f){null!=e&&goog.asserts.assertFunction(e,"opt_onFulfilled should be a function.");null!=d&&goog.asserts.assertFunction(d,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?");goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("then"));return this.addChildPromise_(goog.isFunction(e)?e:null,goog.isFunction(d)?d:null,f)};goog.Thenable.addImplementation(goog.Promise);goog.Promise.prototype.thenVoid=function(e,d,f){null!=e&&goog.asserts.assertFunction(e,"opt_onFulfilled should be a function.");null!=d&&goog.asserts.assertFunction(d,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?");goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("then"));this.addCallbackEntry_(goog.Promise.getCallbackEntry_(e||goog.nullFunction,d||null,f))};goog.Promise.prototype.thenAlways=function(e,d){goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("thenAlways"));var f=goog.Promise.getCallbackEntry_(e,e,d);f.always=!0;this.addCallbackEntry_(f);return this};goog.Promise.prototype.thenCatch=function(d,c){goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("thenCatch"));return this.addChildPromise_(null,d,c)};goog.Promise.prototype.cancel=function(b){this.state_==goog.Promise.State_.PENDING&&goog.async.run(function(){var a=new goog.Promise.CancellationError(b);this.cancelInternal_(a)},this)};goog.Promise.prototype.cancelInternal_=function(b){this.state_==goog.Promise.State_.PENDING&&(this.parent_?(this.parent_.cancelChild_(this,b),this.parent_=null):this.resolve_(goog.Promise.State_.REJECTED,b))};goog.Promise.prototype.cancelChild_=function(h,g){if(this.callbackEntries_){for(var l=0,k=null,j=null,i=this.callbackEntries_;i&&(i.always||(l++,i.child==h&&(k=i),!(k&&1<l)));i=i.next){k||(j=i)}k&&(this.state_==goog.Promise.State_.PENDING&&1==l?this.cancelInternal_(g):(j?this.removeEntryAfter_(j):this.popEntry_(),this.executeCallback_(k,goog.Promise.State_.REJECTED,g)))}};goog.Promise.prototype.addCallbackEntry_=function(b){this.hasEntry_()||this.state_!=goog.Promise.State_.FULFILLED&&this.state_!=goog.Promise.State_.REJECTED||this.scheduleCallbacks_();this.queueEntry_(b)};goog.Promise.prototype.addChildPromise_=function(f,e,h){var g=goog.Promise.getCallbackEntry_(null,null,null);g.child=new goog.Promise(function(b,a){g.onFulfilled=f?function(c){try{var j=f.call(h,c);b(j)}catch(i){a(i)}}:b;g.onRejected=e?function(c){try{var j=e.call(h,c);!goog.isDef(j)&&c instanceof goog.Promise.CancellationError?a(c):b(j)}catch(i){a(i)}}:a});g.child.parent_=this;this.addCallbackEntry_(g);return g.child};goog.Promise.prototype.unblockAndFulfill_=function(b){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED);this.state_=goog.Promise.State_.PENDING;this.resolve_(goog.Promise.State_.FULFILLED,b)};goog.Promise.prototype.unblockAndReject_=function(b){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED);this.state_=goog.Promise.State_.PENDING;this.resolve_(goog.Promise.State_.REJECTED,b)};goog.Promise.prototype.resolve_=function(d,c){this.state_==goog.Promise.State_.PENDING&&(this===c&&(d=goog.Promise.State_.REJECTED,c=new TypeError("Promise cannot resolve to itself")),this.state_=goog.Promise.State_.BLOCKED,goog.Promise.maybeThen_(c,this.unblockAndFulfill_,this.unblockAndReject_,this)||(this.result_=c,this.state_=d,this.parent_=null,this.scheduleCallbacks_(),d!=goog.Promise.State_.REJECTED||c instanceof goog.Promise.CancellationError||goog.Promise.addUnhandledRejection_(this,c)))};goog.Promise.maybeThen_=function(h,g,l,k){if(h instanceof goog.Promise){return h.thenVoid(g,l,k),!0}if(goog.Thenable.isImplementedBy(h)){return h.then(g,l,k),!0}if(goog.isObject(h)){try{var j=h.then;if(goog.isFunction(j)){return goog.Promise.tryThen_(h,j,g,l,k),!0}}catch(i){return l.call(k,i),!0}}return !1};goog.Promise.tryThen_=function(r,q,p,o,n){var m=!1,l=function(b){m||(m=!0,p.call(n,b))},j=function(b){m||(m=!0,o.call(n,b))};try{q.call(r,l,j)}catch(i){j(i)}};goog.Promise.prototype.scheduleCallbacks_=function(){this.executing_||(this.executing_=!0,goog.async.run(this.executeCallbacks_,this))};goog.Promise.prototype.hasEntry_=function(){return !!this.callbackEntries_};goog.Promise.prototype.queueEntry_=function(b){goog.asserts.assert(null!=b.onFulfilled);this.callbackEntriesTail_?this.callbackEntriesTail_.next=b:this.callbackEntries_=b;this.callbackEntriesTail_=b};goog.Promise.prototype.popEntry_=function(){var b=null;this.callbackEntries_&&(b=this.callbackEntries_,this.callbackEntries_=b.next,b.next=null);this.callbackEntries_||(this.callbackEntriesTail_=null);null!=b&&goog.asserts.assert(null!=b.onFulfilled);return b};goog.Promise.prototype.removeEntryAfter_=function(b){goog.asserts.assert(this.callbackEntries_);goog.asserts.assert(null!=b);b.next==this.callbackEntriesTail_&&(this.callbackEntriesTail_=b);b.next=b.next.next};goog.Promise.prototype.executeCallbacks_=function(){for(var b;b=this.popEntry_();){goog.Promise.LONG_STACK_TRACES&&this.currentStep_++,this.executeCallback_(b,this.state_,this.result_)}this.executing_=!1};goog.Promise.prototype.executeCallback_=function(f,e,h){e==goog.Promise.State_.REJECTED&&f.onRejected&&!f.always&&this.removeUnhandledRejection_();if(f.child){f.child.parent_=null,goog.Promise.invokeCallback_(f,e,h)}else{try{f.always?f.onFulfilled.call(f.context):goog.Promise.invokeCallback_(f,e,h)}catch(g){goog.Promise.handleRejection_.call(null,g)}}goog.Promise.returnEntry_(f)};goog.Promise.invokeCallback_=function(e,d,f){d==goog.Promise.State_.FULFILLED?e.onFulfilled.call(e.context,f):e.onRejected&&e.onRejected.call(e.context,f)};goog.Promise.prototype.addStackTrace_=function(d){if(goog.Promise.LONG_STACK_TRACES&&goog.isString(d.stack)){var c=d.stack.split("\n",4)[3];d=d.message;d+=Array(11-d.length).join(" ");this.stack_.push(d+c)}};goog.Promise.prototype.appendLongStack_=function(f){if(goog.Promise.LONG_STACK_TRACES&&f&&goog.isString(f.stack)&&this.stack_.length){for(var e=["Promise trace:"],h=this;h;h=h.parent_){for(var g=this.currentStep_;0<=g;g--){e.push(h.stack_[g])}e.push("Value: ["+(h.state_==goog.Promise.State_.REJECTED?"REJECTED":"FULFILLED")+"] <"+String(h.result_)+">")}f.stack+="\n\n"+e.join("\n")}};goog.Promise.prototype.removeUnhandledRejection_=function(){if(0<goog.Promise.UNHANDLED_REJECTION_DELAY){for(var b=this;b&&b.unhandledRejectionId_;b=b.parent_){goog.global.clearTimeout(b.unhandledRejectionId_),b.unhandledRejectionId_=0}}else{if(0==goog.Promise.UNHANDLED_REJECTION_DELAY){for(b=this;b&&b.hadUnhandledRejection_;b=b.parent_){b.hadUnhandledRejection_=!1}}}};goog.Promise.addUnhandledRejection_=function(d,c){0<goog.Promise.UNHANDLED_REJECTION_DELAY?d.unhandledRejectionId_=goog.global.setTimeout(function(){d.appendLongStack_(c);goog.Promise.handleRejection_.call(null,c)},goog.Promise.UNHANDLED_REJECTION_DELAY):0==goog.Promise.UNHANDLED_REJECTION_DELAY&&(d.hadUnhandledRejection_=!0,goog.async.run(function(){d.hadUnhandledRejection_&&(d.appendLongStack_(c),goog.Promise.handleRejection_.call(null,c))}))};goog.Promise.handleRejection_=goog.async.throwException;goog.Promise.setUnhandledRejectionHandler=function(b){goog.Promise.handleRejection_=b};goog.Promise.CancellationError=function(b){goog.debug.Error.call(this,b)};goog.inherits(goog.Promise.CancellationError,goog.debug.Error);goog.Promise.CancellationError.prototype.name="cancel";goog.Promise.Resolver_=function(e,d,f){this.promise=e;this.resolve=d;this.reject=f};goog.events.EventTarget=function(){goog.Disposable.call(this);this.eventTargetListeners_=new goog.events.ListenerMap(this);this.actualEventTarget_=this;this.parentEventTarget_=null};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.Listenable.addImplementation(goog.events.EventTarget);goog.events.EventTarget.MAX_ANCESTORS_=1000;goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};goog.events.EventTarget.prototype.setParentEventTarget=function(b){this.parentEventTarget_=b};goog.events.EventTarget.prototype.addEventListener=function(f,e,h,g){goog.events.listen(this,f,e,h,g)};goog.events.EventTarget.prototype.removeEventListener=function(f,e,h,g){goog.events.unlisten(this,f,e,h,g)};goog.events.EventTarget.prototype.dispatchEvent=function(f){this.assertInitialized_();var e,h=this.getParentEventTarget();if(h){e=[];for(var g=1;h;h=h.getParentEventTarget()){e.push(h),goog.asserts.assert(++g<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop")}}return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,f,e)};goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);this.removeAllListeners();this.parentEventTarget_=null};goog.events.EventTarget.prototype.listen=function(f,e,h,g){this.assertInitialized_();return this.eventTargetListeners_.add(String(f),e,!1,h,g)};goog.events.EventTarget.prototype.listenOnce=function(f,e,h,g){return this.eventTargetListeners_.add(String(f),e,!0,h,g)};goog.events.EventTarget.prototype.unlisten=function(f,e,h,g){return this.eventTargetListeners_.remove(String(f),e,h,g)};goog.events.EventTarget.prototype.unlistenByKey=function(b){return this.eventTargetListeners_.removeByKey(b)};goog.events.EventTarget.prototype.removeAllListeners=function(b){return this.eventTargetListeners_?this.eventTargetListeners_.removeAll(b):0};goog.events.EventTarget.prototype.fireListeners=function(j,i,p){j=this.eventTargetListeners_.listeners[String(j)];if(!j){return !0}j=j.concat();for(var o=!0,n=0;n<j.length;++n){var m=j[n];if(m&&!m.removed&&m.capture==i){var l=m.listener,k=m.handler||m.src;m.callOnce&&this.unlistenByKey(m);o=!1!==l.call(k,p)&&o}}return o&&0!=p.returnValue_};goog.events.EventTarget.prototype.getListeners=function(d,c){return this.eventTargetListeners_.getListeners(String(d),c)};goog.events.EventTarget.prototype.getListener=function(f,e,h,g){return this.eventTargetListeners_.getListener(String(f),e,h,g)};goog.events.EventTarget.prototype.hasListener=function(e,d){var f=goog.isDef(e)?String(e):void 0;return this.eventTargetListeners_.hasListener(f,d)};goog.events.EventTarget.prototype.setTargetForTesting=function(b){this.actualEventTarget_=b};goog.events.EventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")};goog.events.EventTarget.dispatchEventInternal_=function(i,h,n){var m=h.type||h;if(goog.isString(h)){h=new goog.events.Event(h,i)}else{if(h instanceof goog.events.Event){h.target=h.target||i}else{var l=h;h=new goog.events.Event(m,i);goog.object.extend(h,l)}}var l=!0,k;if(n){for(var j=n.length-1;!h.propagationStopped_&&0<=j;j--){k=h.currentTarget=n[j],l=k.fireListeners(m,!0,h)&&l}}h.propagationStopped_||(k=h.currentTarget=i,l=k.fireListeners(m,!0,h)&&l,h.propagationStopped_||(l=k.fireListeners(m,!1,h)&&l));if(n){for(j=0;!h.propagationStopped_&&j<n.length;j++){k=h.currentTarget=n[j],l=k.fireListeners(m,!1,h)&&l}}return l};goog.Timer=function(d,c){goog.events.EventTarget.call(this);this.interval_=d||1;this.timerObject_=c||goog.Timer.defaultTimerObject;this.boundTick_=goog.bind(this.tick_,this);this.last_=goog.now()};goog.inherits(goog.Timer,goog.events.EventTarget);goog.Timer.MAX_TIMEOUT_=2147483647;goog.Timer.INVALID_TIMEOUT_ID_=-1;goog.Timer.prototype.enabled=!1;goog.Timer.defaultTimerObject=goog.global;goog.Timer.intervalScale=0.8;goog.Timer.prototype.timer_=null;goog.Timer.prototype.getInterval=function(){return this.interval_};goog.Timer.prototype.setInterval=function(b){this.interval_=b;this.timer_&&this.enabled?(this.stop(),this.start()):this.timer_&&this.stop()};goog.Timer.prototype.tick_=function(){if(this.enabled){var b=goog.now()-this.last_;0<b&&b<this.interval_*goog.Timer.intervalScale?this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_-b):(this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null),this.dispatchTick(),this.enabled&&(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=goog.now()))}};goog.Timer.prototype.dispatchTick=function(){this.dispatchEvent(goog.Timer.TICK)};goog.Timer.prototype.start=function(){this.enabled=!0;this.timer_||(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=goog.now())};goog.Timer.prototype.stop=function(){this.enabled=!1;this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null)};goog.Timer.prototype.disposeInternal=function(){goog.Timer.superClass_.disposeInternal.call(this);this.stop();delete this.timerObject_};goog.Timer.TICK="tick";goog.Timer.callOnce=function(e,d,f){if(goog.isFunction(e)){f&&(e=goog.bind(e,f))}else{if(e&&"function"==typeof e.handleEvent){e=goog.bind(e.handleEvent,e)}else{throw Error("Invalid listener argument")}}return Number(d)>goog.Timer.MAX_TIMEOUT_?goog.Timer.INVALID_TIMEOUT_ID_:goog.Timer.defaultTimerObject.setTimeout(e,d||0)};goog.Timer.clear=function(b){goog.Timer.defaultTimerObject.clearTimeout(b)};goog.Timer.promise=function(e,d){var f=null;return(new goog.Promise(function(b,a){f=goog.Timer.callOnce(function(){b(d)},e);f==goog.Timer.INVALID_TIMEOUT_ID_&&a(Error("Failed to schedule timer."))})).thenCatch(function(b){goog.Timer.clear(f);throw b})};goog.events.EventHandler=function(b){goog.Disposable.call(this);this.handler_=b;this.keys_={}};goog.inherits(goog.events.EventHandler,goog.Disposable);goog.events.EventHandler.typeArray_=[];goog.events.EventHandler.prototype.listen=function(f,e,h,g){return this.listen_(f,e,h,g)};goog.events.EventHandler.prototype.listenWithScope=function(g,f,j,i,h){return this.listen_(g,f,j,i,h)};goog.events.EventHandler.prototype.listen_=function(i,h,n,m,l){goog.isArray(h)||(h&&(goog.events.EventHandler.typeArray_[0]=h.toString()),h=goog.events.EventHandler.typeArray_);for(var k=0;k<h.length;k++){var j=goog.events.listen(i,h[k],n||this.handleEvent,m||!1,l||this.handler_||this);if(!j){break}this.keys_[j.key]=j}return this};goog.events.EventHandler.prototype.listenOnce=function(f,e,h,g){return this.listenOnce_(f,e,h,g)};goog.events.EventHandler.prototype.listenOnceWithScope=function(g,f,j,i,h){return this.listenOnce_(g,f,j,i,h)};goog.events.EventHandler.prototype.listenOnce_=function(h,g,l,k,j){if(goog.isArray(g)){for(var i=0;i<g.length;i++){this.listenOnce_(h,g[i],l,k,j)}}else{h=goog.events.listenOnce(h,g,l||this.handleEvent,k,j||this.handler_||this);if(!h){return this}this.keys_[h.key]=h}return this};goog.events.EventHandler.prototype.listenWithWrapper=function(f,e,h,g){return this.listenWithWrapper_(f,e,h,g)};goog.events.EventHandler.prototype.listenWithWrapperAndScope=function(g,f,j,i,h){return this.listenWithWrapper_(g,f,j,i,h)};goog.events.EventHandler.prototype.listenWithWrapper_=function(g,f,j,i,h){f.listen(g,j,i,h||this.handler_||this,this);return this};goog.events.EventHandler.prototype.getListenerCount=function(){var d=0,c;for(c in this.keys_){Object.prototype.hasOwnProperty.call(this.keys_,c)&&d++}return d};goog.events.EventHandler.prototype.unlisten=function(h,g,l,k,j){if(goog.isArray(g)){for(var i=0;i<g.length;i++){this.unlisten(h,g[i],l,k,j)}}else{if(h=goog.events.getListener(h,g,l||this.handleEvent,k,j||this.handler_||this)){goog.events.unlistenByKey(h),delete this.keys_[h.key]}}return this};goog.events.EventHandler.prototype.unlistenWithWrapper=function(g,f,j,i,h){f.unlisten(g,j,i,h||this.handler_||this,this);return this};goog.events.EventHandler.prototype.removeAll=function(){goog.object.forEach(this.keys_,function(d,c){this.keys_.hasOwnProperty(c)&&goog.events.unlistenByKey(d)},this);this.keys_={}};goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this);this.removeAll()};goog.events.EventHandler.prototype.handleEvent=function(b){throw Error("EventHandler.handleEvent not implemented")};goog.ui={};goog.ui.IdGenerator=function(){};goog.addSingletonGetter(goog.ui.IdGenerator);goog.ui.IdGenerator.prototype.nextId_=0;goog.ui.IdGenerator.prototype.getNextUniqueId=function(){return":"+(this.nextId_++).toString(36)};goog.ui.Component=function(b){goog.events.EventTarget.call(this);this.dom_=b||goog.dom.getDomHelper();this.rightToLeft_=goog.ui.Component.defaultRightToLeft_;this.id_=null;this.inDocument_=!1;this.element_=null;this.googUiComponentHandler_=void 0;this.childIndex_=this.children_=this.parent_=this.model_=null;this.wasDecorated_=!1};goog.inherits(goog.ui.Component,goog.events.EventTarget);goog.ui.Component.ALLOW_DETACHED_DECORATION=!1;goog.ui.Component.prototype.idGenerator_=goog.ui.IdGenerator.getInstance();goog.ui.Component.DEFAULT_BIDI_DIR=0;goog.ui.Component.defaultRightToLeft_=1==goog.ui.Component.DEFAULT_BIDI_DIR?!1:-1==goog.ui.Component.DEFAULT_BIDI_DIR?!0:null;goog.ui.Component.EventType={BEFORE_SHOW:"beforeshow",SHOW:"show",HIDE:"hide",DISABLE:"disable",ENABLE:"enable",HIGHLIGHT:"highlight",UNHIGHLIGHT:"unhighlight",ACTIVATE:"activate",DEACTIVATE:"deactivate",SELECT:"select",UNSELECT:"unselect",CHECK:"check",UNCHECK:"uncheck",FOCUS:"focus",BLUR:"blur",OPEN:"open",CLOSE:"close",ENTER:"enter",LEAVE:"leave",ACTION:"action",CHANGE:"change"};goog.ui.Component.Error={NOT_SUPPORTED:"Method not supported",DECORATE_INVALID:"Invalid element to decorate",ALREADY_RENDERED:"Component already rendered",PARENT_UNABLE_TO_BE_SET:"Unable to set parent component",CHILD_INDEX_OUT_OF_BOUNDS:"Child component index out of bounds",NOT_OUR_CHILD:"Child is not in parent component",NOT_IN_DOCUMENT:"Operation not supported while component is not in document",STATE_INVALID:"Invalid component state"};goog.ui.Component.State={ALL:255,DISABLED:1,HOVER:2,ACTIVE:4,SELECTED:8,CHECKED:16,FOCUSED:32,OPENED:64};goog.ui.Component.getStateTransitionEvent=function(d,c){switch(d){case goog.ui.Component.State.DISABLED:return c?goog.ui.Component.EventType.DISABLE:goog.ui.Component.EventType.ENABLE;case goog.ui.Component.State.HOVER:return c?goog.ui.Component.EventType.HIGHLIGHT:goog.ui.Component.EventType.UNHIGHLIGHT;case goog.ui.Component.State.ACTIVE:return c?goog.ui.Component.EventType.ACTIVATE:goog.ui.Component.EventType.DEACTIVATE;case goog.ui.Component.State.SELECTED:return c?goog.ui.Component.EventType.SELECT:goog.ui.Component.EventType.UNSELECT;case goog.ui.Component.State.CHECKED:return c?goog.ui.Component.EventType.CHECK:goog.ui.Component.EventType.UNCHECK;case goog.ui.Component.State.FOCUSED:return c?goog.ui.Component.EventType.FOCUS:goog.ui.Component.EventType.BLUR;case goog.ui.Component.State.OPENED:return c?goog.ui.Component.EventType.OPEN:goog.ui.Component.EventType.CLOSE}throw Error(goog.ui.Component.Error.STATE_INVALID)};goog.ui.Component.setDefaultRightToLeft=function(b){goog.ui.Component.defaultRightToLeft_=b};goog.ui.Component.prototype.getId=function(){return this.id_||(this.id_=this.idGenerator_.getNextUniqueId())};goog.ui.Component.prototype.setId=function(b){this.parent_&&this.parent_.childIndex_&&(goog.object.remove(this.parent_.childIndex_,this.id_),goog.object.add(this.parent_.childIndex_,b,this));this.id_=b};goog.ui.Component.prototype.getElement=function(){return this.element_};goog.ui.Component.prototype.getElementStrict=function(){var b=this.element_;goog.asserts.assert(b,"Can not call getElementStrict before rendering/decorating.");return b};goog.ui.Component.prototype.setElementInternal=function(b){this.element_=b};goog.ui.Component.prototype.getElementsByClass=function(b){return this.element_?this.dom_.getElementsByClass(b,this.element_):[]};goog.ui.Component.prototype.getElementByClass=function(b){return this.element_?this.dom_.getElementByClass(b,this.element_):null};goog.ui.Component.prototype.getRequiredElementByClass=function(d){var c=this.getElementByClass(d);goog.asserts.assert(c,"Expected element in component with class: %s",d);return c};goog.ui.Component.prototype.getHandler=function(){this.googUiComponentHandler_||(this.googUiComponentHandler_=new goog.events.EventHandler(this));return this.googUiComponentHandler_};goog.ui.Component.prototype.setParent=function(b){if(this==b){throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET)}if(b&&this.parent_&&this.id_&&this.parent_.getChild(this.id_)&&this.parent_!=b){throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET)}this.parent_=b;goog.ui.Component.superClass_.setParentEventTarget.call(this,b)};goog.ui.Component.prototype.getParent=function(){return this.parent_};goog.ui.Component.prototype.setParentEventTarget=function(b){if(this.parent_&&this.parent_!=b){throw Error(goog.ui.Component.Error.NOT_SUPPORTED)}goog.ui.Component.superClass_.setParentEventTarget.call(this,b)};goog.ui.Component.prototype.getDomHelper=function(){return this.dom_};goog.ui.Component.prototype.isInDocument=function(){return this.inDocument_};goog.ui.Component.prototype.createDom=function(){this.element_=this.dom_.createElement("DIV")};goog.ui.Component.prototype.render=function(b){this.render_(b)};goog.ui.Component.prototype.renderBefore=function(b){this.render_(b.parentNode,b)};goog.ui.Component.prototype.render_=function(d,c){if(this.inDocument_){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}this.element_||this.createDom();d?d.insertBefore(this.element_,c||null):this.dom_.getDocument().body.appendChild(this.element_);this.parent_&&!this.parent_.isInDocument()||this.enterDocument()};goog.ui.Component.prototype.decorate=function(d){if(this.inDocument_){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}if(d&&this.canDecorate(d)){this.wasDecorated_=!0;var c=goog.dom.getOwnerDocument(d);this.dom_&&this.dom_.getDocument()==c||(this.dom_=goog.dom.getDomHelper(d));this.decorateInternal(d);goog.ui.Component.ALLOW_DETACHED_DECORATION&&!goog.dom.contains(c,d)||this.enterDocument()}else{throw Error(goog.ui.Component.Error.DECORATE_INVALID)}};goog.ui.Component.prototype.canDecorate=function(b){return !0};goog.ui.Component.prototype.wasDecorated=function(){return this.wasDecorated_};goog.ui.Component.prototype.decorateInternal=function(b){this.element_=b};goog.ui.Component.prototype.enterDocument=function(){this.inDocument_=!0;this.forEachChild(function(b){!b.isInDocument()&&b.getElement()&&b.enterDocument()})};goog.ui.Component.prototype.exitDocument=function(){this.forEachChild(function(b){b.isInDocument()&&b.exitDocument()});this.googUiComponentHandler_&&this.googUiComponentHandler_.removeAll();this.inDocument_=!1};goog.ui.Component.prototype.disposeInternal=function(){this.inDocument_&&this.exitDocument();this.googUiComponentHandler_&&(this.googUiComponentHandler_.dispose(),delete this.googUiComponentHandler_);this.forEachChild(function(b){b.dispose()});!this.wasDecorated_&&this.element_&&goog.dom.removeNode(this.element_);this.parent_=this.model_=this.element_=this.childIndex_=this.children_=null;goog.ui.Component.superClass_.disposeInternal.call(this)};goog.ui.Component.prototype.makeId=function(b){return this.getId()+"."+b};goog.ui.Component.prototype.makeIds=function(e){var d={},f;for(f in e){d[f]=this.makeId(e[f])}return d};goog.ui.Component.prototype.getModel=function(){return this.model_};goog.ui.Component.prototype.setModel=function(b){this.model_=b};goog.ui.Component.prototype.getFragmentFromId=function(b){return b.substring(this.getId().length+1)};goog.ui.Component.prototype.getElementByFragment=function(b){if(!this.inDocument_){throw Error(goog.ui.Component.Error.NOT_IN_DOCUMENT)}return this.dom_.getElement(this.makeId(b))};goog.ui.Component.prototype.addChild=function(d,c){this.addChildAt(d,this.getChildCount(),c)};goog.ui.Component.prototype.addChildAt=function(e,d,f){goog.asserts.assert(!!e,"Provided element must not be null.");if(e.inDocument_&&(f||!this.inDocument_)){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}if(0>d||d>this.getChildCount()){throw Error(goog.ui.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS)}this.childIndex_&&this.children_||(this.childIndex_={},this.children_=[]);e.getParent()==this?(goog.object.set(this.childIndex_,e.getId(),e),goog.array.remove(this.children_,e)):goog.object.add(this.childIndex_,e.getId(),e);e.setParent(this);goog.array.insertAt(this.children_,e,d);e.inDocument_&&this.inDocument_&&e.getParent()==this?(f=this.getContentElement(),d=f.childNodes[d]||null,d!=e.getElement()&&f.insertBefore(e.getElement(),d)):f?(this.element_||this.createDom(),d=this.getChildAt(d+1),e.render_(this.getContentElement(),d?d.element_:null)):this.inDocument_&&!e.inDocument_&&e.element_&&e.element_.parentNode&&e.element_.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&e.enterDocument()};goog.ui.Component.prototype.getContentElement=function(){return this.element_};goog.ui.Component.prototype.isRightToLeft=function(){null==this.rightToLeft_&&(this.rightToLeft_=goog.style.isRightToLeft(this.inDocument_?this.element_:this.dom_.getDocument().body));return this.rightToLeft_};goog.ui.Component.prototype.setRightToLeft=function(b){if(this.inDocument_){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}this.rightToLeft_=b};goog.ui.Component.prototype.hasChildren=function(){return !!this.children_&&0!=this.children_.length};goog.ui.Component.prototype.getChildCount=function(){return this.children_?this.children_.length:0};goog.ui.Component.prototype.getChildIds=function(){var b=[];this.forEachChild(function(a){b.push(a.getId())});return b};goog.ui.Component.prototype.getChild=function(b){return this.childIndex_&&b?goog.object.get(this.childIndex_,b)||null:null};goog.ui.Component.prototype.getChildAt=function(b){return this.children_?this.children_[b]||null:null};goog.ui.Component.prototype.forEachChild=function(d,c){this.children_&&goog.array.forEach(this.children_,d,c)};goog.ui.Component.prototype.indexOfChild=function(b){return this.children_&&b?goog.array.indexOf(this.children_,b):-1};goog.ui.Component.prototype.removeChild=function(e,d){if(e){var f=goog.isString(e)?e:e.getId();e=this.getChild(f);f&&e&&(goog.object.remove(this.childIndex_,f),goog.array.remove(this.children_,e),d&&(e.exitDocument(),e.element_&&goog.dom.removeNode(e.element_)),e.setParent(null))}if(!e){throw Error(goog.ui.Component.Error.NOT_OUR_CHILD)}return e};goog.ui.Component.prototype.removeChildAt=function(d,c){return this.removeChild(this.getChildAt(d),c)};goog.ui.Component.prototype.removeChildren=function(d){for(var c=[];this.hasChildren();){c.push(this.removeChildAt(0,d))}return c};goog.a11y={};goog.a11y.aria={};goog.a11y.aria.Role={ALERT:"alert",ALERTDIALOG:"alertdialog",APPLICATION:"application",ARTICLE:"article",BANNER:"banner",BUTTON:"button",CHECKBOX:"checkbox",COLUMNHEADER:"columnheader",COMBOBOX:"combobox",COMPLEMENTARY:"complementary",CONTENTINFO:"contentinfo",DEFINITION:"definition",DIALOG:"dialog",DIRECTORY:"directory",DOCUMENT:"document",FORM:"form",GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",HEADING:"heading",IMG:"img",LINK:"link",LIST:"list",LISTBOX:"listbox",LISTITEM:"listitem",LOG:"log",MAIN:"main",MARQUEE:"marquee",MATH:"math",MENU:"menu",MENUBAR:"menubar",MENU_ITEM:"menuitem",MENU_ITEM_CHECKBOX:"menuitemcheckbox",MENU_ITEM_RADIO:"menuitemradio",NAVIGATION:"navigation",NOTE:"note",OPTION:"option",PRESENTATION:"presentation",PROGRESSBAR:"progressbar",RADIO:"radio",RADIOGROUP:"radiogroup",REGION:"region",ROW:"row",ROWGROUP:"rowgroup",ROWHEADER:"rowheader",SCROLLBAR:"scrollbar",SEARCH:"search",SEPARATOR:"separator",SLIDER:"slider",SPINBUTTON:"spinbutton",STATUS:"status",TAB:"tab",TAB_LIST:"tablist",TAB_PANEL:"tabpanel",TEXTBOX:"textbox",TEXTINFO:"textinfo",TIMER:"timer",TOOLBAR:"toolbar",TOOLTIP:"tooltip",TREE:"tree",TREEGRID:"treegrid",TREEITEM:"treeitem"};goog.a11y.aria.State={ACTIVEDESCENDANT:"activedescendant",ATOMIC:"atomic",AUTOCOMPLETE:"autocomplete",BUSY:"busy",CHECKED:"checked",CONTROLS:"controls",DESCRIBEDBY:"describedby",DISABLED:"disabled",DROPEFFECT:"dropeffect",EXPANDED:"expanded",FLOWTO:"flowto",GRABBED:"grabbed",HASPOPUP:"haspopup",HIDDEN:"hidden",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",LIVE:"live",MULTILINE:"multiline",MULTISELECTABLE:"multiselectable",ORIENTATION:"orientation",OWNS:"owns",POSINSET:"posinset",PRESSED:"pressed",READONLY:"readonly",RELEVANT:"relevant",REQUIRED:"required",SELECTED:"selected",SETSIZE:"setsize",SORT:"sort",VALUEMAX:"valuemax",VALUEMIN:"valuemin",VALUENOW:"valuenow",VALUETEXT:"valuetext"};goog.a11y.aria.AutoCompleteValues={INLINE:"inline",LIST:"list",BOTH:"both",NONE:"none"};goog.a11y.aria.DropEffectValues={COPY:"copy",MOVE:"move",LINK:"link",EXECUTE:"execute",POPUP:"popup",NONE:"none"};goog.a11y.aria.LivePriority={OFF:"off",POLITE:"polite",ASSERTIVE:"assertive"};goog.a11y.aria.OrientationValues={VERTICAL:"vertical",HORIZONTAL:"horizontal"};goog.a11y.aria.RelevantValues={ADDITIONS:"additions",REMOVALS:"removals",TEXT:"text",ALL:"all"};goog.a11y.aria.SortValues={ASCENDING:"ascending",DESCENDING:"descending",NONE:"none",OTHER:"other"};goog.a11y.aria.CheckedValues={TRUE:"true",FALSE:"false",MIXED:"mixed",UNDEFINED:"undefined"};goog.a11y.aria.ExpandedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"};goog.a11y.aria.GrabbedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"};goog.a11y.aria.InvalidValues={FALSE:"false",TRUE:"true",GRAMMAR:"grammar",SPELLING:"spelling"};goog.a11y.aria.PressedValues={TRUE:"true",FALSE:"false",MIXED:"mixed",UNDEFINED:"undefined"};goog.a11y.aria.SelectedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"};goog.a11y.aria.datatables={};goog.a11y.aria.datatables.getDefaultValuesMap=function(){goog.a11y.aria.DefaultStateValueMap_||(goog.a11y.aria.DefaultStateValueMap_=goog.object.create(goog.a11y.aria.State.ATOMIC,!1,goog.a11y.aria.State.AUTOCOMPLETE,"none",goog.a11y.aria.State.DROPEFFECT,"none",goog.a11y.aria.State.HASPOPUP,!1,goog.a11y.aria.State.LIVE,"off",goog.a11y.aria.State.MULTILINE,!1,goog.a11y.aria.State.MULTISELECTABLE,!1,goog.a11y.aria.State.ORIENTATION,"vertical",goog.a11y.aria.State.READONLY,!1,goog.a11y.aria.State.RELEVANT,"additions text",goog.a11y.aria.State.REQUIRED,!1,goog.a11y.aria.State.SORT,"none",goog.a11y.aria.State.BUSY,!1,goog.a11y.aria.State.DISABLED,!1,goog.a11y.aria.State.HIDDEN,!1,goog.a11y.aria.State.INVALID,"false"));return goog.a11y.aria.DefaultStateValueMap_};goog.a11y.aria.ARIA_PREFIX_="aria-";goog.a11y.aria.ROLE_ATTRIBUTE_="role";goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_="A AREA BUTTON HEAD INPUT LINK MENU META OPTGROUP OPTION PROGRESS STYLE SELECT SOURCE TEXTAREA TITLE TRACK".split(" ");goog.a11y.aria.CONTAINER_ROLES_=[goog.a11y.aria.Role.COMBOBOX,goog.a11y.aria.Role.GRID,goog.a11y.aria.Role.GROUP,goog.a11y.aria.Role.LISTBOX,goog.a11y.aria.Role.MENU,goog.a11y.aria.Role.MENUBAR,goog.a11y.aria.Role.RADIOGROUP,goog.a11y.aria.Role.ROW,goog.a11y.aria.Role.ROWGROUP,goog.a11y.aria.Role.TAB_LIST,goog.a11y.aria.Role.TEXTBOX,goog.a11y.aria.Role.TOOLBAR,goog.a11y.aria.Role.TREE,goog.a11y.aria.Role.TREEGRID];goog.a11y.aria.setRole=function(d,c){c?(goog.asserts.ENABLE_ASSERTS&&goog.asserts.assert(goog.object.containsValue(goog.a11y.aria.Role,c),"No such ARIA role "+c),d.setAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_,c)):goog.a11y.aria.removeRole(d)};goog.a11y.aria.getRole=function(b){return b.getAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_)||null};goog.a11y.aria.removeRole=function(b){b.removeAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_)};goog.a11y.aria.setState=function(f,e,h){goog.isArray(h)&&(h=h.join(" "));var g=goog.a11y.aria.getAriaAttributeName_(e);""===h||void 0==h?(h=goog.a11y.aria.datatables.getDefaultValuesMap(),e in h?f.setAttribute(g,h[e]):f.removeAttribute(g)):f.setAttribute(g,h)};goog.a11y.aria.toggleState=function(e,d){var f=goog.a11y.aria.getState(e,d);goog.string.isEmptyOrWhitespace(goog.string.makeSafe(f))||"true"==f||"false"==f?goog.a11y.aria.setState(e,d,"true"==f?"false":"true"):goog.a11y.aria.removeState(e,d)};goog.a11y.aria.removeState=function(d,c){d.removeAttribute(goog.a11y.aria.getAriaAttributeName_(c))};goog.a11y.aria.getState=function(e,d){var f=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(d));return null==f||void 0==f?"":String(f)};goog.a11y.aria.getActiveDescendant=function(d){var c=goog.a11y.aria.getState(d,goog.a11y.aria.State.ACTIVEDESCENDANT);return goog.dom.getOwnerDocument(d).getElementById(c)};goog.a11y.aria.setActiveDescendant=function(e,d){var f="";d&&(f=d.id,goog.asserts.assert(f,"The active element should have an id."));goog.a11y.aria.setState(e,goog.a11y.aria.State.ACTIVEDESCENDANT,f)};goog.a11y.aria.getLabel=function(b){return goog.a11y.aria.getState(b,goog.a11y.aria.State.LABEL)};goog.a11y.aria.setLabel=function(d,c){goog.a11y.aria.setState(d,goog.a11y.aria.State.LABEL,c)};goog.a11y.aria.assertRoleIsSetInternalUtil=function(e,d){if(!goog.array.contains(goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_,e.tagName)){var f=goog.a11y.aria.getRole(e);goog.asserts.assert(null!=f,"The element ARIA role cannot be null.");goog.asserts.assert(goog.array.contains(d,f),'Non existing or incorrect role set for element.The role set is "'+f+'". The role should be any of "'+d+'". Check the ARIA specification for more details http://www.w3.org/TR/wai-aria/roles.')}};goog.a11y.aria.getStateBoolean=function(e,d){var f=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(d));goog.asserts.assert(goog.isBoolean(f)||null==f||"true"==f||"false"==f);return null==f?f:goog.isBoolean(f)?f:"true"==f};goog.a11y.aria.getStateNumber=function(e,d){var f=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(d));goog.asserts.assert((null==f||!isNaN(Number(f)))&&!goog.isBoolean(f));return null==f?null:Number(f)};goog.a11y.aria.getStateString=function(e,d){var f=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(d));goog.asserts.assert((null==f||goog.isString(f))&&(""==f||isNaN(Number(f)))&&"true"!=f&&"false"!=f);return null==f||""==f?null:f};goog.a11y.aria.getStringArrayStateInternalUtil=function(e,d){var f=e.getAttribute(goog.a11y.aria.getAriaAttributeName_(d));return goog.a11y.aria.splitStringOnWhitespace_(f)};goog.a11y.aria.hasState=function(d,c){return d.hasAttribute(goog.a11y.aria.getAriaAttributeName_(c))};goog.a11y.aria.isContainerRole=function(b){b=goog.a11y.aria.getRole(b);return goog.array.contains(goog.a11y.aria.CONTAINER_ROLES_,b)};goog.a11y.aria.splitStringOnWhitespace_=function(b){return b?b.split(/\s+/):[]};goog.a11y.aria.getAriaAttributeName_=function(b){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.assert(b,"ARIA attribute cannot be empty."),goog.asserts.assert(goog.object.containsValue(goog.a11y.aria.State,b),"No such ARIA attribute "+b));return goog.a11y.aria.ARIA_PREFIX_+b};goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255};goog.events.KeyCodes.isTextModifyingKeyEvent=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||b.keyCode>=goog.events.KeyCodes.F1&&b.keyCode<=goog.events.KeyCodes.F12){return !1}switch(b.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.VK_NONAME:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return !1;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return !goog.userAgent.GECKO;default:return b.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||b.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}};goog.events.KeyCodes.firesKeyPressEvent=function(g,f,j,i,h){if(!(goog.userAgent.IE||goog.userAgent.EDGE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525"))){return !0}if(goog.userAgent.MAC&&h){return goog.events.KeyCodes.isCharacterKey(g)}if(h&&!i){return !1}goog.isNumber(f)&&(f=goog.events.KeyCodes.normalizeKeyCode(f));if(!j&&(f==goog.events.KeyCodes.CTRL||f==goog.events.KeyCodes.ALT||goog.userAgent.MAC&&f==goog.events.KeyCodes.META)){return !1}if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&i&&j){switch(g){case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.TILDE:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:return !1}}if(goog.userAgent.IE&&i&&f==g){return !1}switch(g){case goog.events.KeyCodes.ENTER:return !0;case goog.events.KeyCodes.ESC:return !(goog.userAgent.WEBKIT||goog.userAgent.EDGE)}return goog.events.KeyCodes.isCharacterKey(g)};goog.events.KeyCodes.isCharacterKey=function(b){if(b>=goog.events.KeyCodes.ZERO&&b<=goog.events.KeyCodes.NINE||b>=goog.events.KeyCodes.NUM_ZERO&&b<=goog.events.KeyCodes.NUM_MULTIPLY||b>=goog.events.KeyCodes.A&&b<=goog.events.KeyCodes.Z||(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&0==b){return !0}switch(b){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.PLUS_SIGN:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.AT_SIGN:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:return !0;default:return !1}};goog.events.KeyCodes.normalizeKeyCode=function(b){return goog.userAgent.GECKO?goog.events.KeyCodes.normalizeGeckoKeyCode(b):goog.userAgent.MAC&&goog.userAgent.WEBKIT?goog.events.KeyCodes.normalizeMacWebKitKeyCode(b):b};goog.events.KeyCodes.normalizeGeckoKeyCode=function(b){switch(b){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.FF_DASH:return goog.events.KeyCodes.DASH;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return b}};goog.events.KeyCodes.normalizeMacWebKitKeyCode=function(b){switch(b){case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:return goog.events.KeyCodes.META;default:return b}};goog.events.KeyHandler=function(d,c){goog.events.EventTarget.call(this);d&&this.attach(d,c)};goog.inherits(goog.events.KeyHandler,goog.events.EventTarget);goog.events.KeyHandler.prototype.element_=null;goog.events.KeyHandler.prototype.keyPressKey_=null;goog.events.KeyHandler.prototype.keyDownKey_=null;goog.events.KeyHandler.prototype.keyUpKey_=null;goog.events.KeyHandler.prototype.lastKey_=-1;goog.events.KeyHandler.prototype.keyCode_=-1;goog.events.KeyHandler.prototype.altKey_=!1;goog.events.KeyHandler.EventType={KEY:"key"};goog.events.KeyHandler.safariKey_={3:goog.events.KeyCodes.ENTER,12:goog.events.KeyCodes.NUMLOCK,63232:goog.events.KeyCodes.UP,63233:goog.events.KeyCodes.DOWN,63234:goog.events.KeyCodes.LEFT,63235:goog.events.KeyCodes.RIGHT,63236:goog.events.KeyCodes.F1,63237:goog.events.KeyCodes.F2,63238:goog.events.KeyCodes.F3,63239:goog.events.KeyCodes.F4,63240:goog.events.KeyCodes.F5,63241:goog.events.KeyCodes.F6,63242:goog.events.KeyCodes.F7,63243:goog.events.KeyCodes.F8,63244:goog.events.KeyCodes.F9,63245:goog.events.KeyCodes.F10,63246:goog.events.KeyCodes.F11,63247:goog.events.KeyCodes.F12,63248:goog.events.KeyCodes.PRINT_SCREEN,63272:goog.events.KeyCodes.DELETE,63273:goog.events.KeyCodes.HOME,63275:goog.events.KeyCodes.END,63276:goog.events.KeyCodes.PAGE_UP,63277:goog.events.KeyCodes.PAGE_DOWN,63289:goog.events.KeyCodes.NUMLOCK,63302:goog.events.KeyCodes.INSERT};goog.events.KeyHandler.keyIdentifier_={Up:goog.events.KeyCodes.UP,Down:goog.events.KeyCodes.DOWN,Left:goog.events.KeyCodes.LEFT,Right:goog.events.KeyCodes.RIGHT,Enter:goog.events.KeyCodes.ENTER,F1:goog.events.KeyCodes.F1,F2:goog.events.KeyCodes.F2,F3:goog.events.KeyCodes.F3,F4:goog.events.KeyCodes.F4,F5:goog.events.KeyCodes.F5,F6:goog.events.KeyCodes.F6,F7:goog.events.KeyCodes.F7,F8:goog.events.KeyCodes.F8,F9:goog.events.KeyCodes.F9,F10:goog.events.KeyCodes.F10,F11:goog.events.KeyCodes.F11,F12:goog.events.KeyCodes.F12,"U+007F":goog.events.KeyCodes.DELETE,Home:goog.events.KeyCodes.HOME,End:goog.events.KeyCodes.END,PageUp:goog.events.KeyCodes.PAGE_UP,PageDown:goog.events.KeyCodes.PAGE_DOWN,Insert:goog.events.KeyCodes.INSERT};goog.events.KeyHandler.USES_KEYDOWN_=goog.userAgent.IE||goog.userAgent.EDGE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525");goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_=goog.userAgent.MAC&&goog.userAgent.GECKO;goog.events.KeyHandler.prototype.handleKeyDown_=function(b){(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&(this.lastKey_==goog.events.KeyCodes.CTRL&&!b.ctrlKey||this.lastKey_==goog.events.KeyCodes.ALT&&!b.altKey||goog.userAgent.MAC&&this.lastKey_==goog.events.KeyCodes.META&&!b.metaKey)&&this.resetState();-1==this.lastKey_&&(b.ctrlKey&&b.keyCode!=goog.events.KeyCodes.CTRL?this.lastKey_=goog.events.KeyCodes.CTRL:b.altKey&&b.keyCode!=goog.events.KeyCodes.ALT?this.lastKey_=goog.events.KeyCodes.ALT:b.metaKey&&b.keyCode!=goog.events.KeyCodes.META&&(this.lastKey_=goog.events.KeyCodes.META));goog.events.KeyHandler.USES_KEYDOWN_&&!goog.events.KeyCodes.firesKeyPressEvent(b.keyCode,this.lastKey_,b.shiftKey,b.ctrlKey,b.altKey)?this.handleEvent(b):(this.keyCode_=goog.events.KeyCodes.normalizeKeyCode(b.keyCode),goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(this.altKey_=b.altKey))};goog.events.KeyHandler.prototype.resetState=function(){this.keyCode_=this.lastKey_=-1};goog.events.KeyHandler.prototype.handleKeyup_=function(b){this.resetState();this.altKey_=b.altKey};goog.events.KeyHandler.prototype.handleEvent=function(i){var h=i.getBrowserEvent(),n,m,l=h.altKey;goog.userAgent.IE&&i.type==goog.events.EventType.KEYPRESS?(n=this.keyCode_,m=n!=goog.events.KeyCodes.ENTER&&n!=goog.events.KeyCodes.ESC?h.keyCode:0):(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&i.type==goog.events.EventType.KEYPRESS?(n=this.keyCode_,m=0<=h.charCode&&63232>h.charCode&&goog.events.KeyCodes.isCharacterKey(n)?h.charCode:0):goog.userAgent.OPERA&&!goog.userAgent.WEBKIT?(n=this.keyCode_,m=goog.events.KeyCodes.isCharacterKey(n)?h.keyCode:0):(n=h.keyCode||this.keyCode_,m=h.charCode||0,goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(l=this.altKey_),goog.userAgent.MAC&&m==goog.events.KeyCodes.QUESTION_MARK&&n==goog.events.KeyCodes.WIN_KEY&&(n=goog.events.KeyCodes.SLASH));var k=n=goog.events.KeyCodes.normalizeKeyCode(n),j=h.keyIdentifier;n?63232<=n&&n in goog.events.KeyHandler.safariKey_?k=goog.events.KeyHandler.safariKey_[n]:25==n&&i.shiftKey&&(k=9):j&&j in goog.events.KeyHandler.keyIdentifier_&&(k=goog.events.KeyHandler.keyIdentifier_[j]);i=k==this.lastKey_;this.lastKey_=k;h=new goog.events.KeyEvent(k,m,i,h);h.altKey=l;this.dispatchEvent(h)};goog.events.KeyHandler.prototype.getElement=function(){return this.element_};goog.events.KeyHandler.prototype.attach=function(d,c){this.keyUpKey_&&this.detach();this.element_=d;this.keyPressKey_=goog.events.listen(this.element_,goog.events.EventType.KEYPRESS,this,c);this.keyDownKey_=goog.events.listen(this.element_,goog.events.EventType.KEYDOWN,this.handleKeyDown_,c,this);this.keyUpKey_=goog.events.listen(this.element_,goog.events.EventType.KEYUP,this.handleKeyup_,c,this)};goog.events.KeyHandler.prototype.detach=function(){this.keyPressKey_&&(goog.events.unlistenByKey(this.keyPressKey_),goog.events.unlistenByKey(this.keyDownKey_),goog.events.unlistenByKey(this.keyUpKey_),this.keyUpKey_=this.keyDownKey_=this.keyPressKey_=null);this.element_=null;this.keyCode_=this.lastKey_=-1};goog.events.KeyHandler.prototype.disposeInternal=function(){goog.events.KeyHandler.superClass_.disposeInternal.call(this);this.detach()};goog.events.KeyEvent=function(f,e,h,g){goog.events.BrowserEvent.call(this,g);this.type=goog.events.KeyHandler.EventType.KEY;this.keyCode=f;this.charCode=e;this.repeat=h};goog.inherits(goog.events.KeyEvent,goog.events.BrowserEvent);goog.dom.classlist={};goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST=!1;goog.dom.classlist.get=function(b){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||b.classList){return b.classList}b=b.className;return goog.isString(b)&&b.match(/\S+/g)||[]};goog.dom.classlist.set=function(d,c){d.className=c};goog.dom.classlist.contains=function(d,c){return goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||d.classList?d.classList.contains(c):goog.array.contains(goog.dom.classlist.get(d),c)};goog.dom.classlist.add=function(d,c){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||d.classList?d.classList.add(c):goog.dom.classlist.contains(d,c)||(d.className+=0<d.className.length?" "+c:c)};goog.dom.classlist.addAll=function(f,e){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||f.classList){goog.array.forEach(e,function(a){goog.dom.classlist.add(f,a)})}else{var h={};goog.array.forEach(goog.dom.classlist.get(f),function(b){h[b]=!0});goog.array.forEach(e,function(b){h[b]=!0});f.className="";for(var g in h){f.className+=0<f.className.length?" "+g:g}}};goog.dom.classlist.remove=function(d,c){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||d.classList?d.classList.remove(c):goog.dom.classlist.contains(d,c)&&(d.className=goog.array.filter(goog.dom.classlist.get(d),function(b){return b!=c}).join(" "))};goog.dom.classlist.removeAll=function(d,c){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||d.classList?goog.array.forEach(c,function(a){goog.dom.classlist.remove(d,a)}):d.className=goog.array.filter(goog.dom.classlist.get(d),function(b){return !goog.array.contains(c,b)}).join(" ")};goog.dom.classlist.enable=function(e,d,f){f?goog.dom.classlist.add(e,d):goog.dom.classlist.remove(e,d)};goog.dom.classlist.enableAll=function(e,d,f){(f?goog.dom.classlist.addAll:goog.dom.classlist.removeAll)(e,d)};goog.dom.classlist.swap=function(e,d,f){return goog.dom.classlist.contains(e,d)?(goog.dom.classlist.remove(e,d),goog.dom.classlist.add(e,f),!0):!1};goog.dom.classlist.toggle=function(e,d){var f=!goog.dom.classlist.contains(e,d);goog.dom.classlist.enable(e,d,f);return f};goog.dom.classlist.addRemove=function(e,d,f){goog.dom.classlist.remove(e,d);goog.dom.classlist.add(e,f)};goog.ui.registry={};goog.ui.registry.getDefaultRenderer=function(d){for(var c;d;){c=goog.getUid(d);if(c=goog.ui.registry.defaultRenderers_[c]){break}d=d.superClass_?d.superClass_.constructor:null}return c?goog.isFunction(c.getInstance)?c.getInstance():new c:null};goog.ui.registry.setDefaultRenderer=function(e,d){if(!goog.isFunction(e)){throw Error("Invalid component class "+e)}if(!goog.isFunction(d)){throw Error("Invalid renderer class "+d)}var f=goog.getUid(e);goog.ui.registry.defaultRenderers_[f]=d};goog.ui.registry.getDecoratorByClassName=function(b){return b in goog.ui.registry.decoratorFunctions_?goog.ui.registry.decoratorFunctions_[b]():null};goog.ui.registry.setDecoratorByClassName=function(d,c){if(!d){throw Error("Invalid class name "+d)}if(!goog.isFunction(c)){throw Error("Invalid decorator function "+c)}goog.ui.registry.decoratorFunctions_[d]=c};goog.ui.registry.getDecorator=function(f){goog.asserts.assert(f);for(var e=goog.dom.classlist.get(f),h=0,g=e.length;h<g;h++){if(f=goog.ui.registry.getDecoratorByClassName(e[h])){return f}}return null};goog.ui.registry.reset=function(){goog.ui.registry.defaultRenderers_={};goog.ui.registry.decoratorFunctions_={}};goog.ui.registry.defaultRenderers_={};goog.ui.registry.decoratorFunctions_={};goog.ui.ContainerRenderer=function(b){this.ariaRole_=b};goog.addSingletonGetter(goog.ui.ContainerRenderer);goog.ui.ContainerRenderer.getCustomRenderer=function(e,d){var f=new e;f.getCssClass=function(){return d};return f};goog.ui.ContainerRenderer.CSS_CLASS="goog-container";goog.ui.ContainerRenderer.prototype.getAriaRole=function(){return this.ariaRole_};goog.ui.ContainerRenderer.prototype.enableTabIndex=function(d,c){d&&(d.tabIndex=c?0:-1)};goog.ui.ContainerRenderer.prototype.createDom=function(b){return b.getDomHelper().createDom("DIV",this.getClassNames(b).join(" "))};goog.ui.ContainerRenderer.prototype.getContentElement=function(b){return b};goog.ui.ContainerRenderer.prototype.canDecorate=function(b){return"DIV"==b.tagName};goog.ui.ContainerRenderer.prototype.decorate=function(g,f){f.id&&g.setId(f.id);var j=this.getCssClass(),i=!1,h=goog.dom.classlist.get(f);h&&goog.array.forEach(h,function(a){a==j?i=!0:a&&this.setStateFromClassName(g,a,j)},this);i||goog.dom.classlist.add(f,j);this.decorateChildren(g,this.getContentElement(f));return f};goog.ui.ContainerRenderer.prototype.setStateFromClassName=function(e,d,f){d==f+"-disabled"?e.setEnabled(!1):d==f+"-horizontal"?e.setOrientation(goog.ui.Container.Orientation.HORIZONTAL):d==f+"-vertical"&&e.setOrientation(goog.ui.Container.Orientation.VERTICAL)};goog.ui.ContainerRenderer.prototype.decorateChildren=function(g,f,j){if(f){j=j||f.firstChild;for(var i;j&&j.parentNode==f;){i=j.nextSibling;if(j.nodeType==goog.dom.NodeType.ELEMENT){var h=this.getDecoratorForChild(j);h&&(h.setElementInternal(j),g.isEnabled()||h.setEnabled(!1),g.addChild(h),h.decorate(j))}else{j.nodeValue&&""!=goog.string.trim(j.nodeValue)||f.removeChild(j)}j=i}}};goog.ui.ContainerRenderer.prototype.getDecoratorForChild=function(b){return goog.ui.registry.getDecorator(b)};goog.ui.ContainerRenderer.prototype.initializeDom=function(d){d=d.getElement();goog.asserts.assert(d,"The container DOM element cannot be null.");goog.style.setUnselectable(d,!0,goog.userAgent.GECKO);goog.userAgent.IE&&(d.hideFocus=!0);var c=this.getAriaRole();c&&goog.a11y.aria.setRole(d,c)};goog.ui.ContainerRenderer.prototype.getKeyEventTarget=function(b){return b.getElement()};goog.ui.ContainerRenderer.prototype.getCssClass=function(){return goog.ui.ContainerRenderer.CSS_CLASS};goog.ui.ContainerRenderer.prototype.getClassNames=function(e){var d=this.getCssClass(),f=e.getOrientation()==goog.ui.Container.Orientation.HORIZONTAL,f=[d,f?d+"-horizontal":d+"-vertical"];e.isEnabled()||f.push(d+"-disabled");return f};goog.ui.ContainerRenderer.prototype.getDefaultOrientation=function(){return goog.ui.Container.Orientation.VERTICAL};goog.ui.ControlRenderer=function(){};goog.addSingletonGetter(goog.ui.ControlRenderer);goog.tagUnsealableClass(goog.ui.ControlRenderer);goog.ui.ControlRenderer.getCustomRenderer=function(e,d){var f=new e;f.getCssClass=function(){return d};return f};goog.ui.ControlRenderer.CSS_CLASS="goog-control";goog.ui.ControlRenderer.IE6_CLASS_COMBINATIONS=[];goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_=goog.object.create(goog.a11y.aria.Role.BUTTON,goog.a11y.aria.State.PRESSED,goog.a11y.aria.Role.CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.MENU_ITEM_CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM_RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.TAB,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.TREEITEM,goog.a11y.aria.State.SELECTED);goog.ui.ControlRenderer.prototype.getAriaRole=function(){};goog.ui.ControlRenderer.prototype.createDom=function(b){return b.getDomHelper().createDom("DIV",this.getClassNames(b).join(" "),b.getContent())};goog.ui.ControlRenderer.prototype.getContentElement=function(b){return b};goog.ui.ControlRenderer.prototype.enableClassName=function(f,e,h){if(f=f.getElement?f.getElement():f){var g=[e];goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")&&(g=this.getAppliedCombinedClassNames_(goog.dom.classlist.get(f),e),g.push(e));goog.dom.classlist.enableAll(f,g,h)}};goog.ui.ControlRenderer.prototype.enableExtraClassName=function(e,d,f){this.enableClassName(e,d,f)};goog.ui.ControlRenderer.prototype.canDecorate=function(b){return !0};goog.ui.ControlRenderer.prototype.decorate=function(x,w){w.id&&x.setId(w.id);var v=this.getContentElement(w);v&&v.firstChild?x.setContentInternal(v.firstChild.nextSibling?goog.array.clone(v.childNodes):v.firstChild):x.setContentInternal(null);var u=0,t=this.getCssClass(),s=this.getStructuralCssClass(),r=!1,q=!1,o=!1,j=goog.array.toArray(goog.dom.classlist.get(w));goog.array.forEach(j,function(b){r||b!=t?q||b!=s?u|=this.getStateFromClass(b):q=!0:(r=!0,s==t&&(q=!0));this.getStateFromClass(b)==goog.ui.Component.State.DISABLED&&(goog.asserts.assertElement(v),goog.dom.isFocusableTabIndex(v)&&goog.dom.setFocusableTabIndex(v,!1))},this);x.setStateInternal(u);r||(j.push(t),s==t&&(q=!0));q||j.push(s);var i=x.getExtraClassNames();i&&j.push.apply(j,i);if(goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")){var m=this.getAppliedCombinedClassNames_(j);0<m.length&&(j.push.apply(j,m),o=!0)}r&&q&&!i&&!o||goog.dom.classlist.set(w,j.join(" "));return w};goog.ui.ControlRenderer.prototype.initializeDom=function(b){b.isRightToLeft()&&this.setRightToLeft(b.getElement(),!0);b.isEnabled()&&this.setFocusable(b,b.isVisible())};goog.ui.ControlRenderer.prototype.setAriaRole=function(f,e){var h=e||this.getAriaRole();if(h){goog.asserts.assert(f,"The element passed as a first parameter cannot be null.");var g=goog.a11y.aria.getRole(f);h!=g&&goog.a11y.aria.setRole(f,h)}};goog.ui.ControlRenderer.prototype.setAriaStates=function(e,d){goog.asserts.assert(e);goog.asserts.assert(d);var f=e.getAriaLabel();goog.isDefAndNotNull(f)&&this.setAriaLabel(d,f);e.isVisible()||goog.a11y.aria.setState(d,goog.a11y.aria.State.HIDDEN,!e.isVisible());e.isEnabled()||this.updateAriaState(d,goog.ui.Component.State.DISABLED,!e.isEnabled());e.isSupportedState(goog.ui.Component.State.SELECTED)&&this.updateAriaState(d,goog.ui.Component.State.SELECTED,e.isSelected());e.isSupportedState(goog.ui.Component.State.CHECKED)&&this.updateAriaState(d,goog.ui.Component.State.CHECKED,e.isChecked());e.isSupportedState(goog.ui.Component.State.OPENED)&&this.updateAriaState(d,goog.ui.Component.State.OPENED,e.isOpen())};goog.ui.ControlRenderer.prototype.setAriaLabel=function(d,c){goog.a11y.aria.setLabel(d,c)};goog.ui.ControlRenderer.prototype.setAllowTextSelection=function(d,c){goog.style.setUnselectable(d,!c,!goog.userAgent.IE&&!goog.userAgent.OPERA)};goog.ui.ControlRenderer.prototype.setRightToLeft=function(d,c){this.enableClassName(d,this.getStructuralCssClass()+"-rtl",c)};goog.ui.ControlRenderer.prototype.isFocusable=function(d){var c;return d.isSupportedState(goog.ui.Component.State.FOCUSED)&&(c=d.getKeyEventTarget())?goog.dom.isFocusableTabIndex(c):!1};goog.ui.ControlRenderer.prototype.setFocusable=function(f,e){var h;if(f.isSupportedState(goog.ui.Component.State.FOCUSED)&&(h=f.getKeyEventTarget())){if(!e&&f.isFocused()){try{h.blur()}catch(g){}f.isFocused()&&f.handleBlur(null)}goog.dom.isFocusableTabIndex(h)!=e&&goog.dom.setFocusableTabIndex(h,e)}};goog.ui.ControlRenderer.prototype.setVisible=function(d,c){goog.style.setElementShown(d,c);d&&goog.a11y.aria.setState(d,goog.a11y.aria.State.HIDDEN,!c)};goog.ui.ControlRenderer.prototype.setState=function(g,f,j){var i=g.getElement();if(i){var h=this.getClassForState(f);h&&this.enableClassName(g,h,j);this.updateAriaState(i,f,j)}};goog.ui.ControlRenderer.prototype.updateAriaState=function(e,d,f){goog.ui.ControlRenderer.ariaAttributeMap_||(goog.ui.ControlRenderer.ariaAttributeMap_=goog.object.create(goog.ui.Component.State.DISABLED,goog.a11y.aria.State.DISABLED,goog.ui.Component.State.SELECTED,goog.a11y.aria.State.SELECTED,goog.ui.Component.State.CHECKED,goog.a11y.aria.State.CHECKED,goog.ui.Component.State.OPENED,goog.a11y.aria.State.EXPANDED));goog.asserts.assert(e,"The element passed as a first parameter cannot be null.");(d=goog.ui.ControlRenderer.getAriaStateForAriaRole_(e,goog.ui.ControlRenderer.ariaAttributeMap_[d]))&&goog.a11y.aria.setState(e,d,f)};goog.ui.ControlRenderer.getAriaStateForAriaRole_=function(e,d){var f=goog.a11y.aria.getRole(e);if(!f){return d}f=goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_[f]||d;return goog.ui.ControlRenderer.isAriaState_(d)?f:d};goog.ui.ControlRenderer.isAriaState_=function(b){return b==goog.a11y.aria.State.CHECKED||b==goog.a11y.aria.State.SELECTED};goog.ui.ControlRenderer.prototype.setContent=function(f,e){var h=this.getContentElement(f);if(h&&(goog.dom.removeChildren(h),e)){if(goog.isString(e)){goog.dom.setTextContent(h,e)}else{var g=function(d){if(d){var c=goog.dom.getOwnerDocument(h);h.appendChild(goog.isString(d)?c.createTextNode(d):d)}};goog.isArray(e)?goog.array.forEach(e,g):!goog.isArrayLike(e)||"nodeType" in e?g(e):goog.array.forEach(goog.array.clone(e),g)}}};goog.ui.ControlRenderer.prototype.getKeyEventTarget=function(b){return b.getElement()};goog.ui.ControlRenderer.prototype.getCssClass=function(){return goog.ui.ControlRenderer.CSS_CLASS};goog.ui.ControlRenderer.prototype.getIe6ClassCombinations=function(){return[]};goog.ui.ControlRenderer.prototype.getStructuralCssClass=function(){return this.getCssClass()};goog.ui.ControlRenderer.prototype.getClassNames=function(f){var e=this.getCssClass(),h=[e],g=this.getStructuralCssClass();g!=e&&h.push(g);e=this.getClassNamesForState(f.getState());h.push.apply(h,e);(f=f.getExtraClassNames())&&h.push.apply(h,f);goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")&&h.push.apply(h,this.getAppliedCombinedClassNames_(h));return h};goog.ui.ControlRenderer.prototype.getAppliedCombinedClassNames_=function(e,d){var f=[];d&&(e=goog.array.concat(e,[d]));goog.array.forEach(this.getIe6ClassCombinations(),function(a){!goog.array.every(a,goog.partial(goog.array.contains,e))||d&&!goog.array.contains(a,d)||f.push(a.join("_"))});return f};goog.ui.ControlRenderer.prototype.getClassNamesForState=function(e){for(var d=[];e;){var f=e&-e;d.push(this.getClassForState(f));e&=~f}return d};goog.ui.ControlRenderer.prototype.getClassForState=function(b){this.classByState_||this.createClassByStateMap_();return this.classByState_[b]};goog.ui.ControlRenderer.prototype.getStateFromClass=function(b){this.stateByClass_||this.createStateByClassMap_();b=parseInt(this.stateByClass_[b],10);return isNaN(b)?0:b};goog.ui.ControlRenderer.prototype.createClassByStateMap_=function(){var d=this.getStructuralCssClass(),c=!goog.string.contains(goog.string.normalizeWhitespace(d)," ");goog.asserts.assert(c,"ControlRenderer has an invalid css class: '"+d+"'");this.classByState_=goog.object.create(goog.ui.Component.State.DISABLED,d+"-disabled",goog.ui.Component.State.HOVER,d+"-hover",goog.ui.Component.State.ACTIVE,d+"-active",goog.ui.Component.State.SELECTED,d+"-selected",goog.ui.Component.State.CHECKED,d+"-checked",goog.ui.Component.State.FOCUSED,d+"-focused",goog.ui.Component.State.OPENED,d+"-open")};goog.ui.ControlRenderer.prototype.createStateByClassMap_=function(){this.classByState_||this.createClassByStateMap_();this.stateByClass_=goog.object.transpose(this.classByState_)};goog.ui.Control=function(e,d,f){goog.ui.Component.call(this,f);this.renderer_=d||goog.ui.registry.getDefaultRenderer(this.constructor);this.setContentInternal(goog.isDef(e)?e:null);this.ariaLabel_=null};goog.inherits(goog.ui.Control,goog.ui.Component);goog.tagUnsealableClass(goog.ui.Control);goog.ui.Control.registerDecorator=goog.ui.registry.setDecoratorByClassName;goog.ui.Control.getDecorator=goog.ui.registry.getDecorator;goog.ui.Control.prototype.content_=null;goog.ui.Control.prototype.state_=0;goog.ui.Control.prototype.supportedStates_=goog.ui.Component.State.DISABLED|goog.ui.Component.State.HOVER|goog.ui.Component.State.ACTIVE|goog.ui.Component.State.FOCUSED;goog.ui.Control.prototype.autoStates_=goog.ui.Component.State.ALL;goog.ui.Control.prototype.statesWithTransitionEvents_=0;goog.ui.Control.prototype.visible_=!0;goog.ui.Control.prototype.extraClassNames_=null;goog.ui.Control.prototype.handleMouseEvents_=!0;goog.ui.Control.prototype.allowTextSelection_=!1;goog.ui.Control.prototype.preferredAriaRole_=null;goog.ui.Control.prototype.isHandleMouseEvents=function(){return this.handleMouseEvents_};goog.ui.Control.prototype.setHandleMouseEvents=function(b){this.isInDocument()&&b!=this.handleMouseEvents_&&this.enableMouseEventHandling_(b);this.handleMouseEvents_=b};goog.ui.Control.prototype.getKeyEventTarget=function(){return this.renderer_.getKeyEventTarget(this)};goog.ui.Control.prototype.getKeyHandler=function(){return this.keyHandler_||(this.keyHandler_=new goog.events.KeyHandler)};goog.ui.Control.prototype.getRenderer=function(){return this.renderer_};goog.ui.Control.prototype.setRenderer=function(b){if(this.isInDocument()){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}this.getElement()&&this.setElementInternal(null);this.renderer_=b};goog.ui.Control.prototype.getExtraClassNames=function(){return this.extraClassNames_};goog.ui.Control.prototype.addClassName=function(b){b&&(this.extraClassNames_?goog.array.contains(this.extraClassNames_,b)||this.extraClassNames_.push(b):this.extraClassNames_=[b],this.renderer_.enableExtraClassName(this,b,!0))};goog.ui.Control.prototype.removeClassName=function(b){b&&this.extraClassNames_&&goog.array.remove(this.extraClassNames_,b)&&(0==this.extraClassNames_.length&&(this.extraClassNames_=null),this.renderer_.enableExtraClassName(this,b,!1))};goog.ui.Control.prototype.enableClassName=function(d,c){c?this.addClassName(d):this.removeClassName(d)};goog.ui.Control.prototype.createDom=function(){var b=this.renderer_.createDom(this);this.setElementInternal(b);this.renderer_.setAriaRole(b,this.getPreferredAriaRole());this.isAllowTextSelection()||this.renderer_.setAllowTextSelection(b,!1);this.isVisible()||this.renderer_.setVisible(b,!1)};goog.ui.Control.prototype.getPreferredAriaRole=function(){return this.preferredAriaRole_};goog.ui.Control.prototype.setPreferredAriaRole=function(b){this.preferredAriaRole_=b};goog.ui.Control.prototype.getAriaLabel=function(){return this.ariaLabel_};goog.ui.Control.prototype.setAriaLabel=function(d){this.ariaLabel_=d;var c=this.getElement();c&&this.renderer_.setAriaLabel(c,d)};goog.ui.Control.prototype.getContentElement=function(){return this.renderer_.getContentElement(this.getElement())};goog.ui.Control.prototype.canDecorate=function(b){return this.renderer_.canDecorate(b)};goog.ui.Control.prototype.decorateInternal=function(b){b=this.renderer_.decorate(this,b);this.setElementInternal(b);this.renderer_.setAriaRole(b,this.getPreferredAriaRole());this.isAllowTextSelection()||this.renderer_.setAllowTextSelection(b,!1);this.visible_="none"!=b.style.display};goog.ui.Control.prototype.enterDocument=function(){goog.ui.Control.superClass_.enterDocument.call(this);this.renderer_.setAriaStates(this,this.getElementStrict());this.renderer_.initializeDom(this);if(this.supportedStates_&~goog.ui.Component.State.DISABLED&&(this.isHandleMouseEvents()&&this.enableMouseEventHandling_(!0),this.isSupportedState(goog.ui.Component.State.FOCUSED))){var d=this.getKeyEventTarget();if(d){var c=this.getKeyHandler();c.attach(d);this.getHandler().listen(c,goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent).listen(d,goog.events.EventType.FOCUS,this.handleFocus).listen(d,goog.events.EventType.BLUR,this.handleBlur)}}};goog.ui.Control.prototype.enableMouseEventHandling_=function(e){var d=this.getHandler(),f=this.getElement();e?(d.listen(f,goog.events.EventType.MOUSEOVER,this.handleMouseOver).listen(f,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).listen(f,goog.events.EventType.MOUSEUP,this.handleMouseUp).listen(f,goog.events.EventType.MOUSEOUT,this.handleMouseOut),this.handleContextMenu!=goog.nullFunction&&d.listen(f,goog.events.EventType.CONTEXTMENU,this.handleContextMenu),goog.userAgent.IE&&(goog.userAgent.isVersionOrHigher(9)||d.listen(f,goog.events.EventType.DBLCLICK,this.handleDblClick),this.ieMouseEventSequenceSimulator_||(this.ieMouseEventSequenceSimulator_=new goog.ui.Control.IeMouseEventSequenceSimulator_(this),this.registerDisposable(this.ieMouseEventSequenceSimulator_)))):(d.unlisten(f,goog.events.EventType.MOUSEOVER,this.handleMouseOver).unlisten(f,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).unlisten(f,goog.events.EventType.MOUSEUP,this.handleMouseUp).unlisten(f,goog.events.EventType.MOUSEOUT,this.handleMouseOut),this.handleContextMenu!=goog.nullFunction&&d.unlisten(f,goog.events.EventType.CONTEXTMENU,this.handleContextMenu),goog.userAgent.IE&&(goog.userAgent.isVersionOrHigher(9)||d.unlisten(f,goog.events.EventType.DBLCLICK,this.handleDblClick),goog.dispose(this.ieMouseEventSequenceSimulator_),this.ieMouseEventSequenceSimulator_=null))};goog.ui.Control.prototype.exitDocument=function(){goog.ui.Control.superClass_.exitDocument.call(this);this.keyHandler_&&this.keyHandler_.detach();this.isVisible()&&this.isEnabled()&&this.renderer_.setFocusable(this,!1)};goog.ui.Control.prototype.disposeInternal=function(){goog.ui.Control.superClass_.disposeInternal.call(this);this.keyHandler_&&(this.keyHandler_.dispose(),delete this.keyHandler_);delete this.renderer_;this.ieMouseEventSequenceSimulator_=this.extraClassNames_=this.content_=null};goog.ui.Control.prototype.getContent=function(){return this.content_};goog.ui.Control.prototype.setContent=function(b){this.renderer_.setContent(this.getElement(),b);this.setContentInternal(b)};goog.ui.Control.prototype.setContentInternal=function(b){this.content_=b};goog.ui.Control.prototype.getCaption=function(){var b=this.getContent();if(!b){return""}b=goog.isString(b)?b:goog.isArray(b)?goog.array.map(b,goog.dom.getRawTextContent).join(""):goog.dom.getTextContent(b);return goog.string.collapseBreakingSpaces(b)};goog.ui.Control.prototype.setCaption=function(b){this.setContent(b)};goog.ui.Control.prototype.setRightToLeft=function(d){goog.ui.Control.superClass_.setRightToLeft.call(this,d);var c=this.getElement();c&&this.renderer_.setRightToLeft(c,d)};goog.ui.Control.prototype.isAllowTextSelection=function(){return this.allowTextSelection_};goog.ui.Control.prototype.setAllowTextSelection=function(d){this.allowTextSelection_=d;var c=this.getElement();c&&this.renderer_.setAllowTextSelection(c,d)};goog.ui.Control.prototype.isVisible=function(){return this.visible_};goog.ui.Control.prototype.setVisible=function(e,d){if(d||this.visible_!=e&&this.dispatchEvent(e?goog.ui.Component.EventType.SHOW:goog.ui.Component.EventType.HIDE)){var f=this.getElement();f&&this.renderer_.setVisible(f,e);this.isEnabled()&&this.renderer_.setFocusable(this,e);this.visible_=e;return !0}return !1};goog.ui.Control.prototype.isEnabled=function(){return !this.hasState(goog.ui.Component.State.DISABLED)};goog.ui.Control.prototype.isParentDisabled_=function(){var b=this.getParent();return !!b&&"function"==typeof b.isEnabled&&!b.isEnabled()};goog.ui.Control.prototype.setEnabled=function(b){!this.isParentDisabled_()&&this.isTransitionAllowed(goog.ui.Component.State.DISABLED,!b)&&(b||(this.setActive(!1),this.setHighlighted(!1)),this.isVisible()&&this.renderer_.setFocusable(this,b),this.setState(goog.ui.Component.State.DISABLED,!b,!0))};goog.ui.Control.prototype.isHighlighted=function(){return this.hasState(goog.ui.Component.State.HOVER)};goog.ui.Control.prototype.setHighlighted=function(b){this.isTransitionAllowed(goog.ui.Component.State.HOVER,b)&&this.setState(goog.ui.Component.State.HOVER,b)};goog.ui.Control.prototype.isActive=function(){return this.hasState(goog.ui.Component.State.ACTIVE)};goog.ui.Control.prototype.setActive=function(b){this.isTransitionAllowed(goog.ui.Component.State.ACTIVE,b)&&this.setState(goog.ui.Component.State.ACTIVE,b)};goog.ui.Control.prototype.isSelected=function(){return this.hasState(goog.ui.Component.State.SELECTED)};goog.ui.Control.prototype.setSelected=function(b){this.isTransitionAllowed(goog.ui.Component.State.SELECTED,b)&&this.setState(goog.ui.Component.State.SELECTED,b)};goog.ui.Control.prototype.isChecked=function(){return this.hasState(goog.ui.Component.State.CHECKED)};goog.ui.Control.prototype.setChecked=function(b){this.isTransitionAllowed(goog.ui.Component.State.CHECKED,b)&&this.setState(goog.ui.Component.State.CHECKED,b)};goog.ui.Control.prototype.isFocused=function(){return this.hasState(goog.ui.Component.State.FOCUSED)};goog.ui.Control.prototype.setFocused=function(b){this.isTransitionAllowed(goog.ui.Component.State.FOCUSED,b)&&this.setState(goog.ui.Component.State.FOCUSED,b)};goog.ui.Control.prototype.isOpen=function(){return this.hasState(goog.ui.Component.State.OPENED)};goog.ui.Control.prototype.setOpen=function(b){this.isTransitionAllowed(goog.ui.Component.State.OPENED,b)&&this.setState(goog.ui.Component.State.OPENED,b)};goog.ui.Control.prototype.getState=function(){return this.state_};goog.ui.Control.prototype.hasState=function(b){return !!(this.state_&b)};goog.ui.Control.prototype.setState=function(e,d,f){f||e!=goog.ui.Component.State.DISABLED?this.isSupportedState(e)&&d!=this.hasState(e)&&(this.renderer_.setState(this,e,d),this.state_=d?this.state_|e:this.state_&~e):this.setEnabled(!d)};goog.ui.Control.prototype.setStateInternal=function(b){this.state_=b};goog.ui.Control.prototype.isSupportedState=function(b){return !!(this.supportedStates_&b)};goog.ui.Control.prototype.setSupportedState=function(d,c){if(this.isInDocument()&&this.hasState(d)&&!c){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}!c&&this.hasState(d)&&this.setState(d,!1);this.supportedStates_=c?this.supportedStates_|d:this.supportedStates_&~d};goog.ui.Control.prototype.isAutoState=function(b){return !!(this.autoStates_&b)&&this.isSupportedState(b)};goog.ui.Control.prototype.setAutoStates=function(d,c){this.autoStates_=c?this.autoStates_|d:this.autoStates_&~d};goog.ui.Control.prototype.isDispatchTransitionEvents=function(b){return !!(this.statesWithTransitionEvents_&b)&&this.isSupportedState(b)};goog.ui.Control.prototype.setDispatchTransitionEvents=function(d,c){this.statesWithTransitionEvents_=c?this.statesWithTransitionEvents_|d:this.statesWithTransitionEvents_&~d};goog.ui.Control.prototype.isTransitionAllowed=function(d,c){return this.isSupportedState(d)&&this.hasState(d)!=c&&(!(this.statesWithTransitionEvents_&d)||this.dispatchEvent(goog.ui.Component.getStateTransitionEvent(d,c)))&&!this.isDisposed()};goog.ui.Control.prototype.handleMouseOver=function(b){!goog.ui.Control.isMouseEventWithinElement_(b,this.getElement())&&this.dispatchEvent(goog.ui.Component.EventType.ENTER)&&this.isEnabled()&&this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0)};goog.ui.Control.prototype.handleMouseOut=function(b){!goog.ui.Control.isMouseEventWithinElement_(b,this.getElement())&&this.dispatchEvent(goog.ui.Component.EventType.LEAVE)&&(this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1),this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!1))};goog.ui.Control.prototype.handleContextMenu=goog.nullFunction;goog.ui.Control.isMouseEventWithinElement_=function(d,c){return !!d.relatedTarget&&goog.dom.contains(c,d.relatedTarget)};goog.ui.Control.prototype.handleMouseDown=function(b){this.isEnabled()&&(this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0),b.isMouseActionButton()&&(this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!0),this.renderer_&&this.renderer_.isFocusable(this)&&this.getKeyEventTarget().focus()));!this.isAllowTextSelection()&&b.isMouseActionButton()&&b.preventDefault()};goog.ui.Control.prototype.handleMouseUp=function(b){this.isEnabled()&&(this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0),this.isActive()&&this.performActionInternal(b)&&this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1))};goog.ui.Control.prototype.handleDblClick=function(b){this.isEnabled()&&this.performActionInternal(b)};goog.ui.Control.prototype.performActionInternal=function(d){this.isAutoState(goog.ui.Component.State.CHECKED)&&this.setChecked(!this.isChecked());this.isAutoState(goog.ui.Component.State.SELECTED)&&this.setSelected(!0);this.isAutoState(goog.ui.Component.State.OPENED)&&this.setOpen(!this.isOpen());var c=new goog.events.Event(goog.ui.Component.EventType.ACTION,this);d&&(c.altKey=d.altKey,c.ctrlKey=d.ctrlKey,c.metaKey=d.metaKey,c.shiftKey=d.shiftKey,c.platformModifierKey=d.platformModifierKey);return this.dispatchEvent(c)};goog.ui.Control.prototype.handleFocus=function(b){this.isAutoState(goog.ui.Component.State.FOCUSED)&&this.setFocused(!0)};goog.ui.Control.prototype.handleBlur=function(b){this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1);this.isAutoState(goog.ui.Component.State.FOCUSED)&&this.setFocused(!1)};goog.ui.Control.prototype.handleKeyEvent=function(b){return this.isVisible()&&this.isEnabled()&&this.handleKeyEventInternal(b)?(b.preventDefault(),b.stopPropagation(),!0):!1};goog.ui.Control.prototype.handleKeyEventInternal=function(b){return b.keyCode==goog.events.KeyCodes.ENTER&&this.performActionInternal(b)};goog.ui.registry.setDefaultRenderer(goog.ui.Control,goog.ui.ControlRenderer);goog.ui.registry.setDecoratorByClassName(goog.ui.ControlRenderer.CSS_CLASS,function(){return new goog.ui.Control(null)});goog.ui.Control.IeMouseEventSequenceSimulator_=function(b){goog.Disposable.call(this);this.control_=b;this.clickExpected_=!1;this.handler_=new goog.events.EventHandler(this);this.registerDisposable(this.handler_);b=this.control_.getElementStrict();this.handler_.listen(b,goog.events.EventType.MOUSEDOWN,this.handleMouseDown_).listen(b,goog.events.EventType.MOUSEUP,this.handleMouseUp_).listen(b,goog.events.EventType.CLICK,this.handleClick_)};goog.inherits(goog.ui.Control.IeMouseEventSequenceSimulator_,goog.Disposable);goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_=!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9);goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseDown_=function(){this.clickExpected_=!1};goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseUp_=function(){this.clickExpected_=!0};goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_=function(e,d){if(!goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_){return e.button=goog.events.BrowserEvent.MouseButton.LEFT,e.type=d,e}var f=document.createEvent("MouseEvents");f.initMouseEvent(d,e.bubbles,e.cancelable,e.view||null,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,goog.events.BrowserEvent.MouseButton.LEFT,e.relatedTarget||null);return f};goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleClick_=function(g){if(this.clickExpected_){this.clickExpected_=!1}else{var f=g.getBrowserEvent(),j=f.button,i=f.type,h=goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(f,goog.events.EventType.MOUSEDOWN);this.control_.handleMouseDown(new goog.events.BrowserEvent(h,g.currentTarget));h=goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(f,goog.events.EventType.MOUSEUP);this.control_.handleMouseUp(new goog.events.BrowserEvent(h,g.currentTarget));goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_||(f.button=j,f.type=i)}};goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.disposeInternal=function(){this.control_=null;goog.ui.Control.IeMouseEventSequenceSimulator_.superClass_.disposeInternal.call(this)};goog.ui.Container=function(e,d,f){goog.ui.Component.call(this,f);this.renderer_=d||goog.ui.ContainerRenderer.getInstance();this.orientation_=e||this.renderer_.getDefaultOrientation()};goog.inherits(goog.ui.Container,goog.ui.Component);goog.tagUnsealableClass(goog.ui.Container);goog.ui.Container.EventType={AFTER_SHOW:"aftershow",AFTER_HIDE:"afterhide"};goog.ui.Container.Orientation={HORIZONTAL:"horizontal",VERTICAL:"vertical"};goog.ui.Container.prototype.keyEventTarget_=null;goog.ui.Container.prototype.keyHandler_=null;goog.ui.Container.prototype.renderer_=null;goog.ui.Container.prototype.orientation_=null;goog.ui.Container.prototype.visible_=!0;goog.ui.Container.prototype.enabled_=!0;goog.ui.Container.prototype.focusable_=!0;goog.ui.Container.prototype.highlightedIndex_=-1;goog.ui.Container.prototype.openItem_=null;goog.ui.Container.prototype.mouseButtonPressed_=!1;goog.ui.Container.prototype.allowFocusableChildren_=!1;goog.ui.Container.prototype.openFollowsHighlight_=!0;goog.ui.Container.prototype.childElementIdMap_=null;goog.ui.Container.prototype.getKeyEventTarget=function(){return this.keyEventTarget_||this.renderer_.getKeyEventTarget(this)};goog.ui.Container.prototype.setKeyEventTarget=function(f){if(this.focusable_){var e=this.getKeyEventTarget(),h=this.isInDocument();this.keyEventTarget_=f;var g=this.getKeyEventTarget();h&&(this.keyEventTarget_=e,this.enableFocusHandling_(!1),this.keyEventTarget_=f,this.getKeyHandler().attach(g),this.enableFocusHandling_(!0))}else{throw Error("Can't set key event target for container that doesn't support keyboard focus!")}};goog.ui.Container.prototype.getKeyHandler=function(){return this.keyHandler_||(this.keyHandler_=new goog.events.KeyHandler(this.getKeyEventTarget()))};goog.ui.Container.prototype.getRenderer=function(){return this.renderer_};goog.ui.Container.prototype.setRenderer=function(b){if(this.getElement()){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}this.renderer_=b};goog.ui.Container.prototype.createDom=function(){this.setElementInternal(this.renderer_.createDom(this))};goog.ui.Container.prototype.getContentElement=function(){return this.renderer_.getContentElement(this.getElement())};goog.ui.Container.prototype.canDecorate=function(b){return this.renderer_.canDecorate(b)};goog.ui.Container.prototype.decorateInternal=function(b){this.setElementInternal(this.renderer_.decorate(this,b));"none"==b.style.display&&(this.visible_=!1)};goog.ui.Container.prototype.enterDocument=function(){goog.ui.Container.superClass_.enterDocument.call(this);this.forEachChild(function(c){c.isInDocument()&&this.registerChildId_(c)},this);var b=this.getElement();this.renderer_.initializeDom(this);this.setVisible(this.visible_,!0);this.getHandler().listen(this,goog.ui.Component.EventType.ENTER,this.handleEnterItem).listen(this,goog.ui.Component.EventType.HIGHLIGHT,this.handleHighlightItem).listen(this,goog.ui.Component.EventType.UNHIGHLIGHT,this.handleUnHighlightItem).listen(this,goog.ui.Component.EventType.OPEN,this.handleOpenItem).listen(this,goog.ui.Component.EventType.CLOSE,this.handleCloseItem).listen(b,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).listen(goog.dom.getOwnerDocument(b),goog.events.EventType.MOUSEUP,this.handleDocumentMouseUp).listen(b,[goog.events.EventType.MOUSEDOWN,goog.events.EventType.MOUSEUP,goog.events.EventType.MOUSEOVER,goog.events.EventType.MOUSEOUT,goog.events.EventType.CONTEXTMENU],this.handleChildMouseEvents);this.isFocusable()&&this.enableFocusHandling_(!0)};goog.ui.Container.prototype.enableFocusHandling_=function(e){var d=this.getHandler(),f=this.getKeyEventTarget();e?d.listen(f,goog.events.EventType.FOCUS,this.handleFocus).listen(f,goog.events.EventType.BLUR,this.handleBlur).listen(this.getKeyHandler(),goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent):d.unlisten(f,goog.events.EventType.FOCUS,this.handleFocus).unlisten(f,goog.events.EventType.BLUR,this.handleBlur).unlisten(this.getKeyHandler(),goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent)};goog.ui.Container.prototype.exitDocument=function(){this.setHighlightedIndex(-1);this.openItem_&&this.openItem_.setOpen(!1);this.mouseButtonPressed_=!1;goog.ui.Container.superClass_.exitDocument.call(this)};goog.ui.Container.prototype.disposeInternal=function(){goog.ui.Container.superClass_.disposeInternal.call(this);this.keyHandler_&&(this.keyHandler_.dispose(),this.keyHandler_=null);this.renderer_=this.openItem_=this.childElementIdMap_=this.keyEventTarget_=null};goog.ui.Container.prototype.handleEnterItem=function(b){return !0};goog.ui.Container.prototype.handleHighlightItem=function(e){var d=this.indexOfChild(e.target);if(-1<d&&d!=this.highlightedIndex_){var f=this.getHighlighted();f&&f.setHighlighted(!1);this.highlightedIndex_=d;f=this.getHighlighted();this.isMouseButtonPressed()&&f.setActive(!0);this.openFollowsHighlight_&&this.openItem_&&f!=this.openItem_&&(f.isSupportedState(goog.ui.Component.State.OPENED)?f.setOpen(!0):this.openItem_.setOpen(!1))}d=this.getElement();goog.asserts.assert(d,"The DOM element for the container cannot be null.");null!=e.target.getElement()&&goog.a11y.aria.setState(d,goog.a11y.aria.State.ACTIVEDESCENDANT,e.target.getElement().id)};goog.ui.Container.prototype.handleUnHighlightItem=function(b){b.target==this.getHighlighted()&&(this.highlightedIndex_=-1);b=this.getElement();goog.asserts.assert(b,"The DOM element for the container cannot be null.");goog.a11y.aria.removeState(b,goog.a11y.aria.State.ACTIVEDESCENDANT)};goog.ui.Container.prototype.handleOpenItem=function(b){(b=b.target)&&b!=this.openItem_&&b.getParent()==this&&(this.openItem_&&this.openItem_.setOpen(!1),this.openItem_=b)};goog.ui.Container.prototype.handleCloseItem=function(e){e.target==this.openItem_&&(this.openItem_=null);var d=this.getElement(),f=e.target.getElement();d&&e.target.isHighlighted()&&f&&goog.a11y.aria.setActiveDescendant(d,f)};goog.ui.Container.prototype.handleMouseDown=function(d){this.enabled_&&this.setMouseButtonPressed(!0);var c=this.getKeyEventTarget();c&&goog.dom.isFocusableTabIndex(c)?c.focus():d.preventDefault()};goog.ui.Container.prototype.handleDocumentMouseUp=function(b){this.setMouseButtonPressed(!1)};goog.ui.Container.prototype.handleChildMouseEvents=function(d){var c=this.getOwnerControl(d.target);if(c){switch(d.type){case goog.events.EventType.MOUSEDOWN:c.handleMouseDown(d);break;case goog.events.EventType.MOUSEUP:c.handleMouseUp(d);break;case goog.events.EventType.MOUSEOVER:c.handleMouseOver(d);break;case goog.events.EventType.MOUSEOUT:c.handleMouseOut(d);break;case goog.events.EventType.CONTEXTMENU:c.handleContextMenu(d)}}};goog.ui.Container.prototype.getOwnerControl=function(e){if(this.childElementIdMap_){for(var d=this.getElement();e&&e!==d;){var f=e.id;if(f in this.childElementIdMap_){return this.childElementIdMap_[f]}e=e.parentNode}}return null};goog.ui.Container.prototype.handleFocus=function(b){};goog.ui.Container.prototype.handleBlur=function(b){this.setHighlightedIndex(-1);this.setMouseButtonPressed(!1);this.openItem_&&this.openItem_.setOpen(!1)};goog.ui.Container.prototype.handleKeyEvent=function(b){return this.isEnabled()&&this.isVisible()&&(0!=this.getChildCount()||this.keyEventTarget_)&&this.handleKeyEventInternal(b)?(b.preventDefault(),b.stopPropagation(),!0):!1};goog.ui.Container.prototype.handleKeyEventInternal=function(d){var c=this.getHighlighted();if(c&&"function"==typeof c.handleKeyEvent&&c.handleKeyEvent(d)||this.openItem_&&this.openItem_!=c&&"function"==typeof this.openItem_.handleKeyEvent&&this.openItem_.handleKeyEvent(d)){return !0}if(d.shiftKey||d.ctrlKey||d.metaKey||d.altKey){return !1}switch(d.keyCode){case goog.events.KeyCodes.ESC:if(this.isFocusable()){this.getKeyEventTarget().blur()}else{return !1}break;case goog.events.KeyCodes.HOME:this.highlightFirst();break;case goog.events.KeyCodes.END:this.highlightLast();break;case goog.events.KeyCodes.UP:if(this.orientation_==goog.ui.Container.Orientation.VERTICAL){this.highlightPrevious()}else{return !1}break;case goog.events.KeyCodes.LEFT:if(this.orientation_==goog.ui.Container.Orientation.HORIZONTAL){this.isRightToLeft()?this.highlightNext():this.highlightPrevious()}else{return !1}break;case goog.events.KeyCodes.DOWN:if(this.orientation_==goog.ui.Container.Orientation.VERTICAL){this.highlightNext()}else{return !1}break;case goog.events.KeyCodes.RIGHT:if(this.orientation_==goog.ui.Container.Orientation.HORIZONTAL){this.isRightToLeft()?this.highlightPrevious():this.highlightNext()}else{return !1}break;default:return !1}return !0};goog.ui.Container.prototype.registerChildId_=function(d){var c=d.getElement(),c=c.id||(c.id=d.getId());this.childElementIdMap_||(this.childElementIdMap_={});this.childElementIdMap_[c]=d};goog.ui.Container.prototype.addChild=function(d,c){goog.asserts.assertInstanceof(d,goog.ui.Control,"The child of a container must be a control");goog.ui.Container.superClass_.addChild.call(this,d,c)};goog.ui.Container.prototype.addChildAt=function(f,e,h){goog.asserts.assertInstanceof(f,goog.ui.Control);f.setDispatchTransitionEvents(goog.ui.Component.State.HOVER,!0);f.setDispatchTransitionEvents(goog.ui.Component.State.OPENED,!0);!this.isFocusable()&&this.isFocusableChildrenAllowed()||f.setSupportedState(goog.ui.Component.State.FOCUSED,!1);f.setHandleMouseEvents(!1);var g=f.getParent()==this?this.indexOfChild(f):-1;goog.ui.Container.superClass_.addChildAt.call(this,f,e,h);f.isInDocument()&&this.isInDocument()&&this.registerChildId_(f);this.updateHighlightedIndex_(g,e)};goog.ui.Container.prototype.updateHighlightedIndex_=function(d,c){-1==d&&(d=this.getChildCount());d==this.highlightedIndex_?this.highlightedIndex_=Math.min(this.getChildCount()-1,c):d>this.highlightedIndex_&&c<=this.highlightedIndex_?this.highlightedIndex_++:d<this.highlightedIndex_&&c>this.highlightedIndex_&&this.highlightedIndex_--};goog.ui.Container.prototype.removeChild=function(e,d){e=goog.isString(e)?this.getChild(e):e;goog.asserts.assertInstanceof(e,goog.ui.Control);if(e){var f=this.indexOfChild(e);-1!=f&&(f==this.highlightedIndex_?(e.setHighlighted(!1),this.highlightedIndex_=-1):f<this.highlightedIndex_&&this.highlightedIndex_--);(f=e.getElement())&&f.id&&this.childElementIdMap_&&goog.object.remove(this.childElementIdMap_,f.id)}e=goog.ui.Container.superClass_.removeChild.call(this,e,d);e.setHandleMouseEvents(!0);return e};goog.ui.Container.prototype.getOrientation=function(){return this.orientation_};goog.ui.Container.prototype.setOrientation=function(b){if(this.getElement()){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}this.orientation_=b};goog.ui.Container.prototype.isVisible=function(){return this.visible_};goog.ui.Container.prototype.setVisible=function(e,d){if(d||this.visible_!=e&&this.dispatchEvent(e?goog.ui.Component.EventType.SHOW:goog.ui.Component.EventType.HIDE)){this.visible_=e;var f=this.getElement();f&&(goog.style.setElementShown(f,e),this.isFocusable()&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),this.enabled_&&this.visible_),d||this.dispatchEvent(this.visible_?goog.ui.Container.EventType.AFTER_SHOW:goog.ui.Container.EventType.AFTER_HIDE));return !0}return !1};goog.ui.Container.prototype.isEnabled=function(){return this.enabled_};goog.ui.Container.prototype.setEnabled=function(b){this.enabled_!=b&&this.dispatchEvent(b?goog.ui.Component.EventType.ENABLE:goog.ui.Component.EventType.DISABLE)&&(b?(this.enabled_=!0,this.forEachChild(function(c){c.wasDisabled?delete c.wasDisabled:c.setEnabled(!0)})):(this.forEachChild(function(c){c.isEnabled()?c.setEnabled(!1):c.wasDisabled=!0}),this.enabled_=!1,this.setMouseButtonPressed(!1)),this.isFocusable()&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),b&&this.visible_))};goog.ui.Container.prototype.isFocusable=function(){return this.focusable_};goog.ui.Container.prototype.setFocusable=function(b){b!=this.focusable_&&this.isInDocument()&&this.enableFocusHandling_(b);this.focusable_=b;this.enabled_&&this.visible_&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),b)};goog.ui.Container.prototype.isFocusableChildrenAllowed=function(){return this.allowFocusableChildren_};goog.ui.Container.prototype.setFocusableChildrenAllowed=function(b){this.allowFocusableChildren_=b};goog.ui.Container.prototype.isOpenFollowsHighlight=function(){return this.openFollowsHighlight_};goog.ui.Container.prototype.setOpenFollowsHighlight=function(b){this.openFollowsHighlight_=b};goog.ui.Container.prototype.getHighlightedIndex=function(){return this.highlightedIndex_};goog.ui.Container.prototype.setHighlightedIndex=function(b){(b=this.getChildAt(b))?b.setHighlighted(!0):-1<this.highlightedIndex_&&this.getHighlighted().setHighlighted(!1)};goog.ui.Container.prototype.setHighlighted=function(b){this.setHighlightedIndex(this.indexOfChild(b))};goog.ui.Container.prototype.getHighlighted=function(){return this.getChildAt(this.highlightedIndex_)};goog.ui.Container.prototype.highlightFirst=function(){this.highlightHelper(function(d,c){return(d+1)%c},this.getChildCount()-1)};goog.ui.Container.prototype.highlightLast=function(){this.highlightHelper(function(d,c){d--;return 0>d?c-1:d},0)};goog.ui.Container.prototype.highlightNext=function(){this.highlightHelper(function(d,c){return(d+1)%c},this.highlightedIndex_)};goog.ui.Container.prototype.highlightPrevious=function(){this.highlightHelper(function(d,c){d--;return 0>d?c-1:d},this.highlightedIndex_)};goog.ui.Container.prototype.highlightHelper=function(h,g){for(var l=0>g?this.indexOfChild(this.openItem_):g,k=this.getChildCount(),l=h.call(this,l,k),j=0;j<=k;){var i=this.getChildAt(l);if(i&&this.canHighlightItem(i)){return this.setHighlightedIndexFromKeyEvent(l),!0}j++;l=h.call(this,l,k)}return !1};goog.ui.Container.prototype.canHighlightItem=function(b){return b.isVisible()&&b.isEnabled()&&b.isSupportedState(goog.ui.Component.State.HOVER)};goog.ui.Container.prototype.setHighlightedIndexFromKeyEvent=function(b){this.setHighlightedIndex(b)};goog.ui.Container.prototype.getOpenItem=function(){return this.openItem_};goog.ui.Container.prototype.isMouseButtonPressed=function(){return this.mouseButtonPressed_};goog.ui.Container.prototype.setMouseButtonPressed=function(b){this.mouseButtonPressed_=b};goog.ui.MenuHeaderRenderer=function(){goog.ui.ControlRenderer.call(this)};goog.inherits(goog.ui.MenuHeaderRenderer,goog.ui.ControlRenderer);goog.addSingletonGetter(goog.ui.MenuHeaderRenderer);goog.ui.MenuHeaderRenderer.CSS_CLASS="goog-menuheader";goog.ui.MenuHeaderRenderer.prototype.getCssClass=function(){return goog.ui.MenuHeaderRenderer.CSS_CLASS};goog.ui.MenuHeader=function(e,d,f){goog.ui.Control.call(this,e,f||goog.ui.MenuHeaderRenderer.getInstance(),d);this.setSupportedState(goog.ui.Component.State.DISABLED,!1);this.setSupportedState(goog.ui.Component.State.HOVER,!1);this.setSupportedState(goog.ui.Component.State.ACTIVE,!1);this.setSupportedState(goog.ui.Component.State.FOCUSED,!1);this.setStateInternal(goog.ui.Component.State.DISABLED)};goog.inherits(goog.ui.MenuHeader,goog.ui.Control);goog.ui.registry.setDecoratorByClassName(goog.ui.MenuHeaderRenderer.CSS_CLASS,function(){return new goog.ui.MenuHeader(null)});goog.ui.MenuItemRenderer=function(){goog.ui.ControlRenderer.call(this);this.classNameCache_=[]};goog.inherits(goog.ui.MenuItemRenderer,goog.ui.ControlRenderer);goog.addSingletonGetter(goog.ui.MenuItemRenderer);goog.ui.MenuItemRenderer.CSS_CLASS="goog-menuitem";goog.ui.MenuItemRenderer.CompositeCssClassIndex_={HOVER:0,CHECKBOX:1,CONTENT:2};goog.ui.MenuItemRenderer.prototype.getCompositeCssClass_=function(d){var c=this.classNameCache_[d];if(!c){switch(d){case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER:c=this.getStructuralCssClass()+"-highlight";break;case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX:c=this.getStructuralCssClass()+"-checkbox";break;case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT:c=this.getStructuralCssClass()+"-content"}this.classNameCache_[d]=c}return c};goog.ui.MenuItemRenderer.prototype.getAriaRole=function(){return goog.a11y.aria.Role.MENU_ITEM};goog.ui.MenuItemRenderer.prototype.createDom=function(d){var c=d.getDomHelper().createDom("DIV",this.getClassNames(d).join(" "),this.createContent(d.getContent(),d.getDomHelper()));this.setEnableCheckBoxStructure(d,c,d.isSupportedState(goog.ui.Component.State.SELECTED)||d.isSupportedState(goog.ui.Component.State.CHECKED));return c};goog.ui.MenuItemRenderer.prototype.getContentElement=function(b){return b&&b.firstChild};goog.ui.MenuItemRenderer.prototype.decorate=function(d,c){goog.asserts.assert(c);this.hasContentStructure(c)||c.appendChild(this.createContent(c.childNodes,d.getDomHelper()));goog.dom.classlist.contains(c,"goog-option")&&(d.setCheckable(!0),this.setCheckable(d,c,!0));return goog.ui.MenuItemRenderer.superClass_.decorate.call(this,d,c)};goog.ui.MenuItemRenderer.prototype.setContent=function(f,e){var h=this.getContentElement(f),g=this.hasCheckBoxStructure(f)?h.firstChild:null;goog.ui.MenuItemRenderer.superClass_.setContent.call(this,f,e);g&&!this.hasCheckBoxStructure(f)&&h.insertBefore(g,h.firstChild||null)};goog.ui.MenuItemRenderer.prototype.hasContentStructure=function(d){d=goog.dom.getFirstElementChild(d);var c=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);return !!d&&goog.dom.classlist.contains(d,c)};goog.ui.MenuItemRenderer.prototype.createContent=function(e,d){var f=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);return d.createDom("DIV",f,e)};goog.ui.MenuItemRenderer.prototype.setSelectable=function(e,d,f){e&&d&&this.setEnableCheckBoxStructure(e,d,f)};goog.ui.MenuItemRenderer.prototype.setCheckable=function(e,d,f){e&&d&&this.setEnableCheckBoxStructure(e,d,f)};goog.ui.MenuItemRenderer.prototype.hasCheckBoxStructure=function(d){if(d=this.getContentElement(d)){d=d.firstChild;var c=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX);return !!d&&goog.dom.isElement(d)&&goog.dom.classlist.contains(d,c)}return !1};goog.ui.MenuItemRenderer.prototype.setEnableCheckBoxStructure=function(e,d,f){this.setAriaRole(d,e.getPreferredAriaRole());this.setAriaStates(e,d);f!=this.hasCheckBoxStructure(d)&&(goog.dom.classlist.enable(d,"goog-option",f),d=this.getContentElement(d),f?(f=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX),d.insertBefore(e.getDomHelper().createDom("DIV",f),d.firstChild||null)):d.removeChild(d.firstChild))};goog.ui.MenuItemRenderer.prototype.getClassForState=function(b){switch(b){case goog.ui.Component.State.HOVER:return this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);case goog.ui.Component.State.CHECKED:case goog.ui.Component.State.SELECTED:return"goog-option-selected";default:return goog.ui.MenuItemRenderer.superClass_.getClassForState.call(this,b)}};goog.ui.MenuItemRenderer.prototype.getStateFromClass=function(d){var c=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);switch(d){case"goog-option-selected":return goog.ui.Component.State.CHECKED;case c:return goog.ui.Component.State.HOVER;default:return goog.ui.MenuItemRenderer.superClass_.getStateFromClass.call(this,d)}};goog.ui.MenuItemRenderer.prototype.getCssClass=function(){return goog.ui.MenuItemRenderer.CSS_CLASS};goog.ui.MenuItem=function(f,e,h,g){goog.ui.Control.call(this,f,g||goog.ui.MenuItemRenderer.getInstance(),h);this.setValue(e)};goog.inherits(goog.ui.MenuItem,goog.ui.Control);goog.tagUnsealableClass(goog.ui.MenuItem);goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_="goog-menuitem-mnemonic-separator";goog.ui.MenuItem.ACCELERATOR_CLASS="goog-menuitem-accel";goog.ui.MenuItem.prototype.getValue=function(){var b=this.getModel();return null!=b?b:this.getCaption()};goog.ui.MenuItem.prototype.setValue=function(b){this.setModel(b)};goog.ui.MenuItem.prototype.setSupportedState=function(d,c){goog.ui.MenuItem.superClass_.setSupportedState.call(this,d,c);switch(d){case goog.ui.Component.State.SELECTED:this.setSelectableInternal_(c);break;case goog.ui.Component.State.CHECKED:this.setCheckableInternal_(c)}};goog.ui.MenuItem.prototype.setSelectable=function(b){this.setSupportedState(goog.ui.Component.State.SELECTED,b)};goog.ui.MenuItem.prototype.setSelectableInternal_=function(d){this.isChecked()&&!d&&this.setChecked(!1);var c=this.getElement();c&&this.getRenderer().setSelectable(this,c,d)};goog.ui.MenuItem.prototype.setCheckable=function(b){this.setSupportedState(goog.ui.Component.State.CHECKED,b)};goog.ui.MenuItem.prototype.setCheckableInternal_=function(d){var c=this.getElement();c&&this.getRenderer().setCheckable(this,c,d)};goog.ui.MenuItem.prototype.getCaption=function(){var e=this.getContent();if(goog.isArray(e)){var d=goog.ui.MenuItem.ACCELERATOR_CLASS,f=goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_,e=goog.array.map(e,function(b){return goog.dom.isElement(b)&&(goog.dom.classlist.contains(b,d)||goog.dom.classlist.contains(b,f))?"":goog.dom.getRawTextContent(b)}).join("");return goog.string.collapseBreakingSpaces(e)}return goog.ui.MenuItem.superClass_.getCaption.call(this)};goog.ui.MenuItem.prototype.getAccelerator=function(){var d=this.getDomHelper(),c=this.getContent();return goog.isArray(c)&&(c=goog.array.find(c,function(b){return goog.dom.classlist.contains(b,goog.ui.MenuItem.ACCELERATOR_CLASS)}))?d.getTextContent(c):null};goog.ui.MenuItem.prototype.handleMouseUp=function(e){var d=this.getParent();if(d){var f=d.openingCoords;d.openingCoords=null;if(f&&goog.isNumber(e.clientX)&&(d=new goog.math.Coordinate(e.clientX,e.clientY),goog.math.Coordinate.equals(f,d))){return}}goog.ui.MenuItem.superClass_.handleMouseUp.call(this,e)};goog.ui.MenuItem.prototype.handleKeyEventInternal=function(b){return b.keyCode==this.getMnemonic()&&this.performActionInternal(b)?!0:goog.ui.MenuItem.superClass_.handleKeyEventInternal.call(this,b)};goog.ui.MenuItem.prototype.setMnemonic=function(b){this.mnemonicKey_=b};goog.ui.MenuItem.prototype.getMnemonic=function(){return this.mnemonicKey_};goog.ui.registry.setDecoratorByClassName(goog.ui.MenuItemRenderer.CSS_CLASS,function(){return new goog.ui.MenuItem(null)});goog.ui.MenuItem.prototype.getPreferredAriaRole=function(){return this.isSupportedState(goog.ui.Component.State.CHECKED)?goog.a11y.aria.Role.MENU_ITEM_CHECKBOX:this.isSupportedState(goog.ui.Component.State.SELECTED)?goog.a11y.aria.Role.MENU_ITEM_RADIO:goog.ui.MenuItem.superClass_.getPreferredAriaRole.call(this)};goog.ui.MenuItem.prototype.getParent=function(){return goog.ui.Control.prototype.getParent.call(this)};goog.ui.MenuItem.prototype.getParentEventTarget=function(){return goog.ui.Control.prototype.getParentEventTarget.call(this)};goog.ui.MenuSeparatorRenderer=function(){goog.ui.ControlRenderer.call(this)};goog.inherits(goog.ui.MenuSeparatorRenderer,goog.ui.ControlRenderer);goog.addSingletonGetter(goog.ui.MenuSeparatorRenderer);goog.ui.MenuSeparatorRenderer.CSS_CLASS="goog-menuseparator";goog.ui.MenuSeparatorRenderer.prototype.createDom=function(b){return b.getDomHelper().createDom("DIV",this.getCssClass())};goog.ui.MenuSeparatorRenderer.prototype.decorate=function(e,d){d.id&&e.setId(d.id);if("HR"==d.tagName){var f=d;d=this.createDom(e);goog.dom.insertSiblingBefore(d,f);goog.dom.removeNode(f)}else{goog.dom.classlist.add(d,this.getCssClass())}return d};goog.ui.MenuSeparatorRenderer.prototype.setContent=function(d,c){};goog.ui.MenuSeparatorRenderer.prototype.getCssClass=function(){return goog.ui.MenuSeparatorRenderer.CSS_CLASS};goog.ui.Separator=function(d,c){goog.ui.Control.call(this,null,d||goog.ui.MenuSeparatorRenderer.getInstance(),c);this.setSupportedState(goog.ui.Component.State.DISABLED,!1);this.setSupportedState(goog.ui.Component.State.HOVER,!1);this.setSupportedState(goog.ui.Component.State.ACTIVE,!1);this.setSupportedState(goog.ui.Component.State.FOCUSED,!1);this.setStateInternal(goog.ui.Component.State.DISABLED)};goog.inherits(goog.ui.Separator,goog.ui.Control);goog.ui.Separator.prototype.enterDocument=function(){goog.ui.Separator.superClass_.enterDocument.call(this);var b=this.getElement();goog.asserts.assert(b,"The DOM element for the separator cannot be null.");goog.a11y.aria.setRole(b,"separator")};goog.ui.registry.setDecoratorByClassName(goog.ui.MenuSeparatorRenderer.CSS_CLASS,function(){return new goog.ui.Separator});goog.ui.MenuRenderer=function(b){goog.ui.ContainerRenderer.call(this,b||goog.a11y.aria.Role.MENU)};goog.inherits(goog.ui.MenuRenderer,goog.ui.ContainerRenderer);goog.addSingletonGetter(goog.ui.MenuRenderer);goog.ui.MenuRenderer.CSS_CLASS="goog-menu";goog.ui.MenuRenderer.prototype.canDecorate=function(b){return"UL"==b.tagName||goog.ui.MenuRenderer.superClass_.canDecorate.call(this,b)};goog.ui.MenuRenderer.prototype.getDecoratorForChild=function(b){return"HR"==b.tagName?new goog.ui.Separator:goog.ui.MenuRenderer.superClass_.getDecoratorForChild.call(this,b)};goog.ui.MenuRenderer.prototype.containsElement=function(d,c){return goog.dom.contains(d.getElement(),c)};goog.ui.MenuRenderer.prototype.getCssClass=function(){return goog.ui.MenuRenderer.CSS_CLASS};goog.ui.MenuRenderer.prototype.initializeDom=function(b){goog.ui.MenuRenderer.superClass_.initializeDom.call(this,b);b=b.getElement();goog.asserts.assert(b,"The menu DOM element cannot be null.");goog.a11y.aria.setState(b,goog.a11y.aria.State.HASPOPUP,"true")};goog.ui.MenuSeparator=function(b){goog.ui.Separator.call(this,goog.ui.MenuSeparatorRenderer.getInstance(),b)};goog.inherits(goog.ui.MenuSeparator,goog.ui.Separator);goog.ui.registry.setDecoratorByClassName(goog.ui.MenuSeparatorRenderer.CSS_CLASS,function(){return new goog.ui.Separator});goog.ui.Menu=function(d,c){goog.ui.Container.call(this,goog.ui.Container.Orientation.VERTICAL,c||goog.ui.MenuRenderer.getInstance(),d);this.setFocusable(!1)};goog.inherits(goog.ui.Menu,goog.ui.Container);goog.tagUnsealableClass(goog.ui.Menu);goog.ui.Menu.EventType={BEFORE_SHOW:goog.ui.Component.EventType.BEFORE_SHOW,SHOW:goog.ui.Component.EventType.SHOW,BEFORE_HIDE:goog.ui.Component.EventType.HIDE,HIDE:goog.ui.Component.EventType.HIDE};goog.ui.Menu.CSS_CLASS=goog.ui.MenuRenderer.CSS_CLASS;goog.ui.Menu.prototype.allowAutoFocus_=!0;goog.ui.Menu.prototype.allowHighlightDisabled_=!1;goog.ui.Menu.prototype.getCssClass=function(){return this.getRenderer().getCssClass()};goog.ui.Menu.prototype.containsElement=function(f){if(this.getRenderer().containsElement(this,f)){return !0}for(var e=0,h=this.getChildCount();e<h;e++){var g=this.getChildAt(e);if("function"==typeof g.containsElement&&g.containsElement(f)){return !0}}return !1};goog.ui.Menu.prototype.addItem=function(b){this.addChild(b,!0)};goog.ui.Menu.prototype.addItemAt=function(d,c){this.addChildAt(d,c,!0)};goog.ui.Menu.prototype.removeItem=function(b){(b=this.removeChild(b,!0))&&b.dispose()};goog.ui.Menu.prototype.removeItemAt=function(b){(b=this.removeChildAt(b,!0))&&b.dispose()};goog.ui.Menu.prototype.getItemAt=function(b){return this.getChildAt(b)};goog.ui.Menu.prototype.getItemCount=function(){return this.getChildCount()};goog.ui.Menu.prototype.getItems=function(){var b=[];this.forEachChild(function(a){b.push(a)});return b};goog.ui.Menu.prototype.setPosition=function(e,d){var f=this.isVisible();f||goog.style.setElementShown(this.getElement(),!0);goog.style.setPageOffset(this.getElement(),e,d);f||goog.style.setElementShown(this.getElement(),!1)};goog.ui.Menu.prototype.getPosition=function(){return this.isVisible()?goog.style.getPageOffset(this.getElement()):null};goog.ui.Menu.prototype.setAllowAutoFocus=function(b){(this.allowAutoFocus_=b)&&this.setFocusable(!0)};goog.ui.Menu.prototype.getAllowAutoFocus=function(){return this.allowAutoFocus_};goog.ui.Menu.prototype.setAllowHighlightDisabled=function(b){this.allowHighlightDisabled_=b};goog.ui.Menu.prototype.getAllowHighlightDisabled=function(){return this.allowHighlightDisabled_};goog.ui.Menu.prototype.setVisible=function(e,d,f){(d=goog.ui.Menu.superClass_.setVisible.call(this,e,d))&&e&&this.isInDocument()&&this.allowAutoFocus_&&this.getKeyEventTarget().focus();e&&f&&goog.isNumber(f.clientX)?this.openingCoords=new goog.math.Coordinate(f.clientX,f.clientY):this.openingCoords=null;return d};goog.ui.Menu.prototype.handleEnterItem=function(b){this.allowAutoFocus_&&this.getKeyEventTarget().focus();return goog.ui.Menu.superClass_.handleEnterItem.call(this,b)};goog.ui.Menu.prototype.highlightNextPrefix=function(d){var c=new RegExp("^"+goog.string.regExpEscape(d),"i");return this.highlightHelper(function(b,i){var j=0>b?0:b,h=!1;do{++b;b==i&&(b=0,h=!0);var e=this.getChildAt(b).getCaption();if(e&&e.match(c)){return b}}while(!h||b!=j);return this.getHighlightedIndex()},this.getHighlightedIndex())};goog.ui.Menu.prototype.canHighlightItem=function(b){return(this.allowHighlightDisabled_||b.isEnabled())&&b.isVisible()&&b.isSupportedState(goog.ui.Component.State.HOVER)};goog.ui.Menu.prototype.decorateInternal=function(b){this.decorateContent(b);goog.ui.Menu.superClass_.decorateInternal.call(this,b)};goog.ui.Menu.prototype.handleKeyEventInternal=function(d){var c=goog.ui.Menu.superClass_.handleKeyEventInternal.call(this,d);c||this.forEachChild(function(a){!c&&a.getMnemonic&&a.getMnemonic()==d.keyCode&&(this.isEnabled()&&this.setHighlighted(a),c=a.handleKeyEvent(d))},this);return c};goog.ui.Menu.prototype.setHighlightedIndex=function(b){goog.ui.Menu.superClass_.setHighlightedIndex.call(this,b);(b=this.getChildAt(b))&&goog.style.scrollIntoContainerView(b.getElement(),this.getElement())};goog.ui.Menu.prototype.decorateContent=function(f){var e=this.getRenderer();f=this.getDomHelper().getElementsByTagNameAndClass("DIV",e.getCssClass()+"-content",f);for(var h=f.length,g=0;g<h;g++){e.decorateChildren(this,f[g])}};goog.color={};goog.color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};goog.color.parse=function(e){var d={};e=String(e);var f=goog.color.prependHashIfNecessaryHelper(e);if(goog.color.isValidHexColor_(f)){return d.hex=goog.color.normalizeHex(f),d.type="hex",d}f=goog.color.isValidRgbColor_(e);if(f.length){return d.hex=goog.color.rgbArrayToHex(f),d.type="rgb",d}if(goog.color.names&&(f=goog.color.names[e.toLowerCase()])){return d.hex=f,d.type="named",d}throw Error(e+" is not a valid color string")};goog.color.isValidColor=function(d){var c=goog.color.prependHashIfNecessaryHelper(d);return !!(goog.color.isValidHexColor_(c)||goog.color.isValidRgbColor_(d).length||goog.color.names&&goog.color.names[d.toLowerCase()])};goog.color.parseRgb=function(d){var c=goog.color.isValidRgbColor_(d);if(!c.length){throw Error(d+" is not a valid RGB color")}return c};goog.color.hexToRgbStyle=function(b){return goog.color.rgbStyle_(goog.color.hexToRgb(b))};goog.color.hexTripletRe_=/#(.)(.)(.)/;goog.color.normalizeHex=function(b){if(!goog.color.isValidHexColor_(b)){throw Error("'"+b+"' is not a valid hex color")}4==b.length&&(b=b.replace(goog.color.hexTripletRe_,"#$1$1$2$2$3$3"));return b.toLowerCase()};goog.color.hexToRgb=function(e){e=goog.color.normalizeHex(e);var d=parseInt(e.substr(1,2),16),f=parseInt(e.substr(3,2),16);e=parseInt(e.substr(5,2),16);return[d,f,e]};goog.color.rgbToHex=function(e,d,f){e=Number(e);d=Number(d);f=Number(f);if(e!=(e&255)||d!=(d&255)||f!=(f&255)){throw Error('"('+e+","+d+","+f+'") is not a valid RGB color')}e=goog.color.prependZeroIfNecessaryHelper(e.toString(16));d=goog.color.prependZeroIfNecessaryHelper(d.toString(16));f=goog.color.prependZeroIfNecessaryHelper(f.toString(16));return"#"+e+d+f};goog.color.rgbArrayToHex=function(b){return goog.color.rgbToHex(b[0],b[1],b[2])};goog.color.rgbToHsl=function(j,i,p){j/=255;i/=255;p/=255;var o=Math.max(j,i,p),n=Math.min(j,i,p),m=0,l=0,k=0.5*(o+n);o!=n&&(o==j?m=60*(i-p)/(o-n):o==i?m=60*(p-j)/(o-n)+120:o==p&&(m=60*(j-i)/(o-n)+240),l=0<k&&0.5>=k?(o-n)/(2*k):(o-n)/(2-2*k));return[Math.round(m+360)%360,l,k]};goog.color.rgbArrayToHsl=function(b){return goog.color.rgbToHsl(b[0],b[1],b[2])};goog.color.hueToRgb_=function(e,d,f){0>f?f+=1:1<f&&--f;return 1>6*f?e+6*(d-e)*f:1>2*f?d:2>3*f?e+(d-e)*(2/3-f)*6:e};goog.color.hslToRgb=function(g,f,j){g/=360;if(0==f){j=f=g=255*j}else{var i,h;h=0.5>j?j*(1+f):j+f-f*j;i=2*j-h;j=255*goog.color.hueToRgb_(i,h,g+1/3);f=255*goog.color.hueToRgb_(i,h,g);g=255*goog.color.hueToRgb_(i,h,g-1/3)}return[Math.round(j),Math.round(f),Math.round(g)]};goog.color.hslArrayToRgb=function(b){return goog.color.hslToRgb(b[0],b[1],b[2])};goog.color.validHexColorRe_=/^#(?:[0-9a-f]{3}){1,2}$/i;goog.color.isValidHexColor_=function(b){return goog.color.validHexColorRe_.test(b)};goog.color.normalizedHexColorRe_=/^#[0-9a-f]{6}$/;goog.color.isNormalizedHexColor_=function(b){return goog.color.normalizedHexColorRe_.test(b)};goog.color.rgbColorRe_=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;goog.color.isValidRgbColor_=function(e){var d=e.match(goog.color.rgbColorRe_);if(d){e=Number(d[1]);var f=Number(d[2]),d=Number(d[3]);if(0<=e&&255>=e&&0<=f&&255>=f&&0<=d&&255>=d){return[e,f,d]}}return[]};goog.color.prependZeroIfNecessaryHelper=function(b){return 1==b.length?"0"+b:b};goog.color.prependHashIfNecessaryHelper=function(b){return"#"==b.charAt(0)?b:"#"+b};goog.color.rgbStyle_=function(b){return"rgb("+b.join(",")+")"};goog.color.hsvToRgb=function(r,q,p){var o=0,n=0,m=0;if(0==q){m=n=o=p}else{var l=Math.floor(r/60),j=r/60-l;r=p*(1-q);var i=p*(1-q*j);q=p*(1-q*(1-j));switch(l){case 1:o=i;n=p;m=r;break;case 2:o=r;n=p;m=q;break;case 3:o=r;n=i;m=p;break;case 4:o=q;n=r;m=p;break;case 5:o=p;n=r;m=i;break;case 6:case 0:o=p,n=q,m=r}}return[Math.floor(o),Math.floor(n),Math.floor(m)]};goog.color.rgbToHsv=function(h,g,l){var k=Math.max(Math.max(h,g),l),j=Math.min(Math.min(h,g),l);if(j==k){j=h=0}else{var i=k-j,j=i/k;h=60*(h==k?(g-l)/i:g==k?2+(l-h)/i:4+(h-g)/i);0>h&&(h+=360);360<h&&(h-=360)}return[h,j,k]};goog.color.rgbArrayToHsv=function(b){return goog.color.rgbToHsv(b[0],b[1],b[2])};goog.color.hsvArrayToRgb=function(b){return goog.color.hsvToRgb(b[0],b[1],b[2])};goog.color.hexToHsl=function(b){b=goog.color.hexToRgb(b);return goog.color.rgbToHsl(b[0],b[1],b[2])};goog.color.hslToHex=function(e,d,f){return goog.color.rgbArrayToHex(goog.color.hslToRgb(e,d,f))};goog.color.hslArrayToHex=function(b){return goog.color.rgbArrayToHex(goog.color.hslToRgb(b[0],b[1],b[2]))};goog.color.hexToHsv=function(b){return goog.color.rgbArrayToHsv(goog.color.hexToRgb(b))};goog.color.hsvToHex=function(e,d,f){return goog.color.rgbArrayToHex(goog.color.hsvToRgb(e,d,f))};goog.color.hsvArrayToHex=function(b){return goog.color.hsvToHex(b[0],b[1],b[2])};goog.color.hslDistance=function(f,e){var h,g;h=0.5>=f[2]?f[1]*f[2]:f[1]*(1-f[2]);g=0.5>=e[2]?e[1]*e[2]:e[1]*(1-e[2]);return(f[2]-e[2])*(f[2]-e[2])+h*h+g*g-2*h*g*Math.cos(2*(f[0]/360-e[0]/360)*Math.PI)};goog.color.blend=function(e,d,f){f=goog.math.clamp(f,0,1);return[Math.round(f*e[0]+(1-f)*d[0]),Math.round(f*e[1]+(1-f)*d[1]),Math.round(f*e[2]+(1-f)*d[2])]};goog.color.darken=function(d,c){return goog.color.blend([0,0,0],d,c)};goog.color.lighten=function(d,c){return goog.color.blend([255,255,255],d,c)};goog.color.highContrast=function(f,e){for(var h=[],g=0;g<e.length;g++){h.push({color:e[g],diff:goog.color.yiqBrightnessDiff_(e[g],f)+goog.color.colorDiff_(e[g],f)})}h.sort(function(d,c){return c.diff-d.diff});return h[0].color};goog.color.yiqBrightness_=function(b){return Math.round((299*b[0]+587*b[1]+114*b[2])/1000)};goog.color.yiqBrightnessDiff_=function(d,c){return Math.abs(goog.color.yiqBrightness_(d)-goog.color.yiqBrightness_(c))};goog.color.colorDiff_=function(d,c){return Math.abs(d[0]-c[0])+Math.abs(d[1]-c[1])+Math.abs(d[2]-c[2])};goog.iter={};goog.iter.StopIteration="StopIteration" in goog.global?goog.global.StopIteration:{message:"StopIteration",stack:""};goog.iter.Iterator=function(){};goog.iter.Iterator.prototype.next=function(){throw goog.iter.StopIteration};goog.iter.Iterator.prototype.__iterator__=function(b){return this};goog.iter.toIterator=function(e){if(e instanceof goog.iter.Iterator){return e}if("function"==typeof e.__iterator__){return e.__iterator__(!1)}if(goog.isArrayLike(e)){var d=0,f=new goog.iter.Iterator;f.next=function(){for(;;){if(d>=e.length){throw goog.iter.StopIteration}if(d in e){return e[d++]}d++}};return f}throw Error("Not implemented")};goog.iter.forEach=function(f,e,h){if(goog.isArrayLike(f)){try{goog.array.forEach(f,e,h)}catch(g){if(g!==goog.iter.StopIteration){throw g}}}else{f=goog.iter.toIterator(f);try{for(;;){e.call(h,f.next(),void 0,f)}}catch(g){if(g!==goog.iter.StopIteration){throw g}}}};goog.iter.filter=function(f,e,h){var g=goog.iter.toIterator(f);f=new goog.iter.Iterator;f.next=function(){for(;;){var b=g.next();if(e.call(h,b,void 0,g)){return b}}};return f};goog.iter.filterFalse=function(e,d,f){return goog.iter.filter(e,goog.functions.not(d),f)};goog.iter.range=function(i,h,n){var m=0,l=i,k=n||1;1<arguments.length&&(m=i,l=h);if(0==k){throw Error("Range step argument must not be zero")}var j=new goog.iter.Iterator;j.next=function(){if(0<k&&m>=l||0>k&&m<=l){throw goog.iter.StopIteration}var b=m;m+=k;return b};return j};goog.iter.join=function(d,c){return goog.iter.toArray(d).join(c)};goog.iter.map=function(f,e,h){var g=goog.iter.toIterator(f);f=new goog.iter.Iterator;f.next=function(){var b=g.next();return e.call(h,b,void 0,g)};return f};goog.iter.reduce=function(g,f,j,i){var h=j;goog.iter.forEach(g,function(b){h=f.call(i,h,b)});return h};goog.iter.some=function(f,e,h){f=goog.iter.toIterator(f);try{for(;;){if(e.call(h,f.next(),void 0,f)){return !0}}}catch(g){if(g!==goog.iter.StopIteration){throw g}}return !1};goog.iter.every=function(f,e,h){f=goog.iter.toIterator(f);try{for(;;){if(!e.call(h,f.next(),void 0,f)){return !1}}}catch(g){if(g!==goog.iter.StopIteration){throw g}}return !0};goog.iter.chain=function(b){return goog.iter.chainFromIterable(arguments)};goog.iter.chainFromIterable=function(e){var d=goog.iter.toIterator(e);e=new goog.iter.Iterator;var f=null;e.next=function(){for(;;){if(null==f){var b=d.next();f=goog.iter.toIterator(b)}try{return f.next()}catch(c){if(c!==goog.iter.StopIteration){throw c}f=null}}};return e};goog.iter.dropWhile=function(g,f,j){var i=goog.iter.toIterator(g);g=new goog.iter.Iterator;var h=!0;g.next=function(){for(;;){var b=i.next();if(!h||!f.call(j,b,void 0,i)){return h=!1,b}}};return g};goog.iter.takeWhile=function(f,e,h){var g=goog.iter.toIterator(f);f=new goog.iter.Iterator;f.next=function(){var b=g.next();if(e.call(h,b,void 0,g)){return b}throw goog.iter.StopIteration};return f};goog.iter.toArray=function(d){if(goog.isArrayLike(d)){return goog.array.toArray(d)}d=goog.iter.toIterator(d);var c=[];goog.iter.forEach(d,function(b){c.push(b)});return c};goog.iter.equals=function(f,e,h){f=goog.iter.zipLongest({},f,e);var g=h||goog.array.defaultCompareEquality;return goog.iter.every(f,function(b){return g(b[0],b[1])})};goog.iter.nextOrValue=function(e,d){try{return goog.iter.toIterator(e).next()}catch(f){if(f!=goog.iter.StopIteration){throw f}return d}};goog.iter.product=function(f){if(goog.array.some(arguments,function(b){return !b.length})||!arguments.length){return new goog.iter.Iterator}var e=new goog.iter.Iterator,h=arguments,g=goog.array.repeat(0,h.length);e.next=function(){if(g){for(var d=goog.array.map(g,function(j,i){return h[i][j]}),c=g.length-1;0<=c;c--){goog.asserts.assert(g);if(g[c]<h[c].length-1){g[c]++;break}if(0==c){g=null;break}g[c]=0}return d}throw goog.iter.StopIteration};return e};goog.iter.cycle=function(g){var f=goog.iter.toIterator(g),j=[],i=0;g=new goog.iter.Iterator;var h=!1;g.next=function(){var b=null;if(!h){try{return b=f.next(),j.push(b),b}catch(c){if(c!=goog.iter.StopIteration||goog.array.isEmpty(j)){throw c}h=!0}}b=j[i];i=(i+1)%j.length;return b};return g};goog.iter.count=function(g,f){var j=g||0,i=goog.isDef(f)?f:1,h=new goog.iter.Iterator;h.next=function(){var b=j;j+=i;return b};return h};goog.iter.repeat=function(d){var c=new goog.iter.Iterator;c.next=goog.functions.constant(d);return c};goog.iter.accumulate=function(e){var d=goog.iter.toIterator(e),f=0;e=new goog.iter.Iterator;e.next=function(){return f+=d.next()};return e};goog.iter.zip=function(f){var e=arguments,h=new goog.iter.Iterator;if(0<e.length){var g=goog.array.map(e,goog.iter.toIterator);h.next=function(){return goog.array.map(g,function(b){return b.next()})}}return h};goog.iter.zipLongest=function(g,f){var j=goog.array.slice(arguments,1),i=new goog.iter.Iterator;if(0<j.length){var h=goog.array.map(j,goog.iter.toIterator);i.next=function(){var a=!1,d=goog.array.map(h,function(k){var b;try{b=k.next(),a=!0}catch(e){if(e!==goog.iter.StopIteration){throw e}b=g}return b});if(!a){throw goog.iter.StopIteration}return d}}return i};goog.iter.compress=function(e,d){var f=goog.iter.toIterator(d);return goog.iter.filter(e,function(){return !!f.next()})};goog.iter.GroupByIterator_=function(d,c){this.iterator=goog.iter.toIterator(d);this.keyFunc=c||goog.functions.identity};goog.inherits(goog.iter.GroupByIterator_,goog.iter.Iterator);goog.iter.GroupByIterator_.prototype.next=function(){for(;this.currentKey==this.targetKey;){this.currentValue=this.iterator.next(),this.currentKey=this.keyFunc(this.currentValue)}this.targetKey=this.currentKey;return[this.currentKey,this.groupItems_(this.targetKey)]};goog.iter.GroupByIterator_.prototype.groupItems_=function(e){for(var d=[];this.currentKey==e;){d.push(this.currentValue);try{this.currentValue=this.iterator.next()}catch(f){if(f!==goog.iter.StopIteration){throw f}break}this.currentKey=this.keyFunc(this.currentValue)}return d};goog.iter.groupBy=function(d,c){return new goog.iter.GroupByIterator_(d,c)};goog.iter.starMap=function(f,e,h){var g=goog.iter.toIterator(f);f=new goog.iter.Iterator;f.next=function(){var b=goog.iter.toArray(g.next());return e.apply(h,goog.array.concat(b,void 0,g))};return f};goog.iter.tee=function(h,g){var l=goog.iter.toIterator(h),k=goog.isNumber(g)?g:2,j=goog.array.map(goog.array.range(k),function(){return[]}),i=function(){var b=l.next();goog.array.forEach(j,function(a){a.push(b)})};return goog.array.map(j,function(d){var c=new goog.iter.Iterator;c.next=function(){goog.array.isEmpty(d)&&i();goog.asserts.assert(!goog.array.isEmpty(d));return d.shift()};return c})};goog.iter.enumerate=function(d,c){return goog.iter.zip(goog.iter.count(c),d)};goog.iter.limit=function(g,f){goog.asserts.assert(goog.math.isInt(f)&&0<=f);var j=goog.iter.toIterator(g),i=new goog.iter.Iterator,h=f;i.next=function(){if(0<h--){return j.next()}throw goog.iter.StopIteration};return i};goog.iter.consume=function(e,d){goog.asserts.assert(goog.math.isInt(d)&&0<=d);for(var f=goog.iter.toIterator(e);0<d--;){goog.iter.nextOrValue(f,null)}return f};goog.iter.slice=function(e,d,f){goog.asserts.assert(goog.math.isInt(d)&&0<=d);e=goog.iter.consume(e,d);goog.isNumber(f)&&(goog.asserts.assert(goog.math.isInt(f)&&f>=d),e=goog.iter.limit(e,f-d));return e};goog.iter.hasDuplicates_=function(d){var c=[];goog.array.removeDuplicates(d,c);return d.length!=c.length};goog.iter.permutations=function(f,e){var h=goog.iter.toArray(f),g=goog.isNumber(e)?e:h.length,h=goog.array.repeat(h,g),h=goog.iter.product.apply(void 0,h);return goog.iter.filter(h,function(b){return !goog.iter.hasDuplicates_(b)})};goog.iter.combinations=function(h,g){function l(b){return k[b]}var k=goog.iter.toArray(h),j=goog.iter.range(k.length),j=goog.iter.permutations(j,g),i=goog.iter.filter(j,function(b){return goog.array.isSorted(b)}),j=new goog.iter.Iterator;j.next=function(){return goog.array.map(i.next(),l)};return j};goog.iter.combinationsWithReplacement=function(h,g){function l(b){return k[b]}var k=goog.iter.toArray(h),j=goog.array.range(k.length),j=goog.array.repeat(j,g),j=goog.iter.product.apply(void 0,j),i=goog.iter.filter(j,function(b){return goog.array.isSorted(b)}),j=new goog.iter.Iterator;j.next=function(){return goog.array.map(i.next(),l)};return j};goog.dom.TagWalkType={START_TAG:1,OTHER:0,END_TAG:-1};goog.dom.TagIterator=function(g,f,j,i,h){this.reversed=!!f;this.node=null;this.tagType=goog.dom.TagWalkType.OTHER;this.started_=!1;this.constrained=!j;g&&this.setPosition(g,i);this.depth=void 0!=h?h:this.tagType||0;this.reversed&&(this.depth*=-1)};goog.inherits(goog.dom.TagIterator,goog.iter.Iterator);goog.dom.TagIterator.prototype.setPosition=function(e,d,f){if(this.node=e){goog.isNumber(d)?this.tagType=d:this.tagType=this.node.nodeType!=goog.dom.NodeType.ELEMENT?goog.dom.TagWalkType.OTHER:this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG}goog.isNumber(f)&&(this.depth=f)};goog.dom.TagIterator.prototype.copyFrom=function(b){this.node=b.node;this.tagType=b.tagType;this.depth=b.depth;this.reversed=b.reversed;this.constrained=b.constrained};goog.dom.TagIterator.prototype.clone=function(){return new goog.dom.TagIterator(this.node,this.reversed,!this.constrained,this.tagType,this.depth)};goog.dom.TagIterator.prototype.skipTag=function(){var b=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;this.tagType==b&&(this.tagType=-1*b,this.depth+=this.tagType*(this.reversed?-1:1))};goog.dom.TagIterator.prototype.restartTag=function(){var b=this.reversed?goog.dom.TagWalkType.START_TAG:goog.dom.TagWalkType.END_TAG;this.tagType==b&&(this.tagType=-1*b,this.depth+=this.tagType*(this.reversed?-1:1))};goog.dom.TagIterator.prototype.next=function(){var e;if(this.started_){if(!this.node||this.constrained&&0==this.depth){throw goog.iter.StopIteration}e=this.node;var d=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;if(this.tagType==d){var f=this.reversed?e.lastChild:e.firstChild;f?this.setPosition(f):this.setPosition(e,-1*d)}else{(f=this.reversed?e.previousSibling:e.nextSibling)?this.setPosition(f):this.setPosition(e.parentNode,-1*d)}this.depth+=this.tagType*(this.reversed?-1:1)}else{this.started_=!0}e=this.node;if(!this.node){throw goog.iter.StopIteration}return e};goog.dom.TagIterator.prototype.isStarted=function(){return this.started_};goog.dom.TagIterator.prototype.isStartTag=function(){return this.tagType==goog.dom.TagWalkType.START_TAG};goog.dom.TagIterator.prototype.isEndTag=function(){return this.tagType==goog.dom.TagWalkType.END_TAG};goog.dom.TagIterator.prototype.isNonElement=function(){return this.tagType==goog.dom.TagWalkType.OTHER};goog.dom.TagIterator.prototype.equals=function(b){return b.node==this.node&&(!this.node||b.tagType==this.tagType)};goog.dom.TagIterator.prototype.splice=function(f){var e=this.node;this.restartTag();this.reversed=!this.reversed;goog.dom.TagIterator.prototype.next.call(this);this.reversed=!this.reversed;for(var h=goog.isArrayLike(arguments[0])?arguments[0]:arguments,g=h.length-1;0<=g;g--){goog.dom.insertSiblingAfter(h[g],e)}goog.dom.removeNode(e)};goog.dom.NodeIterator=function(f,e,h,g){goog.dom.TagIterator.call(this,f,e,h,null,g)};goog.inherits(goog.dom.NodeIterator,goog.dom.TagIterator);goog.dom.NodeIterator.prototype.next=function(){do{goog.dom.NodeIterator.superClass_.next.call(this)}while(this.isEndTag());return this.node};goog.ui.PaletteRenderer=function(){goog.ui.ControlRenderer.call(this)};goog.inherits(goog.ui.PaletteRenderer,goog.ui.ControlRenderer);goog.addSingletonGetter(goog.ui.PaletteRenderer);goog.ui.PaletteRenderer.cellId_=0;goog.ui.PaletteRenderer.CSS_CLASS="goog-palette";goog.ui.PaletteRenderer.prototype.createDom=function(d){var c=this.getClassNames(d);d=d.getDomHelper().createDom("DIV",c?c.join(" "):null,this.createGrid(d.getContent(),d.getSize(),d.getDomHelper()));goog.a11y.aria.setRole(d,goog.a11y.aria.Role.GRID);return d};goog.ui.PaletteRenderer.prototype.createGrid=function(r,q,p){for(var o=[],n=0,m=0;n<q.height;n++){for(var l=[],j=0;j<q.width;j++){var i=r&&r[m++];l.push(this.createCell(i,p))}o.push(this.createRow(l,p))}return this.createTable(o,p)};goog.ui.PaletteRenderer.prototype.createTable=function(e,d){var f=d.createDom("TABLE",this.getCssClass()+"-table",d.createDom("TBODY",this.getCssClass()+"-body",e));f.cellSpacing=0;f.cellPadding=0;return f};goog.ui.PaletteRenderer.prototype.createRow=function(e,d){var f=d.createDom("TR",this.getCssClass()+"-row",e);goog.a11y.aria.setRole(f,goog.a11y.aria.Role.ROW);return f};goog.ui.PaletteRenderer.prototype.createCell=function(f,e){var h=e.createDom("TD",{"class":this.getCssClass()+"-cell",id:this.getCssClass()+"-cell-"+goog.ui.PaletteRenderer.cellId_++},f);goog.a11y.aria.setRole(h,goog.a11y.aria.Role.GRIDCELL);goog.a11y.aria.setState(h,goog.a11y.aria.State.SELECTED,!1);if(!goog.dom.getTextContent(h)&&!goog.a11y.aria.getLabel(h)){var g=this.findAriaLabelForCell_(h);g&&goog.a11y.aria.setLabel(h,g)}return h};goog.ui.PaletteRenderer.prototype.findAriaLabelForCell_=function(e){e=new goog.dom.NodeIterator(e);for(var d="",f;!d&&(f=goog.iter.nextOrValue(e,null));){f.nodeType==goog.dom.NodeType.ELEMENT&&(d=goog.a11y.aria.getLabel(f)||f.title)}return d};goog.ui.PaletteRenderer.prototype.canDecorate=function(b){return !1};goog.ui.PaletteRenderer.prototype.decorate=function(d,c){return null};goog.ui.PaletteRenderer.prototype.setContent=function(j,i){if(j){var p=goog.dom.getElementsByTagNameAndClass("TBODY",this.getCssClass()+"-body",j)[0];if(p){var o=0;goog.array.forEach(p.rows,function(b){goog.array.forEach(b.cells,function(d){goog.dom.removeChildren(d);if(i){var e=i[o++];e&&goog.dom.appendChild(d,e)}})});if(o<i.length){for(var n=[],m=goog.dom.getDomHelper(j),l=p.rows[0].cells.length;o<i.length;){var k=i[o++];n.push(this.createCell(k,m));n.length==l&&(k=this.createRow(n,m),goog.dom.appendChild(p,k),n.length=0)}if(0<n.length){for(;n.length<l;){n.push(this.createCell("",m))}k=this.createRow(n,m);goog.dom.appendChild(p,k)}}}goog.style.setUnselectable(j,!0,goog.userAgent.GECKO)}};goog.ui.PaletteRenderer.prototype.getContainingItem=function(e,d){for(var f=e.getElement();d&&d.nodeType==goog.dom.NodeType.ELEMENT&&d!=f;){if("TD"==d.tagName&&goog.dom.classlist.contains(d,this.getCssClass()+"-cell")){return d.firstChild}d=d.parentNode}return null};goog.ui.PaletteRenderer.prototype.highlightCell=function(e,d,f){d&&(d=this.getCellForItem(d),goog.asserts.assert(d),goog.dom.classlist.enable(d,this.getCssClass()+"-cell-hover",f),f?goog.a11y.aria.setState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT,d.id):d.id==goog.a11y.aria.getState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT)&&goog.a11y.aria.removeState(e.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT))};goog.ui.PaletteRenderer.prototype.getCellForItem=function(b){return b?b.parentNode:null};goog.ui.PaletteRenderer.prototype.selectCell=function(e,d,f){d&&(e=d.parentNode,goog.dom.classlist.enable(e,this.getCssClass()+"-cell-selected",f),goog.a11y.aria.setState(e,goog.a11y.aria.State.SELECTED,f))};goog.ui.PaletteRenderer.prototype.getCssClass=function(){return goog.ui.PaletteRenderer.CSS_CLASS};goog.ui.SelectionModel=function(b){goog.events.EventTarget.call(this);this.items_=[];this.addItems(b)};goog.inherits(goog.ui.SelectionModel,goog.events.EventTarget);goog.tagUnsealableClass(goog.ui.SelectionModel);goog.ui.SelectionModel.prototype.selectedItem_=null;goog.ui.SelectionModel.prototype.selectionHandler_=null;goog.ui.SelectionModel.prototype.getSelectionHandler=function(){return this.selectionHandler_};goog.ui.SelectionModel.prototype.setSelectionHandler=function(b){this.selectionHandler_=b};goog.ui.SelectionModel.prototype.getItemCount=function(){return this.items_.length};goog.ui.SelectionModel.prototype.indexOfItem=function(b){return b?goog.array.indexOf(this.items_,b):-1};goog.ui.SelectionModel.prototype.getFirst=function(){return this.items_[0]};goog.ui.SelectionModel.prototype.getLast=function(){return this.items_[this.items_.length-1]};goog.ui.SelectionModel.prototype.getItemAt=function(b){return this.items_[b]||null};goog.ui.SelectionModel.prototype.addItems=function(b){b&&(goog.array.forEach(b,function(c){this.selectItem_(c,!1)},this),goog.array.extend(this.items_,b))};goog.ui.SelectionModel.prototype.addItem=function(b){this.addItemAt(b,this.getItemCount())};goog.ui.SelectionModel.prototype.addItemAt=function(d,c){d&&(this.selectItem_(d,!1),goog.array.insertAt(this.items_,d,c))};goog.ui.SelectionModel.prototype.removeItem=function(b){b&&goog.array.remove(this.items_,b)&&b==this.selectedItem_&&(this.selectedItem_=null,this.dispatchEvent(goog.events.EventType.SELECT))};goog.ui.SelectionModel.prototype.removeItemAt=function(b){this.removeItem(this.getItemAt(b))};goog.ui.SelectionModel.prototype.getSelectedItem=function(){return this.selectedItem_};goog.ui.SelectionModel.prototype.getItems=function(){return goog.array.clone(this.items_)};goog.ui.SelectionModel.prototype.setSelectedItem=function(b){b!=this.selectedItem_&&(this.selectItem_(this.selectedItem_,!1),this.selectedItem_=b,this.selectItem_(b,!0));this.dispatchEvent(goog.events.EventType.SELECT)};goog.ui.SelectionModel.prototype.getSelectedIndex=function(){return this.indexOfItem(this.selectedItem_)};goog.ui.SelectionModel.prototype.setSelectedIndex=function(b){this.setSelectedItem(this.getItemAt(b))};goog.ui.SelectionModel.prototype.clear=function(){goog.array.clear(this.items_);this.selectedItem_=null};goog.ui.SelectionModel.prototype.disposeInternal=function(){goog.ui.SelectionModel.superClass_.disposeInternal.call(this);delete this.items_;this.selectedItem_=null};goog.ui.SelectionModel.prototype.selectItem_=function(d,c){d&&("function"==typeof this.selectionHandler_?this.selectionHandler_(d,c):"function"==typeof d.setSelected&&d.setSelected(c))};goog.ui.Palette=function(e,d,f){goog.ui.Control.call(this,e,d||goog.ui.PaletteRenderer.getInstance(),f);this.setAutoStates(goog.ui.Component.State.CHECKED|goog.ui.Component.State.SELECTED|goog.ui.Component.State.OPENED,!1);this.currentCellControl_=new goog.ui.Palette.CurrentCell_;this.currentCellControl_.setParentEventTarget(this);this.lastHighlightedIndex_=-1};goog.inherits(goog.ui.Palette,goog.ui.Control);goog.tagUnsealableClass(goog.ui.Palette);goog.ui.Palette.EventType={AFTER_HIGHLIGHT:goog.events.getUniqueId("afterhighlight")};goog.ui.Palette.prototype.size_=null;goog.ui.Palette.prototype.highlightedIndex_=-1;goog.ui.Palette.prototype.selectionModel_=null;goog.ui.Palette.prototype.disposeInternal=function(){goog.ui.Palette.superClass_.disposeInternal.call(this);this.selectionModel_&&(this.selectionModel_.dispose(),this.selectionModel_=null);this.size_=null;this.currentCellControl_.dispose()};goog.ui.Palette.prototype.setContentInternal=function(b){goog.ui.Palette.superClass_.setContentInternal.call(this,b);this.adjustSize_();this.selectionModel_?(this.selectionModel_.clear(),this.selectionModel_.addItems(b)):(this.selectionModel_=new goog.ui.SelectionModel(b),this.selectionModel_.setSelectionHandler(goog.bind(this.selectItem_,this)),this.getHandler().listen(this.selectionModel_,goog.events.EventType.SELECT,this.handleSelectionChange));this.highlightedIndex_=-1};goog.ui.Palette.prototype.getCaption=function(){return""};goog.ui.Palette.prototype.setCaption=function(b){};goog.ui.Palette.prototype.handleMouseOver=function(d){goog.ui.Palette.superClass_.handleMouseOver.call(this,d);var c=this.getRenderer().getContainingItem(this,d.target);c&&d.relatedTarget&&goog.dom.contains(c,d.relatedTarget)||c!=this.getHighlightedItem()&&this.setHighlightedItem(c)};goog.ui.Palette.prototype.handleMouseDown=function(b){goog.ui.Palette.superClass_.handleMouseDown.call(this,b);this.isActive()&&(b=this.getRenderer().getContainingItem(this,b.target),b!=this.getHighlightedItem()&&this.setHighlightedItem(b))};goog.ui.Palette.prototype.performActionInternal=function(d){var c=this.getHighlightedItem();return c?(d&&this.shouldSelectHighlightedItem_(d)&&this.setSelectedItem(c),goog.ui.Palette.superClass_.performActionInternal.call(this,d)):!1};goog.ui.Palette.prototype.shouldSelectHighlightedItem_=function(b){return this.getSelectedItem()?"mouseup"!=b.type?!0:!!this.getRenderer().getContainingItem(this,b.target):!0};goog.ui.Palette.prototype.handleKeyEvent=function(f){var e=this.getContent(),e=e?e.length:0,h=this.size_.width;if(0==e||!this.isEnabled()){return !1}if(f.keyCode==goog.events.KeyCodes.ENTER||f.keyCode==goog.events.KeyCodes.SPACE){return this.performActionInternal(f)}if(f.keyCode==goog.events.KeyCodes.HOME){return this.setHighlightedIndex(0),!0}if(f.keyCode==goog.events.KeyCodes.END){return this.setHighlightedIndex(e-1),!0}var g=0>this.highlightedIndex_?this.getSelectedIndex():this.highlightedIndex_;switch(f.keyCode){case goog.events.KeyCodes.LEFT:if(-1==g||0==g){g=e}this.setHighlightedIndex(g-1);f.preventDefault();return !0;case goog.events.KeyCodes.RIGHT:return g==e-1&&(g=-1),this.setHighlightedIndex(g+1),f.preventDefault(),!0;case goog.events.KeyCodes.UP:-1==g&&(g=e+h-1);if(g>=h){return this.setHighlightedIndex(g-h),f.preventDefault(),!0}break;case goog.events.KeyCodes.DOWN:if(-1==g&&(g=-h),g<e-h){return this.setHighlightedIndex(g+h),f.preventDefault(),!0}}return !1};goog.ui.Palette.prototype.handleSelectionChange=function(b){};goog.ui.Palette.prototype.getSize=function(){return this.size_};goog.ui.Palette.prototype.setSize=function(d,c){if(this.getElement()){throw Error(goog.ui.Component.Error.ALREADY_RENDERED)}this.size_=goog.isNumber(d)?new goog.math.Size(d,c):d;this.adjustSize_()};goog.ui.Palette.prototype.getHighlightedIndex=function(){return this.highlightedIndex_};goog.ui.Palette.prototype.getHighlightedItem=function(){var b=this.getContent();return b&&b[this.highlightedIndex_]};goog.ui.Palette.prototype.getHighlightedCellElement_=function(){return this.getRenderer().getCellForItem(this.getHighlightedItem())};goog.ui.Palette.prototype.setHighlightedIndex=function(b){b!=this.highlightedIndex_&&(this.highlightIndex_(this.highlightedIndex_,!1),this.lastHighlightedIndex_=this.highlightedIndex_,this.highlightedIndex_=b,this.highlightIndex_(b,!0),this.dispatchEvent(goog.ui.Palette.EventType.AFTER_HIGHLIGHT))};goog.ui.Palette.prototype.setHighlightedItem=function(d){var c=this.getContent();this.setHighlightedIndex(c&&d?goog.array.indexOf(c,d):-1)};goog.ui.Palette.prototype.getSelectedIndex=function(){return this.selectionModel_?this.selectionModel_.getSelectedIndex():-1};goog.ui.Palette.prototype.getSelectedItem=function(){return this.selectionModel_?this.selectionModel_.getSelectedItem():null};goog.ui.Palette.prototype.setSelectedIndex=function(b){this.selectionModel_&&this.selectionModel_.setSelectedIndex(b)};goog.ui.Palette.prototype.setSelectedItem=function(b){this.selectionModel_&&this.selectionModel_.setSelectedItem(b)};goog.ui.Palette.prototype.highlightIndex_=function(f,e){if(this.getElement()){var h=this.getContent();if(h&&0<=f&&f<h.length){var g=this.getHighlightedCellElement_();this.currentCellControl_.getElement()!=g&&this.currentCellControl_.setElementInternal(g);this.currentCellControl_.tryHighlight(e)&&this.getRenderer().highlightCell(this,h[f],e)}}};goog.ui.Palette.prototype.setHighlighted=function(b){b&&-1==this.highlightedIndex_?this.setHighlightedIndex(-1<this.lastHighlightedIndex_?this.lastHighlightedIndex_:0):b||this.setHighlightedIndex(-1);goog.ui.Palette.superClass_.setHighlighted.call(this,b)};goog.ui.Palette.prototype.selectItem_=function(d,c){this.getElement()&&this.getRenderer().selectCell(this,d,c)};goog.ui.Palette.prototype.adjustSize_=function(){var b=this.getContent();if(b){if(this.size_&&this.size_.width){if(b=Math.ceil(b.length/this.size_.width),!goog.isNumber(this.size_.height)||this.size_.height<b){this.size_.height=b}}else{b=Math.ceil(Math.sqrt(b.length)),this.size_=new goog.math.Size(b,b)}}else{this.size_=new goog.math.Size(0,0)}};goog.ui.Palette.CurrentCell_=function(){goog.ui.Control.call(this,null);this.setDispatchTransitionEvents(goog.ui.Component.State.HOVER,!0)};goog.inherits(goog.ui.Palette.CurrentCell_,goog.ui.Control);goog.ui.Palette.CurrentCell_.prototype.tryHighlight=function(b){this.setHighlighted(b);return this.isHighlighted()==b};goog.ui.ColorPalette=function(e,d,f){this.colors_=e||[];goog.ui.Palette.call(this,null,d||goog.ui.PaletteRenderer.getInstance(),f);this.setColors(this.colors_)};goog.inherits(goog.ui.ColorPalette,goog.ui.Palette);goog.tagUnsealableClass(goog.ui.ColorPalette);goog.ui.ColorPalette.prototype.normalizedColors_=null;goog.ui.ColorPalette.prototype.labels_=null;goog.ui.ColorPalette.prototype.getColors=function(){return this.colors_};goog.ui.ColorPalette.prototype.setColors=function(d,c){this.colors_=d;this.labels_=c||null;this.normalizedColors_=null;this.setContent(this.createColorNodes())};goog.ui.ColorPalette.prototype.getSelectedColor=function(){var b=this.getSelectedItem();return b?(b=goog.style.getStyle(b,"background-color"),goog.ui.ColorPalette.parseColor_(b)):null};goog.ui.ColorPalette.prototype.setSelectedColor=function(b){b=goog.ui.ColorPalette.parseColor_(b);this.normalizedColors_||(this.normalizedColors_=goog.array.map(this.colors_,function(c){return goog.ui.ColorPalette.parseColor_(c)}));this.setSelectedIndex(b?goog.array.indexOf(this.normalizedColors_,b):-1)};goog.ui.ColorPalette.prototype.createColorNodes=function(){return goog.array.map(this.colors_,function(e,d){var f=this.getDomHelper().createDom("DIV",{"class":this.getRenderer().getCssClass()+"-colorswatch",style:"background-color:"+e});f.title=this.labels_&&this.labels_[d]?this.labels_[d]:"#"==e.charAt(0)?"RGB ("+goog.color.hexToRgb(e).join(", ")+")":e;return f},this)};goog.ui.ColorPalette.parseColor_=function(d){if(d){try{return goog.color.parse(d).hex}catch(c){}}return null};goog.ui.ColorPicker=function(d,c){goog.ui.Component.call(this,d);this.colorPalette_=c||null;this.getHandler().listen(this,goog.ui.Component.EventType.ACTION,this.onColorPaletteAction_)};goog.inherits(goog.ui.ColorPicker,goog.ui.Component);goog.ui.ColorPicker.DEFAULT_NUM_COLS=5;goog.ui.ColorPicker.EventType={CHANGE:"change"};goog.ui.ColorPicker.prototype.focusable_=!0;goog.ui.ColorPicker.prototype.getColors=function(){return this.colorPalette_?this.colorPalette_.getColors():null};goog.ui.ColorPicker.prototype.setColors=function(b){this.colorPalette_?this.colorPalette_.setColors(b):this.createColorPalette_(b)};goog.ui.ColorPicker.prototype.addColors=function(b){this.setColors(b)};goog.ui.ColorPicker.prototype.setSize=function(b){this.colorPalette_||this.createColorPalette_([]);this.colorPalette_.setSize(b)};goog.ui.ColorPicker.prototype.getSize=function(){return this.colorPalette_?this.colorPalette_.getSize():null};goog.ui.ColorPicker.prototype.setColumnCount=function(b){this.setSize(b)};goog.ui.ColorPicker.prototype.getSelectedIndex=function(){return this.colorPalette_?this.colorPalette_.getSelectedIndex():-1};goog.ui.ColorPicker.prototype.setSelectedIndex=function(b){this.colorPalette_&&this.colorPalette_.setSelectedIndex(b)};goog.ui.ColorPicker.prototype.getSelectedColor=function(){return this.colorPalette_?this.colorPalette_.getSelectedColor():null};goog.ui.ColorPicker.prototype.setSelectedColor=function(b){this.colorPalette_&&this.colorPalette_.setSelectedColor(b)};goog.ui.ColorPicker.prototype.isFocusable=function(){return this.focusable_};goog.ui.ColorPicker.prototype.setFocusable=function(b){this.focusable_=b;this.colorPalette_&&this.colorPalette_.setSupportedState(goog.ui.Component.State.FOCUSED,b)};goog.ui.ColorPicker.prototype.canDecorate=function(b){return !1};goog.ui.ColorPicker.prototype.enterDocument=function(){goog.ui.ColorPicker.superClass_.enterDocument.call(this);this.colorPalette_&&this.colorPalette_.render(this.getElement());this.getElement().unselectable="on"};goog.ui.ColorPicker.prototype.disposeInternal=function(){goog.ui.ColorPicker.superClass_.disposeInternal.call(this);this.colorPalette_&&(this.colorPalette_.dispose(),this.colorPalette_=null)};goog.ui.ColorPicker.prototype.focus=function(){this.colorPalette_&&this.colorPalette_.getElement().focus()};goog.ui.ColorPicker.prototype.onColorPaletteAction_=function(b){b.stopPropagation();this.dispatchEvent(goog.ui.ColorPicker.EventType.CHANGE)};goog.ui.ColorPicker.prototype.createColorPalette_=function(b){b=new goog.ui.ColorPalette(b,null,this.getDomHelper());b.setSize(goog.ui.ColorPicker.DEFAULT_NUM_COLS);b.setSupportedState(goog.ui.Component.State.FOCUSED,this.focusable_);this.addChild(b);this.colorPalette_=b;this.isInDocument()&&this.colorPalette_.render(this.getElement())};goog.ui.ColorPicker.createSimpleColorGrid=function(b){b=new goog.ui.ColorPicker(b);b.setSize(7);b.setColors(goog.ui.ColorPicker.SIMPLE_GRID_COLORS);return b};goog.ui.ColorPicker.SIMPLE_GRID_COLORS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" ");goog.events.FocusHandler=function(b){goog.events.EventTarget.call(this);this.element_=b;b=goog.userAgent.IE?"focusout":"blur";this.listenKeyIn_=goog.events.listen(this.element_,goog.userAgent.IE?"focusin":"focus",this,!goog.userAgent.IE);this.listenKeyOut_=goog.events.listen(this.element_,b,this,!goog.userAgent.IE)};goog.inherits(goog.events.FocusHandler,goog.events.EventTarget);goog.events.FocusHandler.EventType={FOCUSIN:"focusin",FOCUSOUT:"focusout"};goog.events.FocusHandler.prototype.handleEvent=function(d){var c=d.getBrowserEvent(),c=new goog.events.BrowserEvent(c);c.type="focusin"==d.type||"focus"==d.type?goog.events.FocusHandler.EventType.FOCUSIN:goog.events.FocusHandler.EventType.FOCUSOUT;this.dispatchEvent(c)};goog.events.FocusHandler.prototype.disposeInternal=function(){goog.events.FocusHandler.superClass_.disposeInternal.call(this);goog.events.unlistenByKey(this.listenKeyIn_);goog.events.unlistenByKey(this.listenKeyOut_);delete this.element_};goog.structs={};goog.structs.getCount=function(b){return b.getCount&&"function"==typeof b.getCount?b.getCount():goog.isArrayLike(b)||goog.isString(b)?b.length:goog.object.getCount(b)};goog.structs.getValues=function(f){if(f.getValues&&"function"==typeof f.getValues){return f.getValues()}if(goog.isString(f)){return f.split("")}if(goog.isArrayLike(f)){for(var e=[],h=f.length,g=0;g<h;g++){e.push(f[g])}return e}return goog.object.getValues(f)};goog.structs.getKeys=function(e){if(e.getKeys&&"function"==typeof e.getKeys){return e.getKeys()}if(!e.getValues||"function"!=typeof e.getValues){if(goog.isArrayLike(e)||goog.isString(e)){var d=[];e=e.length;for(var f=0;f<e;f++){d.push(f)}return d}return goog.object.getKeys(e)}};goog.structs.contains=function(d,c){return d.contains&&"function"==typeof d.contains?d.contains(c):d.containsValue&&"function"==typeof d.containsValue?d.containsValue(c):goog.isArrayLike(d)||goog.isString(d)?goog.array.contains(d,c):goog.object.containsValue(d,c)};goog.structs.isEmpty=function(b){return b.isEmpty&&"function"==typeof b.isEmpty?b.isEmpty():goog.isArrayLike(b)||goog.isString(b)?goog.array.isEmpty(b):goog.object.isEmpty(b)};goog.structs.clear=function(b){b.clear&&"function"==typeof b.clear?b.clear():goog.isArrayLike(b)?goog.array.clear(b):goog.object.clear(b)};goog.structs.forEach=function(i,h,n){if(i.forEach&&"function"==typeof i.forEach){i.forEach(h,n)}else{if(goog.isArrayLike(i)||goog.isString(i)){goog.array.forEach(i,h,n)}else{for(var m=goog.structs.getKeys(i),l=goog.structs.getValues(i),k=l.length,j=0;j<k;j++){h.call(n,l[j],m&&m[j],i)}}}};goog.structs.filter=function(j,i,p){if("function"==typeof j.filter){return j.filter(i,p)}if(goog.isArrayLike(j)||goog.isString(j)){return goog.array.filter(j,i,p)}var o,n=goog.structs.getKeys(j),m=goog.structs.getValues(j),l=m.length;if(n){o={};for(var k=0;k<l;k++){i.call(p,m[k],n[k],j)&&(o[n[k]]=m[k])}}else{for(o=[],k=0;k<l;k++){i.call(p,m[k],void 0,j)&&o.push(m[k])}}return o};goog.structs.map=function(j,i,p){if("function"==typeof j.map){return j.map(i,p)}if(goog.isArrayLike(j)||goog.isString(j)){return goog.array.map(j,i,p)}var o,n=goog.structs.getKeys(j),m=goog.structs.getValues(j),l=m.length;if(n){o={};for(var k=0;k<l;k++){o[n[k]]=i.call(p,m[k],n[k],j)}}else{for(o=[],k=0;k<l;k++){o[k]=i.call(p,m[k],void 0,j)}}return o};goog.structs.some=function(i,h,n){if("function"==typeof i.some){return i.some(h,n)}if(goog.isArrayLike(i)||goog.isString(i)){return goog.array.some(i,h,n)}for(var m=goog.structs.getKeys(i),l=goog.structs.getValues(i),k=l.length,j=0;j<k;j++){if(h.call(n,l[j],m&&m[j],i)){return !0}}return !1};goog.structs.every=function(i,h,n){if("function"==typeof i.every){return i.every(h,n)}if(goog.isArrayLike(i)||goog.isString(i)){return goog.array.every(i,h,n)}for(var m=goog.structs.getKeys(i),l=goog.structs.getValues(i),k=l.length,j=0;j<k;j++){if(!h.call(n,l[j],m&&m[j],i)){return !1}}return !0};goog.structs.Collection=function(){};goog.structs.Map=function(f,e){this.map_={};this.keys_=[];this.version_=this.count_=0;var h=arguments.length;if(1<h){if(h%2){throw Error("Uneven number of arguments")}for(var g=0;g<h;g+=2){this.set(arguments[g],arguments[g+1])}}else{f&&this.addAll(f)}};goog.structs.Map.prototype.getCount=function(){return this.count_};goog.structs.Map.prototype.getValues=function(){this.cleanupKeysArray_();for(var d=[],c=0;c<this.keys_.length;c++){d.push(this.map_[this.keys_[c]])}return d};goog.structs.Map.prototype.getKeys=function(){this.cleanupKeysArray_();return this.keys_.concat()};goog.structs.Map.prototype.containsKey=function(b){return goog.structs.Map.hasKey_(this.map_,b)};goog.structs.Map.prototype.containsValue=function(e){for(var d=0;d<this.keys_.length;d++){var f=this.keys_[d];if(goog.structs.Map.hasKey_(this.map_,f)&&this.map_[f]==e){return !0}}return !1};goog.structs.Map.prototype.equals=function(g,f){if(this===g){return !0}if(this.count_!=g.getCount()){return !1}var j=f||goog.structs.Map.defaultEquals;this.cleanupKeysArray_();for(var i,h=0;i=this.keys_[h];h++){if(!j(this.get(i),g.get(i))){return !1}}return !0};goog.structs.Map.defaultEquals=function(d,c){return d===c};goog.structs.Map.prototype.isEmpty=function(){return 0==this.count_};goog.structs.Map.prototype.clear=function(){this.map_={};this.version_=this.count_=this.keys_.length=0};goog.structs.Map.prototype.remove=function(b){return goog.structs.Map.hasKey_(this.map_,b)?(delete this.map_[b],this.count_--,this.version_++,this.keys_.length>2*this.count_&&this.cleanupKeysArray_(),!0):!1};goog.structs.Map.prototype.cleanupKeysArray_=function(){if(this.count_!=this.keys_.length){for(var f=0,e=0;f<this.keys_.length;){var h=this.keys_[f];goog.structs.Map.hasKey_(this.map_,h)&&(this.keys_[e++]=h);f++}this.keys_.length=e}if(this.count_!=this.keys_.length){for(var g={},e=f=0;f<this.keys_.length;){h=this.keys_[f],goog.structs.Map.hasKey_(g,h)||(this.keys_[e++]=h,g[h]=1),f++}this.keys_.length=e}};goog.structs.Map.prototype.get=function(d,c){return goog.structs.Map.hasKey_(this.map_,d)?this.map_[d]:c};goog.structs.Map.prototype.set=function(d,c){goog.structs.Map.hasKey_(this.map_,d)||(this.count_++,this.keys_.push(d),this.version_++);this.map_[d]=c};goog.structs.Map.prototype.addAll=function(e){var d;e instanceof goog.structs.Map?(d=e.getKeys(),e=e.getValues()):(d=goog.object.getKeys(e),e=goog.object.getValues(e));for(var f=0;f<d.length;f++){this.set(d[f],e[f])}};goog.structs.Map.prototype.forEach=function(h,g){for(var l=this.getKeys(),k=0;k<l.length;k++){var j=l[k],i=this.get(j);h.call(g,i,j,this)}};goog.structs.Map.prototype.clone=function(){return new goog.structs.Map(this)};goog.structs.Map.prototype.transpose=function(){for(var e=new goog.structs.Map,d=0;d<this.keys_.length;d++){var f=this.keys_[d];e.set(this.map_[f],f)}return e};goog.structs.Map.prototype.toObject=function(){this.cleanupKeysArray_();for(var e={},d=0;d<this.keys_.length;d++){var f=this.keys_[d];e[f]=this.map_[f]}return e};goog.structs.Map.prototype.getKeyIterator=function(){return this.__iterator__(!0)};goog.structs.Map.prototype.getValueIterator=function(){return this.__iterator__(!1)};goog.structs.Map.prototype.__iterator__=function(g){this.cleanupKeysArray_();var f=0,j=this.version_,i=this,h=new goog.iter.Iterator;h.next=function(){if(j!=i.version_){throw Error("The map has changed since the iterator was created")}if(f>=i.keys_.length){throw goog.iter.StopIteration}var a=i.keys_[f++];return g?a:i.map_[a]};return h};goog.structs.Map.hasKey_=function(d,c){return Object.prototype.hasOwnProperty.call(d,c)};goog.structs.Set=function(b){this.map_=new goog.structs.Map;b&&this.addAll(b)};goog.structs.Set.getKey_=function(d){var c=typeof d;return"object"==c&&d||"function"==c?"o"+goog.getUid(d):c.substr(0,1)+d};goog.structs.Set.prototype.getCount=function(){return this.map_.getCount()};goog.structs.Set.prototype.add=function(b){this.map_.set(goog.structs.Set.getKey_(b),b)};goog.structs.Set.prototype.addAll=function(e){e=goog.structs.getValues(e);for(var d=e.length,f=0;f<d;f++){this.add(e[f])}};goog.structs.Set.prototype.removeAll=function(e){e=goog.structs.getValues(e);for(var d=e.length,f=0;f<d;f++){this.remove(e[f])}};goog.structs.Set.prototype.remove=function(b){return this.map_.remove(goog.structs.Set.getKey_(b))};goog.structs.Set.prototype.clear=function(){this.map_.clear()};goog.structs.Set.prototype.isEmpty=function(){return this.map_.isEmpty()};goog.structs.Set.prototype.contains=function(b){return this.map_.containsKey(goog.structs.Set.getKey_(b))};goog.structs.Set.prototype.containsAll=function(b){return goog.structs.every(b,this.contains,this)};goog.structs.Set.prototype.intersection=function(f){var e=new goog.structs.Set;f=goog.structs.getValues(f);for(var h=0;h<f.length;h++){var g=f[h];this.contains(g)&&e.add(g)}return e};goog.structs.Set.prototype.difference=function(d){var c=this.clone();c.removeAll(d);return c};goog.structs.Set.prototype.getValues=function(){return this.map_.getValues()};goog.structs.Set.prototype.clone=function(){return new goog.structs.Set(this)};goog.structs.Set.prototype.equals=function(b){return this.getCount()==goog.structs.getCount(b)&&this.isSubsetOf(b)};goog.structs.Set.prototype.isSubsetOf=function(d){var c=goog.structs.getCount(d);if(this.getCount()>c){return !1}!(d instanceof goog.structs.Set)&&5<c&&(d=new goog.structs.Set(d));return goog.structs.every(this,function(a){return goog.structs.contains(d,a)})};goog.structs.Set.prototype.__iterator__=function(b){return this.map_.__iterator__(!1)};goog.debug.LOGGING_ENABLED=goog.DEBUG;goog.debug.FORCE_SLOPPY_STACKS=!1;goog.debug.catchErrors=function(g,f,j){j=j||goog.global;var i=j.onerror,h=!!f;goog.userAgent.WEBKIT&&!goog.userAgent.isVersionOrHigher("535.3")&&(h=!h);j.onerror=function(a,m,e,d,l){i&&i(a,m,e,d,l);g({message:a,fileName:m,line:e,col:d,error:l});return h}};goog.debug.expose=function(h,g){if("undefined"==typeof h){return"undefined"}if(null==h){return"NULL"}var l=[],k;for(k in h){if(g||!goog.isFunction(h[k])){var j=k+" = ";try{j+=h[k]}catch(i){j+="*** "+i+" ***"}l.push(j)}}return l.join("\n")};goog.debug.deepExpose=function(f,e){var h=[],g=function(b,i,d){var j=i+"  ";d=new goog.structs.Set(d);try{if(goog.isDef(b)){if(goog.isNull(b)){h.push("NULL")}else{if(goog.isString(b)){h.push('"'+b.replace(/\n/g,"\n"+i)+'"')}else{if(goog.isFunction(b)){h.push(String(b).replace(/\n/g,"\n"+i))}else{if(goog.isObject(b)){if(d.contains(b)){h.push("*** reference loop detected ***")}else{d.add(b);h.push("{");for(var c in b){if(e||!goog.isFunction(b[c])){h.push("\n"),h.push(j),h.push(c+" = "),g(b[c],j,d)}}h.push("\n"+i+"}")}}else{h.push(b)}}}}}else{h.push("undefined")}}catch(l){h.push("*** "+l+" ***")}};g(f,"",new goog.structs.Set);return h.join("")};goog.debug.exposeArray=function(e){for(var d=[],f=0;f<e.length;f++){goog.isArray(e[f])?d.push(goog.debug.exposeArray(e[f])):d.push(e[f])}return"[ "+d.join(", ")+" ]"};goog.debug.exposeException=function(e,d){var f=goog.debug.exposeExceptionAsHtml(e,d);return goog.html.SafeHtml.unwrap(f)};goog.debug.exposeExceptionAsHtml=function(g,f){try{var j=goog.debug.normalizeErrorObject(g),i=goog.debug.createViewSourceUrl_(j.fileName);return goog.html.SafeHtml.concat(goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces("Message: "+j.message+"\nUrl: "),goog.html.SafeHtml.create("a",{href:i,target:"_new"},j.fileName),goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces("\nLine: "+j.lineNumber+"\n\nBrowser stack:\n"+j.stack+"-> [end]\n\nJS stack traversal:\n"+goog.debug.getStacktrace(f)+"-> "))}catch(h){return goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces("Exception trying to expose exception! You win, we lose. "+h)}};goog.debug.createViewSourceUrl_=function(b){goog.isDefAndNotNull(b)||(b="");if(!/^https?:\/\//i.test(b)){return goog.html.SafeUrl.fromConstant(goog.string.Const.from("sanitizedviewsrc"))}b=goog.html.SafeUrl.sanitize(b);return goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("view-source scheme plus HTTP/HTTPS URL"),"view-source:"+goog.html.SafeUrl.unwrap(b))};goog.debug.normalizeErrorObject=function(h){var g=goog.getObjectByName("window.location.href");if(goog.isString(h)){return{message:h,name:"Unknown error",lineNumber:"Not available",fileName:g,stack:"Not available"}}var l,k,j=!1;try{l=h.lineNumber||h.line||"Not available"}catch(i){l="Not available",j=!0}try{k=h.fileName||h.filename||h.sourceURL||goog.global.$googDebugFname||g}catch(i){k="Not available",j=!0}return !j&&h.lineNumber&&h.fileName&&h.stack&&h.message&&h.name?h:{message:h.message||"Not available",name:h.name||"UnknownError",lineNumber:l,fileName:k,stack:h.stack||"Not available"}};goog.debug.enhanceError=function(f,e){var h;"string"==typeof f?(h=Error(f),Error.captureStackTrace&&Error.captureStackTrace(h,goog.debug.enhanceError)):h=f;h.stack||(h.stack=goog.debug.getStacktrace(goog.debug.enhanceError));if(e){for(var g=0;h["message"+g];){++g}h["message"+g]=String(e)}return h};goog.debug.getStacktraceSimple=function(g){if(!goog.debug.FORCE_SLOPPY_STACKS){var f=goog.debug.getNativeStackTrace_(goog.debug.getStacktraceSimple);if(f){return f}}for(var f=[],j=arguments.callee.caller,i=0;j&&(!g||i<g);){f.push(goog.debug.getFunctionName(j));f.push("()\n");try{j=j.caller}catch(h){f.push("[exception trying to get caller]\n");break}i++;if(i>=goog.debug.MAX_STACK_DEPTH){f.push("[...long stack...]");break}}g&&i>=g?f.push("[...reached max depth limit...]"):f.push("[end]");return f.join("")};goog.debug.MAX_STACK_DEPTH=50;goog.debug.getNativeStackTrace_=function(e){var d=Error();if(Error.captureStackTrace){return Error.captureStackTrace(d,e),String(d.stack)}try{throw d}catch(f){d=f}return(e=d.stack)?String(e):null};goog.debug.getStacktrace=function(d){var c;goog.debug.FORCE_SLOPPY_STACKS||(c=goog.debug.getNativeStackTrace_(d||goog.debug.getStacktrace));c||(c=goog.debug.getStacktraceHelper_(d||arguments.callee.caller,[]));return c};goog.debug.getStacktraceHelper_=function(i,h){var n=[];if(goog.array.contains(h,i)){n.push("[...circular reference...]")}else{if(i&&h.length<goog.debug.MAX_STACK_DEPTH){n.push(goog.debug.getFunctionName(i)+"(");for(var m=i.arguments,l=0;m&&l<m.length;l++){0<l&&n.push(", ");var k;k=m[l];switch(typeof k){case"object":k=k?"object":"null";break;case"string":break;case"number":k=String(k);break;case"boolean":k=k?"true":"false";break;case"function":k=(k=goog.debug.getFunctionName(k))?k:"[fn]";break;default:k=typeof k}40<k.length&&(k=k.substr(0,40)+"...");n.push(k)}h.push(i);n.push(")\n");try{n.push(goog.debug.getStacktraceHelper_(i.caller,h))}catch(j){n.push("[exception trying to get caller]\n")}}else{i?n.push("[...long stack...]"):n.push("[end]")}}return n.join("")};goog.debug.setFunctionResolver=function(b){goog.debug.fnNameResolver_=b};goog.debug.getFunctionName=function(d){if(goog.debug.fnNameCache_[d]){return goog.debug.fnNameCache_[d]}if(goog.debug.fnNameResolver_){var c=goog.debug.fnNameResolver_(d);if(c){return goog.debug.fnNameCache_[d]=c}}d=String(d);goog.debug.fnNameCache_[d]||(c=/function ([^\(]+)/.exec(d),goog.debug.fnNameCache_[d]=c?c[1]:"[Anonymous]");return goog.debug.fnNameCache_[d]};goog.debug.makeWhitespaceVisible=function(b){return b.replace(/ /g,"[_]").replace(/\f/g,"[f]").replace(/\n/g,"[n]\n").replace(/\r/g,"[r]").replace(/\t/g,"[t]")};goog.debug.runtimeType=function(b){return b instanceof Function?b.displayName||b.name||"unknown type name":b instanceof Object?b.constructor.displayName||b.constructor.name||Object.prototype.toString.call(b):null===b?"null":typeof b};goog.debug.fnNameCache_={};goog.debug.LogRecord=function(g,f,j,i,h){this.reset(g,f,j,i,h)};goog.debug.LogRecord.prototype.sequenceNumber_=0;goog.debug.LogRecord.prototype.exception_=null;goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS=!0;goog.debug.LogRecord.nextSequenceNumber_=0;goog.debug.LogRecord.prototype.reset=function(g,f,j,i,h){goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS&&(this.sequenceNumber_="number"==typeof h?h:goog.debug.LogRecord.nextSequenceNumber_++);this.time_=i||goog.now();this.level_=g;this.msg_=f;this.loggerName_=j;delete this.exception_};goog.debug.LogRecord.prototype.getLoggerName=function(){return this.loggerName_};goog.debug.LogRecord.prototype.getException=function(){return this.exception_};goog.debug.LogRecord.prototype.setException=function(b){this.exception_=b};goog.debug.LogRecord.prototype.setLoggerName=function(b){this.loggerName_=b};goog.debug.LogRecord.prototype.getLevel=function(){return this.level_};goog.debug.LogRecord.prototype.setLevel=function(b){this.level_=b};goog.debug.LogRecord.prototype.getMessage=function(){return this.msg_};goog.debug.LogRecord.prototype.setMessage=function(b){this.msg_=b};goog.debug.LogRecord.prototype.getMillis=function(){return this.time_};goog.debug.LogRecord.prototype.setMillis=function(b){this.time_=b};goog.debug.LogRecord.prototype.getSequenceNumber=function(){return this.sequenceNumber_};goog.debug.LogBuffer=function(){goog.asserts.assert(goog.debug.LogBuffer.isBufferingEnabled(),"Cannot use goog.debug.LogBuffer without defining goog.debug.LogBuffer.CAPACITY.");this.clear()};goog.debug.LogBuffer.getInstance=function(){goog.debug.LogBuffer.instance_||(goog.debug.LogBuffer.instance_=new goog.debug.LogBuffer);return goog.debug.LogBuffer.instance_};goog.debug.LogBuffer.CAPACITY=0;goog.debug.LogBuffer.prototype.addRecord=function(f,e,h){var g=(this.curIndex_+1)%goog.debug.LogBuffer.CAPACITY;this.curIndex_=g;if(this.isFull_){return g=this.buffer_[g],g.reset(f,e,h),g}this.isFull_=g==goog.debug.LogBuffer.CAPACITY-1;return this.buffer_[g]=new goog.debug.LogRecord(f,e,h)};goog.debug.LogBuffer.isBufferingEnabled=function(){return 0<goog.debug.LogBuffer.CAPACITY};goog.debug.LogBuffer.prototype.clear=function(){this.buffer_=Array(goog.debug.LogBuffer.CAPACITY);this.curIndex_=-1;this.isFull_=!1};goog.debug.LogBuffer.prototype.forEachRecord=function(f){var e=this.buffer_;if(e[0]){var h=this.curIndex_,g=this.isFull_?h:-1;do{g=(g+1)%goog.debug.LogBuffer.CAPACITY,f(e[g])}while(g!=h)}};goog.debug.Logger=function(b){this.name_=b;this.handlers_=this.children_=this.level_=this.parent_=null};goog.debug.Logger.ROOT_LOGGER_NAME="";goog.debug.Logger.ENABLE_HIERARCHY=!0;goog.debug.Logger.ENABLE_HIERARCHY||(goog.debug.Logger.rootHandlers_=[]);goog.debug.Logger.Level=function(d,c){this.name=d;this.value=c};goog.debug.Logger.Level.prototype.toString=function(){return this.name};goog.debug.Logger.Level.OFF=new goog.debug.Logger.Level("OFF",Infinity);goog.debug.Logger.Level.SHOUT=new goog.debug.Logger.Level("SHOUT",1200);goog.debug.Logger.Level.SEVERE=new goog.debug.Logger.Level("SEVERE",1000);goog.debug.Logger.Level.WARNING=new goog.debug.Logger.Level("WARNING",900);goog.debug.Logger.Level.INFO=new goog.debug.Logger.Level("INFO",800);goog.debug.Logger.Level.CONFIG=new goog.debug.Logger.Level("CONFIG",700);goog.debug.Logger.Level.FINE=new goog.debug.Logger.Level("FINE",500);goog.debug.Logger.Level.FINER=new goog.debug.Logger.Level("FINER",400);goog.debug.Logger.Level.FINEST=new goog.debug.Logger.Level("FINEST",300);goog.debug.Logger.Level.ALL=new goog.debug.Logger.Level("ALL",0);goog.debug.Logger.Level.PREDEFINED_LEVELS=[goog.debug.Logger.Level.OFF,goog.debug.Logger.Level.SHOUT,goog.debug.Logger.Level.SEVERE,goog.debug.Logger.Level.WARNING,goog.debug.Logger.Level.INFO,goog.debug.Logger.Level.CONFIG,goog.debug.Logger.Level.FINE,goog.debug.Logger.Level.FINER,goog.debug.Logger.Level.FINEST,goog.debug.Logger.Level.ALL];goog.debug.Logger.Level.predefinedLevelsCache_=null;goog.debug.Logger.Level.createPredefinedLevelsCache_=function(){goog.debug.Logger.Level.predefinedLevelsCache_={};for(var d=0,c;c=goog.debug.Logger.Level.PREDEFINED_LEVELS[d];d++){goog.debug.Logger.Level.predefinedLevelsCache_[c.value]=c,goog.debug.Logger.Level.predefinedLevelsCache_[c.name]=c}};goog.debug.Logger.Level.getPredefinedLevel=function(b){goog.debug.Logger.Level.predefinedLevelsCache_||goog.debug.Logger.Level.createPredefinedLevelsCache_();return goog.debug.Logger.Level.predefinedLevelsCache_[b]||null};goog.debug.Logger.Level.getPredefinedLevelByValue=function(e){goog.debug.Logger.Level.predefinedLevelsCache_||goog.debug.Logger.Level.createPredefinedLevelsCache_();if(e in goog.debug.Logger.Level.predefinedLevelsCache_){return goog.debug.Logger.Level.predefinedLevelsCache_[e]}for(var d=0;d<goog.debug.Logger.Level.PREDEFINED_LEVELS.length;++d){var f=goog.debug.Logger.Level.PREDEFINED_LEVELS[d];if(f.value<=e){return f}}return null};goog.debug.Logger.getLogger=function(b){return goog.debug.LogManager.getLogger(b)};goog.debug.Logger.logToProfilers=function(b){goog.global.console&&(goog.global.console.timeStamp?goog.global.console.timeStamp(b):goog.global.console.markTimeline&&goog.global.console.markTimeline(b));goog.global.msWriteProfilerMark&&goog.global.msWriteProfilerMark(b)};goog.debug.Logger.prototype.getName=function(){return this.name_};goog.debug.Logger.prototype.addHandler=function(b){goog.debug.LOGGING_ENABLED&&(goog.debug.Logger.ENABLE_HIERARCHY?(this.handlers_||(this.handlers_=[]),this.handlers_.push(b)):(goog.asserts.assert(!this.name_,"Cannot call addHandler on a non-root logger when goog.debug.Logger.ENABLE_HIERARCHY is false."),goog.debug.Logger.rootHandlers_.push(b)))};goog.debug.Logger.prototype.removeHandler=function(d){if(goog.debug.LOGGING_ENABLED){var c=goog.debug.Logger.ENABLE_HIERARCHY?this.handlers_:goog.debug.Logger.rootHandlers_;return !!c&&goog.array.remove(c,d)}return !1};goog.debug.Logger.prototype.getParent=function(){return this.parent_};goog.debug.Logger.prototype.getChildren=function(){this.children_||(this.children_={});return this.children_};goog.debug.Logger.prototype.setLevel=function(b){goog.debug.LOGGING_ENABLED&&(goog.debug.Logger.ENABLE_HIERARCHY?this.level_=b:(goog.asserts.assert(!this.name_,"Cannot call setLevel() on a non-root logger when goog.debug.Logger.ENABLE_HIERARCHY is false."),goog.debug.Logger.rootLevel_=b))};goog.debug.Logger.prototype.getLevel=function(){return goog.debug.LOGGING_ENABLED?this.level_:goog.debug.Logger.Level.OFF};goog.debug.Logger.prototype.getEffectiveLevel=function(){if(!goog.debug.LOGGING_ENABLED){return goog.debug.Logger.Level.OFF}if(!goog.debug.Logger.ENABLE_HIERARCHY){return goog.debug.Logger.rootLevel_}if(this.level_){return this.level_}if(this.parent_){return this.parent_.getEffectiveLevel()}goog.asserts.fail("Root logger has no level set.");return null};goog.debug.Logger.prototype.isLoggable=function(b){return goog.debug.LOGGING_ENABLED&&b.value>=this.getEffectiveLevel().value};goog.debug.Logger.prototype.log=function(e,d,f){goog.debug.LOGGING_ENABLED&&this.isLoggable(e)&&(goog.isFunction(d)&&(d=d()),this.doLogRecord_(this.getLogRecord(e,d,f)))};goog.debug.Logger.prototype.getLogRecord=function(e,d,f){e=goog.debug.LogBuffer.isBufferingEnabled()?goog.debug.LogBuffer.getInstance().addRecord(e,d,this.name_):new goog.debug.LogRecord(e,String(d),this.name_);f&&e.setException(f);return e};goog.debug.Logger.prototype.shout=function(d,c){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.SHOUT,d,c)};goog.debug.Logger.prototype.severe=function(d,c){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.SEVERE,d,c)};goog.debug.Logger.prototype.warning=function(d,c){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.WARNING,d,c)};goog.debug.Logger.prototype.info=function(d,c){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.INFO,d,c)};goog.debug.Logger.prototype.config=function(d,c){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.CONFIG,d,c)};goog.debug.Logger.prototype.fine=function(d,c){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINE,d,c)};goog.debug.Logger.prototype.finer=function(d,c){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINER,d,c)};goog.debug.Logger.prototype.finest=function(d,c){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINEST,d,c)};goog.debug.Logger.prototype.logRecord=function(b){goog.debug.LOGGING_ENABLED&&this.isLoggable(b.getLevel())&&this.doLogRecord_(b)};goog.debug.Logger.prototype.doLogRecord_=function(e){goog.debug.Logger.logToProfilers("log:"+e.getMessage());if(goog.debug.Logger.ENABLE_HIERARCHY){for(var d=this;d;){d.callPublish_(e),d=d.getParent()}}else{for(var d=0,f;f=goog.debug.Logger.rootHandlers_[d++];){f(e)}}};goog.debug.Logger.prototype.callPublish_=function(e){if(this.handlers_){for(var d=0,f;f=this.handlers_[d];d++){f(e)}}};goog.debug.Logger.prototype.setParent_=function(b){this.parent_=b};goog.debug.Logger.prototype.addChild_=function(d,c){this.getChildren()[d]=c};goog.debug.LogManager={};goog.debug.LogManager.loggers_={};goog.debug.LogManager.rootLogger_=null;goog.debug.LogManager.initialize=function(){goog.debug.LogManager.rootLogger_||(goog.debug.LogManager.rootLogger_=new goog.debug.Logger(goog.debug.Logger.ROOT_LOGGER_NAME),goog.debug.LogManager.loggers_[goog.debug.Logger.ROOT_LOGGER_NAME]=goog.debug.LogManager.rootLogger_,goog.debug.LogManager.rootLogger_.setLevel(goog.debug.Logger.Level.CONFIG))};goog.debug.LogManager.getLoggers=function(){return goog.debug.LogManager.loggers_};goog.debug.LogManager.getRoot=function(){goog.debug.LogManager.initialize();return goog.debug.LogManager.rootLogger_};goog.debug.LogManager.getLogger=function(b){goog.debug.LogManager.initialize();return goog.debug.LogManager.loggers_[b]||goog.debug.LogManager.createLogger_(b)};goog.debug.LogManager.createFunctionForCatchErrors=function(b){return function(a){(b||goog.debug.LogManager.getRoot()).severe("Error: "+a.message+" ("+a.fileName+" @ Line: "+a.line+")")}};goog.debug.LogManager.createLogger_=function(f){var e=new goog.debug.Logger(f);if(goog.debug.Logger.ENABLE_HIERARCHY){var h=f.lastIndexOf("."),g=f.substr(0,h),h=f.substr(h+1),g=goog.debug.LogManager.getLogger(g);g.addChild_(h,e);e.setParent_(g)}return goog.debug.LogManager.loggers_[f]=e};goog.log={};goog.log.ENABLED=goog.debug.LOGGING_ENABLED;goog.log.ROOT_LOGGER_NAME=goog.debug.Logger.ROOT_LOGGER_NAME;goog.log.Logger=goog.debug.Logger;goog.log.Level=goog.debug.Logger.Level;goog.log.LogRecord=goog.debug.LogRecord;goog.log.getLogger=function(e,d){if(goog.log.ENABLED){var f=goog.debug.LogManager.getLogger(e);d&&f&&f.setLevel(d);return f}return null};goog.log.addHandler=function(d,c){goog.log.ENABLED&&d&&d.addHandler(c)};goog.log.removeHandler=function(d,c){return goog.log.ENABLED&&d?d.removeHandler(c):!1};goog.log.log=function(f,e,h,g){goog.log.ENABLED&&f&&f.log(e,h,g)};goog.log.error=function(e,d,f){goog.log.ENABLED&&e&&e.severe(d,f)};goog.log.warning=function(e,d,f){goog.log.ENABLED&&e&&e.warning(d,f)};goog.log.info=function(e,d,f){goog.log.ENABLED&&e&&e.info(d,f)};goog.log.fine=function(e,d,f){goog.log.ENABLED&&e&&e.fine(d,f)};goog.string.StringBuffer=function(d,c){null!=d&&this.append.apply(this,arguments)};goog.string.StringBuffer.prototype.buffer_="";goog.string.StringBuffer.prototype.set=function(b){this.buffer_=""+b};goog.string.StringBuffer.prototype.append=function(f,e,h){this.buffer_+=String(f);if(null!=e){for(var g=1;g<arguments.length;g++){this.buffer_+=arguments[g]}}return this};goog.string.StringBuffer.prototype.clear=function(){this.buffer_=""};goog.string.StringBuffer.prototype.getLength=function(){return this.buffer_.length};goog.string.StringBuffer.prototype.toString=function(){return this.buffer_};goog.ui.tree={};goog.ui.tree.BaseNode=function(e,d,f){goog.ui.Component.call(this,f);this.config_=d||goog.ui.tree.BaseNode.defaultConfig;this.html_=goog.html.SafeHtml.htmlEscapePreservingNewlines(e);this.expanded_=this.selected_=!1;this.toolTip_=null;this.afterLabelHtml_=goog.html.SafeHtml.EMPTY;this.isUserCollapsible_=!0;this.depth_=-1};goog.inherits(goog.ui.tree.BaseNode,goog.ui.Component);goog.ui.tree.BaseNode.EventType={BEFORE_EXPAND:"beforeexpand",EXPAND:"expand",BEFORE_COLLAPSE:"beforecollapse",COLLAPSE:"collapse"};goog.ui.tree.BaseNode.allNodes={};goog.ui.tree.BaseNode.prototype.disposeInternal=function(){goog.ui.tree.BaseNode.superClass_.disposeInternal.call(this);this.tree&&(this.tree.removeNode(this),this.tree=null);this.setElementInternal(null)};goog.ui.tree.BaseNode.prototype.initAccessibility=function(){var e=this.getElement();if(e){var d=this.getLabelElement();d&&!d.id&&(d.id=this.getId()+".label");goog.a11y.aria.setRole(e,"treeitem");goog.a11y.aria.setState(e,"selected",!1);goog.a11y.aria.setState(e,"expanded",!1);goog.a11y.aria.setState(e,"level",this.getDepth());d&&goog.a11y.aria.setState(e,"labelledby",d.id);(e=this.getIconElement())&&goog.a11y.aria.setRole(e,"presentation");(e=this.getExpandIconElement())&&goog.a11y.aria.setRole(e,"presentation");if(e=this.getChildrenElement()){if(goog.a11y.aria.setRole(e,"group"),e.hasChildNodes()){for(e=this.getChildCount(),d=1;d<=e;d++){var f=this.getChildAt(d-1).getElement();goog.asserts.assert(f,"The child element cannot be null");goog.a11y.aria.setState(f,"setsize",e);goog.a11y.aria.setState(f,"posinset",d)}}}}};goog.ui.tree.BaseNode.prototype.createDom=function(){var b=this.getDomHelper().safeHtmlToNode(this.toSafeHtml());this.setElementInternal(b)};goog.ui.tree.BaseNode.prototype.enterDocument=function(){goog.ui.tree.BaseNode.superClass_.enterDocument.call(this);goog.ui.tree.BaseNode.allNodes[this.getId()]=this;this.initAccessibility()};goog.ui.tree.BaseNode.prototype.exitDocument=function(){goog.ui.tree.BaseNode.superClass_.exitDocument.call(this);delete goog.ui.tree.BaseNode.allNodes[this.getId()]};goog.ui.tree.BaseNode.prototype.addChildAt=function(h,g,l){goog.asserts.assert(!h.getParent());goog.asserts.assertInstanceof(h,goog.ui.tree.BaseNode);l=this.getChildAt(g-1);var k=this.getChildAt(g);goog.ui.tree.BaseNode.superClass_.addChildAt.call(this,h,g);h.previousSibling_=l;h.nextSibling_=k;l?l.nextSibling_=h:this.firstChild_=h;k?k.previousSibling_=h:this.lastChild_=h;(g=this.getTree())&&h.setTreeInternal(g);h.setDepth_(this.getDepth()+1);if(this.getElement()&&(this.updateExpandIcon(),this.getExpanded())){g=this.getChildrenElement();h.getElement()||h.createDom();var j=h.getElement(),i=k&&k.getElement();g.insertBefore(j,i);this.isInDocument()&&h.enterDocument();k||(l?l.updateExpandIcon():(goog.style.setElementShown(g,!0),this.setExpanded(this.getExpanded())))}};goog.ui.tree.BaseNode.prototype.add=function(d,c){goog.asserts.assert(!c||c.getParent()==this,"Can only add nodes before siblings");d.getParent()&&d.getParent().removeChild(d);this.addChildAt(d,c?this.indexOfChild(c):this.getChildCount());return d};goog.ui.tree.BaseNode.prototype.removeChild=function(g,f){var j=this.getTree(),i=j?j.getSelectedItem():null;if(i==g||g.contains(i)){j.hasFocus()?(this.select(),goog.Timer.callOnce(this.onTimeoutSelect_,10,this)):this.select()}goog.ui.tree.BaseNode.superClass_.removeChild.call(this,g);this.lastChild_==g&&(this.lastChild_=g.previousSibling_);this.firstChild_==g&&(this.firstChild_=g.nextSibling_);g.previousSibling_&&(g.previousSibling_.nextSibling_=g.nextSibling_);g.nextSibling_&&(g.nextSibling_.previousSibling_=g.previousSibling_);i=g.isLastSibling();g.tree=null;g.depth_=-1;if(j&&(j.removeNode(g),this.isInDocument())){j=this.getChildrenElement();if(g.isInDocument()){var h=g.getElement();j.removeChild(h);g.exitDocument()}i&&(i=this.getLastChild())&&i.updateExpandIcon();this.hasChildren()||(j.style.display="none",this.updateExpandIcon(),this.updateIcon_())}return g};goog.ui.tree.BaseNode.prototype.remove=goog.ui.tree.BaseNode.prototype.removeChild;goog.ui.tree.BaseNode.prototype.onTimeoutSelect_=function(){this.select()};goog.ui.tree.BaseNode.prototype.getTree=goog.abstractMethod;goog.ui.tree.BaseNode.prototype.getDepth=function(){var b=this.depth_;0>b&&(b=this.computeDepth_(),this.setDepth_(b));return b};goog.ui.tree.BaseNode.prototype.computeDepth_=function(){var b=this.getParent();return b?b.getDepth()+1:0};goog.ui.tree.BaseNode.prototype.setDepth_=function(e){if(e!=this.depth_){this.depth_=e;var d=this.getRowElement();if(d){var f=this.getPixelIndent_()+"px";this.isRightToLeft()?d.style.paddingRight=f:d.style.paddingLeft=f}this.forEachChild(function(a){a.setDepth_(e+1)})}};goog.ui.tree.BaseNode.prototype.contains=function(b){for(;b;){if(b==this){return !0}b=b.getParent()}return !1};goog.ui.tree.BaseNode.EMPTY_CHILDREN_=[];goog.ui.tree.BaseNode.prototype.getChildren=function(){var b=[];this.forEachChild(function(a){b.push(a)});return b};goog.ui.tree.BaseNode.prototype.getFirstChild=function(){return this.getChildAt(0)};goog.ui.tree.BaseNode.prototype.getLastChild=function(){return this.getChildAt(this.getChildCount()-1)};goog.ui.tree.BaseNode.prototype.getPreviousSibling=function(){return this.previousSibling_};goog.ui.tree.BaseNode.prototype.getNextSibling=function(){return this.nextSibling_};goog.ui.tree.BaseNode.prototype.isLastSibling=function(){return !this.nextSibling_};goog.ui.tree.BaseNode.prototype.isSelected=function(){return this.selected_};goog.ui.tree.BaseNode.prototype.select=function(){var b=this.getTree();b&&b.setSelectedItem(this)};goog.ui.tree.BaseNode.prototype.deselect=goog.nullFunction;goog.ui.tree.BaseNode.prototype.setSelectedInternal=function(d){if(this.selected_!=d){this.selected_=d;this.updateRow();var c=this.getElement();c&&(goog.a11y.aria.setState(c,"selected",d),d&&(d=this.getTree().getElement(),goog.asserts.assert(d,"The DOM element for the tree cannot be null"),goog.a11y.aria.setState(d,"activedescendant",this.getId())))}};goog.ui.tree.BaseNode.prototype.getExpanded=function(){return this.expanded_};goog.ui.tree.BaseNode.prototype.setExpandedInternal=function(b){this.expanded_=b};goog.ui.tree.BaseNode.prototype.setExpanded=function(g){var f=g!=this.expanded_;if(!f||this.dispatchEvent(g?goog.ui.tree.BaseNode.EventType.BEFORE_EXPAND:goog.ui.tree.BaseNode.EventType.BEFORE_COLLAPSE)){var j;this.expanded_=g;j=this.getTree();var i=this.getElement();if(this.hasChildren()){if(!g&&j&&this.contains(j.getSelectedItem())&&this.select(),i){if(j=this.getChildrenElement()){if(goog.style.setElementShown(j,g),g&&this.isInDocument()&&!j.hasChildNodes()){var h=[];this.forEachChild(function(b){h.push(b.toSafeHtml())});goog.dom.safe.setInnerHtml(j,goog.html.SafeHtml.concat(h));this.forEachChild(function(b){b.enterDocument()})}}this.updateExpandIcon()}}else{(j=this.getChildrenElement())&&goog.style.setElementShown(j,!1)}i&&(this.updateIcon_(),goog.a11y.aria.setState(i,"expanded",g));f&&this.dispatchEvent(g?goog.ui.tree.BaseNode.EventType.EXPAND:goog.ui.tree.BaseNode.EventType.COLLAPSE)}};goog.ui.tree.BaseNode.prototype.toggle=function(){this.setExpanded(!this.getExpanded())};goog.ui.tree.BaseNode.prototype.expand=function(){this.setExpanded(!0)};goog.ui.tree.BaseNode.prototype.collapse=function(){this.setExpanded(!1)};goog.ui.tree.BaseNode.prototype.collapseChildren=function(){this.forEachChild(function(b){b.collapseAll()})};goog.ui.tree.BaseNode.prototype.collapseAll=function(){this.collapseChildren();this.collapse()};goog.ui.tree.BaseNode.prototype.expandChildren=function(){this.forEachChild(function(b){b.expandAll()})};goog.ui.tree.BaseNode.prototype.expandAll=function(){this.expandChildren();this.expand()};goog.ui.tree.BaseNode.prototype.reveal=function(){var b=this.getParent();b&&(b.setExpanded(!0),b.reveal())};goog.ui.tree.BaseNode.prototype.setIsUserCollapsible=function(b){(this.isUserCollapsible_=b)||this.expand();this.getElement()&&this.updateExpandIcon()};goog.ui.tree.BaseNode.prototype.isUserCollapsible=function(){return this.isUserCollapsible_};goog.ui.tree.BaseNode.prototype.toSafeHtml=function(){var e=this.getTree(),d=!e.getShowLines()||e==this.getParent()&&!e.getShowRootLines()?this.config_.cssChildrenNoLines:this.config_.cssChildren,e=this.getExpanded()&&this.hasChildren(),d={"class":d,style:this.getLineStyle()},f=[];e&&this.forEachChild(function(b){f.push(b.toSafeHtml())});e=goog.html.SafeHtml.create("div",d,f);return goog.html.SafeHtml.create("div",{"class":this.config_.cssItem,id:this.getId()},[this.getRowSafeHtml(),e])};goog.ui.tree.BaseNode.prototype.getPixelIndent_=function(){return Math.max(0,(this.getDepth()-1)*this.config_.indentWidth)};goog.ui.tree.BaseNode.prototype.getRowSafeHtml=function(){var d={};d["padding-"+(this.isRightToLeft()?"right":"left")]=this.getPixelIndent_()+"px";var d={"class":this.getRowClassName(),style:d},c=[this.getExpandIconSafeHtml(),this.getIconSafeHtml(),this.getLabelSafeHtml()];return goog.html.SafeHtml.create("div",d,c)};goog.ui.tree.BaseNode.prototype.getRowClassName=function(){var b;b=this.isSelected()?" "+this.config_.cssSelectedRow:"";return this.config_.cssTreeRow+b};goog.ui.tree.BaseNode.prototype.getLabelSafeHtml=function(){var b=goog.html.SafeHtml.create("span",{"class":this.config_.cssItemLabel,title:this.getToolTip()||null},this.getSafeHtml());return goog.html.SafeHtml.concat(b,goog.html.SafeHtml.create("span",{},this.getAfterLabelSafeHtml()))};goog.ui.tree.BaseNode.prototype.getAfterLabelHtml=function(){return goog.html.SafeHtml.unwrap(this.getAfterLabelSafeHtml())};goog.ui.tree.BaseNode.prototype.getAfterLabelSafeHtml=function(){return this.afterLabelHtml_};goog.ui.tree.BaseNode.prototype.setAfterLabelSafeHtml=function(d){this.afterLabelHtml_=d;var c=this.getAfterLabelElement();c&&goog.dom.safe.setInnerHtml(c,d)};goog.ui.tree.BaseNode.prototype.getIconSafeHtml=function(){return goog.html.SafeHtml.create("span",{style:{display:"inline-block"},"class":this.getCalculatedIconClass()})};goog.ui.tree.BaseNode.prototype.getCalculatedIconClass=goog.abstractMethod;goog.ui.tree.BaseNode.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.create("span",{type:"expand",style:{display:"inline-block"},"class":this.getExpandIconClass()})};goog.ui.tree.BaseNode.prototype.getExpandIconClass=function(){var g=this.getTree(),f=!g.getShowLines()||g==this.getParent()&&!g.getShowRootLines(),j=this.config_,i=new goog.string.StringBuffer;i.append(j.cssTreeIcon," ",j.cssExpandTreeIcon," ");if(this.hasChildren()){var h=0;g.getShowExpandIcons()&&this.isUserCollapsible_&&(h=this.getExpanded()?2:1);f||(h=this.isLastSibling()?h+4:h+8);switch(h){case 1:i.append(j.cssExpandTreeIconPlus);break;case 2:i.append(j.cssExpandTreeIconMinus);break;case 4:i.append(j.cssExpandTreeIconL);break;case 5:i.append(j.cssExpandTreeIconLPlus);break;case 6:i.append(j.cssExpandTreeIconLMinus);break;case 8:i.append(j.cssExpandTreeIconT);break;case 9:i.append(j.cssExpandTreeIconTPlus);break;case 10:i.append(j.cssExpandTreeIconTMinus);break;default:i.append(j.cssExpandTreeIconBlank)}}else{f?i.append(j.cssExpandTreeIconBlank):this.isLastSibling()?i.append(j.cssExpandTreeIconL):i.append(j.cssExpandTreeIconT)}return i.toString()};goog.ui.tree.BaseNode.prototype.getLineStyle=function(){var b=this.getExpanded()&&this.hasChildren();return goog.html.SafeStyle.create({"background-position":this.getBackgroundPosition(),display:b?null:"none"})};goog.ui.tree.BaseNode.prototype.getBackgroundPosition=function(){return(this.isLastSibling()?"-100":(this.getDepth()-1)*this.config_.indentWidth)+"px 0"};goog.ui.tree.BaseNode.prototype.getElement=function(){var b=goog.ui.tree.BaseNode.superClass_.getElement.call(this);b||(b=this.getDomHelper().getElement(this.getId()),this.setElementInternal(b));return b};goog.ui.tree.BaseNode.prototype.getRowElement=function(){var b=this.getElement();return b?b.firstChild:null};goog.ui.tree.BaseNode.prototype.getExpandIconElement=function(){var b=this.getRowElement();return b?b.firstChild:null};goog.ui.tree.BaseNode.prototype.getIconElement=function(){var b=this.getRowElement();return b?b.childNodes[1]:null};goog.ui.tree.BaseNode.prototype.getLabelElement=function(){var b=this.getRowElement();return b&&b.lastChild?b.lastChild.previousSibling:null};goog.ui.tree.BaseNode.prototype.getAfterLabelElement=function(){var b=this.getRowElement();return b?b.lastChild:null};goog.ui.tree.BaseNode.prototype.getChildrenElement=function(){var b=this.getElement();return b?b.lastChild:null};goog.ui.tree.BaseNode.prototype.setIconClass=function(b){this.iconClass_=b;this.isInDocument()&&this.updateIcon_()};goog.ui.tree.BaseNode.prototype.getIconClass=function(){return this.iconClass_};goog.ui.tree.BaseNode.prototype.setExpandedIconClass=function(b){this.expandedIconClass_=b;this.isInDocument()&&this.updateIcon_()};goog.ui.tree.BaseNode.prototype.getExpandedIconClass=function(){return this.expandedIconClass_};goog.ui.tree.BaseNode.prototype.setText=function(b){this.setSafeHtml(goog.html.SafeHtml.htmlEscape(b))};goog.ui.tree.BaseNode.prototype.getText=function(){return goog.string.unescapeEntities(goog.html.SafeHtml.unwrap(this.html_))};goog.ui.tree.BaseNode.prototype.setSafeHtml=function(d){this.html_=d;var c=this.getLabelElement();c&&goog.dom.safe.setInnerHtml(c,d);(d=this.getTree())&&d.setNode(this)};goog.ui.tree.BaseNode.prototype.getHtml=function(){return goog.html.SafeHtml.unwrap(this.getSafeHtml())};goog.ui.tree.BaseNode.prototype.getSafeHtml=function(){return this.html_};goog.ui.tree.BaseNode.prototype.setToolTip=function(d){this.toolTip_=d;var c=this.getLabelElement();c&&(c.title=d)};goog.ui.tree.BaseNode.prototype.getToolTip=function(){return this.toolTip_};goog.ui.tree.BaseNode.prototype.updateRow=function(){var b=this.getRowElement();b&&(b.className=this.getRowClassName())};goog.ui.tree.BaseNode.prototype.updateExpandIcon=function(){var b=this.getExpandIconElement();b&&(b.className=this.getExpandIconClass());if(b=this.getChildrenElement()){b.style.backgroundPosition=this.getBackgroundPosition()}};goog.ui.tree.BaseNode.prototype.updateIcon_=function(){this.getIconElement().className=this.getCalculatedIconClass()};goog.ui.tree.BaseNode.prototype.onMouseDown=function(b){"expand"==b.target.getAttribute("type")&&this.hasChildren()?this.isUserCollapsible_&&this.toggle():(this.select(),this.updateRow())};goog.ui.tree.BaseNode.prototype.onClick_=goog.events.Event.preventDefault;goog.ui.tree.BaseNode.prototype.onDoubleClick_=function(b){"expand"==b.target.getAttribute("type")&&this.hasChildren()||this.isUserCollapsible_&&this.toggle()};goog.ui.tree.BaseNode.prototype.onKeyDown=function(f){var e=!0;switch(f.keyCode){case goog.events.KeyCodes.RIGHT:if(f.altKey){break}this.hasChildren()&&(this.getExpanded()?this.getFirstChild().select():this.setExpanded(!0));break;case goog.events.KeyCodes.LEFT:if(f.altKey){break}if(this.hasChildren()&&this.getExpanded()&&this.isUserCollapsible_){this.setExpanded(!1)}else{var h=this.getParent(),g=this.getTree();h&&(g.getShowRootNode()||h!=g)&&h.select()}break;case goog.events.KeyCodes.DOWN:(h=this.getNextShownNode())&&h.select();break;case goog.events.KeyCodes.UP:(h=this.getPreviousShownNode())&&h.select();break;default:e=!1}e&&(f.preventDefault(),(g=this.getTree())&&g.clearTypeAhead());return e};goog.ui.tree.BaseNode.prototype.getLastShownDescendant=function(){return this.getExpanded()&&this.hasChildren()?this.getLastChild().getLastShownDescendant():this};goog.ui.tree.BaseNode.prototype.getNextShownNode=function(){if(this.hasChildren()&&this.getExpanded()){return this.getFirstChild()}for(var d=this,c;d!=this.getTree();){c=d.getNextSibling();if(null!=c){return c}d=d.getParent()}return null};goog.ui.tree.BaseNode.prototype.getPreviousShownNode=function(){var d=this.getPreviousSibling();if(null!=d){return d.getLastShownDescendant()}var d=this.getParent(),c=this.getTree();return !c.getShowRootNode()&&d==c||this==c?null:d};goog.ui.tree.BaseNode.prototype.getClientData=goog.ui.tree.BaseNode.prototype.getModel;goog.ui.tree.BaseNode.prototype.setClientData=goog.ui.tree.BaseNode.prototype.setModel;goog.ui.tree.BaseNode.prototype.getConfig=function(){return this.config_};goog.ui.tree.BaseNode.prototype.setTreeInternal=function(b){this.tree!=b&&(this.tree=b,b.setNode(this),this.forEachChild(function(a){a.setTreeInternal(b)}))};goog.ui.tree.BaseNode.defaultConfig={indentWidth:19,cssRoot:"goog-tree-root goog-tree-item",cssHideRoot:"goog-tree-hide-root",cssItem:"goog-tree-item",cssChildren:"goog-tree-children",cssChildrenNoLines:"goog-tree-children-nolines",cssTreeRow:"goog-tree-row",cssItemLabel:"goog-tree-item-label",cssTreeIcon:"goog-tree-icon",cssExpandTreeIcon:"goog-tree-expand-icon",cssExpandTreeIconPlus:"goog-tree-expand-icon-plus",cssExpandTreeIconMinus:"goog-tree-expand-icon-minus",cssExpandTreeIconTPlus:"goog-tree-expand-icon-tplus",cssExpandTreeIconTMinus:"goog-tree-expand-icon-tminus",cssExpandTreeIconLPlus:"goog-tree-expand-icon-lplus",cssExpandTreeIconLMinus:"goog-tree-expand-icon-lminus",cssExpandTreeIconT:"goog-tree-expand-icon-t",cssExpandTreeIconL:"goog-tree-expand-icon-l",cssExpandTreeIconBlank:"goog-tree-expand-icon-blank",cssExpandedFolderIcon:"goog-tree-expanded-folder-icon",cssCollapsedFolderIcon:"goog-tree-collapsed-folder-icon",cssFileIcon:"goog-tree-file-icon",cssExpandedRootIcon:"goog-tree-expanded-folder-icon",cssCollapsedRootIcon:"goog-tree-collapsed-folder-icon",cssSelectedRow:"selected"};goog.ui.tree.TreeNode=function(e,d,f){goog.ui.tree.BaseNode.call(this,e,d,f)};goog.inherits(goog.ui.tree.TreeNode,goog.ui.tree.BaseNode);goog.ui.tree.TreeNode.prototype.getTree=function(){if(this.tree){return this.tree}var b=this.getParent();return b&&(b=b.getTree())?(this.setTreeInternal(b),b):null};goog.ui.tree.TreeNode.prototype.getCalculatedIconClass=function(){var d=this.getExpanded(),c=this.getExpandedIconClass();if(d&&c){return c}c=this.getIconClass();if(!d&&c){return c}c=this.getConfig();if(this.hasChildren()){if(d&&c.cssExpandedFolderIcon){return c.cssTreeIcon+" "+c.cssExpandedFolderIcon}if(!d&&c.cssCollapsedFolderIcon){return c.cssTreeIcon+" "+c.cssCollapsedFolderIcon}}else{if(c.cssFileIcon){return c.cssTreeIcon+" "+c.cssFileIcon}}return""};goog.structs.Trie=function(b){this.value_=void 0;this.childNodes_={};b&&this.setAll(b)};goog.structs.Trie.prototype.set=function(d,c){this.setOrAdd_(d,c,!1)};goog.structs.Trie.prototype.add=function(d,c){this.setOrAdd_(d,c,!0)};goog.structs.Trie.prototype.setOrAdd_=function(h,g,l){for(var k=this,j=0;j<h.length;j++){var i=h.charAt(j);k.childNodes_[i]||(k.childNodes_[i]=new goog.structs.Trie);k=k.childNodes_[i]}if(l&&void 0!==k.value_){throw Error('The collection already contains the key "'+h+'"')}k.value_=g};goog.structs.Trie.prototype.setAll=function(e){var d=goog.structs.getKeys(e);e=goog.structs.getValues(e);for(var f=0;f<d.length;f++){this.set(d[f],e[f])}};goog.structs.Trie.prototype.getChildNode_=function(f){for(var e=this,h=0;h<f.length;h++){var g=f.charAt(h),e=e.childNodes_[g];if(!e){return}}return e};goog.structs.Trie.prototype.get=function(b){return(b=this.getChildNode_(b))?b.value_:void 0};goog.structs.Trie.prototype.getKeyAndPrefixes=function(h,g){var l=this,k={},j=g||0;void 0!==l.value_&&(k[j]=l.value_);for(;j<h.length;j++){var i=h.charAt(j);if(!(i in l.childNodes_)){break}l=l.childNodes_[i];void 0!==l.value_&&(k[j]=l.value_)}return k};goog.structs.Trie.prototype.getValues=function(){var b=[];this.getValuesInternal_(b);return b};goog.structs.Trie.prototype.getValuesInternal_=function(d){void 0!==this.value_&&d.push(this.value_);for(var c in this.childNodes_){this.childNodes_[c].getValuesInternal_(d)}};goog.structs.Trie.prototype.getKeys=function(g){var f=[];if(g){for(var j=this,i=0;i<g.length;i++){var h=g.charAt(i);if(!j.childNodes_[h]){return[]}j=j.childNodes_[h]}j.getKeysInternal_(g,f)}else{this.getKeysInternal_("",f)}return f};goog.structs.Trie.prototype.getKeysInternal_=function(e,d){void 0!==this.value_&&d.push(e);for(var f in this.childNodes_){this.childNodes_[f].getKeysInternal_(e+f,d)}};goog.structs.Trie.prototype.containsKey=function(b){return void 0!==this.get(b)};goog.structs.Trie.prototype.containsPrefix=function(b){return 0==b.length?!this.isEmpty():!!this.getChildNode_(b)};goog.structs.Trie.prototype.containsValue=function(d){if(this.value_===d){return !0}for(var c in this.childNodes_){if(this.childNodes_[c].containsValue(d)){return !0}}return !1};goog.structs.Trie.prototype.clear=function(){this.childNodes_={};this.value_=void 0};goog.structs.Trie.prototype.remove=function(g){for(var f=this,j=[],i=0;i<g.length;i++){var h=g.charAt(i);if(!f.childNodes_[h]){throw Error('The collection does not have the key "'+g+'"')}j.push([f,h]);f=f.childNodes_[h]}g=f.value_;for(delete f.value_;0<j.length;){if(h=j.pop(),f=h[0],h=h[1],f.childNodes_[h].isEmpty()){delete f.childNodes_[h]}else{break}}return g};goog.structs.Trie.prototype.clone=function(){return new goog.structs.Trie(this)};goog.structs.Trie.prototype.getCount=function(){return goog.structs.getCount(this.getValues())};goog.structs.Trie.prototype.isEmpty=function(){return void 0===this.value_&&goog.object.isEmpty(this.childNodes_)};goog.ui.tree.TypeAhead=function(){this.nodeMap_=new goog.structs.Trie;this.buffer_="";this.matchingNodes_=this.matchingLabels_=null;this.matchingNodeIndex_=this.matchingLabelIndex_=0};goog.ui.tree.TypeAhead.Offset={DOWN:1,UP:-1};goog.ui.tree.TypeAhead.prototype.handleNavigation=function(d){var c=!1;switch(d.keyCode){case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.UP:d.ctrlKey&&(this.jumpTo_(d.keyCode==goog.events.KeyCodes.DOWN?goog.ui.tree.TypeAhead.Offset.DOWN:goog.ui.tree.TypeAhead.Offset.UP),c=!0);break;case goog.events.KeyCodes.BACKSPACE:d=this.buffer_.length-1;c=!0;0<d?(this.buffer_=this.buffer_.substring(0,d),this.jumpToLabel_(this.buffer_)):0==d?this.buffer_="":c=!1;break;case goog.events.KeyCodes.ESC:this.buffer_="",c=!0}return c};goog.ui.tree.TypeAhead.prototype.handleTypeAheadChar=function(d){var c=!1;d.ctrlKey||d.altKey||(d=String.fromCharCode(d.charCode||d.keyCode).toLowerCase(),goog.string.isUnicodeChar(d)&&(" "!=d||this.buffer_)&&(this.buffer_+=d,c=this.jumpToLabel_(this.buffer_)));return c};goog.ui.tree.TypeAhead.prototype.setNodeInMap=function(e){var d=e.getText();if(d&&!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(d))){var d=d.toLowerCase(),f=this.nodeMap_.get(d);f?f.push(e):this.nodeMap_.set(d,[e])}};goog.ui.tree.TypeAhead.prototype.removeNodeFromMap=function(g){var f=g.getText();if(f&&!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(f))){var f=f.toLowerCase(),j=this.nodeMap_.get(f);if(j){for(var i=g.getChildCount(),h=0;h<i;h++){this.removeNodeFromMap(g.getChildAt(h))}goog.array.remove(j,g);j.length||this.nodeMap_.remove(f)}}};goog.ui.tree.TypeAhead.prototype.jumpToLabel_=function(d){var c=!1;(d=this.nodeMap_.getKeys(d))&&d.length&&(this.matchingLabelIndex_=this.matchingNodeIndex_=0,c=this.nodeMap_.get(d[0]),c=this.selectMatchingNode_(c))&&(this.matchingLabels_=d);return c};goog.ui.tree.TypeAhead.prototype.jumpTo_=function(g){var f=!1,j=this.matchingLabels_;if(j){var f=null,i=!1;if(this.matchingNodes_){var h=this.matchingNodeIndex_+g;0<=h&&h<this.matchingNodes_.length?(this.matchingNodeIndex_=h,f=this.matchingNodes_):i=!0}f||(h=this.matchingLabelIndex_+g,0<=h&&h<j.length&&(this.matchingLabelIndex_=h),j.length>this.matchingLabelIndex_&&(f=this.nodeMap_.get(j[this.matchingLabelIndex_])),f&&f.length&&i&&(this.matchingNodeIndex_=g==goog.ui.tree.TypeAhead.Offset.UP?f.length-1:0));if(f=this.selectMatchingNode_(f)){this.matchingLabels_=j}}return f};goog.ui.tree.TypeAhead.prototype.selectMatchingNode_=function(d){var c;d&&(this.matchingNodeIndex_<d.length&&(c=d[this.matchingNodeIndex_],this.matchingNodes_=d),c&&(c.reveal(),c.select()));return !!c};goog.ui.tree.TypeAhead.prototype.clear=function(){this.buffer_=""};goog.ui.tree.TreeControl=function(f,e,h){goog.ui.tree.BaseNode.call(this,f,e,h);this.setExpandedInternal(!0);this.setSelectedInternal(!0);this.selectedItem_=this;this.typeAhead_=new goog.ui.tree.TypeAhead;this.focusHandler_=this.keyHandler_=null;this.logger_=goog.log.getLogger("this");this.focused_=!1;this.focusedNode_=null;this.showRootLines_=this.showRootNode_=this.showExpandIcons_=this.showLines_=!0;if(goog.userAgent.IE){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(g){goog.log.warning(this.logger_,"Failed to enable background image cache")}}};goog.inherits(goog.ui.tree.TreeControl,goog.ui.tree.BaseNode);goog.ui.tree.TreeControl.prototype.getTree=function(){return this};goog.ui.tree.TreeControl.prototype.getDepth=function(){return 0};goog.ui.tree.TreeControl.prototype.reveal=function(){};goog.ui.tree.TreeControl.prototype.handleFocus_=function(b){this.focused_=!0;goog.dom.classlist.add(goog.asserts.assert(this.getElement()),"focused");this.selectedItem_&&this.selectedItem_.select()};goog.ui.tree.TreeControl.prototype.handleBlur_=function(b){this.focused_=!1;goog.dom.classlist.remove(goog.asserts.assert(this.getElement()),"focused")};goog.ui.tree.TreeControl.prototype.hasFocus=function(){return this.focused_};goog.ui.tree.TreeControl.prototype.getExpanded=function(){return !this.showRootNode_||goog.ui.tree.TreeControl.superClass_.getExpanded.call(this)};goog.ui.tree.TreeControl.prototype.setExpanded=function(b){this.showRootNode_?goog.ui.tree.TreeControl.superClass_.setExpanded.call(this,b):this.setExpandedInternal(b)};goog.ui.tree.TreeControl.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.EMPTY};goog.ui.tree.TreeControl.prototype.getIconElement=function(){var b=this.getRowElement();return b?b.firstChild:null};goog.ui.tree.TreeControl.prototype.getExpandIconElement=function(){return null};goog.ui.tree.TreeControl.prototype.updateExpandIcon=function(){};goog.ui.tree.TreeControl.prototype.getRowClassName=function(){return goog.ui.tree.TreeControl.superClass_.getRowClassName.call(this)+(this.showRootNode_?"":" "+this.getConfig().cssHideRoot)};goog.ui.tree.TreeControl.prototype.getCalculatedIconClass=function(){var d=this.getExpanded(),c=this.getExpandedIconClass();if(d&&c){return c}c=this.getIconClass();if(!d&&c){return c}c=this.getConfig();return d&&c.cssExpandedRootIcon?c.cssTreeIcon+" "+c.cssExpandedRootIcon:!d&&c.cssCollapsedRootIcon?c.cssTreeIcon+" "+c.cssCollapsedRootIcon:""};goog.ui.tree.TreeControl.prototype.setSelectedItem=function(d){if(this.selectedItem_!=d){var c=!1;this.selectedItem_&&(c=this.selectedItem_==this.focusedNode_,this.selectedItem_.setSelectedInternal(!1));if(this.selectedItem_=d){d.setSelectedInternal(!0),c&&d.select()}this.dispatchEvent(goog.events.EventType.CHANGE)}};goog.ui.tree.TreeControl.prototype.getSelectedItem=function(){return this.selectedItem_};goog.ui.tree.TreeControl.prototype.setShowLines=function(b){this.showLines_!=b&&(this.showLines_=b,this.isInDocument()&&this.updateLinesAndExpandIcons_())};goog.ui.tree.TreeControl.prototype.getShowLines=function(){return this.showLines_};goog.ui.tree.TreeControl.prototype.updateLinesAndExpandIcons_=function(){function f(c){var b=c.getChildrenElement();if(b){var a=!h||e==c.getParent()&&!g?c.getConfig().cssChildrenNoLines:c.getConfig().cssChildren;b.className=a;if(b=c.getExpandIconElement()){b.className=c.getExpandIconClass()}}c.forEachChild(f)}var e=this,h=e.getShowLines(),g=e.getShowRootLines();f(this)};goog.ui.tree.TreeControl.prototype.setShowRootLines=function(b){this.showRootLines_!=b&&(this.showRootLines_=b,this.isInDocument()&&this.updateLinesAndExpandIcons_())};goog.ui.tree.TreeControl.prototype.getShowRootLines=function(){return this.showRootLines_};goog.ui.tree.TreeControl.prototype.setShowExpandIcons=function(b){this.showExpandIcons_!=b&&(this.showExpandIcons_=b,this.isInDocument()&&this.updateLinesAndExpandIcons_())};goog.ui.tree.TreeControl.prototype.getShowExpandIcons=function(){return this.showExpandIcons_};goog.ui.tree.TreeControl.prototype.setShowRootNode=function(d){if(this.showRootNode_!=d){this.showRootNode_=d;if(this.isInDocument()){var c=this.getRowElement();c&&(c.className=this.getRowClassName())}!d&&this.getSelectedItem()==this&&this.getFirstChild()&&this.setSelectedItem(this.getFirstChild())}};goog.ui.tree.TreeControl.prototype.getShowRootNode=function(){return this.showRootNode_};goog.ui.tree.TreeControl.prototype.initAccessibility=function(){goog.ui.tree.TreeControl.superClass_.initAccessibility.call(this);var b=this.getElement();goog.asserts.assert(b,"The DOM element for the tree cannot be null.");goog.a11y.aria.setRole(b,"tree");goog.a11y.aria.setState(b,"labelledby",this.getLabelElement().id)};goog.ui.tree.TreeControl.prototype.enterDocument=function(){goog.ui.tree.TreeControl.superClass_.enterDocument.call(this);var b=this.getElement();b.className=this.getConfig().cssRoot;b.setAttribute("hideFocus","true");this.attachEvents_();this.initAccessibility()};goog.ui.tree.TreeControl.prototype.exitDocument=function(){goog.ui.tree.TreeControl.superClass_.exitDocument.call(this);this.detachEvents_()};goog.ui.tree.TreeControl.prototype.attachEvents_=function(){var e=this.getElement();e.tabIndex=0;var d=this.keyHandler_=new goog.events.KeyHandler(e),f=this.focusHandler_=new goog.events.FocusHandler(e);this.getHandler().listen(f,goog.events.FocusHandler.EventType.FOCUSOUT,this.handleBlur_).listen(f,goog.events.FocusHandler.EventType.FOCUSIN,this.handleFocus_).listen(d,goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent).listen(e,goog.events.EventType.MOUSEDOWN,this.handleMouseEvent_).listen(e,goog.events.EventType.CLICK,this.handleMouseEvent_).listen(e,goog.events.EventType.DBLCLICK,this.handleMouseEvent_)};goog.ui.tree.TreeControl.prototype.detachEvents_=function(){this.keyHandler_.dispose();this.keyHandler_=null;this.focusHandler_.dispose();this.focusHandler_=null};goog.ui.tree.TreeControl.prototype.handleMouseEvent_=function(d){goog.log.fine(this.logger_,"Received event "+d.type);var c=this.getNodeFromEvent_(d);if(c){switch(d.type){case goog.events.EventType.MOUSEDOWN:c.onMouseDown(d);break;case goog.events.EventType.CLICK:c.onClick_(d);break;case goog.events.EventType.DBLCLICK:c.onDoubleClick_(d)}}};goog.ui.tree.TreeControl.prototype.handleKeyEvent=function(d){var c;(c=this.typeAhead_.handleNavigation(d)||this.selectedItem_&&this.selectedItem_.onKeyDown(d)||this.typeAhead_.handleTypeAheadChar(d))&&d.preventDefault();return c};goog.ui.tree.TreeControl.prototype.getNodeFromEvent_=function(d){for(var c=d.target;null!=c;){if(d=goog.ui.tree.BaseNode.allNodes[c.id]){return d}if(c==this.getElement()){break}c=c.parentNode}return null};goog.ui.tree.TreeControl.prototype.createNode=function(b){return new goog.ui.tree.TreeNode(b||goog.html.SafeHtml.EMPTY,this.getConfig(),this.getDomHelper())};goog.ui.tree.TreeControl.prototype.setNode=function(b){this.typeAhead_.setNodeInMap(b)};goog.ui.tree.TreeControl.prototype.removeNode=function(b){this.typeAhead_.removeNodeFromMap(b)};goog.ui.tree.TreeControl.prototype.clearTypeAhead=function(){this.typeAhead_.clear()};goog.ui.tree.TreeControl.defaultConfig=goog.ui.tree.BaseNode.defaultConfig;"use strict";var Blockly={};Blockly.Blocks=Object(null);"use strict";Blockly.Touch={};Blockly.Touch.touchIdentifier_=null;Blockly.Touch.onTouchUpWrapper_=null;Blockly.Touch.TOUCH_MAP={};goog.events.BrowserFeature.TOUCH_ENABLED&&(Blockly.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]});Blockly.longPid_=0;Blockly.longStart_=function(d,c){Blockly.longStop_();1==d.changedTouches.length&&(Blockly.longPid_=setTimeout(function(){d.button=2;d.clientX=d.changedTouches[0].clientX;d.clientY=d.changedTouches[0].clientY;c.onMouseDown_(d)},Blockly.LONGPRESS))};Blockly.longStop_=function(){Blockly.longPid_&&(clearTimeout(Blockly.longPid_),Blockly.longPid_=0)};Blockly.onMouseUp_=function(b){b=Blockly.getMainWorkspace();b.dragMode_!=Blockly.DRAG_NONE&&(Blockly.Touch.clearTouchIdentifier(),b.resetDragSurface(),Blockly.Css.setCursor(Blockly.Css.Cursor.OPEN),b.dragMode_=Blockly.DRAG_NONE,Blockly.Touch.onTouchUpWrapper_&&(Blockly.unbindEvent_(Blockly.Touch.onTouchUpWrapper_),Blockly.Touch.onTouchUpWrapper_=null),Blockly.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.onMouseMoveWrapper_),Blockly.onMouseMoveWrapper_=null))};Blockly.onMouseMove_=function(i){var h=Blockly.getMainWorkspace();if(h.dragMode_!=Blockly.DRAG_NONE){var n=i.clientX-h.startDragMouseX,m=i.clientY-h.startDragMouseY,l=h.startDragMetrics,k=h.startScrollX+n,j=h.startScrollY+m,k=Math.min(k,-l.contentLeft),j=Math.min(j,-l.contentTop),k=Math.max(k,l.viewWidth-l.contentLeft-l.contentWidth),j=Math.max(j,l.viewHeight-l.contentTop-l.contentHeight);h.scrollbar.set(-k-l.contentLeft,-j-l.contentTop);Math.sqrt(n*n+m*m)>Blockly.DRAG_RADIUS&&(Blockly.longStop_(),h.dragMode_=Blockly.DRAG_FREE);i.stopPropagation();i.preventDefault()}};Blockly.Touch.clearTouchIdentifier=function(){Blockly.Touch.touchIdentifier_=null};Blockly.Touch.shouldHandleEvent=function(b){return !Blockly.Touch.isMouseOrTouchEvent(b)||Blockly.Touch.checkTouchIdentifier(b)};Blockly.Touch.checkTouchIdentifier=function(d){var c=d.changedTouches&&d.changedTouches[0]&&void 0!=d.changedTouches[0].identifier&&null!=d.changedTouches[0].identifier?d.changedTouches[0].identifier:"mouse";return void 0!=Blockly.Touch.touchIdentifier_&&null!=Blockly.Touch.touchIdentifier_?Blockly.Touch.touchIdentifier_==c:"mousedown"==d.type||"touchstart"==d.type?(Blockly.Touch.touchIdentifier_=c,!0):!1};Blockly.Touch.setClientFromTouch=function(d){if(goog.string.startsWith(d.type,"touch")){var c=d.changedTouches[0];d.clientX=c.clientX;d.clientY=c.clientY}};Blockly.Touch.isMouseOrTouchEvent=function(b){return goog.string.startsWith(b.type,"touch")||goog.string.startsWith(b.type,"mouse")};Blockly.Touch.splitEventByTouches=function(e){var d=[];if(e.changedTouches){for(var f=0;f<e.changedTouches.length;f++){d[f]={type:e.type,changedTouches:[e.changedTouches[f]],target:e.target,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()}}}}else{d.push(e)}return d};"use strict";Blockly.Workspace=function(b){this.id=Blockly.utils.genUid();Blockly.Workspace.WorkspaceDB_[this.id]=this;this.options=b||{};this.RTL=!!this.options.RTL;this.horizontalLayout=!!this.options.horizontalLayout;this.toolboxPosition=this.options.toolboxPosition;this.topBlocks_=[];this.listeners_=[];this.undoStack_=[];this.redoStack_=[];this.blockDB_=Object.create(null);this.variableList=[]};Blockly.Workspace.prototype.rendered=!1;Blockly.Workspace.prototype.MAX_UNDO=1024;Blockly.Workspace.prototype.dispose=function(){this.listeners_.length=0;this.clear();delete Blockly.Workspace.WorkspaceDB_[this.id]};Blockly.Workspace.SCAN_ANGLE=3;Blockly.Workspace.prototype.addTopBlock=function(d){this.topBlocks_.push(d);if(this.isFlyout){d=Blockly.Variables.allUsedVariables(d);for(var c=0;c<d.length;c++){-1==this.variableList.indexOf(d[c])&&this.variableList.push(d[c])}}};Blockly.Workspace.prototype.removeTopBlock=function(b){if(!goog.array.remove(this.topBlocks_,b)){throw"Block not present in workspace's list of top-most blocks."}};Blockly.Workspace.prototype.getTopBlocks=function(e){var d=[].concat(this.topBlocks_);if(e&&1<d.length){var f=Math.sin(goog.math.toRadians(Blockly.Workspace.SCAN_ANGLE));this.RTL&&(f*=-1);d.sort(function(g,c){var i=g.getRelativeToSurfaceXY(),h=c.getRelativeToSurfaceXY();return i.y+f*i.x-(h.y+f*h.x)})}return d};Blockly.Workspace.prototype.getAllBlocks=function(){for(var d=this.getTopBlocks(!1),c=0;c<d.length;c++){d.push.apply(d,d[c].getChildren())}return d};Blockly.Workspace.prototype.clear=function(){var b=Blockly.Events.getGroup();for(b||Blockly.Events.setGroup(!0);this.topBlocks_.length;){this.topBlocks_[0].dispose()}b||Blockly.Events.setGroup(!1);this.variableList.length=0};Blockly.Workspace.prototype.updateVariableList=function(d){if(!this.isFlyout){d&&(this.variableList.length=0);d=Blockly.Variables.allUsedVariables(this);for(var c=0;c<d.length;c++){this.createVariable(d[c])}}};Blockly.Workspace.prototype.renameVariable=function(i,h){var n=this.variableIndexOf(i),m=this.variableIndexOf(h);if(-1!=m&&this.variableList[m]!=h){var l=this.variableList[m]}Blockly.Events.setGroup(!0);for(var k=this.getAllBlocks(),j=0;j<k.length;j++){k[j].renameVar(i,h),l&&k[j].renameVar(l,h)}Blockly.Events.setGroup(!1);n==m||-1!=n&&-1==m?this.variableList[n]=h:-1!=n&&-1!=m?(this.variableList[m]=h,this.variableList.splice(n,1)):(this.variableList.push(h),console.log("Tried to rename an non-existent variable."))};Blockly.Workspace.prototype.createVariable=function(b){-1==this.variableIndexOf(b)&&this.variableList.push(b)};Blockly.Workspace.prototype.getVariableUses=function(i){for(var h=[],n=this.getAllBlocks(),m=0;m<n.length;m++){var l=n[m].getVars();if(l){for(var k=0;k<l.length;k++){var j=l[k];j&&Blockly.Names.equals(j,i)&&h.push(n[m])}}}return h};Blockly.Workspace.prototype.deleteVariable=function(i){function h(){Blockly.Events.setGroup(!0);for(var b=0;b<m.length;b++){m[b].dispose(!0,!1)}Blockly.Events.setGroup(!1);j.variableList.splice(n,1)}var n=this.variableIndexOf(i);if(-1!=n){for(var m=this.getVariableUses(i),l=0,k;k=m[l];l++){if("procedures_defnoreturn"==k.type||"procedures_defreturn"==k.type){l=k.getFieldValue("NAME");Blockly.alert(Blockly.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",i).replace("%2",l));return}}var j=this;1<m.length?Blockly.confirm(Blockly.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",m.length).replace("%2",i),function(b){b&&h()}):h()}};Blockly.Workspace.prototype.variableIndexOf=function(e){for(var d=0,f;f=this.variableList[d];d++){if(Blockly.Names.equals(f,e)){return d}}return -1};Blockly.Workspace.prototype.getWidth=function(){return 0};Blockly.Workspace.prototype.newBlock=function(d,c){return new Blockly.Block(this,d,c)};Blockly.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?Infinity:this.options.maxBlocks-this.getAllBlocks().length};Blockly.Workspace.prototype.undo=function(g){var f=g?this.redoStack_:this.undoStack_,j=g?this.undoStack_:this.redoStack_,i=f.pop();if(i){for(var h=[i];f.length&&i.group&&i.group==f[f.length-1].group;){h.push(f.pop())}for(f=0;i=h[f];f++){j.push(i)}h=Blockly.Events.filter(h,g);Blockly.Events.recordUndo=!1;for(f=0;i=h[f];f++){i.run(g)}Blockly.Events.recordUndo=!0}};Blockly.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0;this.redoStack_.length=0;Blockly.Events.clearPendingUndo()};Blockly.Workspace.prototype.addChangeListener=function(b){this.listeners_.push(b);return b};Blockly.Workspace.prototype.removeChangeListener=function(b){goog.array.remove(this.listeners_,b)};Blockly.Workspace.prototype.fireChangeListener=function(e){e.recordUndo&&(this.undoStack_.push(e),this.redoStack_.length=0,this.undoStack_.length>this.MAX_UNDO&&this.undoStack_.unshift());for(var d=0,f;f=this.listeners_[d];d++){f(e)}};Blockly.Workspace.prototype.getBlockById=function(b){return this.blockDB_[b]||null};Blockly.Workspace.prototype.allInputsFilled=function(f){for(var e=this.getTopBlocks(!1),h=0,g;g=e[h];h++){if(!g.allInputsFilled(f)){return !1}}return !0};Blockly.Workspace.WorkspaceDB_=Object.create(null);Blockly.Workspace.getById=function(b){return Blockly.Workspace.WorkspaceDB_[b]||null};Blockly.Workspace.prototype.clear=Blockly.Workspace.prototype.clear;Blockly.Workspace.prototype.clearUndo=Blockly.Workspace.prototype.clearUndo;Blockly.Workspace.prototype.addChangeListener=Blockly.Workspace.prototype.addChangeListener;Blockly.Workspace.prototype.removeChangeListener=Blockly.Workspace.prototype.removeChangeListener;"use strict";Blockly.Bubble=function(h,g,l,k,j,i){this.workspace_=h;this.content_=g;this.shape_=l;l=Blockly.Bubble.ARROW_ANGLE;this.workspace_.RTL&&(l=-l);this.arrow_radians_=goog.math.toRadians(l);h.getBubbleCanvas().appendChild(this.createDom_(g,!(!j||!i)));this.setAnchorLocation(k);j&&i||(g=this.content_.getBBox(),j=g.width+2*Blockly.Bubble.BORDER_WIDTH,i=g.height+2*Blockly.Bubble.BORDER_WIDTH);this.setBubbleSize(j,i);this.positionBubble_();this.renderArrow_();this.rendered_=!0;h.options.readOnly||(Blockly.bindEventWithChecks_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&Blockly.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))};Blockly.Bubble.BORDER_WIDTH=6;Blockly.Bubble.ARROW_THICKNESS=5;Blockly.Bubble.ARROW_ANGLE=20;Blockly.Bubble.ARROW_BEND=4;Blockly.Bubble.ANCHOR_RADIUS=8;Blockly.Bubble.onMouseUpWrapper_=null;Blockly.Bubble.onMouseMoveWrapper_=null;Blockly.Bubble.prototype.resizeCallback_=null;Blockly.Bubble.unbindDragEvents_=function(){Blockly.Bubble.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Bubble.onMouseUpWrapper_),Blockly.Bubble.onMouseUpWrapper_=null);Blockly.Bubble.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Bubble.onMouseMoveWrapper_),Blockly.Bubble.onMouseMoveWrapper_=null)};Blockly.Bubble.bubbleMouseUp_=function(){Blockly.Touch.clearTouchIdentifier();Blockly.Css.setCursor(Blockly.Css.Cursor.OPEN);Blockly.Bubble.unbindDragEvents_()};Blockly.Bubble.prototype.rendered_=!1;Blockly.Bubble.prototype.anchorXY_=null;Blockly.Bubble.prototype.relativeLeft_=0;Blockly.Bubble.prototype.relativeTop_=0;Blockly.Bubble.prototype.width_=0;Blockly.Bubble.prototype.height_=0;Blockly.Bubble.prototype.autoLayout_=!0;Blockly.Bubble.prototype.createDom_=function(e,d){this.bubbleGroup_=Blockly.utils.createSvgElement("g",{},null);var f={filter:"url(#"+this.workspace_.options.embossFilterId+")"};-1!=goog.userAgent.getUserAgentString().indexOf("JavaFX")&&(f={});f=Blockly.utils.createSvgElement("g",f,this.bubbleGroup_);this.bubbleArrow_=Blockly.utils.createSvgElement("path",{},f);this.bubbleBack_=Blockly.utils.createSvgElement("rect",{"class":"blocklyDraggable",x:0,y:0,rx:Blockly.Bubble.BORDER_WIDTH,ry:Blockly.Bubble.BORDER_WIDTH},f);d?(this.resizeGroup_=Blockly.utils.createSvgElement("g",{"class":this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),f=2*Blockly.Bubble.BORDER_WIDTH,Blockly.utils.createSvgElement("polygon",{points:"0,x x,x x,0".replace(/x/g,f.toString())},this.resizeGroup_),Blockly.utils.createSvgElement("line",{"class":"blocklyResizeLine",x1:f/3,y1:f-1,x2:f-1,y2:f/3},this.resizeGroup_),Blockly.utils.createSvgElement("line",{"class":"blocklyResizeLine",x1:2*f/3,y1:f-1,x2:f-1,y2:2*f/3},this.resizeGroup_)):this.resizeGroup_=null;this.bubbleGroup_.appendChild(e);return this.bubbleGroup_};Blockly.Bubble.prototype.bubbleMouseDown_=function(b){this.promote_();Blockly.Bubble.unbindDragEvents_();Blockly.utils.isRightButton(b)?b.stopPropagation():Blockly.utils.isTargetInput(b)||(Blockly.Css.setCursor(Blockly.Css.Cursor.CLOSED),this.workspace_.startDrag(b,new goog.math.Coordinate(this.workspace_.RTL?-this.relativeLeft_:this.relativeLeft_,this.relativeTop_)),Blockly.Bubble.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,Blockly.Bubble.bubbleMouseUp_),Blockly.Bubble.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.bubbleMouseMove_),Blockly.hideChaff(),b.stopPropagation())};Blockly.Bubble.prototype.bubbleMouseMove_=function(b){this.autoLayout_=!1;b=this.workspace_.moveDrag(b);this.relativeLeft_=this.workspace_.RTL?-b.x:b.x;this.relativeTop_=b.y;this.positionBubble_();this.renderArrow_()};Blockly.Bubble.prototype.resizeMouseDown_=function(b){this.promote_();Blockly.Bubble.unbindDragEvents_();Blockly.utils.isRightButton(b)||(Blockly.Css.setCursor(Blockly.Css.Cursor.CLOSED),this.workspace_.startDrag(b,new goog.math.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),Blockly.Bubble.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,Blockly.Bubble.bubbleMouseUp_),Blockly.Bubble.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.resizeMouseMove_),Blockly.hideChaff());b.stopPropagation()};Blockly.Bubble.prototype.resizeMouseMove_=function(b){this.autoLayout_=!1;b=this.workspace_.moveDrag(b);this.setBubbleSize(this.workspace_.RTL?-b.x:b.x,b.y);this.workspace_.RTL&&this.positionBubble_()};Blockly.Bubble.prototype.registerResizeEvent=function(b){this.resizeCallback_=b};Blockly.Bubble.prototype.promote_=function(){this.bubbleGroup_.parentNode.appendChild(this.bubbleGroup_)};Blockly.Bubble.prototype.setAnchorLocation=function(b){this.anchorXY_=b;this.rendered_&&this.positionBubble_()};Blockly.Bubble.prototype.layoutBubble_=function(){var f=-this.width_/4,e=-this.height_-Blockly.BlockSvg.MIN_BLOCK_Y,h=this.workspace_.getMetrics();h.viewWidth/=this.workspace_.scale;h.viewLeft/=this.workspace_.scale;var g=this.anchorXY_.x;this.workspace_.RTL?g-h.viewLeft-f-this.width_<Blockly.Scrollbar.scrollbarThickness?f=g-h.viewLeft-this.width_-Blockly.Scrollbar.scrollbarThickness:g-h.viewLeft-f>h.viewWidth&&(f=g-h.viewLeft-h.viewWidth):g+f<h.viewLeft?f=h.viewLeft-g:h.viewLeft+h.viewWidth<g+f+this.width_+Blockly.BlockSvg.SEP_SPACE_X+Blockly.Scrollbar.scrollbarThickness&&(f=h.viewLeft+h.viewWidth-g-this.width_-Blockly.Scrollbar.scrollbarThickness);this.anchorXY_.y+e<h.viewTop&&(e=this.shape_.getBBox().height);this.relativeLeft_=f;this.relativeTop_=e};Blockly.Bubble.prototype.positionBubble_=function(){var b=this.anchorXY_.x,b=this.workspace_.RTL?b-(this.relativeLeft_+this.width_):b+this.relativeLeft_;this.bubbleGroup_.setAttribute("transform","translate("+b+","+(this.relativeTop_+this.anchorXY_.y)+")")};Blockly.Bubble.prototype.getBubbleSize=function(){return{width:this.width_,height:this.height_}};Blockly.Bubble.prototype.setBubbleSize=function(e,d){var f=2*Blockly.Bubble.BORDER_WIDTH;e=Math.max(e,f+45);d=Math.max(d,f+20);this.width_=e;this.height_=d;this.bubbleBack_.setAttribute("width",e);this.bubbleBack_.setAttribute("height",d);this.resizeGroup_&&(this.workspace_.RTL?this.resizeGroup_.setAttribute("transform","translate("+2*Blockly.Bubble.BORDER_WIDTH+","+(d-f)+") scale(-1 1)"):this.resizeGroup_.setAttribute("transform","translate("+(e-f)+","+(d-f)+")"));this.rendered_&&(this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_());this.resizeCallback_&&this.resizeCallback_()};Blockly.Bubble.prototype.renderArrow_=function(){var x=[],w=this.width_/2,v=this.height_/2,u=-this.relativeLeft_,t=-this.relativeTop_;if(w==u&&v==t){x.push("M "+w+","+v)}else{t-=v;u-=w;this.workspace_.RTL&&(u*=-1);var s=Math.sqrt(t*t+u*u),r=Math.acos(u/s);0>t&&(r=2*Math.PI-r);var q=r+Math.PI/2;q>2*Math.PI&&(q-=2*Math.PI);var o=Math.sin(q),j=Math.cos(q),i=this.getBubbleSize(),q=(i.width+i.height)/Blockly.Bubble.ARROW_THICKNESS,q=Math.min(q,i.width,i.height)/4,i=1-Blockly.Bubble.ANCHOR_RADIUS/s,u=w+i*u,t=v+i*t,i=w+q*j,m=v+q*o,w=w-q*j,v=v-q*o,o=r+this.arrow_radians_;o>2*Math.PI&&(o-=2*Math.PI);r=Math.sin(o)*s/Blockly.Bubble.ARROW_BEND;s=Math.cos(o)*s/Blockly.Bubble.ARROW_BEND;x.push("M"+i+","+m);x.push("C"+(i+s)+","+(m+r)+" "+u+","+t+" "+u+","+t);x.push("C"+u+","+t+" "+(w+s)+","+(v+r)+" "+w+","+v)}x.push("z");this.bubbleArrow_.setAttribute("d",x.join(" "))};Blockly.Bubble.prototype.setColour=function(b){this.bubbleBack_.setAttribute("fill",b);this.bubbleArrow_.setAttribute("fill",b)};Blockly.Bubble.prototype.dispose=function(){Blockly.Bubble.unbindDragEvents_();goog.dom.removeNode(this.bubbleGroup_);this.shape_=this.content_=this.workspace_=this.resizeGroup_=this.bubbleBack_=this.bubbleArrow_=this.bubbleGroup_=null};"use strict";Blockly.Icon=function(b){this.block_=b};Blockly.Icon.prototype.collapseHidden=!0;Blockly.Icon.prototype.SIZE=17;Blockly.Icon.prototype.bubble_=null;Blockly.Icon.prototype.iconXY_=null;Blockly.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=Blockly.utils.createSvgElement("g",{"class":"blocklyIconGroup"},null),this.block_.isInFlyout&&Blockly.utils.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),Blockly.bindEventWithChecks_(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())};Blockly.Icon.prototype.dispose=function(){goog.dom.removeNode(this.iconGroup_);this.iconGroup_=null;this.setVisible(!1);this.block_=null};Blockly.Icon.prototype.updateEditable=function(){};Blockly.Icon.prototype.isVisible=function(){return !!this.bubble_};Blockly.Icon.prototype.iconClick_=function(b){this.block_.workspace.isDragging()||this.block_.isInFlyout||Blockly.utils.isRightButton(b)||this.setVisible(!this.isVisible())};Blockly.Icon.prototype.updateColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.getColour())};Blockly.Icon.prototype.renderIcon=function(d){if(this.collapseHidden&&this.block_.isCollapsed()){return this.iconGroup_.setAttribute("display","none"),d}this.iconGroup_.setAttribute("display","block");var c=this.SIZE;this.block_.RTL&&(d-=c);this.iconGroup_.setAttribute("transform","translate("+d+",5)");this.computeIconLocation();return d=this.block_.RTL?d-Blockly.BlockSvg.SEP_SPACE_X:d+(c+Blockly.BlockSvg.SEP_SPACE_X)};Blockly.Icon.prototype.setIconLocation=function(b){this.iconXY_=b;this.isVisible()&&this.bubble_.setAnchorLocation(b)};Blockly.Icon.prototype.computeIconLocation=function(){var d=this.block_.getRelativeToSurfaceXY(),c=Blockly.utils.getRelativeXY(this.iconGroup_),d=new goog.math.Coordinate(d.x+c.x+this.SIZE/2,d.y+c.y+this.SIZE/2);goog.math.Coordinate.equals(this.getIconLocation(),d)||this.setIconLocation(d)};Blockly.Icon.prototype.getIconLocation=function(){return this.iconXY_};"use strict";Blockly.Comment=function(b){Blockly.Comment.superClass_.constructor.call(this,b);this.createIcon()};goog.inherits(Blockly.Comment,Blockly.Icon);Blockly.Comment.prototype.text_="";Blockly.Comment.prototype.width_=160;Blockly.Comment.prototype.height_=80;Blockly.Comment.prototype.drawIcon_=function(b){Blockly.utils.createSvgElement("circle",{"class":"blocklyIconShape",r:"8",cx:"8",cy:"8"},b);Blockly.utils.createSvgElement("path",{"class":"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.405 0.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25 -1.201,0.998 -1.201,1.528 -1.204,2.19z"},b);Blockly.utils.createSvgElement("rect",{"class":"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},b)};Blockly.Comment.prototype.createEditor_=function(){this.foreignObject_=Blockly.utils.createSvgElement("foreignObject",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null);var d=document.createElementNS(Blockly.HTML_NS,"body");d.setAttribute("xmlns",Blockly.HTML_NS);d.className="blocklyMinimalBody";var c=document.createElementNS(Blockly.HTML_NS,"textarea");c.className="blocklyCommentTextarea";c.setAttribute("dir",this.block_.RTL?"RTL":"LTR");d.appendChild(c);this.textarea_=c;this.foreignObject_.appendChild(d);Blockly.bindEventWithChecks_(c,"mouseup",this,this.textareaFocus_);Blockly.bindEventWithChecks_(c,"wheel",this,function(b){b.stopPropagation()});Blockly.bindEventWithChecks_(c,"change",this,function(b){this.text_!=c.value&&(Blockly.Events.fire(new Blockly.Events.Change(this.block_,"comment",null,this.text_,c.value)),this.text_=c.value)});setTimeout(function(){c.focus()},0);return this.foreignObject_};Blockly.Comment.prototype.updateEditable=function(){this.isVisible()&&(this.setVisible(!1),this.setVisible(!0));Blockly.Icon.prototype.updateEditable.call(this)};Blockly.Comment.prototype.resizeBubble_=function(){if(this.isVisible()){var d=this.bubble_.getBubbleSize(),c=2*Blockly.Bubble.BORDER_WIDTH;this.foreignObject_.setAttribute("width",d.width-c);this.foreignObject_.setAttribute("height",d.height-c);this.textarea_.style.width=d.width-c-4+"px";this.textarea_.style.height=d.height-c-4+"px"}};Blockly.Comment.prototype.setVisible=function(e){if(e!=this.isVisible()){if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"commentOpen",!e,e)),!this.block_.isEditable()&&!this.textarea_||goog.userAgent.IE){Blockly.Warning.prototype.setVisible.call(this,e)}else{var d=this.getText(),f=this.getBubbleSize();e?(this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,this.width_,this.height_),this.bubble_.registerResizeEvent(this.resizeBubble_.bind(this)),this.updateColour()):(this.bubble_.dispose(),this.foreignObject_=this.textarea_=this.bubble_=null);this.setText(d);this.setBubbleSize(f.width,f.height)}}};Blockly.Comment.prototype.textareaFocus_=function(b){this.bubble_.promote_();this.textarea_.focus()};Blockly.Comment.prototype.getBubbleSize=function(){return this.isVisible()?this.bubble_.getBubbleSize():{width:this.width_,height:this.height_}};Blockly.Comment.prototype.setBubbleSize=function(d,c){this.textarea_?this.bubble_.setBubbleSize(d,c):(this.width_=d,this.height_=c)};Blockly.Comment.prototype.getText=function(){return this.textarea_?this.textarea_.value:this.text_};Blockly.Comment.prototype.setText=function(b){this.text_!=b&&(Blockly.Events.fire(new Blockly.Events.Change(this.block_,"comment",null,this.text_,b)),this.text_=b);this.textarea_&&(this.textarea_.value=b)};Blockly.Comment.prototype.dispose=function(){Blockly.Events.isEnabled()&&this.setText("");this.block_.comment=null;Blockly.Icon.prototype.dispose.call(this)};"use strict";Blockly.Connection=function(d,c){this.sourceBlock_=d;this.type=c;d.workspace.connectionDBList&&(this.db_=d.workspace.connectionDBList[c],this.dbOpposite_=d.workspace.connectionDBList[Blockly.OPPOSITE_TYPE[c]],this.hidden_=!this.db_)};Blockly.Connection.CAN_CONNECT=0;Blockly.Connection.REASON_SELF_CONNECTION=1;Blockly.Connection.REASON_WRONG_TYPE=2;Blockly.Connection.REASON_TARGET_NULL=3;Blockly.Connection.REASON_CHECKS_FAILED=4;Blockly.Connection.REASON_DIFFERENT_WORKSPACES=5;Blockly.Connection.REASON_SHADOW_PARENT=6;Blockly.Connection.prototype.targetConnection=null;Blockly.Connection.prototype.check_=null;Blockly.Connection.prototype.shadowDom_=null;Blockly.Connection.prototype.x_=0;Blockly.Connection.prototype.y_=0;Blockly.Connection.prototype.inDB_=!1;Blockly.Connection.prototype.db_=null;Blockly.Connection.prototype.dbOpposite_=null;Blockly.Connection.prototype.hidden_=null;Blockly.Connection.prototype.connect_=function(t){var s=this,r=s.getSourceBlock(),q=t.getSourceBlock();t.isConnected()&&t.disconnect();if(s.isConnected()){var p=s.targetBlock(),o=s.getShadowDom();s.setShadowDom(null);if(p.isShadow()){o=Blockly.Xml.blockToDom(p),p.dispose(),p=null}else{if(s.type==Blockly.INPUT_VALUE){if(!p.outputConnection){throw"Orphan block does not have an output connection."}var m=Blockly.Connection.lastConnectionInRow_(q,p);m&&(p.outputConnection.connect(m),p=null)}else{if(s.type==Blockly.NEXT_STATEMENT){if(!p.previousConnection){throw"Orphan block does not have a previous connection."}for(m=q;m.nextConnection;){var l=m.getNextBlock();if(l&&!l.isShadow()){m=l}else{p.previousConnection.checkType_(m.nextConnection)&&(m.nextConnection.connect(p.previousConnection),p=null);break}}}}}if(p&&(s.disconnect(),Blockly.Events.recordUndo)){var j=Blockly.Events.getGroup();setTimeout(function(){p.workspace&&!p.getParent()&&(Blockly.Events.setGroup(j),p.outputConnection?p.outputConnection.bumpAwayFrom_(s):p.previousConnection&&p.previousConnection.bumpAwayFrom_(s),Blockly.Events.setGroup(!1))},Blockly.BUMP_DELAY)}s.setShadowDom(o)}var i;Blockly.Events.isEnabled()&&(i=new Blockly.Events.Move(q));Blockly.Connection.connectReciprocally_(s,t);q.setParent(r);i&&(i.recordNew(),Blockly.Events.fire(i))};Blockly.Connection.prototype.dispose=function(){if(this.isConnected()){throw"Disconnect connection before disposing of it."}this.inDB_&&this.db_.removeConnection_(this);Blockly.highlightedConnection_==this&&(Blockly.highlightedConnection_=null);Blockly.localConnection_==this&&(Blockly.localConnection_=null);this.dbOpposite_=this.db_=null};Blockly.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_};Blockly.Connection.prototype.isSuperior=function(){return this.type==Blockly.INPUT_VALUE||this.type==Blockly.NEXT_STATEMENT};Blockly.Connection.prototype.isConnected=function(){return !!this.targetConnection};Blockly.Connection.prototype.canConnectWithReason_=function(e){if(!e){return Blockly.Connection.REASON_TARGET_NULL}if(this.isSuperior()){var d=this.sourceBlock_,f=e.getSourceBlock()}else{f=this.sourceBlock_,d=e.getSourceBlock()}return d&&d==f?Blockly.Connection.REASON_SELF_CONNECTION:e.type!=Blockly.OPPOSITE_TYPE[this.type]?Blockly.Connection.REASON_WRONG_TYPE:d&&f&&d.workspace!==f.workspace?Blockly.Connection.REASON_DIFFERENT_WORKSPACES:this.checkType_(e)?d.isShadow()&&!f.isShadow()?Blockly.Connection.REASON_SHADOW_PARENT:Blockly.Connection.CAN_CONNECT:Blockly.Connection.REASON_CHECKS_FAILED};Blockly.Connection.prototype.checkConnection_=function(b){switch(this.canConnectWithReason_(b)){case Blockly.Connection.CAN_CONNECT:break;case Blockly.Connection.REASON_SELF_CONNECTION:throw"Attempted to connect a block to itself.";case Blockly.Connection.REASON_DIFFERENT_WORKSPACES:throw"Blocks not on same workspace.";case Blockly.Connection.REASON_WRONG_TYPE:throw"Attempt to connect incompatible types.";case Blockly.Connection.REASON_TARGET_NULL:throw"Target connection is null.";case Blockly.Connection.REASON_CHECKS_FAILED:throw"Connection checks failed. "+(this+" expected "+this.check_+", found "+b.check_);case Blockly.Connection.REASON_SHADOW_PARENT:throw"Connecting non-shadow to shadow block.";default:throw"Unknown connection failure: this should never happen!"}};Blockly.Connection.prototype.isConnectionAllowed=function(b){if(this.canConnectWithReason_(b)!=Blockly.Connection.CAN_CONNECT){return !1}if(b.type==Blockly.OUTPUT_VALUE||b.type==Blockly.PREVIOUS_STATEMENT){if(b.isConnected()||this.isConnected()){return !1}}return b.type==Blockly.INPUT_VALUE&&b.isConnected()&&!b.targetBlock().isMovable()&&!b.targetBlock().isShadow()||this.type==Blockly.PREVIOUS_STATEMENT&&b.isConnected()&&!this.sourceBlock_.nextConnection&&!b.targetBlock().isShadow()&&b.targetBlock().nextConnection||-1!=Blockly.draggingConnections_.indexOf(b)?!1:!0};Blockly.Connection.prototype.connect=function(b){this.targetConnection!=b&&(this.checkConnection_(b),this.isSuperior()?this.connect_(b):b.connect_(this))};Blockly.Connection.connectReciprocally_=function(d,c){goog.asserts.assert(d&&c,"Cannot connect null connections.");d.targetConnection=c;c.targetConnection=d};Blockly.Connection.singleConnection_=function(g,f){for(var j=!1,i=0;i<g.inputList.length;i++){var h=g.inputList[i].connection;if(h&&h.type==Blockly.INPUT_VALUE&&f.outputConnection.checkType_(h)){if(j){return null}j=h}}return j};Blockly.Connection.lastConnectionInRow_=function(f,e){for(var h=f,g;g=Blockly.Connection.singleConnection_(h,e);){if(h=g.targetBlock(),!h||h.isShadow()){return g}}return null};Blockly.Connection.prototype.disconnect=function(){var e=this.targetConnection;goog.asserts.assert(e,"Source connection not connected.");goog.asserts.assert(e.targetConnection==this,"Target connection not connected to source connection.");var d,f;this.isSuperior()?(d=this.sourceBlock_,f=e.getSourceBlock(),e=this):(d=e.getSourceBlock(),f=this.sourceBlock_);this.disconnectInternal_(d,f);e.respawnShadow_()};Blockly.Connection.prototype.disconnectInternal_=function(e,d){var f;Blockly.Events.isEnabled()&&(f=new Blockly.Events.Move(d));this.targetConnection=this.targetConnection.targetConnection=null;d.setParent(null);f&&(f.recordNew(),Blockly.Events.fire(f))};Blockly.Connection.prototype.respawnShadow_=function(){var d=this.getSourceBlock(),c=this.getShadowDom();if(d.workspace&&c&&Blockly.Events.recordUndo){if(d=Blockly.Xml.domToBlock(c,d.workspace),d.outputConnection){this.connect(d.outputConnection)}else{if(d.previousConnection){this.connect(d.previousConnection)}else{throw"Child block does not have output or previous statement."}}}};Blockly.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null};Blockly.Connection.prototype.checkType_=function(d){if(!this.check_||!d.check_){return !0}for(var c=0;c<this.check_.length;c++){if(-1!=d.check_.indexOf(this.check_[c])){return !0}}return !1};Blockly.Connection.prototype.onCheckChanged_=function(){this.isConnected()&&!this.checkType_(this.targetConnection)&&(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()};Blockly.Connection.prototype.setCheck=function(b){b?(goog.isArray(b)||(b=[b]),this.check_=b,this.onCheckChanged_()):this.check_=null;return this};Blockly.Connection.prototype.setShadowDom=function(b){this.shadowDom_=b};Blockly.Connection.prototype.getShadowDom=function(){return this.shadowDom_};Blockly.Connection.prototype.neighbours_=function(){return[]};Blockly.Connection.prototype.toString=function(){var d,c=this.sourceBlock_;if(c){if(c.outputConnection==this){d="Output Connection of "}else{if(c.previousConnection==this){d="Previous Connection of "}else{if(c.nextConnection==this){d="Next Connection of "}else{if(d=goog.array.find(c.inputList,function(b){return b.connection==this},this)){d='Input "'+d.name+'" connection on '}else{return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}}}}}else{return"Orphan Connection"}return d+c.toDevString()};"use strict";Blockly.Extensions={};Blockly.Extensions.ALL_={};Blockly.Extensions.MUTATOR_PROPERTIES_=["domToMutation","mutationToDom","compose","decompose"];Blockly.Extensions.register=function(d,c){if(!goog.isString(d)||goog.string.isEmptyOrWhitespace(d)){throw Error('Error: Invalid extension name "'+d+'"')}if(Blockly.Extensions.ALL_[d]){throw Error('Error: Extension "'+d+'" is already registered.')}if(!goog.isFunction(c)){throw Error('Error: Extension "'+d+'" must be a function')}Blockly.Extensions.ALL_[d]=c};Blockly.Extensions.registerMixin=function(d,c){Blockly.Extensions.register(d,function(){this.mixin(c)})};Blockly.Extensions.registerMutator=function(h,g,l,k){var j='Error when registering mutator "'+h+'": ';Blockly.Extensions.checkHasFunction_(j,g,"domToMutation");Blockly.Extensions.checkHasFunction_(j,g,"mutationToDom");var i=Blockly.Extensions.checkMutatorDialog_(g,j);if(l&&!goog.isFunction(l)){throw Error('Extension "'+h+'" is not a function')}Blockly.Extensions.register(h,function(){i&&this.setMutator(new Blockly.Mutator(k));this.mixin(g);l&&l.apply(this)})};Blockly.Extensions.apply=function(g,f,j){var i=Blockly.Extensions.ALL_[g];if(!goog.isFunction(i)){throw Error('Error: Extension "'+g+'" not found.')}if(j){Blockly.Extensions.checkNoMutatorProperties_(g,f)}else{var h=Blockly.Extensions.getMutatorProperties_(f)}i.apply(f);if(j){Blockly.Extensions.checkBlockHasMutatorProperties_(g,f,'Error after applying mutator "'+g+'": ')}else{if(!Blockly.Extensions.mutatorPropertiesMatch_(h,f)){throw Error('Error when applying extension "'+g+'": mutation properties changed when applying a non-mutator extension.')}}};Blockly.Extensions.checkHasFunction_=function(e,d,f){if(!d.hasOwnProperty(f)){throw Error(e+'missing required property "'+f+'"')}if("function"!==typeof d[f]){throw Error(e+'" required property "'+f+'" must be a function')}};Blockly.Extensions.checkNoMutatorProperties_=function(f,e){for(var h=0;h<Blockly.Extensions.MUTATOR_PROPERTIES_.length;h++){var g=Blockly.Extensions.MUTATOR_PROPERTIES_[h];if(e.hasOwnProperty(g)){throw Error('Error: tried to apply mutation "'+f+'" to a block that already has a "'+g+'" function.  Block id: '+e.id)}}};Blockly.Extensions.checkMutatorDialog_=function(f,e){var h=f.hasOwnProperty("compose"),g=f.hasOwnProperty("decompose");if(h&&g){if("function"!==typeof f.compose){throw Error(e+"compose must be a function.")}if("function"!==typeof f.decompose){throw Error(e+"decompose must be a function.")}return !0}if(h||g){throw Error(e+'Must have both or neither of "compose" and "decompose"')}return !1};Blockly.Extensions.checkBlockHasMutatorProperties_=function(d,c){if(!c.hasOwnProperty("domToMutation")){throw Error(d+'Applying a mutator didn\'t add "domToMutation"')}if(!c.hasOwnProperty("mutationToDom")){throw Error(d+'Applying a mutator didn\'t add "mutationToDom"')}Blockly.Extensions.checkMutatorDialog_(c,d)};Blockly.Extensions.getMutatorProperties_=function(e){for(var d=[],f=0;f<Blockly.Extensions.MUTATOR_PROPERTIES_.length;f++){d.push(e[Blockly.Extensions.MUTATOR_PROPERTIES_[f]])}return d};Blockly.Extensions.mutatorPropertiesMatch_=function(g,f){var j=!0,i=Blockly.Extensions.getMutatorProperties_(f);if(i.length!=g.length){j=!1}else{for(var h=0;h<i.length;h++){g[h]!=i[h]&&(j=!1)}}return j};Blockly.Extensions.buildTooltipForDropdown=function(e,d){var f=[];document&&Blockly.utils.runAfterPageLoad(function(){for(var b in d){Blockly.utils.checkMessageReferences(d[b])}});return function(){this.type&&-1===f.indexOf(this.type)&&(Blockly.Extensions.checkDropdownOptionsInTable_(this,e,d),f.push(this.type));this.setTooltip(function(){var b=this.getFieldValue(e),a=d[b];null==a?-1===f.indexOf(this.type)&&(b="No tooltip mapping for value "+b+" of field "+e,null!=this.type&&(b+=" of block type "+this.type),console.warn(b+".")):a=Blockly.utils.replaceMessageReferences(a);return a}.bind(this))}};Blockly.Extensions.checkDropdownOptionsInTable_=function(h,g,l){var k=h.getField(g);if(!k.isOptionListDynamic()){for(var k=k.getOptions(),j=0;j<k.length;++j){var i=k[j][1];null==l[i]&&console.warn("No tooltip mapping for value "+i+" of field "+g+" of block type "+h.type)}}};Blockly.Extensions.buildTooltipWithFieldValue=function(d,c){document&&Blockly.utils.runAfterPageLoad(function(){Blockly.utils.checkMessageReferences(d)});return function(){this.setTooltip(function(){return Blockly.utils.replaceMessageReferences(d).replace("%1",this.getFieldValue(c))}.bind(this))}};Blockly.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip;this.setTooltip(function(){var b=this.getParent();return b&&b.getInputsInline()&&b.tooltip||this.tooltipWhenNotConnected_}.bind(this))};Blockly.Extensions.register("parent_tooltip_when_inline",Blockly.Extensions.extensionParentTooltip_);"use strict";Blockly.Field=function(d,c){this.size_=new goog.math.Size(0,Blockly.BlockSvg.MIN_BLOCK_Y);this.setValue(d);this.setValidator(c)};Blockly.Field.cacheWidths_=null;Blockly.Field.cacheReference_=0;Blockly.Field.prototype.name=void 0;Blockly.Field.prototype.maxDisplayLength=50;Blockly.Field.prototype.text_="";Blockly.Field.prototype.sourceBlock_=null;Blockly.Field.prototype.visible_=!0;Blockly.Field.prototype.validator_=null;Blockly.Field.NBSP="\u00a0";Blockly.Field.prototype.EDITABLE=!0;Blockly.Field.prototype.setSourceBlock=function(b){goog.asserts.assert(!this.sourceBlock_,"Field already bound to a block.");this.sourceBlock_=b};Blockly.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null),this.visible_||(this.fieldGroup_.style.display="none"),this.borderRect_=Blockly.utils.createSvgElement("rect",{rx:4,ry:4,x:-Blockly.BlockSvg.SEP_SPACE_X/2,y:0,height:16},this.fieldGroup_,this.sourceBlock_.workspace),this.textElement_=Blockly.utils.createSvgElement("text",{"class":"blocklyText",y:this.size_.height-12.5},this.fieldGroup_),this.updateEditable(),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.mouseUpWrapper_=Blockly.bindEventWithChecks_(this.fieldGroup_,"mouseup",this,this.onMouseUp_),this.render_())};Blockly.Field.prototype.dispose=function(){this.mouseUpWrapper_&&(Blockly.unbindEvent_(this.mouseUpWrapper_),this.mouseUpWrapper_=null);this.sourceBlock_=null;goog.dom.removeNode(this.fieldGroup_);this.validator_=this.borderRect_=this.textElement_=this.fieldGroup_=null};Blockly.Field.prototype.updateEditable=function(){var b=this.fieldGroup_;this.EDITABLE&&b&&(this.sourceBlock_.isEditable()?(Blockly.utils.addClass(b,"blocklyEditableText"),Blockly.utils.removeClass(b,"blocklyNonEditableText"),this.fieldGroup_.style.cursor=this.CURSOR):(Blockly.utils.addClass(b,"blocklyNonEditableText"),Blockly.utils.removeClass(b,"blocklyEditableText"),this.fieldGroup_.style.cursor=""))};Blockly.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()};Blockly.Field.prototype.isVisible=function(){return this.visible_};Blockly.Field.prototype.setVisible=function(d){if(this.visible_!=d){this.visible_=d;var c=this.getSvgRoot();c&&(c.style.display=d?"block":"none",this.render_())}};Blockly.Field.prototype.setValidator=function(b){this.validator_=b};Blockly.Field.prototype.getValidator=function(){return this.validator_};Blockly.Field.prototype.classValidator=function(b){return b};Blockly.Field.prototype.callValidator=function(d){var c=this.classValidator(d);if(null===c){return null}void 0!==c&&(d=c);if(c=this.getValidator()){c=c.call(this,d);if(null===c){return null}void 0!==c&&(d=c)}return d};Blockly.Field.prototype.getSvgRoot=function(){return this.fieldGroup_};Blockly.Field.prototype.render_=function(){if(this.visible_){goog.dom.removeChildren(this.textElement_);var b=document.createTextNode(this.getDisplayText_());this.textElement_.appendChild(b);this.updateWidth()}else{this.size_.width=0}};Blockly.Field.prototype.updateWidth=function(){var b=Blockly.Field.getCachedWidth(this.textElement_);this.borderRect_&&this.borderRect_.setAttribute("width",b+Blockly.BlockSvg.SEP_SPACE_X);this.size_.width=b};Blockly.Field.getCachedWidth=function(f){var e=f.textContent+"\n"+f.className.baseVal,h;if(Blockly.Field.cacheWidths_&&(h=Blockly.Field.cacheWidths_[e])){return h}try{h=f.getComputedTextLength()}catch(g){return 8*f.textContent.length}Blockly.Field.cacheWidths_&&(Blockly.Field.cacheWidths_[e]=h);return h};Blockly.Field.startCache=function(){Blockly.Field.cacheReference_++;Blockly.Field.cacheWidths_||(Blockly.Field.cacheWidths_={})};Blockly.Field.stopCache=function(){Blockly.Field.cacheReference_--;Blockly.Field.cacheReference_||(Blockly.Field.cacheWidths_=null)};Blockly.Field.prototype.getSize=function(){this.size_.width||this.render_();return this.size_};Blockly.Field.prototype.getScaledBBox_=function(){var b=this.borderRect_.getBBox();return new goog.math.Size(b.width*this.sourceBlock_.workspace.scale,b.height*this.sourceBlock_.workspace.scale)};Blockly.Field.prototype.getDisplayText_=function(){var b=this.text_;if(!b){return Blockly.Field.NBSP}b.length>this.maxDisplayLength&&(b=b.substring(0,this.maxDisplayLength-2)+"\u2026");b=b.replace(/\s/g,Blockly.Field.NBSP);this.sourceBlock_.RTL&&(b+="\u200f");return b};Blockly.Field.prototype.getText=function(){return this.text_};Blockly.Field.prototype.setText=function(b){null!==b&&(b=String(b),b!==this.text_&&(this.text_=b,this.size_.width=0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_())))};Blockly.Field.prototype.getValue=function(){return this.getText()};Blockly.Field.prototype.setValue=function(d){if(null!==d){var c=this.getValue();c!=d&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,c,d)),this.setText(d))}};Blockly.Field.prototype.onMouseUp_=function(b){if(!goog.userAgent.IPHONE&&!goog.userAgent.IPAD||goog.userAgent.isVersionOrHigher("537.51.2")||0===b.layerX||0===b.layerY){Blockly.utils.isRightButton(b)||this.sourceBlock_.workspace.isDragging()||this.sourceBlock_.isEditable()&&this.showEditor_()}};Blockly.Field.prototype.setTooltip=function(b){};Blockly.Field.prototype.getAbsoluteXY_=function(){return goog.style.getPageOffset(this.borderRect_)};"use strict";Blockly.Tooltip={};Blockly.Tooltip.visible=!1;Blockly.Tooltip.LIMIT=50;Blockly.Tooltip.mouseOutPid_=0;Blockly.Tooltip.showPid_=0;Blockly.Tooltip.lastX_=0;Blockly.Tooltip.lastY_=0;Blockly.Tooltip.element_=null;Blockly.Tooltip.poisonedElement_=null;Blockly.Tooltip.OFFSET_X=0;Blockly.Tooltip.OFFSET_Y=10;Blockly.Tooltip.RADIUS_OK=10;Blockly.Tooltip.HOVER_MS=750;Blockly.Tooltip.MARGINS=5;Blockly.Tooltip.DIV=null;Blockly.Tooltip.createDom=function(){Blockly.Tooltip.DIV||(Blockly.Tooltip.DIV=goog.dom.createDom("DIV","blocklyTooltipDiv"),document.body.appendChild(Blockly.Tooltip.DIV))};Blockly.Tooltip.bindMouseEvents=function(b){Blockly.bindEvent_(b,"mouseover",null,Blockly.Tooltip.onMouseOver_);Blockly.bindEvent_(b,"mouseout",null,Blockly.Tooltip.onMouseOut_);b.addEventListener("mousemove",Blockly.Tooltip.onMouseMove_,!1)};Blockly.Tooltip.onMouseOver_=function(b){for(b=b.target;!goog.isString(b.tooltip)&&!goog.isFunction(b.tooltip);){b=b.tooltip}Blockly.Tooltip.element_!=b&&(Blockly.Tooltip.hide(),Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.element_=b);clearTimeout(Blockly.Tooltip.mouseOutPid_)};Blockly.Tooltip.onMouseOut_=function(b){Blockly.Tooltip.mouseOutPid_=setTimeout(function(){Blockly.Tooltip.element_=null;Blockly.Tooltip.poisonedElement_=null;Blockly.Tooltip.hide()},1);clearTimeout(Blockly.Tooltip.showPid_)};Blockly.Tooltip.onMouseMove_=function(d){if(Blockly.Tooltip.element_&&Blockly.Tooltip.element_.tooltip&&Blockly.dragMode_==Blockly.DRAG_NONE&&!Blockly.WidgetDiv.isVisible()){if(Blockly.Tooltip.visible){var c=Blockly.Tooltip.lastX_-d.pageX;d=Blockly.Tooltip.lastY_-d.pageY;Math.sqrt(c*c+d*d)>Blockly.Tooltip.RADIUS_OK&&Blockly.Tooltip.hide()}else{Blockly.Tooltip.poisonedElement_!=Blockly.Tooltip.element_&&(clearTimeout(Blockly.Tooltip.showPid_),Blockly.Tooltip.lastX_=d.pageX,Blockly.Tooltip.lastY_=d.pageY,Blockly.Tooltip.showPid_=setTimeout(Blockly.Tooltip.show_,Blockly.Tooltip.HOVER_MS))}}};Blockly.Tooltip.hide=function(){Blockly.Tooltip.visible&&(Blockly.Tooltip.visible=!1,Blockly.Tooltip.DIV&&(Blockly.Tooltip.DIV.style.display="none"));clearTimeout(Blockly.Tooltip.showPid_)};Blockly.Tooltip.show_=function(){Blockly.Tooltip.poisonedElement_=Blockly.Tooltip.element_;if(Blockly.Tooltip.DIV){goog.dom.removeChildren(Blockly.Tooltip.DIV);for(var f=Blockly.Tooltip.element_.tooltip;goog.isFunction(f);){f=f()}for(var f=Blockly.utils.wrap(f,Blockly.Tooltip.LIMIT),f=f.split("\n"),e=0;e<f.length;e++){var h=document.createElement("div");h.appendChild(document.createTextNode(f[e]));Blockly.Tooltip.DIV.appendChild(h)}f=Blockly.Tooltip.element_.RTL;e=goog.dom.getViewportSize();Blockly.Tooltip.DIV.style.direction=f?"rtl":"ltr";Blockly.Tooltip.DIV.style.display="block";Blockly.Tooltip.visible=!0;var h=Blockly.Tooltip.lastX_,h=f?h-(Blockly.Tooltip.OFFSET_X+Blockly.Tooltip.DIV.offsetWidth):h+Blockly.Tooltip.OFFSET_X,g=Blockly.Tooltip.lastY_+Blockly.Tooltip.OFFSET_Y;g+Blockly.Tooltip.DIV.offsetHeight>e.height+window.scrollY&&(g-=Blockly.Tooltip.DIV.offsetHeight+2*Blockly.Tooltip.OFFSET_Y);f?h=Math.max(Blockly.Tooltip.MARGINS-window.scrollX,h):h+Blockly.Tooltip.DIV.offsetWidth>e.width+window.scrollX-2*Blockly.Tooltip.MARGINS&&(h=e.width-Blockly.Tooltip.DIV.offsetWidth-2*Blockly.Tooltip.MARGINS);Blockly.Tooltip.DIV.style.top=g+"px";Blockly.Tooltip.DIV.style.left=h+"px"}};"use strict";Blockly.FieldLabel=function(d,c){this.size_=new goog.math.Size(0,17.5);this.class_=c;this.setValue(d)};goog.inherits(Blockly.FieldLabel,Blockly.Field);Blockly.FieldLabel.prototype.EDITABLE=!1;Blockly.FieldLabel.prototype.init=function(){this.textElement_||(this.textElement_=Blockly.utils.createSvgElement("text",{"class":"blocklyText",y:this.size_.height-5},null),this.class_&&Blockly.utils.addClass(this.textElement_,this.class_),this.visible_||(this.textElement_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.textElement_),this.textElement_.tooltip=this.sourceBlock_,Blockly.Tooltip.bindMouseEvents(this.textElement_),this.render_())};Blockly.FieldLabel.prototype.dispose=function(){goog.dom.removeNode(this.textElement_);this.textElement_=null};Blockly.FieldLabel.prototype.getSvgRoot=function(){return this.textElement_};Blockly.FieldLabel.prototype.setTooltip=function(b){this.textElement_.tooltip=b};"use strict";Blockly.Input=function(f,e,h,g){this.type=f;this.name=e;this.sourceBlock_=h;this.connection=g;this.fieldRow=[]};Blockly.Input.prototype.align=Blockly.ALIGN_LEFT;Blockly.Input.prototype.visible_=!0;Blockly.Input.prototype.appendField=function(d,c){this.insertFieldAt(this.fieldRow.length,d,c);return this};Blockly.Input.prototype.insertFieldAt=function(e,d,f){if(0>e||e>this.fieldRow.length){throw Error("index "+e+" out of bounds.")}if(!d&&!f){return this}goog.isString(d)&&(d=new Blockly.FieldLabel(d));d.setSourceBlock(this.sourceBlock_);this.sourceBlock_.rendered&&d.init();d.name=f;d.prefixField&&(e=this.insertFieldAt(e,d.prefixField));this.fieldRow.splice(e,0,d);++e;d.suffixField&&(e=this.insertFieldAt(e,d.suffixField));this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_());return e};Blockly.Input.prototype.removeField=function(e){for(var d=0,f;f=this.fieldRow[d];d++){if(f.name===e){f.dispose();this.fieldRow.splice(d,1);this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_());return}}goog.asserts.fail('Field "%s" not found.',e)};Blockly.Input.prototype.isVisible=function(){return this.visible_};Blockly.Input.prototype.setVisible=function(g){var f=[];if(this.visible_==g){return f}for(var j=(this.visible_=g)?"block":"none",i=0,h;h=this.fieldRow[i];i++){h.setVisible(g)}this.connection&&(g?f=this.connection.unhideAll():this.connection.hideAll(),i=this.connection.targetBlock())&&(i.getSvgRoot().style.display=j,g||(i.rendered=!1));return f};Blockly.Input.prototype.setCheck=function(b){if(!this.connection){throw"This input does not have a connection."}this.connection.setCheck(b);return this};Blockly.Input.prototype.setAlign=function(b){this.align=b;this.sourceBlock_.rendered&&this.sourceBlock_.render();return this};Blockly.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered){for(var b=0;b<this.fieldRow.length;b++){this.fieldRow[b].init()}}};Blockly.Input.prototype.dispose=function(){for(var d=0,c;c=this.fieldRow[d];d++){c.dispose()}this.connection&&this.connection.dispose();this.sourceBlock_=null};"use strict";Blockly.ConnectionDB=function(){};Blockly.ConnectionDB.prototype=[];Blockly.ConnectionDB.constructor=Blockly.ConnectionDB;Blockly.ConnectionDB.prototype.addConnection=function(d){if(d.inDB_){throw"Connection already in database."}if(!d.getSourceBlock().isInFlyout){var c=this.findPositionForConnection_(d);this.splice(c,0,d);d.inDB_=!0}};Blockly.ConnectionDB.prototype.findConnection=function(f){if(!this.length){return -1}var e=this.findPositionForConnection_(f);if(e>=this.length){return -1}for(var h=f.y_,g=e;0<=g&&this[g].y_==h;){if(this[g]==f){return g}g--}for(;e<this.length&&this[e].y_==h;){if(this[e]==f){return e}e++}return -1};Blockly.ConnectionDB.prototype.findPositionForConnection_=function(f){if(!this.length){return 0}for(var e=0,h=this.length;e<h;){var g=Math.floor((e+h)/2);if(this[g].y_<f.y_){e=g+1}else{if(this[g].y_>f.y_){h=g}else{e=g;break}}}return e};Blockly.ConnectionDB.prototype.removeConnection_=function(d){if(!d.inDB_){throw"Connection not in database."}var c=this.findConnection(d);if(-1==c){throw"Unable to find connection in connectionDB."}d.inDB_=!1;this.splice(c,1)};Blockly.ConnectionDB.prototype.getNeighbours=function(t,s){function r(b){var e=p-q[b].x_,d=o-q[b].y_;Math.sqrt(e*e+d*d)<=s&&i.push(q[b]);return d<s}for(var q=this,p=t.x_,o=t.y_,m=0,l=q.length-2,j=l;m<j;){q[j].y_<o?m=j:l=j,j=Math.floor((m+l)/2)}var i=[],l=m=j;if(q.length){for(;0<=m&&r(m);){m--}do{l++}while(l<q.length&&r(l))}return i};Blockly.ConnectionDB.prototype.isInYRange_=function(e,d,f){return Math.abs(this[e].y_-d)<=f};Blockly.ConnectionDB.prototype.searchForClosest=function(r,q,p){if(!this.length){return{connection:null,radius:q}}var o=r.y_,n=r.x_;r.x_=n+p.x;r.y_=o+p.y;var m=this.findPositionForConnection_(r);p=null;for(var l=q,j,i=m-1;0<=i&&this.isInYRange_(i,r.y_,q);){j=this[i],r.isConnectionAllowed(j,l)&&(p=j,l=j.distanceFrom(r)),i--}for(;m<this.length&&this.isInYRange_(m,r.y_,q);){j=this[m],r.isConnectionAllowed(j,l)&&(p=j,l=j.distanceFrom(r)),m++}r.x_=n;r.y_=o;return{connection:p,radius:l}};Blockly.ConnectionDB.init=function(d){var c=[];c[Blockly.INPUT_VALUE]=new Blockly.ConnectionDB;c[Blockly.OUTPUT_VALUE]=new Blockly.ConnectionDB;c[Blockly.NEXT_STATEMENT]=new Blockly.ConnectionDB;c[Blockly.PREVIOUS_STATEMENT]=new Blockly.ConnectionDB;d.connectionDBList=c};"use strict";Blockly.constants={};Blockly.DRAG_RADIUS=5;Blockly.SNAP_RADIUS=20;Blockly.BUMP_DELAY=250;Blockly.COLLAPSE_CHARS=30;Blockly.LONGPRESS=750;Blockly.SOUND_LIMIT=100;Blockly.DRAG_STACK=!0;Blockly.HSV_SATURATION=0.45;Blockly.HSV_VALUE=0.65;Blockly.SPRITE={width:96,height:124,url:"sprites.png"};Blockly.SVG_NS="http://www.w3.org/2000/svg";Blockly.HTML_NS="http://www.w3.org/1999/xhtml";Blockly.INPUT_VALUE=1;Blockly.OUTPUT_VALUE=2;Blockly.NEXT_STATEMENT=3;Blockly.PREVIOUS_STATEMENT=4;Blockly.DUMMY_INPUT=5;Blockly.ALIGN_LEFT=-1;Blockly.ALIGN_CENTRE=0;Blockly.ALIGN_RIGHT=1;Blockly.DRAG_NONE=0;Blockly.DRAG_STICKY=1;Blockly.DRAG_BEGIN=1;Blockly.DRAG_FREE=2;Blockly.OPPOSITE_TYPE=[];Blockly.OPPOSITE_TYPE[Blockly.INPUT_VALUE]=Blockly.OUTPUT_VALUE;Blockly.OPPOSITE_TYPE[Blockly.OUTPUT_VALUE]=Blockly.INPUT_VALUE;Blockly.OPPOSITE_TYPE[Blockly.NEXT_STATEMENT]=Blockly.PREVIOUS_STATEMENT;Blockly.OPPOSITE_TYPE[Blockly.PREVIOUS_STATEMENT]=Blockly.NEXT_STATEMENT;Blockly.TOOLBOX_AT_TOP=0;Blockly.TOOLBOX_AT_BOTTOM=1;Blockly.TOOLBOX_AT_LEFT=2;Blockly.TOOLBOX_AT_RIGHT=3;Blockly.DELETE_AREA_TRASH=1;Blockly.DELETE_AREA_TOOLBOX=2;Blockly.VARIABLE_CATEGORY_NAME="VARIABLE";Blockly.PROCEDURE_CATEGORY_NAME="PROCEDURE";"use strict";Blockly.Options=function(E){var D=!!E.readOnly;if(D){var C=null,B=!1,A=!1,z=!1,y=!1,x=!1,w=!1}else{C=Blockly.Options.parseToolboxTree(E.toolbox),B=!(!C||!C.getElementsByTagName("category").length),A=E.trashcan,void 0===A&&(A=B),z=E.collapse,void 0===z&&(z=B),y=E.comments,void 0===y&&(y=B),x=E.disable,void 0===x&&(x=B),w=E.sounds,void 0===w&&(w=!0)}var s=!!E.rtl,o=E.horizontalLayout;void 0===o&&(o=!1);var v=E.toolboxPosition,v="end"===v?!1:!0,v=o?v?Blockly.TOOLBOX_AT_TOP:Blockly.TOOLBOX_AT_BOTTOM:v==s?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT,u=E.scrollbars;void 0===u&&(u=B);var j=E.css;void 0===j&&(j=!0);var F="https://blockly-demo.appspot.com/static/media/";E.media?F=E.media:E.path&&(F=E.path+"media/");var i=void 0===E.oneBasedIndex?!0:!!E.oneBasedIndex;this.RTL=s;this.oneBasedIndex=i;this.collapse=z;this.comments=y;this.disable=x;this.readOnly=D;this.maxBlocks=E.maxBlocks||Infinity;this.pathToMedia=F;this.hasCategories=B;this.hasScrollbars=u;this.hasTrashcan=A;this.hasSounds=w;this.hasCss=j;this.horizontalLayout=o;this.languageTree=C;this.gridOptions=Blockly.Options.parseGridOptions_(E);this.zoomOptions=Blockly.Options.parseZoomOptions_(E);this.toolboxPosition=v};Blockly.Options.prototype.parentWorkspace=null;Blockly.Options.prototype.setMetrics=null;Blockly.Options.prototype.getMetrics=null;Blockly.Options.parseZoomOptions_=function(d){d=d.zoom||{};var c={};c.controls=void 0===d.controls?!1:!!d.controls;c.wheel=void 0===d.wheel?!1:!!d.wheel;c.startScale=void 0===d.startScale?1:parseFloat(d.startScale);c.maxScale=void 0===d.maxScale?3:parseFloat(d.maxScale);c.minScale=void 0===d.minScale?0.3:parseFloat(d.minScale);c.scaleSpeed=void 0===d.scaleSpeed?1.2:parseFloat(d.scaleSpeed);return c};Blockly.Options.parseGridOptions_=function(d){d=d.grid||{};var c={};c.spacing=parseFloat(d.spacing)||0;c.colour=d.colour||"#888";c.length=parseFloat(d.length)||1;c.snap=0<c.spacing&&!!d.snap;return c};Blockly.Options.parseToolboxTree=function(b){b?("string"!=typeof b&&("undefined"==typeof XSLTProcessor&&b.outerHTML?b=b.outerHTML:b instanceof Element||(b=null)),"string"==typeof b&&(b=Blockly.Xml.textToDom(b))):b=null;return b};"use strict";Blockly.ScrollbarPair=function(b){this.workspace_=b;this.hScroll=new Blockly.Scrollbar(b,!0,!0,"blocklyMainWorkspaceScrollbar");this.vScroll=new Blockly.Scrollbar(b,!1,!0,"blocklyMainWorkspaceScrollbar");this.corner_=Blockly.utils.createSvgElement("rect",{height:Blockly.Scrollbar.scrollbarThickness,width:Blockly.Scrollbar.scrollbarThickness,"class":"blocklyScrollbarBackground"},null);Blockly.utils.insertAfter_(this.corner_,b.getBubbleCanvas())};Blockly.ScrollbarPair.prototype.oldHostMetrics_=null;Blockly.ScrollbarPair.prototype.dispose=function(){goog.dom.removeNode(this.corner_);this.oldHostMetrics_=this.workspace_=this.corner_=null;this.hScroll.dispose();this.hScroll=null;this.vScroll.dispose();this.vScroll=null};Blockly.ScrollbarPair.prototype.resize=function(){var e=this.workspace_.getMetrics();if(e){var d=!1,f=!1;this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==e.viewWidth&&this.oldHostMetrics_.viewHeight==e.viewHeight&&this.oldHostMetrics_.absoluteTop==e.absoluteTop&&this.oldHostMetrics_.absoluteLeft==e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.contentWidth==e.contentWidth&&this.oldHostMetrics_.viewLeft==e.viewLeft&&this.oldHostMetrics_.contentLeft==e.contentLeft||(d=!0),this.oldHostMetrics_&&this.oldHostMetrics_.contentHeight==e.contentHeight&&this.oldHostMetrics_.viewTop==e.viewTop&&this.oldHostMetrics_.contentTop==e.contentTop||(f=!0)):f=d=!0;d&&this.hScroll.resize(e);f&&this.vScroll.resize(e);this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==e.viewWidth&&this.oldHostMetrics_.absoluteLeft==e.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position_.x);this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==e.viewHeight&&this.oldHostMetrics_.absoluteTop==e.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position_.y);this.oldHostMetrics_=e}};Blockly.ScrollbarPair.prototype.set=function(h,g){var l={},k=h*this.hScroll.ratio_,j=g*this.vScroll.ratio_,i=this.vScroll.scrollViewSize_;l.x=this.getRatio_(k,this.hScroll.scrollViewSize_);l.y=this.getRatio_(j,i);this.workspace_.setMetrics(l);this.hScroll.setHandlePosition(k);this.vScroll.setHandlePosition(j)};Blockly.ScrollbarPair.prototype.getRatio_=function(e,d){var f=e/d;return isNaN(f)?0:f};Blockly.Scrollbar=function(f,e,h,g){this.workspace_=f;this.pair_=h||!1;this.horizontal_=e;this.oldHostMetrics_=null;this.createDom_(g);this.position_=new goog.math.Coordinate(0,0);e?(this.svgBackground_.setAttribute("height",Blockly.Scrollbar.scrollbarThickness),this.outerSvg_.setAttribute("height",Blockly.Scrollbar.scrollbarThickness),this.svgHandle_.setAttribute("height",Blockly.Scrollbar.scrollbarThickness-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",Blockly.Scrollbar.scrollbarThickness),this.outerSvg_.setAttribute("width",Blockly.Scrollbar.scrollbarThickness),this.svgHandle_.setAttribute("width",Blockly.Scrollbar.scrollbarThickness-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y");this.onMouseDownBarWrapper_=Blockly.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDownBar_);this.onMouseDownHandleWrapper_=Blockly.bindEventWithChecks_(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)};Blockly.Scrollbar.prototype.origin_=new goog.math.Coordinate(0,0);Blockly.Scrollbar.prototype.scrollViewSize_=0;Blockly.Scrollbar.prototype.handleLength_=0;Blockly.Scrollbar.prototype.handlePosition_=0;Blockly.Scrollbar.prototype.isVisible_=!0;Blockly.Scrollbar.prototype.containerVisible_=!0;Blockly.Scrollbar.scrollbarThickness=15;goog.events.BrowserFeature.TOUCH_ENABLED&&(Blockly.Scrollbar.scrollbarThickness=25);Blockly.Scrollbar.metricsAreEquivalent_=function(d,c){return d&&c&&d.viewWidth==c.viewWidth&&d.viewHeight==c.viewHeight&&d.viewLeft==c.viewLeft&&d.viewTop==c.viewTop&&d.absoluteTop==c.absoluteTop&&d.absoluteLeft==c.absoluteLeft&&d.contentWidth==c.contentWidth&&d.contentHeight==c.contentHeight&&d.contentLeft==c.contentLeft&&d.contentTop==c.contentTop?!0:!1};Blockly.Scrollbar.prototype.dispose=function(){this.cleanUp_();Blockly.unbindEvent_(this.onMouseDownBarWrapper_);this.onMouseDownBarWrapper_=null;Blockly.unbindEvent_(this.onMouseDownHandleWrapper_);this.onMouseDownHandleWrapper_=null;goog.dom.removeNode(this.outerSvg_);this.workspace_=this.svgHandle_=this.svgBackground_=this.svgGroup_=this.outerSvg_=null};Blockly.Scrollbar.prototype.setHandleLength_=function(b){this.handleLength_=b;this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)};Blockly.Scrollbar.prototype.setHandlePosition=function(b){this.handlePosition_=b;this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)};Blockly.Scrollbar.prototype.setScrollViewSize_=function(b){this.scrollViewSize_=b;this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollViewSize_);this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollViewSize_)};Blockly.ScrollbarPair.prototype.setContainerVisible=function(b){this.hScroll.setContainerVisible(b);this.vScroll.setContainerVisible(b)};Blockly.Scrollbar.prototype.setPosition=function(d,c){this.position_.x=d;this.position_.y=c;Blockly.utils.setCssTransform(this.outerSvg_,"translate("+(this.position_.x+this.origin_.x)+"px,"+(this.position_.y+this.origin_.y)+"px)")};Blockly.Scrollbar.prototype.resize=function(b){if(!b&&(b=this.workspace_.getMetrics(),!b)){return}Blockly.Scrollbar.metricsAreEquivalent_(b,this.oldHostMetrics_)||(this.oldHostMetrics_=b,this.horizontal_?this.resizeHorizontal_(b):this.resizeVertical_(b),this.onScroll_())};Blockly.Scrollbar.prototype.resizeHorizontal_=function(b){this.resizeViewHorizontal(b)};Blockly.Scrollbar.prototype.resizeViewHorizontal=function(d){var c=d.viewWidth-1;this.pair_&&(c-=Blockly.Scrollbar.scrollbarThickness);this.setScrollViewSize_(Math.max(0,c));c=d.absoluteLeft+0.5;this.pair_&&this.workspace_.RTL&&(c+=Blockly.Scrollbar.scrollbarThickness);this.setPosition(c,d.absoluteTop+d.viewHeight-Blockly.Scrollbar.scrollbarThickness-0.5);this.resizeContentHorizontal(d)};Blockly.Scrollbar.prototype.resizeContentHorizontal=function(b){this.pair_||this.setVisible(this.scrollViewSize_<b.contentWidth);this.ratio_=this.scrollViewSize_/b.contentWidth;if(-Infinity==this.ratio_||Infinity==this.ratio_||isNaN(this.ratio_)){this.ratio_=0}this.setHandleLength_(Math.max(0,b.viewWidth*this.ratio_));this.setHandlePosition(this.constrainHandle_((b.viewLeft-b.contentLeft)*this.ratio_))};Blockly.Scrollbar.prototype.resizeVertical_=function(b){this.resizeViewVertical(b)};Blockly.Scrollbar.prototype.resizeViewVertical=function(d){var c=d.viewHeight-1;this.pair_&&(c-=Blockly.Scrollbar.scrollbarThickness);this.setScrollViewSize_(Math.max(0,c));c=d.absoluteLeft+0.5;this.workspace_.RTL||(c+=d.viewWidth-Blockly.Scrollbar.scrollbarThickness-1);this.setPosition(c,d.absoluteTop+0.5);this.resizeContentVertical(d)};Blockly.Scrollbar.prototype.resizeContentVertical=function(b){this.pair_||this.setVisible(this.scrollViewSize_<b.contentHeight);this.ratio_=this.scrollViewSize_/b.contentHeight;if(-Infinity==this.ratio_||Infinity==this.ratio_||isNaN(this.ratio_)){this.ratio_=0}this.setHandleLength_(Math.max(0,b.viewHeight*this.ratio_));this.setHandlePosition(this.constrainHandle_((b.viewTop-b.contentTop)*this.ratio_))};Blockly.Scrollbar.prototype.createDom_=function(d){var c="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");d&&(c+=" "+d);this.outerSvg_=Blockly.utils.createSvgElement("svg",{"class":c},null);this.svgGroup_=Blockly.utils.createSvgElement("g",{},this.outerSvg_);this.svgBackground_=Blockly.utils.createSvgElement("rect",{"class":"blocklyScrollbarBackground"},this.svgGroup_);d=Math.floor((Blockly.Scrollbar.scrollbarThickness-5)/2);this.svgHandle_=Blockly.utils.createSvgElement("rect",{"class":"blocklyScrollbarHandle",rx:d,ry:d},this.svgGroup_);Blockly.utils.insertAfter_(this.outerSvg_,this.workspace_.getParentSvg())};Blockly.Scrollbar.prototype.isVisible=function(){return this.isVisible_};Blockly.Scrollbar.prototype.setContainerVisible=function(d){var c=d!=this.containerVisible_;this.containerVisible_=d;c&&this.updateDisplay_()};Blockly.Scrollbar.prototype.setVisible=function(d){var c=d!=this.isVisible();if(this.pair_){throw"Unable to toggle visibility of paired scrollbars."}this.isVisible_=d;c&&this.updateDisplay_()};Blockly.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")};Blockly.Scrollbar.prototype.onMouseDownBar_=function(g){this.workspace_.markFocused();Blockly.Touch.clearTouchIdentifier();this.cleanUp_();if(Blockly.utils.isRightButton(g)){g.stopPropagation()}else{var f=Blockly.utils.mouseToSvg(g,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM()),f=this.horizontal_?f.x:f.y,j=Blockly.utils.getInjectionDivXY_(this.svgHandle_),j=this.horizontal_?j.x:j.y,i=this.handlePosition_,h=0.95*this.handleLength_;f<=j?i-=h:f>=j+this.handleLength_&&(i+=h);this.setHandlePosition(this.constrainHandle_(i));this.onScroll_();g.stopPropagation();g.preventDefault()}};Blockly.Scrollbar.prototype.onMouseDownHandle_=function(b){this.workspace_.markFocused();this.cleanUp_();Blockly.utils.isRightButton(b)?b.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse=this.horizontal_?b.clientX:b.clientY,Blockly.Scrollbar.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,this.onMouseUpHandle_),Blockly.Scrollbar.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.onMouseMoveHandle_),b.stopPropagation(),b.preventDefault())};Blockly.Scrollbar.prototype.onMouseMoveHandle_=function(b){this.setHandlePosition(this.constrainHandle_(this.startDragHandle+((this.horizontal_?b.clientX:b.clientY)-this.startDragMouse)));this.onScroll_()};Blockly.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface();Blockly.Touch.clearTouchIdentifier();this.cleanUp_()};Blockly.Scrollbar.prototype.cleanUp_=function(){Blockly.hideChaff(!0);Blockly.Scrollbar.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Scrollbar.onMouseUpWrapper_),Blockly.Scrollbar.onMouseUpWrapper_=null);Blockly.Scrollbar.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Scrollbar.onMouseMoveWrapper_),Blockly.Scrollbar.onMouseMoveWrapper_=null)};Blockly.Scrollbar.prototype.constrainHandle_=function(b){return b=0>=b||isNaN(b)||this.scrollViewSize_<this.handleLength_?0:Math.min(b,this.scrollViewSize_-this.handleLength_)};Blockly.Scrollbar.prototype.onScroll_=function(){var d=this.handlePosition_/this.scrollViewSize_;isNaN(d)&&(d=0);var c={};this.horizontal_?c.x=d:c.y=d;this.workspace_.setMetrics(c)};Blockly.Scrollbar.prototype.set=function(b){this.setHandlePosition(this.constrainHandle_(b*this.ratio_));this.onScroll_()};Blockly.Scrollbar.prototype.setOrigin=function(d,c){this.origin_=new goog.math.Coordinate(d,c)};"use strict";Blockly.Trashcan=function(b){this.workspace_=b};Blockly.Trashcan.prototype.WIDTH_=47;Blockly.Trashcan.prototype.BODY_HEIGHT_=44;Blockly.Trashcan.prototype.LID_HEIGHT_=16;Blockly.Trashcan.prototype.MARGIN_BOTTOM_=20;Blockly.Trashcan.prototype.MARGIN_SIDE_=20;Blockly.Trashcan.prototype.MARGIN_HOTSPOT_=10;Blockly.Trashcan.prototype.SPRITE_LEFT_=0;Blockly.Trashcan.prototype.SPRITE_TOP_=32;Blockly.Trashcan.prototype.isOpen=!1;Blockly.Trashcan.prototype.svgGroup_=null;Blockly.Trashcan.prototype.svgLid_=null;Blockly.Trashcan.prototype.lidTask_=0;Blockly.Trashcan.prototype.lidOpen_=0;Blockly.Trashcan.prototype.left_=0;Blockly.Trashcan.prototype.top_=0;Blockly.Trashcan.prototype.createDom=function(){this.svgGroup_=Blockly.utils.createSvgElement("g",{"class":"blocklyTrash"},null);var d=String(Math.random()).substring(2),c=Blockly.utils.createSvgElement("clipPath",{id:"blocklyTrashBodyClipPath"+d},this.svgGroup_);Blockly.utils.createSvgElement("rect",{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},c);Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+d+")"},this.svgGroup_).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url);c=Blockly.utils.createSvgElement("clipPath",{id:"blocklyTrashLidClipPath"+d},this.svgGroup_);Blockly.utils.createSvgElement("rect",{width:this.WIDTH_,height:this.LID_HEIGHT_},c);this.svgLid_=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+d+")"},this.svgGroup_);this.svgLid_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url);Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.click);this.animateLid_();return this.svgGroup_};Blockly.Trashcan.prototype.init=function(b){this.bottom_=this.MARGIN_BOTTOM_+b;this.setOpen_(!1);return this.bottom_+this.BODY_HEIGHT_+this.LID_HEIGHT_};Blockly.Trashcan.prototype.dispose=function(){this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null);this.workspace_=this.svgLid_=null;goog.Timer.clear(this.lidTask_)};Blockly.Trashcan.prototype.position=function(){var b=this.workspace_.getMetrics();b&&(this.workspace_.RTL?(this.left_=this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness,b.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(this.left_+=b.flyoutWidth,this.workspace_.toolbox_&&(this.left_+=b.absoluteLeft))):(this.left_=b.viewWidth+b.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness,b.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(this.left_-=b.flyoutWidth)),this.top_=b.viewHeight+b.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.bottom_,b.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM&&(this.top_-=b.flyoutHeight),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))};Blockly.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_){return null}var b=this.svgGroup_.getBoundingClientRect();return new goog.math.Rect(b.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,b.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_,this.WIDTH_+2*this.MARGIN_HOTSPOT_,this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_)};Blockly.Trashcan.prototype.setOpen_=function(b){this.isOpen!=b&&(goog.Timer.clear(this.lidTask_),this.isOpen=b,this.animateLid_())};Blockly.Trashcan.prototype.animateLid_=function(){this.lidOpen_+=this.isOpen?0.2:-0.2;this.lidOpen_=goog.math.clamp(this.lidOpen_,0,1);var b=45*this.lidOpen_;this.svgLid_.setAttribute("transform","rotate("+(this.workspace_.RTL?-b:b)+","+(this.workspace_.RTL?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")");b=goog.math.lerp(0.4,0.8,this.lidOpen_);this.svgGroup_.style.opacity=b;0<this.lidOpen_&&1>this.lidOpen_&&(this.lidTask_=goog.Timer.callOnce(this.animateLid_,20,this))};Blockly.Trashcan.prototype.close=function(){this.setOpen_(!1)};Blockly.Trashcan.prototype.click=function(){var d=this.workspace_.startScrollX-this.workspace_.scrollX,c=this.workspace_.startScrollY-this.workspace_.scrollY;Math.sqrt(d*d+c*c)>Blockly.DRAG_RADIUS||console.log("TODO: Inspect trash.")};"use strict";Blockly.utils={};Blockly.utils.removeAttribute=function(d,c){goog.userAgent.IE&&goog.userAgent.isVersion("10.0")?d.setAttribute(c,null):d.removeAttribute(c)};Blockly.utils.addClass=function(e,d){var f=e.getAttribute("class")||"";if(-1!=(" "+f+" ").indexOf(" "+d+" ")){return !1}f&&(f+=" ");e.setAttribute("class",f+d);return !0};Blockly.utils.removeClass=function(f,e){var h=f.getAttribute("class");if(-1==(" "+h+" ").indexOf(" "+e+" ")){return !1}for(var h=h.split(/\s+/),g=0;g<h.length;g++){h[g]&&h[g]!=e||(h.splice(g,1),g--)}h.length?f.setAttribute("class",h.join(" ")):Blockly.utils.removeAttribute(f,"class");return !0};Blockly.utils.hasClass=function(d,c){return -1!=(" "+d.getAttribute("class")+" ").indexOf(" "+c+" ")};Blockly.utils.noEvent=function(b){b.preventDefault();b.stopPropagation()};Blockly.utils.isTargetInput=function(b){return"textarea"==b.target.type||"text"==b.target.type||"number"==b.target.type||"email"==b.target.type||"password"==b.target.type||"search"==b.target.type||"tel"==b.target.type||"url"==b.target.type||b.target.isContentEditable};Blockly.utils.getRelativeXY=function(e){var d=new goog.math.Coordinate(0,0),f=e.getAttribute("x");f&&(d.x=parseInt(f,10));if(f=e.getAttribute("y")){d.y=parseInt(f,10)}if(f=(f=e.getAttribute("transform"))&&f.match(Blockly.utils.getRelativeXY.XY_REGEX_)){d.x+=parseFloat(f[1]),f[3]&&(d.y+=parseFloat(f[3]))}(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&((f=e.match(Blockly.utils.getRelativeXY.XY_2D_REGEX_))||(f=e.match(Blockly.utils.getRelativeXY.XY_3D_REGEX_)),f&&(d.x+=parseFloat(f[1]),f[3]&&(d.y+=parseFloat(f[3]))));return d};Blockly.utils.getInjectionDivXY_=function(g){for(var f=0,j=0,i;g;){var h=Blockly.utils.getRelativeXY(g);i=Blockly.utils.getScale_(g);f=f*i+h.x;j=j*i+h.y;if(-1!=(" "+(g.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){break}g=g.parentNode}return new goog.math.Coordinate(f,j)};Blockly.utils.getScale_=function(d){var c=1;(d=d.getAttribute("transform"))&&(d=d.match(Blockly.utils.getScale_.REGEXP_))&&d[0]&&(c=parseFloat(d[0]));return c};Blockly.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*\))?/;Blockly.utils.getScale_REGEXP_=/scale\(\s*([-+\d.e]+)\s*\)/;Blockly.utils.getRelativeXY.XY_3D_REGEX_=/transform:\s*translate3d\(\s*([-+\d.e]+)px([ ,]\s*([-+\d.e]+)\s*)px([ ,]\s*([-+\d.e]+)\s*)px\)?/;Blockly.utils.getRelativeXY.XY_2D_REGEX_=/transform:\s*translate\(\s*([-+\d.e]+)px([ ,]\s*([-+\d.e]+)\s*)px\)?/;Blockly.utils.createSvgElement=function(f,e,h){f=document.createElementNS(Blockly.SVG_NS,f);for(var g in e){f.setAttribute(g,e[g])}document.body.runtimeStyle&&(f.runtimeStyle=f.currentStyle=f.style);h&&h.appendChild(f);return f};Blockly.utils.isRightButton=function(b){return b.ctrlKey&&goog.userAgent.MAC?!0:2==b.button};Blockly.utils.mouseToSvg=function(f,e,h){var g=e.createSVGPoint();g.x=f.clientX;g.y=f.clientY;h||(h=e.getScreenCTM().inverse());return g.matrixTransform(h)};Blockly.utils.shortestStringLength=function(b){return b.length?b.reduce(function(d,e){return d.length<e.length?d:e}).length:0};Blockly.utils.commonWordPrefix=function(i,h){if(!i.length){return 0}if(1==i.length){return i[0].length}for(var n=0,m=h||Blockly.utils.shortestStringLength(i),l=0;l<m;l++){for(var k=i[0][l],j=1;j<i.length;j++){if(k!=i[j][l]){return n}}" "==k&&(n=l+1)}for(j=1;j<i.length;j++){if((k=i[j][l])&&" "!=k){return n}}return m};Blockly.utils.commonWordSuffix=function(i,h){if(!i.length){return 0}if(1==i.length){return i[0].length}for(var n=0,m=h||Blockly.utils.shortestStringLength(i),l=0;l<m;l++){for(var k=i[0].substr(-l-1,1),j=1;j<i.length;j++){if(k!=i[j].substr(-l-1,1)){return n}}" "==k&&(n=l+1)}for(j=1;j<i.length;j++){if((k=i[j].charAt(i[j].length-l-1))&&" "!=k){return n}}return m};Blockly.utils.tokenizeInterpolation=function(b){return Blockly.utils.tokenizeInterpolation_(b,!0)};Blockly.utils.replaceMessageReferences=function(b){if(!goog.isString(b)){return b}b=Blockly.utils.tokenizeInterpolation_(b,!1);return b.length?b[0]:""};Blockly.utils.checkMessageReferences=function(g){for(var f=!0,j=/%{BKY_([a-zA-Z][a-zA-Z0-9_]*)}/g,i=j.exec(g);null!=i;){var h=i[1];null==Blockly.Msg[h]&&(console.log("WARNING: No message string for %{BKY_"+h+"}."),f=!1);g=g.substring(i.index+h.length+1);i=j.exec(g)}return f};Blockly.utils.tokenizeInterpolation_=function(r,q){var p=[],o=r.split("");o.push("");for(var n=0,m=[],l=null,j=0;j<o.length;j++){var i=o[j];0==n?"%"==i?((i=m.join(""))&&p.push(i),m.length=0,n=1):m.push(i):1==n?"%"==i?(m.push(i),n=0):q&&"0"<=i&&"9">=i?(n=2,l=i,(i=m.join(""))&&p.push(i),m.length=0):"{"==i?n=3:(m.push("%",i),n=0):2==n?"0"<=i&&"9">=i?l+=i:(p.push(parseInt(l,10)),j--,n=0):3==n&&(""==i?(m.splice(0,0,"%{"),j--,n=0):"}"!=i?m.push(i):(n=m.join(""),/[a-zA-Z][a-zA-Z0-9_]*/.test(n)?(i=n.toUpperCase(),(i=goog.string.startsWith(i,"BKY_")?i.substring(4):null)&&i in Blockly.Msg?(n=Blockly.Msg[i],goog.isString(n)?Array.prototype.push.apply(p,Blockly.utils.tokenizeInterpolation(n)):q?p.push(String(n)):p.push(n)):p.push("%{"+n+"}")):p.push("%{"+n+"}"),n=m.length=0))}(i=m.join(""))&&p.push(i);o=[];for(j=m.length=0;j<p.length;++j){"string"==typeof p[j]?m.push(p[j]):((i=m.join(""))&&o.push(i),m.length=0,o.push(p[j]))}(i=m.join(""))&&o.push(i);m.length=0;return o};Blockly.utils.genUid=function(){for(var e=Blockly.utils.genUid.soup_.length,d=[],f=0;20>f;f++){d[f]=Blockly.utils.genUid.soup_.charAt(Math.random()*e)}return d.join("")};Blockly.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";Blockly.utils.wrap=function(f,e){for(var h=f.split("\n"),g=0;g<h.length;g++){h[g]=Blockly.utils.wrapLine_(h[g],e)}return h.join("\n")};Blockly.utils.wrapLine_=function(t,s){if(t.length<=s){return t}for(var r=t.trim().split(/\s+/),q=0;q<r.length;q++){r[q].length>s&&(s=r[q].length)}var p,q=-Infinity,o,m=1;do{p=q;o=t;for(var l=[],j=r.length/m,i=1,q=0;q<r.length-1;q++){i<(q+1.5)/j?(i++,l[q]=!0):l[q]=!1}l=Blockly.utils.wrapMutate_(r,l,s);q=Blockly.utils.wrapScore_(r,l,s);t=Blockly.utils.wrapToText_(r,l);m++}while(q>p);return o};Blockly.utils.wrapScore_=function(h,g,l){for(var k=[0],j=[],i=0;i<h.length;i++){k[k.length-1]+=h[i].length,!0===g[i]?(k.push(0),j.push(h[i].charAt(h[i].length-1))):!1===g[i]&&k[k.length-1]++}h=Math.max.apply(Math,k);for(i=g=0;i<k.length;i++){g-=2*Math.pow(Math.abs(l-k[i]),1.5),g-=Math.pow(h-k[i],1.5),-1!=".?!".indexOf(j[i])?g+=l/3:-1!=",;)]}".indexOf(j[i])&&(g+=l/4)}1<k.length&&k[k.length-1]<=k[k.length-2]&&(g+=0.5);return g};Blockly.utils.wrapMutate_=function(j,i,p){for(var o=Blockly.utils.wrapScore_(j,i,p),n,m=0;m<i.length-1;m++){if(i[m]!=i[m+1]){var l=[].concat(i);l[m]=!l[m];l[m+1]=!l[m+1];var k=Blockly.utils.wrapScore_(j,l,p);k>o&&(o=k,n=l)}}return n?Blockly.utils.wrapMutate_(j,n,p):i};Blockly.utils.wrapToText_=function(f,e){for(var h=[],g=0;g<f.length;g++){h.push(f[g]),void 0!==e[g]&&h.push(e[g]?"\n":" ")}return h.join("")};Blockly.utils.is3dSupported=function(){if(void 0!==Blockly.utils.is3dSupported.cached_){return Blockly.utils.is3dSupported.cached_}if(!goog.global.getComputedStyle){return !1}var f=document.createElement("p"),e="none",h={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(f,null);for(var g in h){if(void 0!==f.style[g]){f.style[g]="translate3d(1px,1px,1px)";e=goog.global.getComputedStyle(f);if(!e){return document.body.removeChild(f),!1}e=e.getPropertyValue(h[g])}}document.body.removeChild(f);Blockly.utils.is3dSupported.cached_="none"!==e;return Blockly.utils.is3dSupported.cached_};Blockly.utils.insertAfter_=function(f,e){var h=e.nextSibling,g=e.parentNode;if(!g){throw"Reference node has no parent."}h?g.insertBefore(f,h):g.appendChild(f)};Blockly.utils.runAfterPageLoad=function(d){if(!document){throw Error("Blockly.utils.runAfterPageLoad() requires browser document.")}if("complete"===document.readyState){d()}else{var c=setInterval(function(){"complete"===document.readyState&&(clearInterval(c),d())},10)}};Blockly.utils.setCssTransform=function(d,c){d.style.transform=c;d.style["-webkit-transform"]=c};"use strict";Blockly.WorkspaceDragSurfaceSvg={};Blockly.workspaceDragSurfaceSvg=function(b){this.container_=b;this.createDom()};Blockly.workspaceDragSurfaceSvg.prototype.SVG_=null;Blockly.workspaceDragSurfaceSvg.prototype.dragGroup_=null;Blockly.workspaceDragSurfaceSvg.prototype.container_=null;Blockly.workspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=Blockly.utils.createSvgElement("svg",{xmlns:Blockly.SVG_NS,"xmlns:html":Blockly.HTML_NS,"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1","class":"blocklyWsDragSurface"},null),this.container_.appendChild(this.SVG_))};Blockly.workspaceDragSurfaceSvg.prototype.translateSurface=function(d,c){d=d.toFixed(0);c=c.toFixed(0);this.SVG_.style.display="block";Blockly.utils.setCssTransform(this.SVG_,"translate3d("+d+"px, "+c+"px, 0px)")};Blockly.workspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return Blockly.utils.getRelativeXY(this.SVG_)};Blockly.workspaceDragSurfaceSvg.prototype.clearAndHide=function(e){var d=this.SVG_.childNodes[0],f=this.SVG_.childNodes[1];if(!(d&&f&&Blockly.utils.hasClass(d,"blocklyBlockCanvas")&&Blockly.utils.hasClass(f,"blocklyBubbleCanvas"))){throw"Couldn't clear and hide the drag surface.  A node was missing."}null!=this.previousSibling_?Blockly.utils.insertAfter_(d,this.previousSibling_):e.insertBefore(d,e.firstChild);Blockly.utils.insertAfter_(f,d);this.SVG_.style.display="none";goog.asserts.assert(0==this.SVG_.childNodes.length,"Drag surface was not cleared.");Blockly.utils.setCssTransform(this.SVG_,"");this.previousSibling_=null};Blockly.workspaceDragSurfaceSvg.prototype.setContentsAndShow=function(h,g,l,k,j,i){goog.asserts.assert(0==this.SVG_.childNodes.length,"Already dragging a block.");this.previousSibling_=l;h.setAttribute("transform","translate(0, 0) scale("+i+")");g.setAttribute("transform","translate(0, 0) scale("+i+")");this.SVG_.setAttribute("width",k);this.SVG_.setAttribute("height",j);this.SVG_.appendChild(h);this.SVG_.appendChild(g);this.SVG_.style.display="block"};"use strict";Blockly.Xml={};Blockly.Xml.workspaceToDom=function(h,g){for(var l=goog.dom.createDom("xml"),k=h.getTopBlocks(!0),j=0,i;i=k[j];j++){l.appendChild(Blockly.Xml.blockToDomWithXY(i,g))}return l};Blockly.Xml.blockToDomWithXY=function(g,f){var j;g.workspace.RTL&&(j=g.workspace.getWidth());var i=Blockly.Xml.blockToDom(g,f),h=g.getRelativeToSurfaceXY();i.setAttribute("x",Math.round(g.workspace.RTL?j-h.x:h.x));i.setAttribute("y",Math.round(h.y));return i};Blockly.Xml.blockToDom=function(r,q){var p=goog.dom.createDom(r.isShadow()?"shadow":"block");p.setAttribute("type",r.type);q||p.setAttribute("id",r.id);if(r.mutationToDom){var o=r.mutationToDom();o&&(o.hasChildNodes()||o.hasAttributes())&&p.appendChild(o)}for(var o=0,n;n=r.inputList[o];o++){for(var m=0,l;l=n.fieldRow[m];m++){if(l.name&&l.EDITABLE){var j=goog.dom.createDom("field",null,l.getValue());j.setAttribute("name",l.name);p.appendChild(j)}}}if(o=r.getCommentText()){o=goog.dom.createDom("comment",null,o),"object"==typeof r.comment&&(o.setAttribute("pinned",r.comment.isVisible()),n=r.comment.getBubbleSize(),o.setAttribute("h",n.height),o.setAttribute("w",n.width)),p.appendChild(o)}r.data&&(o=goog.dom.createDom("data",null,r.data),p.appendChild(o));for(o=0;n=r.inputList[o];o++){var i;l=!0;n.type!=Blockly.DUMMY_INPUT&&(j=n.connection.targetBlock(),n.type==Blockly.INPUT_VALUE?i=goog.dom.createDom("value"):n.type==Blockly.NEXT_STATEMENT&&(i=goog.dom.createDom("statement")),m=n.connection.getShadowDom(),!m||j&&j.isShadow()||i.appendChild(Blockly.Xml.cloneShadow_(m)),j&&(i.appendChild(Blockly.Xml.blockToDom(j,q)),l=!1),i.setAttribute("name",n.name),l||p.appendChild(i))}r.inputsInlineDefault!=r.inputsInline&&p.setAttribute("inline",r.inputsInline);r.isCollapsed()&&p.setAttribute("collapsed",!0);r.disabled&&p.setAttribute("disabled",!0);r.isDeletable()||r.isShadow()||p.setAttribute("deletable",!1);r.isMovable()||r.isShadow()||p.setAttribute("movable",!1);r.isEditable()||p.setAttribute("editable",!1);if(o=r.getNextBlock()){i=goog.dom.createDom("next",null,Blockly.Xml.blockToDom(o,q)),p.appendChild(i)}m=r.nextConnection&&r.nextConnection.getShadowDom();!m||o&&o.isShadow()||i.appendChild(Blockly.Xml.cloneShadow_(m));return p};Blockly.Xml.cloneShadow_=function(e){for(var d=e=e.cloneNode(!0),f;d;){if(d.firstChild){d=d.firstChild}else{for(;d&&!d.nextSibling;){f=d,d=d.parentNode,3==f.nodeType&&""==f.data.trim()&&d.firstChild!=f&&goog.dom.removeNode(f)}d&&(f=d,d=d.nextSibling,3==f.nodeType&&""==f.data.trim()&&goog.dom.removeNode(f))}}return e};Blockly.Xml.domToText=function(b){return(new XMLSerializer).serializeToString(b)};Blockly.Xml.domToPrettyText=function(f){f=Blockly.Xml.domToText(f).split("<");for(var e="",h=1;h<f.length;h++){var g=f[h];"/"==g[0]&&(e=e.substring(2));f[h]=e+"<"+g;"/"!=g[0]&&"/>"!=g.slice(-2)&&(e+="  ")}f=f.join("\n");f=f.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>");return f.replace(/^\n/,"")};Blockly.Xml.textToDom=function(b){(b=(new DOMParser).parseFromString(b,"text/xml"))&&b.firstChild&&"xml"==b.firstChild.nodeName.toLowerCase()&&b.firstChild===b.lastChild||goog.asserts.fail("Blockly.Xml.textToDom did not obtain a valid XML tree.");return b.firstChild};Blockly.Xml.domToWorkspace=function(t,s){if(t instanceof Blockly.Workspace){var r=t;t=s;s=r;console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var q;s.RTL&&(q=s.getWidth());r=[];Blockly.Field.startCache();var p=t.childNodes.length,o=Blockly.Events.getGroup();o||Blockly.Events.setGroup(!0);s.setResizesEnabled&&s.setResizesEnabled(!1);for(var m=0;m<p;m++){var l=t.childNodes[m],j=l.nodeName.toLowerCase();if("block"==j||"shadow"==j&&!Blockly.Events.recordUndo){j=Blockly.Xml.domToBlock(l,s);r.push(j.id);var i=parseInt(l.getAttribute("x"),10),l=parseInt(l.getAttribute("y"),10);isNaN(i)||isNaN(l)||j.moveBy(s.RTL?q-i:i,l)}else{"shadow"==j&&goog.asserts.fail("Shadow block cannot be a top-level block.")}}o||Blockly.Events.setGroup(!1);Blockly.Field.stopCache();s.updateVariableList(!1);s.setResizesEnabled&&s.setResizesEnabled(!0);return r};Blockly.Xml.appendDomToWorkspace=function(t,s){var r;if(s.hasOwnProperty("scale")){var q=Blockly.BlockSvg.TAB_WIDTH;try{Blockly.BlockSvg.TAB_WIDTH=0,r=s.getBlocksBoundingBox()}finally{Blockly.BlockSvg.TAB_WIDTH=q}}q=Blockly.Xml.domToWorkspace(t,s);if(r&&r.height){var p,o;p=r.y+r.height;o=r.x;var m=Infinity,l=Infinity;for(r=0;r<q.length;r++){var j=s.getBlockById(q[r]).getRelativeToSurfaceXY();j.y<l&&(l=j.y);j.x<m&&(m=j.x)}p=p-l+Blockly.BlockSvg.SEP_SPACE_Y;o-=m;var i;s.RTL&&(i=s.getWidth());for(r=0;r<q.length;r++){s.getBlockById(q[r]).moveBy(s.RTL?i-o:o,p)}}return q};Blockly.Xml.domToBlock=function(h,g){if(h instanceof Blockly.Workspace){var l=h;h=g;g=l;console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}Blockly.Events.disable();try{var k=Blockly.Xml.domToBlockHeadless_(h,g);if(g.rendered){k.setConnectionsHidden(!0);for(var j=k.getDescendants(),i=j.length-1;0<=i;i--){j[i].initSvg()}for(i=j.length-1;0<=i;i--){j[i].render(!1)}setTimeout(function(){k.workspace&&k.setConnectionsHidden(!1)},1);k.updateDisabled();g.resizeContents()}}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Create(k));return k};Blockly.Xml.domToBlockHeadless_=function(v,u){var t=null,s=v.getAttribute("type");goog.asserts.assert(s,"Block type unspecified: %s",v.outerHTML);for(var r=v.getAttribute("id"),t=u.newBlock(s,r),q=null,r=0,o;o=v.childNodes[r];r++){if(3!=o.nodeType){for(var m=q=null,l=0,j;j=o.childNodes[l];l++){1==j.nodeType&&("block"==j.nodeName.toLowerCase()?q=j:"shadow"==j.nodeName.toLowerCase()&&(m=j))}!q&&m&&(q=m);l=o.getAttribute("name");switch(o.nodeName.toLowerCase()){case"mutation":t.domToMutation&&(t.domToMutation(o),t.setHelpUrl(t.getHelpUrl()),t.initSvg&&t.initSvg());break;case"comment":t.setCommentText(o.textContent);var i=o.getAttribute("pinned");i&&!t.isInFlyout&&setTimeout(function(){t.comment&&t.comment.setVisible&&t.comment.setVisible("true"==i)},1);q=parseInt(o.getAttribute("w"),10);o=parseInt(o.getAttribute("h"),10);!isNaN(q)&&!isNaN(o)&&t.comment&&t.comment.setVisible&&t.comment.setBubbleSize(q,o);break;case"data":t.data=o.textContent;break;case"title":case"field":q=t.getField(l);if(!q){console.warn("Ignoring non-existent field "+l+" in block "+s);break}q.setValue(o.textContent);break;case"value":case"statement":o=t.getInput(l);if(!o){console.warn("Ignoring non-existent input "+l+" in block "+s);break}m&&o.connection.setShadowDom(m);q&&(q=Blockly.Xml.domToBlockHeadless_(q,u),q.outputConnection?o.connection.connect(q.outputConnection):q.previousConnection?o.connection.connect(q.previousConnection):goog.asserts.fail("Child block does not have output or previous statement."));break;case"next":m&&t.nextConnection&&t.nextConnection.setShadowDom(m);q&&(goog.asserts.assert(t.nextConnection,"Next statement does not exist."),goog.asserts.assert(!t.nextConnection.isConnected(),"Next statement is already connected."),q=Blockly.Xml.domToBlockHeadless_(q,u),goog.asserts.assert(q.previousConnection,"Next block does not have previous statement."),t.nextConnection.connect(q.previousConnection));break;default:console.warn("Ignoring unknown tag: "+o.nodeName)}}}(r=v.getAttribute("inline"))&&t.setInputsInline("true"==r);(r=v.getAttribute("disabled"))&&t.setDisabled("true"==r);(r=v.getAttribute("deletable"))&&t.setDeletable("true"==r);(r=v.getAttribute("movable"))&&t.setMovable("true"==r);(r=v.getAttribute("editable"))&&t.setEditable("true"==r);(r=v.getAttribute("collapsed"))&&t.setCollapsed("true"==r);if("shadow"==v.nodeName.toLowerCase()){s=t.getChildren();for(r=0;o=s[r];r++){goog.asserts.assert(o.isShadow(),"Shadow block not allowed non-shadow child.")}goog.asserts.assert(0==t.getVars().length,"Shadow blocks cannot have variable fields.");t.setShadow(!0)}return t};Blockly.Xml.deleteNext=function(e){for(var d=0,f;f=e.childNodes[d];d++){if("next"==f.nodeName.toLowerCase()){e.removeChild(f);break}}};goog.global.Blockly||(goog.global.Blockly={});goog.global.Blockly.Xml||(goog.global.Blockly.Xml={});goog.global.Blockly.Xml.domToText=Blockly.Xml.domToText;goog.global.Blockly.Xml.domToWorkspace=Blockly.Xml.domToWorkspace;goog.global.Blockly.Xml.textToDom=Blockly.Xml.textToDom;goog.global.Blockly.Xml.workspaceToDom=Blockly.Xml.workspaceToDom;"use strict";Blockly.ZoomControls=function(b){this.workspace_=b};Blockly.ZoomControls.prototype.WIDTH_=32;Blockly.ZoomControls.prototype.HEIGHT_=110;Blockly.ZoomControls.prototype.MARGIN_BOTTOM_=20;Blockly.ZoomControls.prototype.MARGIN_SIDE_=20;Blockly.ZoomControls.prototype.svgGroup_=null;Blockly.ZoomControls.prototype.left_=0;Blockly.ZoomControls.prototype.top_=0;Blockly.ZoomControls.prototype.createDom=function(){var g=this.workspace_;this.svgGroup_=Blockly.utils.createSvgElement("g",{"class":"blocklyZoom"},null);var f=String(Math.random()).substring(2),j=Blockly.utils.createSvgElement("clipPath",{id:"blocklyZoomoutClipPath"+f},this.svgGroup_);Blockly.utils.createSvgElement("rect",{width:32,height:32,y:77},j);var i=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,x:-64,y:-15,"clip-path":"url(#blocklyZoomoutClipPath"+f+")"},this.svgGroup_);i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g.options.pathToMedia+Blockly.SPRITE.url);j=Blockly.utils.createSvgElement("clipPath",{id:"blocklyZoominClipPath"+f},this.svgGroup_);Blockly.utils.createSvgElement("rect",{width:32,height:32,y:43},j);var h=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,x:-32,y:-49,"clip-path":"url(#blocklyZoominClipPath"+f+")"},this.svgGroup_);h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g.options.pathToMedia+Blockly.SPRITE.url);j=Blockly.utils.createSvgElement("clipPath",{id:"blocklyZoomresetClipPath"+f},this.svgGroup_);Blockly.utils.createSvgElement("rect",{width:32,height:32},j);f=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+f+")"},this.svgGroup_);f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g.options.pathToMedia+Blockly.SPRITE.url);Blockly.bindEventWithChecks_(f,"mousedown",null,function(a){g.markFocused();g.setScale(g.options.zoomOptions.startScale);g.scrollCenter();Blockly.Touch.clearTouchIdentifier();a.stopPropagation();a.preventDefault()});Blockly.bindEventWithChecks_(h,"mousedown",null,function(a){g.markFocused();g.zoomCenter(1);Blockly.Touch.clearTouchIdentifier();a.stopPropagation();a.preventDefault()});Blockly.bindEventWithChecks_(i,"mousedown",null,function(a){g.markFocused();g.zoomCenter(-1);Blockly.Touch.clearTouchIdentifier();a.stopPropagation();a.preventDefault()});return this.svgGroup_};Blockly.ZoomControls.prototype.init=function(b){this.bottom_=this.MARGIN_BOTTOM_+b;return this.bottom_+this.HEIGHT_};Blockly.ZoomControls.prototype.dispose=function(){this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null);this.workspace_=null};Blockly.ZoomControls.prototype.position=function(){var b=this.workspace_.getMetrics();b&&(this.workspace_.RTL?(this.left_=this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness,b.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(this.left_+=b.flyoutWidth,this.workspace_.toolbox_&&(this.left_+=b.absoluteLeft))):(this.left_=b.viewWidth+b.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness,b.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(this.left_-=b.flyoutWidth)),this.top_=b.viewHeight+b.absoluteTop-this.HEIGHT_-this.bottom_,b.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM&&(this.top_-=b.flyoutHeight),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))};"use strict";Blockly.WorkspaceSvg=function(e,d,f){Blockly.WorkspaceSvg.superClass_.constructor.call(this,e);this.getMetrics=e.getMetrics||Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_;this.setMetrics=e.setMetrics||Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_;Blockly.ConnectionDB.init(this);d&&(this.blockDragSurface_=d);f&&(this.workspaceDragSurface_=f);this.useWorkspaceDragSurface_=this.workspaceDragSurface_&&Blockly.utils.is3dSupported();this.SOUNDS_=Object.create(null);this.highlightedBlocks_=[];this.registerToolboxCategoryCallback(Blockly.VARIABLE_CATEGORY_NAME,Blockly.Variables.flyoutCategory);this.registerToolboxCategoryCallback(Blockly.PROCEDURE_CATEGORY_NAME,Blockly.Procedures.flyoutCategory)};goog.inherits(Blockly.WorkspaceSvg,Blockly.Workspace);Blockly.WorkspaceSvg.prototype.resizeHandlerWrapper_=null;Blockly.WorkspaceSvg.prototype.rendered=!0;Blockly.WorkspaceSvg.prototype.isFlyout=!1;Blockly.WorkspaceSvg.prototype.isMutator=!1;Blockly.WorkspaceSvg.prototype.dragMode_=Blockly.DRAG_NONE;Blockly.WorkspaceSvg.prototype.resizesEnabled_=!0;Blockly.WorkspaceSvg.prototype.scrollX=0;Blockly.WorkspaceSvg.prototype.scrollY=0;Blockly.WorkspaceSvg.prototype.startScrollX=0;Blockly.WorkspaceSvg.prototype.startScrollY=0;Blockly.WorkspaceSvg.prototype.dragDeltaXY_=null;Blockly.WorkspaceSvg.prototype.scale=1;Blockly.WorkspaceSvg.prototype.trashcan=null;Blockly.WorkspaceSvg.prototype.scrollbar=null;Blockly.WorkspaceSvg.prototype.blockDragSurface_=null;Blockly.WorkspaceSvg.prototype.workspaceDragSurface_=null;Blockly.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1;Blockly.WorkspaceSvg.prototype.isDragSurfaceActive_=!1;Blockly.WorkspaceSvg.prototype.lastSound_=null;Blockly.WorkspaceSvg.prototype.lastRecordedPageScroll_=null;Blockly.WorkspaceSvg.prototype.flyoutButtonCallbacks_={};Blockly.WorkspaceSvg.prototype.toolboxCategoryCallbacks_={};Blockly.WorkspaceSvg.prototype.inverseScreenCTM_=null;Blockly.WorkspaceSvg.prototype.getInverseScreenCTM=function(){return this.inverseScreenCTM_};Blockly.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){var b=this.getParentSvg().getScreenCTM();b&&(this.inverseScreenCTM_=b.inverse())};Blockly.WorkspaceSvg.prototype.getSvgXY=function(g){var f=0,j=0,i=1;if(goog.dom.contains(this.getCanvas(),g)||goog.dom.contains(this.getBubbleCanvas(),g)){i=this.scale}do{var h=Blockly.utils.getRelativeXY(g);if(g==this.getCanvas()||g==this.getBubbleCanvas()){i=1}f+=h.x*i;j+=h.y*i;g=g.parentNode}while(g&&g!=this.getParentSvg());return new goog.math.Coordinate(f,j)};Blockly.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(b){this.resizeHandlerWrapper_=b};Blockly.WorkspaceSvg.prototype.createDom=function(d){this.svgGroup_=Blockly.utils.createSvgElement("g",{"class":"blocklyWorkspace"},null);d&&(this.svgBackground_=Blockly.utils.createSvgElement("rect",{height:"100%",width:"100%","class":d},this.svgGroup_),"blocklyMainBackground"==d&&(this.svgBackground_.style.fill="url(#"+this.options.gridPattern.id+")"));this.svgBlockCanvas_=Blockly.utils.createSvgElement("g",{"class":"blocklyBlockCanvas"},this.svgGroup_,this);this.svgBubbleCanvas_=Blockly.utils.createSvgElement("g",{"class":"blocklyBubbleCanvas"},this.svgGroup_,this);d=Blockly.Scrollbar.scrollbarThickness;this.options.hasTrashcan&&(d=this.addTrashcan_(d));this.options.zoomOptions&&this.options.zoomOptions.controls&&(d=this.addZoomControls_(d));if(!this.isFlyout){Blockly.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_);var c=this;Blockly.bindEvent_(this.svgGroup_,"touchstart",null,function(b){Blockly.longStart_(b,c)});this.options.zoomOptions&&this.options.zoomOptions.wheel&&Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.onMouseWheel_)}this.options.hasCategories&&(this.toolbox_=new Blockly.Toolbox(this));this.updateGridPattern_();this.recordDeleteAreas();return this.svgGroup_};Blockly.WorkspaceSvg.prototype.dispose=function(){this.rendered=!1;Blockly.WorkspaceSvg.superClass_.dispose.call(this);this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null);this.svgBubbleCanvas_=this.svgBlockCanvas_=null;this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null);this.flyout_&&(this.flyout_.dispose(),this.flyout_=null);this.trashcan&&(this.trashcan.dispose(),this.trashcan=null);this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null);this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null);this.toolboxCategoryCallbacks_&&(this.toolboxCategoryCallbacks_=null);this.flyoutButtonCallbacks_&&(this.flyoutButtonCallbacks_=null);this.options.parentWorkspace||goog.dom.removeNode(this.getParentSvg().parentNode);this.resizeHandlerWrapper_&&(Blockly.unbindEvent_(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)};Blockly.WorkspaceSvg.prototype.newBlock=function(d,c){return new Blockly.BlockSvg(this,d,c)};Blockly.WorkspaceSvg.prototype.addTrashcan_=function(d){this.trashcan=new Blockly.Trashcan(this);var c=this.trashcan.createDom();this.svgGroup_.insertBefore(c,this.svgBlockCanvas_);return this.trashcan.init(d)};Blockly.WorkspaceSvg.prototype.addZoomControls_=function(d){this.zoomControls_=new Blockly.ZoomControls(this);var c=this.zoomControls_.createDom();this.svgGroup_.appendChild(c);return this.zoomControls_.init(d)};Blockly.WorkspaceSvg.prototype.addFlyout_=function(b){this.flyout_=new Blockly.Flyout({disabledPatternId:this.options.disabledPatternId,parentWorkspace:this,RTL:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,toolboxPosition:this.options.toolboxPosition});this.flyout_.autoClose=!1;return this.flyout_.createDom(b)};Blockly.WorkspaceSvg.prototype.getFlyout_=function(){return this.flyout_?this.flyout_:this.toolbox_?this.toolbox_.flyout_:null};Blockly.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM();this.recordDeleteAreas()};Blockly.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())};Blockly.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position();this.flyout_&&this.flyout_.position();this.trashcan&&this.trashcan.position();this.zoomControls_&&this.zoomControls_.position();this.scrollbar&&this.scrollbar.resize();this.updateScreenCalculations_()};Blockly.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var b=goog.dom.getDocumentScroll();goog.math.Coordinate.equals(this.lastRecordedPageScroll_,b)||(this.lastRecordedPageScroll_=b,this.updateScreenCalculations_())};Blockly.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_};Blockly.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_};Blockly.WorkspaceSvg.prototype.getParentSvg=function(){if(this.cachedParentSvg_){return this.cachedParentSvg_}for(var b=this.svgGroup_;b;){if("svg"==b.tagName){return this.cachedParentSvg_=b}b=b.parentNode}return null};Blockly.WorkspaceSvg.prototype.translate=function(e,d){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_){this.workspaceDragSurface_.translateSurface(e,d)}else{var f="translate("+e+","+d+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",f);this.svgBubbleCanvas_.setAttribute("transform",f)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(e,d,this.scale)};Blockly.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var b=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_);b="translate("+b.x+","+b.y+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",b);this.svgBubbleCanvas_.setAttribute("transform",b)}};Blockly.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var f=this.svgBlockCanvas_.previousSibling,e=this.getParentSvg().getAttribute("width"),h=this.getParentSvg().getAttribute("height"),g=Blockly.utils.getRelativeXY(this.svgBlockCanvas_);this.workspaceDragSurface_.setContentsAndShow(this.svgBlockCanvas_,this.svgBubbleCanvas_,f,e,h,this.scale);this.workspaceDragSurface_.translateSurface(g.x,g.y)}};Blockly.WorkspaceSvg.prototype.getWidth=function(){var b=this.getMetrics();return b?b.viewWidth/this.scale:0};Blockly.WorkspaceSvg.prototype.setVisible=function(b){this.scrollbar&&this.scrollbar.setContainerVisible(b);this.getFlyout_()&&this.getFlyout_().setContainerVisible(b);this.getParentSvg().style.display=b?"block":"none";this.toolbox_&&(this.toolbox_.HtmlDiv.style.display=b?"block":"none");b?(this.render(),this.toolbox_&&this.toolbox_.position()):Blockly.hideChaff(!0)};Blockly.WorkspaceSvg.prototype.render=function(){for(var d=this.getAllBlocks(),c=d.length-1;0<=c;c--){d[c].render(!1)}};Blockly.WorkspaceSvg.prototype.traceOn=function(){console.warn("Deprecated call to traceOn, delete this.")};Blockly.WorkspaceSvg.prototype.highlightBlock=function(f,e){if(void 0===e){for(var h=0,g;g=this.highlightedBlocks_[h];h++){g.setHighlighted(!1)}this.highlightedBlocks_.length=0}if(g=f?this.getBlockById(f):null){(h=void 0===e||e)?-1==this.highlightedBlocks_.indexOf(g)&&this.highlightedBlocks_.push(g):goog.array.remove(this.highlightedBlocks_,g),g.setHighlighted(h)}};Blockly.WorkspaceSvg.prototype.paste=function(t){if(this.rendered&&!(t.getElementsByTagName("block").length>=this.remainingCapacity())){Blockly.terminateDrag_();Blockly.Events.disable();try{var s=Blockly.Xml.domToBlock(t,this),r=parseInt(t.getAttribute("x"),10),q=parseInt(t.getAttribute("y"),10);if(!isNaN(r)&&!isNaN(q)){this.RTL&&(r=-r);do{t=!1;for(var p=this.getAllBlocks(),o=0,m;m=p[o];o++){var l=m.getRelativeToSurfaceXY();if(1>=Math.abs(r-l.x)&&1>=Math.abs(q-l.y)){t=!0;break}}if(!t){for(var j=s.getConnections_(!1),o=0,i;i=j[o];o++){if(i.closest(Blockly.SNAP_RADIUS,new goog.math.Coordinate(r,q)).connection){t=!0;break}}}t&&(r=this.RTL?r-Blockly.SNAP_RADIUS:r+Blockly.SNAP_RADIUS,q+=2*Blockly.SNAP_RADIUS)}while(t);s.moveBy(r,q)}}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&!s.isShadow()&&Blockly.Events.fire(new Blockly.Events.Create(s));s.select()}};Blockly.WorkspaceSvg.prototype.createVariable=function(b){Blockly.WorkspaceSvg.superClass_.createVariable.call(this,b);this.toolbox_&&this.toolbox_.flyout_&&!Blockly.Flyout.startFlyout_&&this.toolbox_.refreshSelection()};Blockly.WorkspaceSvg.prototype.recordDeleteAreas=function(){this.deleteAreaTrash_=this.trashcan?this.trashcan.getClientRect():null;this.deleteAreaToolbox_=this.flyout_?this.flyout_.getClientRect():this.toolbox_?this.toolbox_.getClientRect():null};Blockly.WorkspaceSvg.prototype.isDeleteArea=function(b){b=new goog.math.Coordinate(b.clientX,b.clientY);return this.deleteAreaTrash_&&this.deleteAreaTrash_.contains(b)?Blockly.DELETE_AREA_TRASH:this.deleteAreaToolbox_&&this.deleteAreaToolbox_.contains(b)?Blockly.DELETE_AREA_TOOLBOX:null};Blockly.WorkspaceSvg.prototype.onMouseDown_=function(b){this.markFocused();Blockly.utils.isTargetInput(b)?Blockly.Touch.clearTouchIdentifier():(Blockly.terminateDrag_(),Blockly.hideChaff(),b.target&&b.target.nodeName&&("svg"==b.target.nodeName.toLowerCase()||b.target==this.svgBackground_)&&Blockly.selected&&!this.options.readOnly&&Blockly.selected.unselect(),Blockly.utils.isRightButton(b)?(this.showContextMenu_(b),Blockly.onMouseUp_(b),Blockly.Touch.clearTouchIdentifier()):this.scrollbar?(this.dragMode_=Blockly.DRAG_BEGIN,this.startDragMouseX=b.clientX,this.startDragMouseY=b.clientY,this.startDragMetrics=this.getMetrics(),this.startScrollX=this.scrollX,this.startScrollY=this.scrollY,this.setupDragSurface(),"mouseup" in Blockly.Touch.TOUCH_MAP&&(Blockly.Touch.onTouchUpWrapper_=Blockly.Touch.onTouchUpWrapper_||[],Blockly.Touch.onTouchUpWrapper_=Blockly.Touch.onTouchUpWrapper_.concat(Blockly.bindEventWithChecks_(document,"mouseup",null,Blockly.onMouseUp_))),Blockly.onMouseMoveWrapper_=Blockly.onMouseMoveWrapper_||[],Blockly.onMouseMoveWrapper_=Blockly.onMouseMoveWrapper_.concat(Blockly.bindEventWithChecks_(document,"mousemove",null,Blockly.onMouseMove_))):Blockly.Touch.clearTouchIdentifier(),b.stopPropagation(),b.preventDefault())};Blockly.WorkspaceSvg.prototype.startDrag=function(e,d){var f=Blockly.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM());f.x/=this.scale;f.y/=this.scale;this.dragDeltaXY_=goog.math.Coordinate.difference(d,f)};Blockly.WorkspaceSvg.prototype.moveDrag=function(b){b=Blockly.utils.mouseToSvg(b,this.getParentSvg(),this.getInverseScreenCTM());b.x/=this.scale;b.y/=this.scale;return goog.math.Coordinate.sum(this.dragDeltaXY_,b)};Blockly.WorkspaceSvg.prototype.isDragging=function(){return Blockly.dragMode_==Blockly.DRAG_FREE||Blockly.Flyout.startFlyout_&&Blockly.Flyout.startFlyout_.dragMode_==Blockly.DRAG_FREE||this.dragMode_==Blockly.DRAG_FREE};Blockly.WorkspaceSvg.prototype.isDraggable=function(){return !!this.scrollbar};Blockly.WorkspaceSvg.prototype.onMouseWheel_=function(e){Blockly.terminateDrag_();var d=-e.deltaY/50,f=Blockly.utils.mouseToSvg(e,this.getParentSvg(),this.getInverseScreenCTM());this.zoom(f.x,f.y,d);e.preventDefault()};Blockly.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var f=this.getTopBlocks(!1);if(!f.length){return{x:0,y:0,width:0,height:0}}for(var e=f[0].getBoundingRectangle(),h=1;h<f.length;h++){var g=f[h].getBoundingRectangle();g.topLeft.x<e.topLeft.x&&(e.topLeft.x=g.topLeft.x);g.bottomRight.x>e.bottomRight.x&&(e.bottomRight.x=g.bottomRight.x);g.topLeft.y<e.topLeft.y&&(e.topLeft.y=g.topLeft.y);g.bottomRight.y>e.bottomRight.y&&(e.bottomRight.y=g.bottomRight.y)}return{x:e.topLeft.x,y:e.topLeft.y,width:e.bottomRight.x-e.topLeft.x,height:e.bottomRight.y-e.topLeft.y}};Blockly.WorkspaceSvg.prototype.cleanUp=function(){Blockly.Events.setGroup(!0);for(var g=this.getTopBlocks(!0),f=0,j=0,i;i=g[j];j++){var h=i.getRelativeToSurfaceXY();i.moveBy(-h.x,f-h.y);i.snapToGrid();f=i.getRelativeToSurfaceXY().y+i.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}Blockly.Events.setGroup(!1);this.resizeContents()};Blockly.WorkspaceSvg.prototype.showContextMenu_=function(x){function w(b){if(b.isDeletable()){m=m.concat(b.getDescendants())}else{b=b.getChildren();for(var d=0;d<b.length;d++){w(b[d])}}}function v(){Blockly.Events.setGroup(s);var b=m.shift();b&&(b.workspace?(b.dispose(!1,!0),setTimeout(v,10)):v());Blockly.Events.setGroup(!1)}if(!this.options.readOnly&&!this.isFlyout){var u=[],t=this.getTopBlocks(!0),s=Blockly.utils.genUid(),r={};r.text=Blockly.Msg.UNDO;r.enabled=0<this.undoStack_.length;r.callback=this.undo.bind(this,!1);u.push(r);r={};r.text=Blockly.Msg.REDO;r.enabled=0<this.redoStack_.length;r.callback=this.undo.bind(this,!0);u.push(r);this.scrollbar&&(r={},r.text=Blockly.Msg.CLEAN_UP,r.enabled=1<t.length,r.callback=this.cleanUp.bind(this),u.push(r));if(this.options.collapse){for(var q=r=!1,o=0;o<t.length;o++){for(var j=t[o];j;){j.isCollapsed()?r=!0:q=!0,j=j.getNextBlock()}}var i=function(f){for(var e=0,h=0;h<t.length;h++){for(var g=t[h];g;){setTimeout(g.setCollapsed.bind(g,f),e),g=g.getNextBlock(),e+=10}}},q={enabled:q};q.text=Blockly.Msg.COLLAPSE_ALL;q.callback=function(){i(!0)};u.push(q);r={enabled:r};r.text=Blockly.Msg.EXPAND_ALL;r.callback=function(){i(!1)};u.push(r)}for(var m=[],o=0;o<t.length;o++){w(t[o])}r={text:1==m.length?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(m.length)),enabled:0<m.length,callback:function(){2>m.length?v():Blockly.confirm(Blockly.Msg.DELETE_ALL_BLOCKS.replace("%1",m.length),function(b){b&&v()})}};u.push(r);Blockly.ContextMenu.show(x,u,this.RTL)}};Blockly.WorkspaceSvg.prototype.loadAudio_=function(j,i){if(j.length){try{var p=new window.Audio}catch(k){return}for(var o,n=0;n<j.length;n++){var m=j[n],l=m.match(/\.(\w+)$/);if(l&&p.canPlayType("audio/"+l[1])){o=new window.Audio(m);break}}o&&o.play&&(this.SOUNDS_[i]=o)}};Blockly.WorkspaceSvg.prototype.preloadAudio_=function(){for(var d in this.SOUNDS_){var c=this.SOUNDS_[d];c.volume=0.01;c.play();c.pause();if(goog.userAgent.IPAD||goog.userAgent.IPHONE){break}}};Blockly.WorkspaceSvg.prototype.playAudio=function(f,e){var h=this.SOUNDS_[f];if(h){var g=new Date;g-this.lastSound_<Blockly.SOUND_LIMIT||(this.lastSound_=g,h=goog.userAgent.DOCUMENT_MODE&&9===goog.userAgent.DOCUMENT_MODE||goog.userAgent.IPAD||goog.userAgent.ANDROID?h:h.cloneNode(),h.volume=void 0===e?1:e,h.play())}else{this.options.parentWorkspace&&this.options.parentWorkspace.playAudio(f,e)}};Blockly.WorkspaceSvg.prototype.updateToolbox=function(b){if(b=Blockly.Options.parseToolboxTree(b)){if(!this.options.languageTree){throw"Existing toolbox is null.  Can't create new toolbox."}if(b.getElementsByTagName("category").length){if(!this.toolbox_){throw"Existing toolbox has no categories.  Can't change mode."}this.options.languageTree=b;this.toolbox_.populate_(b);this.toolbox_.addColour_()}else{if(!this.flyout_){throw"Existing toolbox has categories.  Can't change mode."}this.options.languageTree=b;this.flyout_.show(b.childNodes)}}else{if(this.options.languageTree){throw"Can't nullify an existing toolbox."}}};Blockly.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(Blockly.mainWorkspace=this,this.setBrowserFocus())};Blockly.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur();try{this.getParentSvg().focus()}catch(d){try{this.getParentSvg().parentNode.setActive()}catch(c){this.getParentSvg().parentNode.focus()}}};Blockly.WorkspaceSvg.prototype.zoom=function(h,g,l){var k=this.options.zoomOptions.scaleSpeed,j=this.getMetrics(),i=this.getParentSvg().createSVGPoint();i.x=h;i.y=g;i=i.matrixTransform(this.getCanvas().getCTM().inverse());h=i.x;g=i.y;i=this.getCanvas();k=Math.pow(k,l);l=this.scale*k;l>this.options.zoomOptions.maxScale?k=this.options.zoomOptions.maxScale/this.scale:l<this.options.zoomOptions.minScale&&(k=this.options.zoomOptions.minScale/this.scale);this.scale!=l&&(this.scrollbar&&(h=i.getCTM().translate(h*(1-k),g*(1-k)).scale(k),this.scrollX=h.e-j.absoluteLeft,this.scrollY=h.f-j.absoluteTop),this.setScale(l))};Blockly.WorkspaceSvg.prototype.zoomCenter=function(d){var c=this.getMetrics();this.zoom(c.viewWidth/2,c.viewHeight/2,d)};Blockly.WorkspaceSvg.prototype.zoomToFit=function(){var g=this.getMetrics(),f=this.getBlocksBoundingBox(),j=f.width,f=f.height;if(j){var i=g.viewWidth,h=g.viewHeight;this.flyout_&&(i-=this.flyout_.width_);this.scrollbar||(j+=g.contentLeft,f+=g.contentTop);this.setScale(Math.min(i/j,h/f));this.scrollCenter()}};Blockly.WorkspaceSvg.prototype.scrollCenter=function(){if(this.scrollbar){var d=this.getMetrics(),c=(d.contentWidth-d.viewWidth)/2;this.flyout_&&(c-=this.flyout_.width_/2);this.scrollbar.set(c,(d.contentHeight-d.viewHeight)/2)}};Blockly.WorkspaceSvg.prototype.setScale=function(b){this.options.zoomOptions.maxScale&&b>this.options.zoomOptions.maxScale?b=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&b<this.options.zoomOptions.minScale&&(b=this.options.zoomOptions.minScale);this.scale=b;this.updateGridPattern_();this.scrollbar?this.scrollbar.resize():this.translate(this.scrollX,this.scrollY);Blockly.hideChaff(!1);this.flyout_&&this.flyout_.reflow()};Blockly.WorkspaceSvg.prototype.updateGridPattern_=function(){if(this.options.gridPattern){var g=this.options.gridOptions.spacing*this.scale||100;this.options.gridPattern.setAttribute("width",g);this.options.gridPattern.setAttribute("height",g);var g=Math.floor(this.options.gridOptions.spacing/2)+0.5,f=g-this.options.gridOptions.length/2,j=g+this.options.gridOptions.length/2,i=this.options.gridPattern.firstChild,h=i&&i.nextSibling,g=g*this.scale,f=f*this.scale,j=j*this.scale;i&&(i.setAttribute("stroke-width",this.scale),i.setAttribute("x1",f),i.setAttribute("y1",g),i.setAttribute("x2",j),i.setAttribute("y2",g));h&&(h.setAttribute("stroke-width",this.scale),h.setAttribute("x1",g),h.setAttribute("y1",f),h.setAttribute("x2",g),h.setAttribute("y2",j))}};Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){var r=Blockly.svgSize(this.getParentSvg());if(this.toolbox_){if(this.toolboxPosition==Blockly.TOOLBOX_AT_TOP||this.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM){r.height-=this.toolbox_.getHeight()}else{if(this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT||this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT){r.width-=this.toolbox_.getWidth()}}}var q=Blockly.Flyout.prototype.CORNER_RADIUS-1,p=r.width-q,o=r.height-q,n=this.getBlocksBoundingBox(),m=n.width*this.scale,l=n.height*this.scale,j=n.x*this.scale,i=n.y*this.scale;this.scrollbar?(q=Math.min(j-p/2,j+m-p),p=Math.max(j+m+p/2,j+p),m=Math.min(i-o/2,i+l-o),o=Math.max(i+l+o/2,i+o)):(q=n.x,p=q+n.width,m=n.y,o=m+n.height);n=0;this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(n=this.toolbox_.getWidth());l=0;this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_TOP&&(l=this.toolbox_.getHeight());return{viewHeight:r.height,viewWidth:r.width,contentHeight:o-m,contentWidth:p-q,viewTop:-this.scrollY,viewLeft:-this.scrollX,contentTop:m,contentLeft:q,absoluteTop:l,absoluteLeft:n,toolboxWidth:this.toolbox_?this.toolbox_.getWidth():0,toolboxHeight:this.toolbox_?this.toolbox_.getHeight():0,flyoutWidth:this.flyout_?this.flyout_.getWidth():0,flyoutHeight:this.flyout_?this.flyout_.getHeight():0,toolboxPosition:this.toolboxPosition}};Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(d){if(!this.scrollbar){throw"Attempt to set top level workspace scroll without scrollbars."}var c=this.getMetrics();goog.isNumber(d.x)&&(this.scrollX=-c.contentWidth*d.x-c.contentLeft);goog.isNumber(d.y)&&(this.scrollY=-c.contentHeight*d.y-c.contentTop);d=this.scrollX+c.absoluteLeft;c=this.scrollY+c.absoluteTop;this.translate(d,c);this.options.gridPattern&&(this.options.gridPattern.setAttribute("x",d),this.options.gridPattern.setAttribute("y",c),(goog.userAgent.IE||goog.userAgent.EDGE)&&this.updateGridPattern_())};Blockly.WorkspaceSvg.prototype.setResizesEnabled=function(d){var c=!this.resizesEnabled_&&d;this.resizesEnabled_=d;c&&this.resizeContents()};Blockly.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1);Blockly.WorkspaceSvg.superClass_.clear.call(this);this.setResizesEnabled(!0)};Blockly.WorkspaceSvg.prototype.registerButtonCallback=function(d,c){goog.asserts.assert(goog.isFunction(c),"Button callbacks must be functions.");this.flyoutButtonCallbacks_[d]=c};Blockly.WorkspaceSvg.prototype.getButtonCallback=function(b){return(b=this.flyoutButtonCallbacks_[b])?b:null};Blockly.WorkspaceSvg.prototype.removeButtonCallback=function(b){this.flyoutButtonCallbacks_[b]=null};Blockly.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(d,c){goog.asserts.assert(goog.isFunction(c),"Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[d]=c};Blockly.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(b){return(b=this.toolboxCategoryCallbacks_[b])?b:null};Blockly.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(b){this.toolboxCategoryCallbacks_[b]=null};Blockly.WorkspaceSvg.prototype.setVisible=Blockly.WorkspaceSvg.prototype.setVisible;"use strict";Blockly.Mutator=function(b){Blockly.Mutator.superClass_.constructor.call(this,null);this.quarkNames_=b};goog.inherits(Blockly.Mutator,Blockly.Icon);Blockly.Mutator.prototype.workspaceWidth_=0;Blockly.Mutator.prototype.workspaceHeight_=0;Blockly.Mutator.prototype.drawIcon_=function(b){Blockly.utils.createSvgElement("rect",{"class":"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},b);Blockly.utils.createSvgElement("path",{"class":"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},b);Blockly.utils.createSvgElement("circle",{"class":"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},b)};Blockly.Mutator.prototype.iconClick_=function(b){this.block_.isEditable()&&Blockly.Icon.prototype.iconClick_.call(this,b)};Blockly.Mutator.prototype.createEditor_=function(){this.svgDialog_=Blockly.utils.createSvgElement("svg",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null);if(this.quarkNames_.length){for(var e=goog.dom.createDom("xml"),d=0,f;f=this.quarkNames_[d];d++){e.appendChild(goog.dom.createDom("block",{type:f}))}}else{e=null}e={languageTree:e,parentWorkspace:this.block_.workspace,pathToMedia:this.block_.workspace.options.pathToMedia,RTL:this.block_.RTL,toolboxPosition:this.block_.RTL?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT,horizontalLayout:!1,getMetrics:this.getFlyoutMetrics_.bind(this),setMetrics:null};this.workspace_=new Blockly.WorkspaceSvg(e);this.workspace_.isMutator=!0;e=this.workspace_.addFlyout_("g");d=this.workspace_.createDom("blocklyMutatorBackground");d.appendChild(e);this.svgDialog_.appendChild(d);return this.svgDialog_};Blockly.Mutator.prototype.updateEditable=function(){this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&Blockly.utils.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&Blockly.utils.addClass(this.iconGroup_,"blocklyIconGroupReadonly")));Blockly.Icon.prototype.updateEditable.call(this)};Blockly.Mutator.prototype.resizeBubble_=function(){var f=2*Blockly.Bubble.BORDER_WIDTH,e=this.workspace_.getCanvas().getBBox(),h;h=this.block_.RTL?-e.x:e.width+e.x;e=e.height+3*f;if(this.workspace_.flyout_){var g=this.workspace_.flyout_.getMetrics_(),e=Math.max(e,g.contentHeight+20)}h+=3*f;if(Math.abs(this.workspaceWidth_-h)>f||Math.abs(this.workspaceHeight_-e)>f){this.workspaceWidth_=h,this.workspaceHeight_=e,this.bubble_.setBubbleSize(h+f,e+f),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_)}this.block_.RTL&&(f="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",f));this.workspace_.resize()};Blockly.Mutator.prototype.setVisible=function(f){if(f!=this.isVisible()){if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"mutatorOpen",!f,f)),f){this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,null,null);if(f=this.workspace_.options.languageTree){this.workspace_.flyout_.init(this.workspace_),this.workspace_.flyout_.show(f.childNodes)}this.rootBlock_=this.block_.decompose(this.workspace_);f=this.rootBlock_.getDescendants();for(var e=0,h;h=f[e];e++){h.render()}this.rootBlock_.setMovable(!1);this.rootBlock_.setDeletable(!1);this.workspace_.flyout_?(f=2*this.workspace_.flyout_.CORNER_RADIUS,e=this.workspace_.flyout_.width_+f):e=f=16;this.block_.RTL&&(e=-e);this.rootBlock_.moveBy(e,f);if(this.block_.saveConnections){var g=this;this.block_.saveConnections(this.rootBlock_);this.sourceListener_=function(){g.block_.saveConnections(g.rootBlock_)};this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_();this.workspace_.addChangeListener(this.workspaceChanged_.bind(this));this.updateColour()}else{this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)}}};Blockly.Mutator.prototype.workspaceChanged_=function(){if(Blockly.dragMode_==Blockly.DRAG_NONE){for(var h=this.workspace_.getTopBlocks(!1),g=0,l;l=h[g];g++){var k=l.getRelativeToSurfaceXY(),j=l.getHeightWidth();20>k.y+j.height&&l.moveBy(0,20-j.height-k.y)}}if(this.rootBlock_.workspace==this.workspace_){Blockly.Events.setGroup(!0);l=this.block_;h=(h=l.mutationToDom())&&Blockly.Xml.domToText(h);g=l.rendered;l.rendered=!1;l.compose(this.rootBlock_);l.rendered=g;l.initSvg();g=(g=l.mutationToDom())&&Blockly.Xml.domToText(g);if(h!=g){Blockly.Events.fire(new Blockly.Events.Change(l,"mutation",null,h,g));var i=Blockly.Events.getGroup();setTimeout(function(){Blockly.Events.setGroup(i);l.bumpNeighbours_();Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY)}l.rendered&&l.render();this.resizeBubble_();Blockly.Events.setGroup(!1)}};Blockly.Mutator.prototype.getFlyoutMetrics_=function(){return{viewHeight:this.workspaceHeight_,viewWidth:this.workspaceWidth_,absoluteTop:0,absoluteLeft:0}};Blockly.Mutator.prototype.dispose=function(){this.block_.mutator=null;Blockly.Icon.prototype.dispose.call(this)};Blockly.Mutator.reconnect=function(f,e,h){if(!f||!f.getSourceBlock().workspace){return !1}h=e.getInput(h).connection;var g=f.targetBlock();return g&&g!=e||h.targetConnection==f?!1:(h.isConnected()&&h.disconnect(),h.connect(f),!0)};goog.global.Blockly||(goog.global.Blockly={});goog.global.Blockly.Mutator||(goog.global.Blockly.Mutator={});goog.global.Blockly.Mutator.reconnect=Blockly.Mutator.reconnect;"use strict";Blockly.Warning=function(b){Blockly.Warning.superClass_.constructor.call(this,b);this.createIcon();this.text_={}};goog.inherits(Blockly.Warning,Blockly.Icon);Blockly.Warning.prototype.collapseHidden=!1;Blockly.Warning.prototype.drawIcon_=function(b){Blockly.utils.createSvgElement("path",{"class":"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},b);Blockly.utils.createSvgElement("path",{"class":"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},b);Blockly.utils.createSvgElement("rect",{"class":"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},b)};Blockly.Warning.textToDom_=function(g){var f=Blockly.utils.createSvgElement("text",{"class":"blocklyText blocklyBubbleText",y:Blockly.Bubble.BORDER_WIDTH},null);g=g.split("\n");for(var j=0;j<g.length;j++){var i=Blockly.utils.createSvgElement("tspan",{dy:"1em",x:Blockly.Bubble.BORDER_WIDTH},f),h=document.createTextNode(g[j]);i.appendChild(h)}return f};Blockly.Warning.prototype.setVisible=function(f){if(f!=this.isVisible()){if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"warningOpen",!f,f)),f){f=Blockly.Warning.textToDom_(this.getText());this.bubble_=new Blockly.Bubble(this.block_.workspace,f,this.block_.svgPath_,this.iconXY_,null,null);if(this.block_.RTL){for(var e=f.getBBox().width,h=0,g;g=f.childNodes[h];h++){g.setAttribute("text-anchor","end"),g.setAttribute("x",e+Blockly.Bubble.BORDER_WIDTH)}}this.updateColour();f=this.bubble_.getBubbleSize();this.bubble_.setBubbleSize(f.width,f.height)}else{this.bubble_.dispose(),this.body_=this.bubble_=null}}};Blockly.Warning.prototype.bodyFocus_=function(b){this.bubble_.promote_()};Blockly.Warning.prototype.setText=function(d,c){this.text_[c]!=d&&(d?this.text_[c]=d:delete this.text_[c],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))};Blockly.Warning.prototype.getText=function(){var d=[],c;for(c in this.text_){d.push(this.text_[c])}return d.join("\n")};Blockly.Warning.prototype.dispose=function(){this.block_.warning=null;Blockly.Icon.prototype.dispose.call(this)};"use strict";Blockly.Block=function(e,d,f){this.id=f&&!e.getBlockById(f)?f:Blockly.utils.genUid();e.blockDB_[this.id]=this;this.previousConnection=this.nextConnection=this.outputConnection=null;this.inputList=[];this.inputsInline=void 0;this.disabled=!1;this.tooltip="";this.contextMenu=!0;this.parentBlock_=null;this.childBlocks_=[];this.editable_=this.movable_=this.deletable_=!0;this.collapsed_=this.isShadow_=!1;this.comment=null;this.xy_=new goog.math.Coordinate(0,0);this.workspace=e;this.isInFlyout=e.isFlyout;this.isInMutator=e.isMutator;this.RTL=e.RTL;d&&(this.type=d,f=Blockly.Blocks[d],goog.asserts.assertObject(f,'Error: Unknown block type "%s".',d),goog.mixin(this,f));e.addTopBlock(this);goog.isFunction(this.init)&&this.init();this.setHelpUrl(this.getHelpUrl());this.inputsInlineDefault=this.inputsInline;Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Create(this));goog.isFunction(this.onchange)&&this.setOnChange(this.onchange)};Blockly.Block.obtain=function(d,c){console.warn("Deprecated call to Blockly.Block.obtain, use workspace.newBlock instead.");return d.newBlock(c)};Blockly.Block.prototype.data=null;Blockly.Block.prototype.colour_="#000000";Blockly.Block.prototype.dispose=function(g){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_);this.unplug(g);Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Delete(this));Blockly.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),delete this.workspace.blockDB_[this.id],this.workspace=null);for(var f=this.childBlocks_.length-1;0<=f;f--){this.childBlocks_[f].dispose(!1)}for(var f=0,j;j=this.inputList[f];f++){j.dispose()}this.inputList.length=0;for(var i=this.getConnections_(!0),f=0;f<i.length;f++){var h=i[f];h.isConnected()&&h.disconnect();i[f].dispose()}}finally{Blockly.Events.enable()}}};Blockly.Block.prototype.unplug=function(e){if(this.outputConnection){this.outputConnection.isConnected()&&this.outputConnection.disconnect()}else{if(this.previousConnection){var d=null;this.previousConnection.isConnected()&&(d=this.previousConnection.targetConnection,this.previousConnection.disconnect());var f=this.getNextBlock();e&&f&&(e=this.nextConnection.targetConnection,e.disconnect(),d&&d.checkType_(e)&&d.connect(e))}}};Blockly.Block.prototype.getConnections_=function(){var e=[];this.outputConnection&&e.push(this.outputConnection);this.previousConnection&&e.push(this.previousConnection);this.nextConnection&&e.push(this.nextConnection);for(var d=0,f;f=this.inputList[d];d++){f.connection&&e.push(f.connection)}return e};Blockly.Block.prototype.lastConnectionInStack_=function(){for(var d=this.nextConnection;d;){var c=d.targetBlock();if(!c){return d}d=c.nextConnection}return null};Blockly.Block.prototype.bumpNeighbours_=function(){if(this.workspace&&Blockly.dragMode_==Blockly.DRAG_NONE){var i=this.getRootBlock();if(!i.isInFlyout){for(var h=this.getConnections_(!1),n=0,m;m=h[n];n++){m.isConnected()&&m.isSuperior()&&m.targetBlock().bumpNeighbours_();for(var l=m.neighbours_(Blockly.SNAP_RADIUS),k=0,j;j=l[k];k++){m.isConnected()&&j.isConnected()||j.getSourceBlock().getRootBlock()!=i&&(m.isSuperior()?j.bumpAwayFrom_(m):m.bumpAwayFrom_(j))}}}}};Blockly.Block.prototype.getParent=function(){return this.parentBlock_};Blockly.Block.prototype.getInputWithBlock=function(e){for(var d=0,f;f=this.inputList[d];d++){if(f.connection&&f.connection.targetBlock()==e){return f}}return null};Blockly.Block.prototype.getSurroundParent=function(){var d=this;do{var c=d,d=d.getParent();if(!d){return null}}while(d.getNextBlock()==c);return d};Blockly.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()};Blockly.Block.prototype.getRootBlock=function(){var d,c=this;do{d=c,c=d.parentBlock_}while(c);return d};Blockly.Block.prototype.getChildren=function(){return this.childBlocks_};Blockly.Block.prototype.setParent=function(b){if(b!=this.parentBlock_){if(this.parentBlock_){goog.array.remove(this.parentBlock_.childBlocks_,this);if(this.previousConnection&&this.previousConnection.isConnected()){throw"Still connected to previous block."}if(this.outputConnection&&this.outputConnection.isConnected()){throw"Still connected to parent block."}this.parentBlock_=null}else{this.workspace.removeTopBlock(this)}(this.parentBlock_=b)?b.childBlocks_.push(this):this.workspace.addTopBlock(this)}};Blockly.Block.prototype.getDescendants=function(){for(var e=[this],d,f=0;d=this.childBlocks_[f];f++){e.push.apply(e,d.getDescendants())}return e};Blockly.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)};Blockly.Block.prototype.setDeletable=function(b){this.deletable_=b};Blockly.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)};Blockly.Block.prototype.setMovable=function(b){this.movable_=b};Blockly.Block.prototype.isShadow=function(){return this.isShadow_};Blockly.Block.prototype.setShadow=function(b){this.isShadow_=b};Blockly.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)};Blockly.Block.prototype.setEditable=function(f){this.editable_=f;f=0;for(var e;e=this.inputList[f];f++){for(var h=0,g;g=e.fieldRow[h];h++){g.updateEditable()}}};Blockly.Block.prototype.setConnectionsHidden=function(f){if(!f&&this.isCollapsed()){if(this.outputConnection&&this.outputConnection.setHidden(f),this.previousConnection&&this.previousConnection.setHidden(f),this.nextConnection){this.nextConnection.setHidden(f);var e=this.nextConnection.targetBlock();e&&e.setConnectionsHidden(f)}}else{for(var h=this.getConnections_(!0),g=0;e=h[g];g++){e.setHidden(f),e.isSuperior()&&(e=e.targetBlock())&&e.setConnectionsHidden(f)}}};Blockly.Block.prototype.setHelpUrl=function(b){this.helpUrl=b};Blockly.Block.prototype.setTooltip=function(b){this.tooltip=b};Blockly.Block.prototype.getColour=function(){return this.colour_};Blockly.Block.prototype.setColour=function(d){var c=Number(d);if(isNaN(c)){if(goog.isString(d)&&d.match(/^#[0-9a-fA-F]{6}$/)){this.colour_=d}else{throw"Invalid colour: "+d}}else{this.colour_=Blockly.hueToRgb(c)}};Blockly.Block.prototype.setOnChange=function(b){if(b&&!goog.isFunction(b)){throw Error("onchange must be a function.")}this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_);if(this.onchange=b){this.onchangeWrapper_=b.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}};Blockly.Block.prototype.getField=function(g){for(var f=0,j;j=this.inputList[f];f++){for(var i=0,h;h=j.fieldRow[i];i++){if(h.name===g){return h}}}return null};Blockly.Block.prototype.getVars=function(){for(var g=[],f=0,j;j=this.inputList[f];f++){for(var i=0,h;h=j.fieldRow[i];i++){h instanceof Blockly.FieldVariable&&g.push(h.getValue())}}return g};Blockly.Block.prototype.renameVar=function(h,g){for(var l=0,k;k=this.inputList[l];l++){for(var j=0,i;i=k.fieldRow[j];j++){i instanceof Blockly.FieldVariable&&Blockly.Names.equals(h,i.getValue())&&i.setValue(g)}}};Blockly.Block.prototype.getFieldValue=function(b){return(b=this.getField(b))?b.getValue():null};Blockly.Block.prototype.setFieldValue=function(e,d){var f=this.getField(d);goog.asserts.assertObject(f,'Field "%s" not found.',d);f.setValue(e)};Blockly.Block.prototype.setPreviousStatement=function(d,c){d?(void 0===c&&(c=null),this.previousConnection||(goog.asserts.assert(!this.outputConnection,"Remove output connection prior to adding previous connection."),this.previousConnection=this.makeConnection_(Blockly.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(c)):this.previousConnection&&(goog.asserts.assert(!this.previousConnection.isConnected(),"Must disconnect previous statement before removing connection."),this.previousConnection.dispose(),this.previousConnection=null)};Blockly.Block.prototype.setNextStatement=function(d,c){d?(void 0===c&&(c=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Blockly.NEXT_STATEMENT)),this.nextConnection.setCheck(c)):this.nextConnection&&(goog.asserts.assert(!this.nextConnection.isConnected(),"Must disconnect next statement before removing connection."),this.nextConnection.dispose(),this.nextConnection=null)};Blockly.Block.prototype.setOutput=function(d,c){d?(void 0===c&&(c=null),this.outputConnection||(goog.asserts.assert(!this.previousConnection,"Remove previous connection prior to adding output connection."),this.outputConnection=this.makeConnection_(Blockly.OUTPUT_VALUE)),this.outputConnection.setCheck(c)):this.outputConnection&&(goog.asserts.assert(!this.outputConnection.isConnected(),"Must disconnect output value before removing connection."),this.outputConnection.dispose(),this.outputConnection=null)};Blockly.Block.prototype.setInputsInline=function(b){this.inputsInline!=b&&(Blockly.Events.fire(new Blockly.Events.Change(this,"inline",null,this.inputsInline,b)),this.inputsInline=b)};Blockly.Block.prototype.getInputsInline=function(){if(void 0!=this.inputsInline){return this.inputsInline}for(var b=1;b<this.inputList.length;b++){if(this.inputList[b-1].type==Blockly.DUMMY_INPUT&&this.inputList[b].type==Blockly.DUMMY_INPUT){return !1}}for(b=1;b<this.inputList.length;b++){if(this.inputList[b-1].type==Blockly.INPUT_VALUE&&this.inputList[b].type==Blockly.DUMMY_INPUT){return !0}}return !1};Blockly.Block.prototype.setDisabled=function(b){this.disabled!=b&&(Blockly.Events.fire(new Blockly.Events.Change(this,"disabled",null,this.disabled,b)),this.disabled=b)};Blockly.Block.prototype.getInheritedDisabled=function(){for(var b=this.getSurroundParent();b;){if(b.disabled){return !0}b=b.getSurroundParent()}return !1};Blockly.Block.prototype.isCollapsed=function(){return this.collapsed_};Blockly.Block.prototype.setCollapsed=function(b){this.collapsed_!=b&&(Blockly.Events.fire(new Blockly.Events.Change(this,"collapsed",null,this.collapsed_,b)),this.collapsed_=b)};Blockly.Block.prototype.toString=function(j,i){var p=[],o=i||"?";if(this.collapsed_){p.push(this.getInput("_TEMP_COLLAPSED_INPUT").fieldRow[0].text_)}else{for(var n=0,m;m=this.inputList[n];n++){for(var l=0,k;k=m.fieldRow[l];l++){k instanceof Blockly.FieldDropdown&&!k.getValue()?p.push(o):p.push(k.getText())}m.connection&&((m=m.connection.targetBlock())?p.push(m.toString(void 0,i)):p.push(o))}}p=goog.string.trim(p.join(" "))||"???";j&&(p=goog.string.truncate(p,j));return p};Blockly.Block.prototype.appendValueInput=function(b){return this.appendInput_(Blockly.INPUT_VALUE,b)};Blockly.Block.prototype.appendStatementInput=function(b){return this.appendInput_(Blockly.NEXT_STATEMENT,b)};Blockly.Block.prototype.appendDummyInput=function(b){return this.appendInput_(Blockly.DUMMY_INPUT,b||"")};Blockly.Block.prototype.jsonInit=function(d){goog.asserts.assert(void 0==d.output||void 0==d.previousStatement,"Must not have both an output and a previousStatement.");if(void 0!==d.colour){var c=d.colour,c=goog.isString(c)?Blockly.utils.replaceMessageReferences(c):c;this.setColour(c)}for(c=0;void 0!==d["message"+c];){this.interpolate_(d["message"+c],d["args"+c]||[],d["lastDummyAlign"+c]),c++}void 0!==d.inputsInline&&this.setInputsInline(d.inputsInline);void 0!==d.output&&this.setOutput(!0,d.output);void 0!==d.previousStatement&&this.setPreviousStatement(!0,d.previousStatement);void 0!==d.nextStatement&&this.setNextStatement(!0,d.nextStatement);void 0!==d.tooltip&&(c=d.tooltip,c=Blockly.utils.replaceMessageReferences(c),this.setTooltip(c));void 0!==d.enableContextMenu&&(c=d.enableContextMenu,this.contextMenu=!!c);void 0!==d.helpUrl&&(c=d.helpUrl,c=Blockly.utils.replaceMessageReferences(c),this.setHelpUrl(c));goog.isString(d.extensions)&&(console.warn("JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+d.type+"' block."),d.extensions=[d.extensions]);void 0!==d.mutator&&Blockly.Extensions.apply(d.mutator,this,!0);if(Array.isArray(d.extensions)){for(d=d.extensions,c=0;c<d.length;++c){Blockly.Extensions.apply(d[c],this,!1)}}};Blockly.Block.prototype.mixin=function(f,e){if(goog.isDef(e)&&!goog.isBoolean(e)){throw Error("opt_disableCheck must be a boolean if provided")}if(!e){var h=[],g;for(g in f){void 0!==this[g]&&h.push(g)}if(h.length){throw Error("Mixin will overwrite block members: "+JSON.stringify(h))}}goog.mixin(this,f)};Blockly.Block.prototype.interpolate_=function(j,i,p){var o=Blockly.utils.tokenizeInterpolation(j),n=[],m=0;j=[];for(var l=0;l<o.length;l++){var k=o[l];"number"==typeof k?(goog.asserts.assert(0<k&&k<=i.length,"Message index %%s out of range.",k),goog.asserts.assert(!n[k],"Message index %%s duplicated.",k),n[k]=!0,m++,j.push(i[k-1])):(k=k.trim())&&j.push(k)}goog.asserts.assert(m==i.length,'block "%s": Message does not reference all %s arg(s).',this.type,i.length);j.length&&("string"==typeof j[j.length-1]||goog.string.startsWith(j[j.length-1].type,"field_"))&&(l={type:"input_dummy"},p&&(l.align=p),j.push(l));p={LEFT:Blockly.ALIGN_LEFT,RIGHT:Blockly.ALIGN_RIGHT,CENTRE:Blockly.ALIGN_CENTRE};i=[];for(l=0;l<j.length;l++){if(n=j[l],"string"==typeof n){i.push([n,void 0])}else{o=m=null;do{if(k=!1,"string"==typeof n){m=new Blockly.FieldLabel(n)}else{switch(n.type){case"input_value":o=this.appendValueInput(n.name);break;case"input_statement":o=this.appendStatementInput(n.name);break;case"input_dummy":o=this.appendDummyInput(n.name);break;case"field_label":m=Blockly.Block.newFieldLabelFromJson_(n);break;case"field_input":m=Blockly.Block.newFieldTextInputFromJson_(n);break;case"field_angle":m=new Blockly.FieldAngle(n.angle);break;case"field_checkbox":m=new Blockly.FieldCheckbox(n.checked?"TRUE":"FALSE");break;case"field_colour":m=new Blockly.FieldColour(n.colour);break;case"field_variable":m=Blockly.Block.newFieldVariableFromJson_(n);break;case"field_dropdown":m=new Blockly.FieldDropdown(n.options);break;case"field_image":m=Blockly.Block.newFieldImageFromJson_(n);break;case"field_number":m=new Blockly.FieldNumber(n.value,n.min,n.max,n.precision);break;case"field_date":if(Blockly.FieldDate){m=new Blockly.FieldDate(n.date);break}default:n.alt&&(n=n.alt,k=!0)}}}while(k);if(m){i.push([m,n.name])}else{if(o){n.check&&o.setCheck(n.check);n.align&&o.setAlign(p[n.align]);for(n=0;n<i.length;n++){o.appendField(i[n][0],i[n][1])}i.length=0}}}}};Blockly.Block.newFieldImageFromJson_=function(f){var e=Blockly.utils.replaceMessageReferences(f.src),h=Number(Blockly.utils.replaceMessageReferences(f.width)),g=Number(Blockly.utils.replaceMessageReferences(f.height));f=Blockly.utils.replaceMessageReferences(f.alt);return new Blockly.FieldImage(e,h,g,f)};Blockly.Block.newFieldLabelFromJson_=function(d){var c=Blockly.utils.replaceMessageReferences(d.text);return new Blockly.FieldLabel(c,d["class"])};Blockly.Block.newFieldTextInputFromJson_=function(d){var c=Blockly.utils.replaceMessageReferences(d.text),c=new Blockly.FieldTextInput(c,d["class"]);"boolean"==typeof d.spellcheck&&c.setSpellcheck(d.spellcheck);return c};Blockly.Block.newFieldVariableFromJson_=function(b){b=Blockly.utils.replaceMessageReferences(b.variable);return new Blockly.FieldVariable(b)};Blockly.Block.prototype.appendInput_=function(e,d){var f=null;if(e==Blockly.INPUT_VALUE||e==Blockly.NEXT_STATEMENT){f=this.makeConnection_(e)}f=new Blockly.Input(e,d,this,f);this.inputList.push(f);return f};Blockly.Block.prototype.moveInputBefore=function(h,g){if(h!=g){for(var l=-1,k=g?-1:this.inputList.length,j=0,i;i=this.inputList[j];j++){if(i.name==h){if(l=j,-1!=k){break}}else{if(g&&i.name==g&&(k=j,-1!=l)){break}}}goog.asserts.assert(-1!=l,'Named input "%s" not found.',h);goog.asserts.assert(-1!=k,'Reference input "%s" not found.',g);this.moveNumberedInputBefore(l,k)}};Blockly.Block.prototype.moveNumberedInputBefore=function(e,d){goog.asserts.assert(e!=d,"Can't move input to itself.");goog.asserts.assert(e<this.inputList.length,"Input index "+e+" out of bounds.");goog.asserts.assert(d<=this.inputList.length,"Reference input "+d+" out of bounds.");var f=this.inputList[e];this.inputList.splice(e,1);e<d&&d--;this.inputList.splice(d,0,f)};Blockly.Block.prototype.removeInput=function(g,f){for(var j=0,i;i=this.inputList[j];j++){if(i.name==g){if(i.connection&&i.connection.isConnected()){i.connection.setShadowDom(null);var h=i.connection.targetBlock();h.isShadow()?h.dispose():h.unplug()}i.dispose();this.inputList.splice(j,1);return}}f||goog.asserts.fail('Input "%s" not found.',g)};Blockly.Block.prototype.getInput=function(e){for(var d=0,f;f=this.inputList[d];d++){if(f.name==e){return f}}return null};Blockly.Block.prototype.getInputTargetBlock=function(b){return(b=this.getInput(b))&&b.connection&&b.connection.targetBlock()};Blockly.Block.prototype.getCommentText=function(){return this.comment||""};Blockly.Block.prototype.setCommentText=function(b){this.comment!=b&&(Blockly.Events.fire(new Blockly.Events.Change(this,"comment",null,this.comment,b||"")),this.comment=b)};Blockly.Block.prototype.setWarningText=function(){};Blockly.Block.prototype.setMutator=function(){};Blockly.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_};Blockly.Block.prototype.moveBy=function(e,d){goog.asserts.assert(!this.parentBlock_,"Block has parent.");var f=new Blockly.Events.Move(this);this.xy_.translate(e,d);f.recordNew();Blockly.Events.fire(f)};Blockly.Block.prototype.makeConnection_=function(b){return new Blockly.Connection(this,b)};Blockly.Block.prototype.allInputsFilled=function(e){void 0===e&&(e=!0);if(!e&&this.isShadow()){return !1}for(var d=0,f;f=this.inputList[d];d++){if(f.connection&&(f=f.connection.targetBlock(),!f||!f.allInputsFilled(e))){return !1}}return(d=this.getNextBlock())?d.allInputsFilled(e):!0};Blockly.Block.prototype.toDevString=function(){var b=this.type?'"'+this.type+'" block':"Block";this.id&&(b+=' (id="'+this.id+'")');return b};"use strict";Blockly.ContextMenu={};Blockly.ContextMenu.currentBlock=null;Blockly.ContextMenu.show=function(r,q,p){Blockly.WidgetDiv.show(Blockly.ContextMenu,p,null);if(q.length){var o=new goog.ui.Menu;o.setRightToLeft(p);for(var n=0,m;m=q[n];n++){var l=new goog.ui.MenuItem(m.text);l.setRightToLeft(p);o.addChild(l,!0);l.setEnabled(m.enabled);m.enabled&&(goog.events.listen(l,goog.ui.Component.EventType.ACTION,m.callback),l.handleContextMenu=function(b){goog.events.dispatchEvent(this,goog.ui.Component.EventType.ACTION)})}goog.events.listen(o,goog.ui.Component.EventType.ACTION,Blockly.ContextMenu.hide);q=goog.dom.getViewportSize();n=goog.style.getViewportPageOffset(document);o.render(Blockly.WidgetDiv.DIV);var j=o.getElement();Blockly.utils.addClass(j,"blocklyContextMenu");Blockly.bindEventWithChecks_(j,"contextmenu",null,Blockly.utils.noEvent);m=goog.style.getSize(j);var l=r.clientX+n.x,i=r.clientY+n.y;r.clientY+m.height>=q.height&&(i-=m.height);p?m.width>=r.clientX&&(l+=m.width):r.clientX+m.width>=q.width&&(l-=m.width);Blockly.WidgetDiv.position(l,i,q,n,p);o.setAllowAutoFocus(!0);setTimeout(function(){j.focus()},1);Blockly.ContextMenu.currentBlock=null}else{Blockly.ContextMenu.hide()}};Blockly.ContextMenu.hide=function(){Blockly.WidgetDiv.hideIfOwner(Blockly.ContextMenu);Blockly.ContextMenu.currentBlock=null};Blockly.ContextMenu.callbackFactory=function(d,c){return function(){Blockly.Events.disable();try{var b=Blockly.Xml.domToBlock(c,d.workspace),a=d.getRelativeToSurfaceXY();a.x=d.RTL?a.x-Blockly.SNAP_RADIUS:a.x+Blockly.SNAP_RADIUS;a.y+=2*Blockly.SNAP_RADIUS;b.moveBy(a.x,a.y)}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&!b.isShadow()&&Blockly.Events.fire(new Blockly.Events.Create(b));b.select()}};"use strict";Blockly.RenderedConnection=function(d,c){Blockly.RenderedConnection.superClass_.constructor.call(this,d,c);this.offsetInBlock_=new goog.math.Coordinate(0,0)};goog.inherits(Blockly.RenderedConnection,Blockly.Connection);Blockly.RenderedConnection.prototype.distanceFrom=function(d){var c=this.x_-d.x_;d=this.y_-d.y_;return Math.sqrt(c*c+d*d)};Blockly.RenderedConnection.prototype.bumpAwayFrom_=function(g){if(Blockly.dragMode_==Blockly.DRAG_NONE){var f=this.sourceBlock_.getRootBlock();if(!f.isInFlyout){var j=!1;if(!f.isMovable()){f=g.getSourceBlock().getRootBlock();if(!f.isMovable()){return}g=this;j=!0}var i=Blockly.selected==f;i||f.addSelect();var h=g.x_+Blockly.SNAP_RADIUS-this.x_;g=g.y_+Blockly.SNAP_RADIUS-this.y_;j&&(g=-g);f.RTL&&(h=-h);f.moveBy(h,g);i||f.removeSelect()}}};Blockly.RenderedConnection.prototype.moveTo=function(d,c){this.inDB_&&this.db_.removeConnection_(this);this.x_=d;this.y_=c;this.hidden_||this.db_.addConnection(this)};Blockly.RenderedConnection.prototype.moveBy=function(d,c){this.moveTo(this.x_+d,this.y_+c)};Blockly.RenderedConnection.prototype.moveToOffset=function(b){this.moveTo(b.x+this.offsetInBlock_.x,b.y+this.offsetInBlock_.y)};Blockly.RenderedConnection.prototype.setOffsetInBlock=function(d,c){this.offsetInBlock_.x=d;this.offsetInBlock_.y=c};Blockly.RenderedConnection.prototype.tighten_=function(){var f=this.targetConnection.x_-this.x_,e=this.targetConnection.y_-this.y_;if(0!=f||0!=e){var h=this.targetBlock(),g=h.getSvgRoot();if(!g){throw"block is not rendered."}g=Blockly.utils.getRelativeXY(g);h.getSvgRoot().setAttribute("transform","translate("+(g.x-f)+","+(g.y-e)+")");h.moveConnections_(-f,-e)}};Blockly.RenderedConnection.prototype.closest=function(e,d,f){return this.dbOpposite_.searchForClosest(this,e,d,f)};Blockly.RenderedConnection.prototype.highlight=function(){var d;d=this.type==Blockly.INPUT_VALUE||this.type==Blockly.OUTPUT_VALUE?"m 0,0 "+Blockly.BlockSvg.TAB_PATH_DOWN+" v 5":"m -20,0 h 5 "+Blockly.BlockSvg.NOTCH_PATH_LEFT+" h 5";var c=this.sourceBlock_.getRelativeToSurfaceXY();Blockly.Connection.highlightedPath_=Blockly.utils.createSvgElement("path",{"class":"blocklyHighlightedConnectionPath",d:d,transform:"translate("+(this.x_-c.x)+","+(this.y_-c.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())};Blockly.RenderedConnection.prototype.unhideAll=function(){this.setHidden(!1);var f=[];if(this.type!=Blockly.INPUT_VALUE&&this.type!=Blockly.NEXT_STATEMENT){return f}var e=this.targetBlock();if(e){var h;e.isCollapsed()?(h=[],e.outputConnection&&h.push(e.outputConnection),e.nextConnection&&h.push(e.nextConnection),e.previousConnection&&h.push(e.previousConnection)):h=e.getConnections_(!0);for(var g=0;g<h.length;g++){f.push.apply(f,h[g].unhideAll())}f.length||(f[0]=e)}return f};Blockly.RenderedConnection.prototype.unhighlight=function(){goog.dom.removeNode(Blockly.Connection.highlightedPath_);delete Blockly.Connection.highlightedPath_};Blockly.RenderedConnection.prototype.setHidden=function(b){(this.hidden_=b)&&this.inDB_?this.db_.removeConnection_(this):b||this.inDB_||this.db_.addConnection(this)};Blockly.RenderedConnection.prototype.hideAll=function(){this.setHidden(!0);if(this.targetConnection){for(var g=this.targetBlock().getDescendants(),f=0;f<g.length;f++){for(var j=g[f],i=j.getConnections_(!0),h=0;h<i.length;h++){i[h].setHidden(!0)}j=j.getIcons();for(h=0;h<j.length;h++){j[h].setVisible(!1)}}}};Blockly.RenderedConnection.prototype.isConnectionAllowed=function(d,c){return this.distanceFrom(d)>c?!1:Blockly.RenderedConnection.superClass_.isConnectionAllowed.call(this,d)};Blockly.RenderedConnection.prototype.disconnectInternal_=function(d,c){Blockly.RenderedConnection.superClass_.disconnectInternal_.call(this,d,c);d.rendered&&d.render();c.rendered&&(c.updateDisabled(),c.render())};Blockly.RenderedConnection.prototype.respawnShadow_=function(){var d=this.getSourceBlock(),c=this.getShadowDom();if(d.workspace&&c&&Blockly.Events.recordUndo){Blockly.RenderedConnection.superClass_.respawnShadow_.call(this);c=this.targetBlock();if(!c){throw"Couldn't respawn the shadow block that should exist here."}c.initSvg();c.render(!1);d.rendered&&d.render()}};Blockly.RenderedConnection.prototype.neighbours_=function(b){return this.dbOpposite_.getNeighbours(this,b)};Blockly.RenderedConnection.prototype.connect_=function(d){Blockly.RenderedConnection.superClass_.connect_.call(this,d);var c=this.getSourceBlock();d=d.getSourceBlock();c.rendered&&c.updateDisabled();d.rendered&&d.updateDisabled();c.rendered&&d.rendered&&(this.type==Blockly.NEXT_STATEMENT||this.type==Blockly.PREVIOUS_STATEMENT?d.render():c.render())};Blockly.RenderedConnection.prototype.onCheckChanged_=function(){this.isConnected()&&!this.checkType_(this.targetConnection)&&((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours_())};"use strict";Blockly.BlockSvg=function(e,d,f){this.svgGroup_=Blockly.utils.createSvgElement("g",{},null);this.svgPathDark_=Blockly.utils.createSvgElement("path",{"class":"blocklyPathDark",transform:"translate(1,1)"},this.svgGroup_);this.svgPath_=Blockly.utils.createSvgElement("path",{"class":"blocklyPath"},this.svgGroup_);this.svgPathLight_=Blockly.utils.createSvgElement("path",{"class":"blocklyPathLight"},this.svgGroup_);this.svgPath_.tooltip=this;this.rendered=!1;this.useDragSurface_=Blockly.utils.is3dSupported()&&e.blockDragSurface_;Blockly.Tooltip.bindMouseEvents(this.svgPath_);Blockly.BlockSvg.superClass_.constructor.call(this,e,d,f)};goog.inherits(Blockly.BlockSvg,Blockly.Block);Blockly.BlockSvg.prototype.height=0;Blockly.BlockSvg.prototype.width=0;Blockly.BlockSvg.prototype.dragStartXY_=null;Blockly.BlockSvg.INLINE=-1;Blockly.BlockSvg.prototype.initSvg=function(){goog.asserts.assert(this.workspace.rendered,"Workspace is headless.");for(var e=0,d;d=this.inputList[e];e++){d.init()}d=this.getIcons();for(e=0;e<d.length;e++){d[e].createIcon()}this.updateColour();this.updateMovable();if(!this.workspace.options.readOnly&&!this.eventsInit_){Blockly.bindEventWithChecks_(this.getSvgRoot(),"mousedown",this,this.onMouseDown_);var f=this;Blockly.bindEvent_(this.getSvgRoot(),"touchstart",null,function(b){Blockly.longStart_(b,f)})}this.eventsInit_=!0;this.getSvgRoot().parentNode||this.workspace.getCanvas().appendChild(this.getSvgRoot())};Blockly.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent()){this.getParent().select()}else{if(Blockly.selected!=this){var b=null;if(Blockly.selected){b=Blockly.selected.id;Blockly.Events.disable();try{Blockly.selected.unselect()}finally{Blockly.Events.enable()}}b=new Blockly.Events.Ui(null,"selected",b,this.id);b.workspaceId=this.workspace.id;Blockly.Events.fire(b);Blockly.selected=this;this.addSelect()}}};Blockly.BlockSvg.prototype.unselect=function(){if(Blockly.selected==this){var b=new Blockly.Events.Ui(null,"selected",this.id,null);b.workspaceId=this.workspace.id;Blockly.Events.fire(b);Blockly.selected=null;this.removeSelect()}};Blockly.BlockSvg.prototype.mutator=null;Blockly.BlockSvg.prototype.comment=null;Blockly.BlockSvg.prototype.warning=null;Blockly.BlockSvg.prototype.getIcons=function(){var b=[];this.mutator&&b.push(this.mutator);this.comment&&b.push(this.comment);this.warning&&b.push(this.warning);return b};Blockly.BlockSvg.onMouseUpWrapper_=null;Blockly.BlockSvg.onMouseMoveWrapper_=null;Blockly.BlockSvg.terminateDrag=function(){Blockly.BlockSvg.disconnectUiStop_();Blockly.BlockSvg.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.BlockSvg.onMouseUpWrapper_),Blockly.BlockSvg.onMouseUpWrapper_=null);Blockly.BlockSvg.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.BlockSvg.onMouseMoveWrapper_),Blockly.BlockSvg.onMouseMoveWrapper_=null);var f=Blockly.selected;if(Blockly.dragMode_==Blockly.DRAG_FREE&&f){var e=f.getRelativeToSurfaceXY(),e=goog.math.Coordinate.difference(e,f.dragStartXY_),h=new Blockly.Events.Move(f);h.oldCoordinate=f.dragStartXY_;h.recordNew();Blockly.Events.fire(h);f.moveConnections_(e.x,e.y);delete f.draggedBubbles_;f.setDragging_(!1);f.moveOffDragSurface_();f.render();f.workspace.setResizesEnabled(!0);var g=Blockly.Events.getGroup();setTimeout(function(){Blockly.Events.setGroup(g);f.snapToGrid();Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY/2);setTimeout(function(){Blockly.Events.setGroup(g);f.bumpNeighbours_();Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY)}Blockly.dragMode_=Blockly.DRAG_NONE;Blockly.Css.setCursor(Blockly.Css.Cursor.OPEN)};Blockly.BlockSvg.prototype.setParent=function(e){if(e!=this.parentBlock_){var d=this.getSvgRoot();if(this.parentBlock_&&d){var f=this.getRelativeToSurfaceXY();this.workspace.getCanvas().appendChild(d);d.setAttribute("transform","translate("+f.x+","+f.y+")")}Blockly.Field.startCache();Blockly.BlockSvg.superClass_.setParent.call(this,e);Blockly.Field.stopCache();e&&(f=this.getRelativeToSurfaceXY(),e.getSvgRoot().appendChild(d),e=this.getRelativeToSurfaceXY(),this.moveConnections_(e.x-f.x,e.y-f.y))}};Blockly.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var g=0,f=0,j=this.useDragSurface_?this.workspace.blockDragSurface_.getGroup():null,i=this.getSvgRoot();if(i){do{var h=Blockly.utils.getRelativeXY(i),g=g+h.x,f=f+h.y;this.useDragSurface_&&this.workspace.blockDragSurface_.getCurrentBlock()==i&&(h=this.workspace.blockDragSurface_.getSurfaceTranslation(),g+=h.x,f+=h.y);i=i.parentNode}while(i&&i!=this.workspace.getCanvas()&&i!=j)}return new goog.math.Coordinate(g,f)};Blockly.BlockSvg.prototype.moveBy=function(f,e){goog.asserts.assert(!this.parentBlock_,"Block has parent.");var h=new Blockly.Events.Move(this),g=this.getRelativeToSurfaceXY();this.translate(g.x+f,g.y+e);this.moveConnections_(f,e);h.recordNew();this.workspace.resizeContents();Blockly.Events.fire(h)};Blockly.BlockSvg.prototype.translate=function(d,c){this.getSvgRoot().setAttribute("transform","translate("+d+","+c+")")};Blockly.BlockSvg.prototype.moveToDragSurface_=function(){if(this.useDragSurface_){var b=this.getRelativeToSurfaceXY();this.clearTransformAttributes_();this.workspace.blockDragSurface_.translateSurface(b.x,b.y);this.workspace.blockDragSurface_.setBlocksAndShow(this.getSvgRoot())}};Blockly.BlockSvg.prototype.moveOffDragSurface_=function(){if(this.useDragSurface_){var b=this.getRelativeToSurfaceXY();this.clearTransformAttributes_();this.translate(b.x,b.y);this.workspace.blockDragSurface_.clearAndHide(this.workspace.getCanvas())}};Blockly.BlockSvg.prototype.clearTransformAttributes_=function(){Blockly.utils.removeAttribute(this.getSvgRoot(),"transform")};Blockly.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&Blockly.dragMode_==Blockly.DRAG_NONE&&!this.getParent()&&!this.isInFlyout&&this.workspace.options.gridOptions&&this.workspace.options.gridOptions.snap){var f=this.workspace.options.gridOptions.spacing,e=f/2,h=this.getRelativeToSurfaceXY(),g=Math.round((h.x-e)/f)*f+e-h.x,f=Math.round((h.y-e)/f)*f+e-h.y,g=Math.round(g),f=Math.round(f);0==g&&0==f||this.moveBy(g,f)}};Blockly.BlockSvg.prototype.getHeightWidth=function(){var e=this.height,d=this.width,f=this.getNextBlock();f?(f=f.getHeightWidth(),e+=f.height-4,d=Math.max(d,f.width)):this.nextConnection||this.outputConnection||(e+=2);return{height:e,width:d}};Blockly.BlockSvg.prototype.getBoundingRectangle=function(){var f=this.getRelativeToSurfaceXY(this),e=this.outputConnection?Blockly.BlockSvg.TAB_WIDTH:0,h=this.getHeightWidth(),g;this.RTL?(g=new goog.math.Coordinate(f.x-(h.width-e),f.y),f=new goog.math.Coordinate(f.x+e,f.y+h.height)):(g=new goog.math.Coordinate(f.x-e,f.y),f=new goog.math.Coordinate(f.x+h.width-e,f.y+h.height));return{topLeft:g,bottomRight:f}};Blockly.BlockSvg.prototype.setCollapsed=function(f){if(this.collapsed_!=f){for(var e=[],h=0,g;g=this.inputList[h];h++){e.push.apply(e,g.setVisible(!f))}if(f){g=this.getIcons();for(h=0;h<g.length;h++){g[h].setVisible(!1)}h=this.toString(Blockly.COLLAPSE_CHARS);this.appendDummyInput("_TEMP_COLLAPSED_INPUT").appendField(h).init()}else{this.removeInput("_TEMP_COLLAPSED_INPUT"),this.setWarningText(null)}Blockly.BlockSvg.superClass_.setCollapsed.call(this,f);e.length||(e[0]=this);if(this.rendered){for(h=0;f=e[h];h++){f.render()}}}};Blockly.BlockSvg.prototype.tab=function(i,h){for(var n=[],m=0,l;l=this.inputList[m];m++){for(var k=0,j;j=l.fieldRow[k];k++){j instanceof Blockly.FieldTextInput&&n.push(j)}l.connection&&(l=l.connection.targetBlock())&&n.push(l)}m=n.indexOf(i);-1==m&&(m=h?-1:n.length);(n=n[h?m+1:m-1])?n instanceof Blockly.Field?n.showEditor_():n.tab(null,h):(n=this.getParent())&&n.tab(this,h)};Blockly.BlockSvg.prototype.onMouseDown_=function(h){if(!this.workspace.options.readOnly){if(this.isInFlyout){"touchstart"==h.type&&Blockly.utils.isRightButton(h)&&(Blockly.Flyout.blockRightClick_(h,this),h.stopPropagation(),h.preventDefault())}else{this.isInMutator&&this.workspace.resize();this.workspace.updateScreenCalculationsIfScrolled();this.workspace.markFocused();Blockly.terminateDrag_();this.select();Blockly.hideChaff();if(Blockly.utils.isRightButton(h)){this.showContextMenu_(h),Blockly.Touch.clearTouchIdentifier()}else{if(this.isMovable()){Blockly.Events.getGroup()||Blockly.Events.setGroup(!0);Blockly.Css.setCursor(Blockly.Css.Cursor.CLOSED);this.dragStartXY_=this.getRelativeToSurfaceXY();this.workspace.startDrag(h,this.dragStartXY_);Blockly.dragMode_=Blockly.DRAG_STICKY;Blockly.BlockSvg.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,this.onMouseUp_);Blockly.BlockSvg.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.onMouseMove_);this.draggedBubbles_=[];for(var g=this.getDescendants(),l=0,k;k=g[l];l++){k=k.getIcons();for(var j=0;j<k.length;j++){var i=k[j].getIconLocation();i.bubble=k[j];this.draggedBubbles_.push(i)}}}else{return}}h.stopPropagation();h.preventDefault()}}};Blockly.BlockSvg.prototype.onMouseUp_=function(b){Blockly.Touch.clearTouchIdentifier();Blockly.dragMode_==Blockly.DRAG_FREE||Blockly.WidgetDiv.isVisible()||Blockly.Events.fire(new Blockly.Events.Ui(this,"click",void 0,void 0));Blockly.terminateDrag_();b=this.workspace.isDeleteArea(b);Blockly.selected&&Blockly.highlightedConnection_&&b!=Blockly.DELETE_AREA_TOOLBOX?(Blockly.localConnection_.connect(Blockly.highlightedConnection_),this.rendered&&(Blockly.localConnection_.isSuperior()?Blockly.highlightedConnection_:Blockly.localConnection_).getSourceBlock().connectionUiEffect(),this.workspace.trashcan&&this.workspace.trashcan.close()):b&&!this.getParent()&&Blockly.selected.isDeletable()&&((b=this.workspace.trashcan)&&goog.Timer.callOnce(b.close,100,b),Blockly.selected.dispose(!1,!0));Blockly.highlightedConnection_&&(Blockly.highlightedConnection_.unhighlight(),Blockly.highlightedConnection_=null);Blockly.Css.setCursor(Blockly.Css.Cursor.OPEN);Blockly.WidgetDiv.isVisible()||Blockly.Events.setGroup(!1)};Blockly.BlockSvg.prototype.showHelp_=function(){var b=goog.isFunction(this.helpUrl)?this.helpUrl():this.helpUrl;b&&Code.Help._show(b)};Blockly.BlockSvg.prototype.showContextMenu_=function(h){if(!this.workspace.options.readOnly&&this.contextMenu){var g=this,l=[];if(this.isDeletable()&&this.isMovable()&&!g.isInFlyout){var k={text:Blockly.Msg.DUPLICATE_BLOCK,enabled:!0,callback:function(){Blockly.duplicate_(g)}};this.getDescendants().length>this.workspace.remainingCapacity()&&(k.enabled=!1);l.push(k);this.isEditable()&&!this.collapsed_&&this.workspace.options.comments&&(k={enabled:!goog.userAgent.IE},this.comment?(k.text=Blockly.Msg.REMOVE_COMMENT,k.callback=function(){g.setCommentText(null)}):(k.text=Blockly.Msg.ADD_COMMENT,k.callback=function(){g.setCommentText("")}),l.push(k));if(!this.collapsed_){for(k=1;k<this.inputList.length;k++){if(this.inputList[k-1].type!=Blockly.NEXT_STATEMENT&&this.inputList[k].type!=Blockly.NEXT_STATEMENT){var k={enabled:!0},j=this.getInputsInline();k.text=j?Blockly.Msg.EXTERNAL_INPUTS:Blockly.Msg.INLINE_INPUTS;k.callback=function(){g.setInputsInline(!j)};l.push(k);break}}}this.workspace.options.collapse&&(this.collapsed_?(k={enabled:!0},k.text=Blockly.Msg.EXPAND_BLOCK,k.callback=function(){g.setCollapsed(!1)}):(k={enabled:!0},k.text=Blockly.Msg.COLLAPSE_BLOCK,k.callback=function(){g.setCollapsed(!0)}),l.push(k));this.workspace.options.disable&&(k={text:this.disabled?Blockly.Msg.ENABLE_BLOCK:Blockly.Msg.DISABLE_BLOCK,enabled:!this.getInheritedDisabled(),callback:function(){g.setDisabled(!g.disabled)}},l.push(k));var k=this.getDescendants().length,i=this.getNextBlock();i&&(k-=i.getDescendants().length);k={text:1==k?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(k)),enabled:!0,callback:function(){Blockly.Events.setGroup(!0);g.dispose(!0,!0);Blockly.Events.setGroup(!1)}};l.push(k)}k={enabled:!(goog.isFunction(this.helpUrl)?!this.helpUrl():!this.helpUrl)};k.text=Blockly.Msg.HELP;k.callback=function(){g.showHelp_()};l.push(k);this.customContextMenu&&!g.isInFlyout&&this.customContextMenu(l);Blockly.ContextMenu.show(h,l,this.RTL);Blockly.ContextMenu.currentBlock=this}};Blockly.BlockSvg.prototype.moveConnections_=function(f,e){if(this.rendered){for(var h=this.getConnections_(!1),g=0;g<h.length;g++){h[g].moveBy(f,e)}h=this.getIcons();for(g=0;g<h.length;g++){h[g].computeIconLocation()}for(g=0;g<this.childBlocks_.length;g++){this.childBlocks_[g].moveConnections_(f,e)}}};Blockly.BlockSvg.prototype.setDragging_=function(d){if(d){var c=this.getSvgRoot();c.translate_="";c.skew_="";Blockly.draggingConnections_=Blockly.draggingConnections_.concat(this.getConnections_(!0));Blockly.utils.addClass(this.svgGroup_,"blocklyDragging")}else{Blockly.draggingConnections_=[],Blockly.utils.removeClass(this.svgGroup_,"blocklyDragging")}for(c=0;c<this.childBlocks_.length;c++){this.childBlocks_[c].setDragging_(d)}};Blockly.BlockSvg.prototype.onMouseMove_=function(r){if("mousemove"==r.type&&1>=r.clientX&&0==r.clientY&&0==r.button){r.stopPropagation()}else{var q=this.getRelativeToSurfaceXY(),p=this.workspace.moveDrag(r);if(Blockly.dragMode_==Blockly.DRAG_STICKY&&goog.math.Coordinate.distance(q,p)*this.workspace.scale>Blockly.DRAG_RADIUS){Blockly.dragMode_=Blockly.DRAG_FREE;Blockly.longStop_();this.workspace.setResizesEnabled(!1);var o=!!this.parentBlock_,n=!Blockly.DRAG_STACK;if(r.altKey||r.ctrlKey||r.metaKey){n=!n}this.unplug(n);o&&(o=this.getSvgRoot(),o.translate_="translate("+p.x+","+p.y+")",this.disconnectUiEffect());this.setDragging_(!0);this.moveToDragSurface_()}if(Blockly.dragMode_==Blockly.DRAG_FREE){q=goog.math.Coordinate.difference(q,this.dragStartXY_);o=this.getSvgRoot();this.useDragSurface_?this.workspace.blockDragSurface_.translateSurface(p.x,p.y):(o.translate_="translate("+p.x+","+p.y+")",o.setAttribute("transform",o.translate_+o.skew_));for(p=0;p<this.draggedBubbles_.length;p++){o=this.draggedBubbles_[p],o.bubble.setIconLocation(goog.math.Coordinate.sum(o,q))}o=this.getConnections_(!1);(p=this.lastConnectionInStack_())&&p!=this.nextConnection&&o.push(p);for(var m=n=null,l=Blockly.SNAP_RADIUS,p=0;p<o.length;p++){var j=o[p],i=j.closest(l,q);i.connection&&(n=i.connection,m=j,l=i.radius)}Blockly.highlightedConnection_&&Blockly.highlightedConnection_!=n&&(Blockly.highlightedConnection_.unhighlight(),Blockly.highlightedConnection_=null,Blockly.localConnection_=null);!this.updateCursor_(r,n)&&n&&n!=Blockly.highlightedConnection_&&(n.highlight(),Blockly.highlightedConnection_=n,Blockly.localConnection_=m)}r.stopPropagation();r.preventDefault()}};Blockly.BlockSvg.prototype.updateCursor_=function(f,e){var h=this.workspace.isDeleteArea(f),g=Blockly.selected&&e&&h!=Blockly.DELETE_AREA_TOOLBOX;if(h&&!this.getParent()&&Blockly.selected.isDeletable()&&!g){return Blockly.Css.setCursor(Blockly.Css.Cursor.DELETE),h==Blockly.DELETE_AREA_TRASH&&this.workspace.trashcan&&this.workspace.trashcan.setOpen_(!0),!0}Blockly.Css.setCursor(Blockly.Css.Cursor.CLOSED);this.workspace.trashcan&&this.workspace.trashcan.setOpen_(!1);return !1};Blockly.BlockSvg.prototype.updateMovable=function(){this.isMovable()?Blockly.utils.addClass(this.svgGroup_,"blocklyDraggable"):Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggable")};Blockly.BlockSvg.prototype.setMovable=function(b){Blockly.BlockSvg.superClass_.setMovable.call(this,b);this.updateMovable()};Blockly.BlockSvg.prototype.setEditable=function(d){Blockly.BlockSvg.superClass_.setEditable.call(this,d);d=this.getIcons();for(var c=0;c<d.length;c++){d[c].updateEditable()}};Blockly.BlockSvg.prototype.setShadow=function(b){Blockly.BlockSvg.superClass_.setShadow.call(this,b);this.updateColour()};Blockly.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_};Blockly.BlockSvg.prototype.dispose=function(g,f){if(this.workspace){Blockly.Tooltip.hide();Blockly.Field.startCache();var j=this.workspace;Blockly.selected==this&&(this.unselect(),Blockly.terminateDrag_());Blockly.ContextMenu.currentBlock==this&&Blockly.ContextMenu.hide();f&&this.rendered&&(this.unplug(g),this.disposeUiEffect());this.rendered=!1;Blockly.Events.disable();try{for(var i=this.getIcons(),h=0;h<i.length;h++){i[h].dispose()}}finally{Blockly.Events.enable()}Blockly.BlockSvg.superClass_.dispose.call(this,g);goog.dom.removeNode(this.svgGroup_);j.resizeContents();this.svgPathDark_=this.svgPathLight_=this.svgPath_=this.svgGroup_=null;Blockly.Field.stopCache()}};Blockly.BlockSvg.prototype.disposeUiEffect=function(){this.workspace.playAudio("delete");var d=this.workspace.getSvgXY(this.svgGroup_),c=this.svgGroup_.cloneNode(!0);c.translateX_=d.x;c.translateY_=d.y;c.setAttribute("transform","translate("+c.translateX_+","+c.translateY_+")");this.workspace.getParentSvg().appendChild(c);c.bBox_=c.getBBox();Blockly.BlockSvg.disposeUiStep_(c,this.RTL,new Date,this.workspace.scale)};Blockly.BlockSvg.disposeUiStep_=function(g,f,j,i){var h=(new Date-j)/150;1<h?goog.dom.removeNode(g):(g.setAttribute("transform","translate("+(g.translateX_+(f?-1:1)*g.bBox_.width*i/2*h)+","+(g.translateY_+g.bBox_.height*i*h)+") scale("+(1-h)*i+")"),setTimeout(function(){Blockly.BlockSvg.disposeUiStep_(g,f,j,i)},10))};Blockly.BlockSvg.prototype.connectionUiEffect=function(){this.workspace.playAudio("click");if(!(1>this.workspace.scale)){var b=this.workspace.getSvgXY(this.svgGroup_);this.outputConnection?(b.x+=(this.RTL?3:-3)*this.workspace.scale,b.y+=13*this.workspace.scale):this.previousConnection&&(b.x+=(this.RTL?-23:23)*this.workspace.scale,b.y+=3*this.workspace.scale);b=Blockly.utils.createSvgElement("circle",{cx:b.x,cy:b.y,r:0,fill:"none",stroke:"#888","stroke-width":10},this.workspace.getParentSvg());Blockly.BlockSvg.connectionUiStep_(b,new Date,this.workspace.scale)}};Blockly.BlockSvg.connectionUiStep_=function(f,e,h){var g=(new Date-e)/150;1<g?goog.dom.removeNode(f):(f.setAttribute("r",25*g*h),f.style.opacity=1-g,Blockly.BlockSvg.disconnectUiStop_.pid_=setTimeout(function(){Blockly.BlockSvg.connectionUiStep_(f,e,h)},10))};Blockly.BlockSvg.prototype.disconnectUiEffect=function(){this.workspace.playAudio("disconnect");if(!(1>this.workspace.scale)){var b=this.getHeightWidth().height,b=Math.atan(10/b)/Math.PI*180;this.RTL||(b*=-1);Blockly.BlockSvg.disconnectUiStep_(this.svgGroup_,b,new Date)}};Blockly.BlockSvg.disconnectUiStep_=function(f,e,h){var g=(new Date-h)/200;1<g?f.skew_="":(f.skew_="skewX("+Math.round(Math.sin(g*Math.PI*3)*(1-g)*e)+")",Blockly.BlockSvg.disconnectUiStop_.group=f,Blockly.BlockSvg.disconnectUiStop_.pid=setTimeout(function(){Blockly.BlockSvg.disconnectUiStep_(f,e,h)},10));f.setAttribute("transform",f.translate_+f.skew_)};Blockly.BlockSvg.disconnectUiStop_=function(){if(Blockly.BlockSvg.disconnectUiStop_.group){clearTimeout(Blockly.BlockSvg.disconnectUiStop_.pid);var b=Blockly.BlockSvg.disconnectUiStop_.group;b.skew_="";b.setAttribute("transform",b.translate_);Blockly.BlockSvg.disconnectUiStop_.group=null}};Blockly.BlockSvg.disconnectUiStop_.pid=0;Blockly.BlockSvg.disconnectUiStop_.group=null;Blockly.BlockSvg.prototype.updateColour=function(){if(!this.disabled){var f=this.getColour(),e=goog.color.hexToRgb(f);if(this.isShadow()){e=goog.color.lighten(e,0.6),f=goog.color.rgbArrayToHex(e),this.svgPathLight_.style.display="none",this.svgPathDark_.setAttribute("fill",f)}else{this.svgPathLight_.style.display="";var h=goog.color.rgbArrayToHex(goog.color.lighten(e,0.3)),e=goog.color.rgbArrayToHex(goog.color.darken(e,0.2));this.svgPathLight_.setAttribute("stroke",h);this.svgPathDark_.setAttribute("fill",e)}this.svgPath_.setAttribute("fill",f);f=this.getIcons();for(h=0;h<f.length;h++){f[h].updateColour()}for(f=0;h=this.inputList[f];f++){for(var e=0,g;g=h.fieldRow[e];e++){g.setText(null)}}}};Blockly.BlockSvg.prototype.updateDisabled=function(){this.disabled||this.getInheritedDisabled()?Blockly.utils.addClass(this.svgGroup_,"blocklyDisabled")&&this.svgPath_.setAttribute("fill","url(#"+this.workspace.options.disabledPatternId+")"):Blockly.utils.removeClass(this.svgGroup_,"blocklyDisabled")&&this.updateColour();for(var e=this.getChildren(),d=0,f;f=e[d];d++){f.updateDisabled()}};Blockly.BlockSvg.prototype.getCommentText=function(){return this.comment?this.comment.getText().replace(/\s+$/,"").replace(/ +\n/g,"\n"):""};Blockly.BlockSvg.prototype.setCommentText=function(d){var c=!1;goog.isString(d)?(this.comment||(this.comment=new Blockly.Comment(this),c=!0),this.comment.setText(d)):this.comment&&(this.comment.dispose(),c=!0);c&&this.rendered&&(this.render(),this.bumpNeighbours_())};Blockly.BlockSvg.prototype.setWarningText=function(h,g){this.setWarningText.pid_||(this.setWarningText.pid_=Object.create(null));var l=g||"";if(l){this.setWarningText.pid_[l]&&(clearTimeout(this.setWarningText.pid_[l]),delete this.setWarningText.pid_[l])}else{for(var k in this.setWarningText.pid_){clearTimeout(this.setWarningText.pid_[k]),delete this.setWarningText.pid_[k]}}if(Blockly.dragMode_==Blockly.DRAG_FREE){var j=this;this.setWarningText.pid_[l]=setTimeout(function(){j.workspace&&(delete j.setWarningText.pid_[l],j.setWarningText(h,l))},100)}else{this.isInFlyout&&(h=null);k=this.getSurroundParent();for(var i=null;k;){k.isCollapsed()&&(i=k),k=k.getSurroundParent()}i&&i.setWarningText(h,"collapsed "+this.id+" "+l);k=!1;goog.isString(h)?(this.warning||(this.warning=new Blockly.Warning(this),k=!0),this.warning.setText(h,l)):this.warning&&!l?(this.warning.dispose(),k=!0):this.warning&&(k=this.warning.getText(),this.warning.setText("",l),(i=this.warning.getText())||this.warning.dispose(),k=k!=i);k&&this.rendered&&(this.render(),this.bumpNeighbours_())}};Blockly.BlockSvg.prototype.setMutator=function(b){this.mutator&&this.mutator!==b&&this.mutator.dispose();b&&(b.block_=this,this.mutator=b,b.createIcon())};Blockly.BlockSvg.prototype.setDisabled=function(b){this.disabled!=b&&(Blockly.BlockSvg.superClass_.setDisabled.call(this,b),this.rendered&&this.updateDisabled())};Blockly.BlockSvg.prototype.setHighlighted=function(b){this.rendered&&(b?(this.svgPath_.setAttribute("filter","url(#"+this.workspace.options.embossFilterId+")"),this.svgPathLight_.style.display="none"):(Blockly.utils.removeAttribute(this.svgPath_,"filter"),delete this.svgPathLight_.style.display))};Blockly.BlockSvg.prototype.addSelect=function(){Blockly.utils.addClass(this.svgGroup_,"blocklySelected");var d=this;do{var c=d.getSvgRoot();c.parentNode.appendChild(c);d=d.getParent()}while(d)};Blockly.BlockSvg.prototype.removeSelect=function(){Blockly.utils.removeClass(this.svgGroup_,"blocklySelected")};Blockly.BlockSvg.prototype.setColour=function(b){Blockly.BlockSvg.superClass_.setColour.call(this,b);this.rendered&&this.updateColour()};Blockly.BlockSvg.prototype.setPreviousStatement=function(d,c){Blockly.BlockSvg.superClass_.setPreviousStatement.call(this,d,c);this.rendered&&(this.render(),this.bumpNeighbours_())};Blockly.BlockSvg.prototype.setNextStatement=function(d,c){Blockly.BlockSvg.superClass_.setNextStatement.call(this,d,c);this.rendered&&(this.render(),this.bumpNeighbours_())};Blockly.BlockSvg.prototype.setOutput=function(d,c){Blockly.BlockSvg.superClass_.setOutput.call(this,d,c);this.rendered&&(this.render(),this.bumpNeighbours_())};Blockly.BlockSvg.prototype.setInputsInline=function(b){Blockly.BlockSvg.superClass_.setInputsInline.call(this,b);this.rendered&&(this.render(),this.bumpNeighbours_())};Blockly.BlockSvg.prototype.removeInput=function(d,c){Blockly.BlockSvg.superClass_.removeInput.call(this,d,c);this.rendered&&(this.render(),this.bumpNeighbours_())};Blockly.BlockSvg.prototype.moveNumberedInputBefore=function(d,c){Blockly.BlockSvg.superClass_.moveNumberedInputBefore.call(this,d,c);this.rendered&&(this.render(),this.bumpNeighbours_())};Blockly.BlockSvg.prototype.appendInput_=function(e,d){var f=Blockly.BlockSvg.superClass_.appendInput_.call(this,e,d);this.rendered&&(this.render(),this.bumpNeighbours_());return f};Blockly.BlockSvg.prototype.getConnections_=function(e){var d=[];if(e||this.rendered){if(this.outputConnection&&d.push(this.outputConnection),this.previousConnection&&d.push(this.previousConnection),this.nextConnection&&d.push(this.nextConnection),e||!this.collapsed_){e=0;for(var f;f=this.inputList[e];e++){f.connection&&d.push(f.connection)}}}return d};Blockly.BlockSvg.prototype.makeConnection_=function(b){return new Blockly.RenderedConnection(this,b)};"use strict";Blockly.BlockSvg.render={};Blockly.BlockSvg.SEP_SPACE_X=10;Blockly.BlockSvg.SEP_SPACE_Y=10;Blockly.BlockSvg.INLINE_PADDING_Y=5;Blockly.BlockSvg.MIN_BLOCK_Y=25;Blockly.BlockSvg.TAB_HEIGHT=20;Blockly.BlockSvg.TAB_WIDTH=8;Blockly.BlockSvg.NOTCH_WIDTH=30;Blockly.BlockSvg.CORNER_RADIUS=8;Blockly.BlockSvg.START_HAT=!0;Blockly.BlockSvg.START_HAT_HEIGHT=15;Blockly.BlockSvg.START_HAT_PATH="c 30,-"+Blockly.BlockSvg.START_HAT_HEIGHT+" 70,-"+Blockly.BlockSvg.START_HAT_HEIGHT+" 100,0";Blockly.BlockSvg.START_HAT_HIGHLIGHT_LTR="c 17.8,-9.2 45.3,-14.9 75,-8.7 M 100.5,0.5";Blockly.BlockSvg.START_HAT_HIGHLIGHT_RTL="m 25,-8.7 c 29.7,-6.2 57.2,-0.5 75,8.7";Blockly.BlockSvg.DISTANCE_45_INSIDE=(1-Math.SQRT1_2)*(Blockly.BlockSvg.CORNER_RADIUS-0.5)+0.5;Blockly.BlockSvg.DISTANCE_45_OUTSIDE=(1-Math.SQRT1_2)*(Blockly.BlockSvg.CORNER_RADIUS+0.5)-0.5;Blockly.BlockSvg.NOTCH_PATH_LEFT="l 6,4 3,0 6,-4";Blockly.BlockSvg.NOTCH_PATH_LEFT_HIGHLIGHT="l 6,4 3,0 6,-4";Blockly.BlockSvg.NOTCH_PATH_RIGHT="l -6,4 -3,0 -6,-4";Blockly.BlockSvg.JAGGED_TEETH="l 8,0 0,4 8,4 -16,8 8,4";Blockly.BlockSvg.JAGGED_TEETH_HEIGHT=20;Blockly.BlockSvg.JAGGED_TEETH_WIDTH=15;Blockly.BlockSvg.TAB_PATH_DOWN="v 5 c 0,10 -"+Blockly.BlockSvg.TAB_WIDTH+",-8 -"+Blockly.BlockSvg.TAB_WIDTH+",7.5 s "+Blockly.BlockSvg.TAB_WIDTH+",-2.5 "+Blockly.BlockSvg.TAB_WIDTH+",7.5";Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL="v 6.5 m -"+0.97*Blockly.BlockSvg.TAB_WIDTH+",3 q -"+0.05*Blockly.BlockSvg.TAB_WIDTH+",10 "+0.3*Blockly.BlockSvg.TAB_WIDTH+",9.5 m "+0.67*Blockly.BlockSvg.TAB_WIDTH+",-1.9 v 1.4";Blockly.BlockSvg.TOP_LEFT_CORNER_START="m 0,"+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_RTL="m "+Blockly.BlockSvg.DISTANCE_45_INSIDE+","+Blockly.BlockSvg.DISTANCE_45_INSIDE;Blockly.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_LTR="m 0.5,"+(Blockly.BlockSvg.CORNER_RADIUS-0.5);Blockly.BlockSvg.TOP_LEFT_CORNER="A "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+",0";Blockly.BlockSvg.TOP_LEFT_CORNER_HIGHLIGHT="A "+(Blockly.BlockSvg.CORNER_RADIUS-0.5)+","+(Blockly.BlockSvg.CORNER_RADIUS-0.5)+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+",0.5";Blockly.BlockSvg.INNER_TOP_LEFT_CORNER=Blockly.BlockSvg.NOTCH_PATH_RIGHT+" h -"+(Blockly.BlockSvg.NOTCH_WIDTH-15-Blockly.BlockSvg.CORNER_RADIUS)+" a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 -"+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS;Blockly.BlockSvg.INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 "+(-Blockly.BlockSvg.DISTANCE_45_OUTSIDE-0.5)+","+(Blockly.BlockSvg.CORNER_RADIUS-Blockly.BlockSvg.DISTANCE_45_OUTSIDE);Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL="a "+(Blockly.BlockSvg.CORNER_RADIUS+0.5)+","+(Blockly.BlockSvg.CORNER_RADIUS+0.5)+" 0 0,0 "+(Blockly.BlockSvg.CORNER_RADIUS+0.5)+","+(Blockly.BlockSvg.CORNER_RADIUS+0.5);Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR="a "+(Blockly.BlockSvg.CORNER_RADIUS+0.5)+","+(Blockly.BlockSvg.CORNER_RADIUS+0.5)+" 0 0,0 "+(Blockly.BlockSvg.CORNER_RADIUS-Blockly.BlockSvg.DISTANCE_45_OUTSIDE)+","+(Blockly.BlockSvg.DISTANCE_45_OUTSIDE+0.5);Blockly.BlockSvg.prototype.render=function(f){Blockly.Field.startCache();this.rendered=!0;var e=Blockly.BlockSvg.SEP_SPACE_X;this.RTL&&(e=-e);for(var h=this.getIcons(),g=0;g<h.length;g++){e=h[g].renderIcon(e)}e+=this.RTL?Blockly.BlockSvg.SEP_SPACE_X:-Blockly.BlockSvg.SEP_SPACE_X;h=this.renderCompute_(e);this.renderDraw_(e,h);this.renderMoveConnections_();!1!==f&&((f=this.getParent())?f.render(!0):this.workspace.resizeContents());Blockly.Field.stopCache()};Blockly.BlockSvg.prototype.renderFields_=function(h,g,l){l+=Blockly.BlockSvg.INLINE_PADDING_Y;this.RTL&&(g=-g);for(var k=0,j;j=h[k];k++){var i=j.getSvgRoot();i&&((goog.userAgent.IE||goog.userAgent.EDGE)&&j.updateWidth(),this.RTL?(g-=j.renderSep+j.renderWidth,i.setAttribute("transform","translate("+g+","+l+")"),j.renderWidth&&(g-=Blockly.BlockSvg.SEP_SPACE_X)):(i.setAttribute("transform","translate("+(g+j.renderSep)+","+l+")"),j.renderWidth&&(g+=j.renderSep+j.renderWidth+Blockly.BlockSvg.SEP_SPACE_X)))}return this.RTL?-g:g};Blockly.BlockSvg.prototype.renderCompute_=function(F){var E=this.inputList,D=[];D.rightEdge=F+2*Blockly.BlockSvg.SEP_SPACE_X;if(this.previousConnection||this.nextConnection){D.rightEdge=Math.max(D.rightEdge,Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.SEP_SPACE_X)}for(var C=0,B=0,A=!1,z=!1,y=!1,x=void 0,s=this.getInputsInline()&&!this.isCollapsed(),o=0,w;w=E[o];o++){if(w.isVisible()){var v;s&&x&&x!=Blockly.NEXT_STATEMENT&&w.type!=Blockly.NEXT_STATEMENT?v=D[D.length-1]:(x=w.type,v=[],v.type=s&&w.type!=Blockly.NEXT_STATEMENT?Blockly.BlockSvg.INLINE:w.type,v.height=0,D.push(v));v.push(w);w.renderHeight=Blockly.BlockSvg.MIN_BLOCK_Y;w.renderWidth=s&&w.type==Blockly.INPUT_VALUE?Blockly.BlockSvg.TAB_WIDTH+1.25*Blockly.BlockSvg.SEP_SPACE_X:0;if(w.connection&&w.connection.isConnected()){var j=w.connection.targetBlock().getHeightWidth();w.renderHeight=Math.max(w.renderHeight,j.height);w.renderWidth=Math.max(w.renderWidth,j.width)}s||o!=E.length-1?!s&&w.type==Blockly.INPUT_VALUE&&E[o+1]&&E[o+1].type==Blockly.NEXT_STATEMENT&&w.renderHeight--:w.renderHeight--;v.height=Math.max(v.height,w.renderHeight);w.fieldWidth=0;1==D.length&&(w.fieldWidth+=this.RTL?-F:F);for(var j=!1,H=0,i;i=w.fieldRow[H];H++){0!=H&&(w.fieldWidth+=Blockly.BlockSvg.SEP_SPACE_X);var G=i.getSize();i.renderWidth=G.width;i.renderSep=j&&i.EDITABLE?Blockly.BlockSvg.SEP_SPACE_X:0;w.fieldWidth+=i.renderWidth+i.renderSep;v.height=Math.max(v.height,G.height);j=i.EDITABLE}v.type!=Blockly.BlockSvg.INLINE&&(v.type==Blockly.NEXT_STATEMENT?(z=!0,B=Math.max(B,w.fieldWidth)):(v.type==Blockly.INPUT_VALUE?A=!0:v.type==Blockly.DUMMY_INPUT&&(y=!0),C=Math.max(C,w.fieldWidth)))}}for(F=0;v=D[F];F++){if(v.thicker=!1,v.type==Blockly.BlockSvg.INLINE){for(E=0;w=v[E];E++){if(w.type==Blockly.INPUT_VALUE){v.height+=2*Blockly.BlockSvg.INLINE_PADDING_Y;v.thicker=!0;break}}}}D.statementEdge=2*Blockly.BlockSvg.SEP_SPACE_X+B;z&&(D.rightEdge=Math.max(D.rightEdge,D.statementEdge+Blockly.BlockSvg.NOTCH_WIDTH));A?D.rightEdge=Math.max(D.rightEdge,C+2*Blockly.BlockSvg.SEP_SPACE_X+Blockly.BlockSvg.TAB_WIDTH):y&&(D.rightEdge=Math.max(D.rightEdge,C+2*Blockly.BlockSvg.SEP_SPACE_X));D.hasValue=A;D.hasStatement=z;D.hasDummy=y;return D};Blockly.BlockSvg.prototype.renderDraw_=function(i,h){this.startHat_=!1;this.height=0;if(this.outputConnection){this.squareBottomLeftCorner_=this.squareTopLeftCorner_=!0}else{this.squareBottomLeftCorner_=this.squareTopLeftCorner_=!1;if(this.previousConnection){var n=this.previousConnection.targetBlock();n&&n.getNextBlock()==this&&(this.squareTopLeftCorner_=!0)}else{Blockly.BlockSvg.START_HAT&&(this.startHat_=this.squareTopLeftCorner_=!0,this.height+=Blockly.BlockSvg.START_HAT_HEIGHT,h.rightEdge=Math.max(h.rightEdge,100))}this.getNextBlock()&&(this.squareBottomLeftCorner_=!0)}var m=[],l=[],n=[],k=[];this.renderDrawTop_(m,n,h.rightEdge);var j=this.renderDrawRight_(m,n,l,k,h,i);this.renderDrawBottom_(m,n,j);this.renderDrawLeft_(m,n);m=m.join(" ")+"\n"+l.join(" ");this.svgPath_.setAttribute("d",m);this.svgPathDark_.setAttribute("d",m);m=n.join(" ")+"\n"+k.join(" ");this.svgPathLight_.setAttribute("d",m);this.RTL&&(this.svgPath_.setAttribute("transform","scale(-1 1)"),this.svgPathLight_.setAttribute("transform","scale(-1 1)"),this.svgPathDark_.setAttribute("transform","translate(1,1) scale(-1 1)"))};Blockly.BlockSvg.prototype.renderMoveConnections_=function(){var e=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(e);this.outputConnection&&this.outputConnection.moveToOffset(e);for(var d=0;d<this.inputList.length;d++){var f=this.inputList[d].connection;f&&(f.moveToOffset(e),f.isConnected()&&f.tighten_())}this.nextConnection&&(this.nextConnection.moveToOffset(e),this.nextConnection.isConnected()&&this.nextConnection.tighten_())};Blockly.BlockSvg.prototype.renderDrawTop_=function(e,d,f){this.squareTopLeftCorner_?(e.push("m 0,0"),d.push("m 0.5,0.5"),this.startHat_&&(e.push(Blockly.BlockSvg.START_HAT_PATH),d.push(this.RTL?Blockly.BlockSvg.START_HAT_HIGHLIGHT_RTL:Blockly.BlockSvg.START_HAT_HIGHLIGHT_LTR))):(e.push(Blockly.BlockSvg.TOP_LEFT_CORNER_START),d.push(this.RTL?Blockly.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_RTL:Blockly.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_LTR),e.push(Blockly.BlockSvg.TOP_LEFT_CORNER),d.push(Blockly.BlockSvg.TOP_LEFT_CORNER_HIGHLIGHT));this.previousConnection&&(e.push("H",Blockly.BlockSvg.NOTCH_WIDTH-15),d.push("H",Blockly.BlockSvg.NOTCH_WIDTH-15),e.push(Blockly.BlockSvg.NOTCH_PATH_LEFT),d.push(Blockly.BlockSvg.NOTCH_PATH_LEFT_HIGHLIGHT),this.previousConnection.setOffsetInBlock(this.RTL?-Blockly.BlockSvg.NOTCH_WIDTH:Blockly.BlockSvg.NOTCH_WIDTH,0));e.push("H",f);d.push("H",f-0.5);this.width=f};Blockly.BlockSvg.prototype.renderDrawRight_=function(B,A,z,y,x,w){for(var v,u=0,t,o,j=0,s;s=x[j];j++){v=Blockly.BlockSvg.SEP_SPACE_X;0==j&&(v+=this.RTL?-w:w);A.push("M",x.rightEdge-0.5+","+(u+0.5));if(this.isCollapsed()){var r=s[0];t=u;this.renderFields_(r.fieldRow,v,t);B.push(Blockly.BlockSvg.JAGGED_TEETH);A.push("h 8");r=s.height-Blockly.BlockSvg.JAGGED_TEETH_HEIGHT;B.push("v",r);this.RTL&&(A.push("v 3.9 l 7.2,3.4 m -14.5,8.9 l 7.3,3.5"),A.push("v",r-0.7));this.width+=Blockly.BlockSvg.JAGGED_TEETH_WIDTH}else{if(s.type==Blockly.BlockSvg.INLINE){for(var i=0;r=s[i];i++){t=u,s.thicker&&(t+=Blockly.BlockSvg.INLINE_PADDING_Y),v=this.renderFields_(r.fieldRow,v,t),r.type!=Blockly.DUMMY_INPUT&&(v+=r.renderWidth+Blockly.BlockSvg.SEP_SPACE_X),r.type==Blockly.INPUT_VALUE&&(z.push("M",v-Blockly.BlockSvg.SEP_SPACE_X+","+(u+Blockly.BlockSvg.INLINE_PADDING_Y)),z.push("h",Blockly.BlockSvg.TAB_WIDTH-2-r.renderWidth),z.push(Blockly.BlockSvg.TAB_PATH_DOWN),z.push("v",r.renderHeight+1-Blockly.BlockSvg.TAB_HEIGHT),z.push("h",r.renderWidth+2-Blockly.BlockSvg.TAB_WIDTH),z.push("z"),this.RTL?(y.push("M",v-Blockly.BlockSvg.SEP_SPACE_X-2.5+Blockly.BlockSvg.TAB_WIDTH-r.renderWidth+","+(u+Blockly.BlockSvg.INLINE_PADDING_Y+0.5)),y.push(Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL),y.push("v",r.renderHeight-Blockly.BlockSvg.TAB_HEIGHT+2.5),y.push("h",r.renderWidth-Blockly.BlockSvg.TAB_WIDTH+2)):(y.push("M",v-Blockly.BlockSvg.SEP_SPACE_X+0.5+","+(u+Blockly.BlockSvg.INLINE_PADDING_Y+0.5)),y.push("v",r.renderHeight+1),y.push("h",Blockly.BlockSvg.TAB_WIDTH-2-r.renderWidth),y.push("M",v-r.renderWidth-Blockly.BlockSvg.SEP_SPACE_X+0.9+","+(u+Blockly.BlockSvg.INLINE_PADDING_Y+Blockly.BlockSvg.TAB_HEIGHT-0.7)),y.push("l",0.46*Blockly.BlockSvg.TAB_WIDTH+",-2.1")),t=this.RTL?-v-Blockly.BlockSvg.TAB_WIDTH+Blockly.BlockSvg.SEP_SPACE_X+r.renderWidth+1:v+Blockly.BlockSvg.TAB_WIDTH-Blockly.BlockSvg.SEP_SPACE_X-r.renderWidth-1,o=u+Blockly.BlockSvg.INLINE_PADDING_Y+1,r.connection.setOffsetInBlock(t,o))}v=Math.max(v,x.rightEdge);this.width=Math.max(this.width,v);B.push("H",v);A.push("H",v-0.5);B.push("v",s.height);this.RTL&&A.push("v",s.height-1)}else{s.type==Blockly.INPUT_VALUE?(r=s[0],t=u,r.align!=Blockly.ALIGN_LEFT&&(i=x.rightEdge-r.fieldWidth-Blockly.BlockSvg.TAB_WIDTH-2*Blockly.BlockSvg.SEP_SPACE_X,r.align==Blockly.ALIGN_RIGHT?v+=i:r.align==Blockly.ALIGN_CENTRE&&(v+=i/2)),this.renderFields_(r.fieldRow,v,t),B.push(Blockly.BlockSvg.TAB_PATH_DOWN),i=s.height-Blockly.BlockSvg.TAB_HEIGHT,B.push("v",i),this.RTL?(A.push(Blockly.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL),A.push("v",i+0.5)):(A.push("M",x.rightEdge-5+","+(u+Blockly.BlockSvg.TAB_HEIGHT-0.7)),A.push("l",0.46*Blockly.BlockSvg.TAB_WIDTH+",-2.1")),t=this.RTL?-x.rightEdge-1:x.rightEdge+1,r.connection.setOffsetInBlock(t,u),r.connection.isConnected()&&(this.width=Math.max(this.width,x.rightEdge+r.connection.targetBlock().getHeightWidth().width-Blockly.BlockSvg.TAB_WIDTH+1))):s.type==Blockly.DUMMY_INPUT?(r=s[0],t=u,r.align!=Blockly.ALIGN_LEFT&&(i=x.rightEdge-r.fieldWidth-2*Blockly.BlockSvg.SEP_SPACE_X,x.hasValue&&(i-=Blockly.BlockSvg.TAB_WIDTH),r.align==Blockly.ALIGN_RIGHT?v+=i:r.align==Blockly.ALIGN_CENTRE&&(v+=i/2)),this.renderFields_(r.fieldRow,v,t),B.push("v",s.height),this.RTL&&A.push("v",s.height-1)):s.type==Blockly.NEXT_STATEMENT&&(r=s[0],0==j&&(B.push("v",Blockly.BlockSvg.SEP_SPACE_Y),this.RTL&&A.push("v",Blockly.BlockSvg.SEP_SPACE_Y-1),u+=Blockly.BlockSvg.SEP_SPACE_Y),t=u,r.align!=Blockly.ALIGN_LEFT&&(i=x.statementEdge-r.fieldWidth-2*Blockly.BlockSvg.SEP_SPACE_X,r.align==Blockly.ALIGN_RIGHT?v+=i:r.align==Blockly.ALIGN_CENTRE&&(v+=i/2)),this.renderFields_(r.fieldRow,v,t),v=x.statementEdge+Blockly.BlockSvg.NOTCH_WIDTH,B.push("H",v),B.push(Blockly.BlockSvg.INNER_TOP_LEFT_CORNER),B.push("v",s.height-2*Blockly.BlockSvg.CORNER_RADIUS),B.push(Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER),B.push("H",x.rightEdge),this.RTL?(A.push("M",v-Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.DISTANCE_45_OUTSIDE+","+(u+Blockly.BlockSvg.DISTANCE_45_OUTSIDE)),A.push(Blockly.BlockSvg.INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL),A.push("v",s.height-2*Blockly.BlockSvg.CORNER_RADIUS),A.push(Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL)):(A.push("M",v-Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.DISTANCE_45_OUTSIDE+","+(u+s.height-Blockly.BlockSvg.DISTANCE_45_OUTSIDE)),A.push(Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR)),A.push("H",x.rightEdge-0.5),t=this.RTL?-v:v+1,r.connection.setOffsetInBlock(t,u+1),r.connection.isConnected()&&(this.width=Math.max(this.width,x.statementEdge+r.connection.targetBlock().getHeightWidth().width)),j==x.length-1||x[j+1].type==Blockly.NEXT_STATEMENT)&&(B.push("v",Blockly.BlockSvg.SEP_SPACE_Y),this.RTL&&A.push("v",Blockly.BlockSvg.SEP_SPACE_Y-1),u+=Blockly.BlockSvg.SEP_SPACE_Y)}}u+=s.height}x.length||(u=Blockly.BlockSvg.MIN_BLOCK_Y,B.push("V",u),this.RTL&&A.push("V",u-1));return u};Blockly.BlockSvg.prototype.renderDrawBottom_=function(e,d,f){this.height+=f+1;this.nextConnection&&(e.push("H",Blockly.BlockSvg.NOTCH_WIDTH+(this.RTL?0.5:-0.5)+" "+Blockly.BlockSvg.NOTCH_PATH_RIGHT),this.nextConnection.setOffsetInBlock(this.RTL?-Blockly.BlockSvg.NOTCH_WIDTH:Blockly.BlockSvg.NOTCH_WIDTH,f+1),this.height+=4);this.squareBottomLeftCorner_?(e.push("H 0"),this.RTL||d.push("M","0.5,"+(f-0.5))):(e.push("H",Blockly.BlockSvg.CORNER_RADIUS),e.push("a",Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 -"+Blockly.BlockSvg.CORNER_RADIUS+",-"+Blockly.BlockSvg.CORNER_RADIUS),this.RTL||(d.push("M",Blockly.BlockSvg.DISTANCE_45_INSIDE+","+(f-Blockly.BlockSvg.DISTANCE_45_INSIDE)),d.push("A",Blockly.BlockSvg.CORNER_RADIUS-0.5+","+(Blockly.BlockSvg.CORNER_RADIUS-0.5)+" 0 0,1 0.5,"+(f-Blockly.BlockSvg.CORNER_RADIUS))))};Blockly.BlockSvg.prototype.renderDrawLeft_=function(d,c){this.outputConnection?(this.outputConnection.setOffsetInBlock(0,0),d.push("V",Blockly.BlockSvg.TAB_HEIGHT),d.push("c 0,-10 -"+Blockly.BlockSvg.TAB_WIDTH+",8 -"+Blockly.BlockSvg.TAB_WIDTH+",-7.5 s "+Blockly.BlockSvg.TAB_WIDTH+",2.5 "+Blockly.BlockSvg.TAB_WIDTH+",-7.5"),this.RTL?(c.push("M",-0.25*Blockly.BlockSvg.TAB_WIDTH+",8.4"),c.push("l",-0.45*Blockly.BlockSvg.TAB_WIDTH+",-2.1")):(c.push("V",Blockly.BlockSvg.TAB_HEIGHT-1.5),c.push("m",-0.92*Blockly.BlockSvg.TAB_WIDTH+",-0.5 q "+-0.19*Blockly.BlockSvg.TAB_WIDTH+",-5.5 0,-11"),c.push("m",0.92*Blockly.BlockSvg.TAB_WIDTH+",1 V 0.5 H 1")),this.width+=Blockly.BlockSvg.TAB_WIDTH):this.RTL||(this.squareTopLeftCorner_?c.push("V",0.5):c.push("V",Blockly.BlockSvg.CORNER_RADIUS));d.push("z")};"use strict";Blockly.Events={};Blockly.Events.group_="";Blockly.Events.recordUndo=!0;Blockly.Events.disabled_=0;Blockly.Events.CREATE="create";Blockly.Events.DELETE="delete";Blockly.Events.CHANGE="change";Blockly.Events.MOVE="move";Blockly.Events.UI="ui";Blockly.Events.FIRE_QUEUE_=[];Blockly.Events.fire=function(b){Blockly.Events.isEnabled()&&(Blockly.Events.FIRE_QUEUE_.length||setTimeout(Blockly.Events.fireNow_,0),Blockly.Events.FIRE_QUEUE_.push(b))};Blockly.Events.fireNow_=function(){for(var f=Blockly.Events.filter(Blockly.Events.FIRE_QUEUE_,!0),e=Blockly.Events.FIRE_QUEUE_.length=0,h;h=f[e];e++){var g=Blockly.Workspace.getById(h.workspaceId);g&&g.fireChangeListener(h)}};Blockly.Events.filter=function(i,h){var n=goog.array.clone(i);h||n.reverse();for(var m=0,l;l=n[m];m++){for(var k=m+1,j;j=n[k];k++){l.type==j.type&&l.blockId==j.blockId&&l.workspaceId==j.workspaceId&&(l.type==Blockly.Events.MOVE?(l.newParentId=j.newParentId,l.newInputName=j.newInputName,l.newCoordinate=j.newCoordinate,n.splice(k,1),k--):l.type==Blockly.Events.CHANGE&&l.element==j.element&&l.name==j.name?(l.newValue=j.newValue,n.splice(k,1),k--):l.type!=Blockly.Events.UI||"click"!=j.element||"commentOpen"!=l.element&&"mutatorOpen"!=l.element&&"warningOpen"!=l.element||(l.newValue=j.newValue,n.splice(k,1),k--))}}for(m=n.length-1;0<=m;m--){n[m].isNull()&&n.splice(m,1)}h||n.reverse();for(m=1;l=n[m];m++){l.type==Blockly.Events.CHANGE&&"mutation"==l.element&&n.unshift(n.splice(m,1)[0])}return n};Blockly.Events.clearPendingUndo=function(){for(var d=0,c;c=Blockly.Events.FIRE_QUEUE_[d];d++){c.recordUndo=!1}};Blockly.Events.disable=function(){Blockly.Events.disabled_++};Blockly.Events.enable=function(){Blockly.Events.disabled_--};Blockly.Events.isEnabled=function(){return 0==Blockly.Events.disabled_};Blockly.Events.getGroup=function(){return Blockly.Events.group_};Blockly.Events.setGroup=function(b){Blockly.Events.group_="boolean"==typeof b?b?Blockly.utils.genUid():"":b};Blockly.Events.getDescendantIds_=function(f){var e=[];f=f.getDescendants();for(var h=0,g;g=f[h];h++){e[h]=g.id}return e};Blockly.Events.fromJson=function(e,d){var f;switch(e.type){case Blockly.Events.CREATE:f=new Blockly.Events.Create(null);break;case Blockly.Events.DELETE:f=new Blockly.Events.Delete(null);break;case Blockly.Events.CHANGE:f=new Blockly.Events.Change(null);break;case Blockly.Events.MOVE:f=new Blockly.Events.Move(null);break;case Blockly.Events.UI:f=new Blockly.Events.Ui(null);break;default:throw"Unknown event type."}f.fromJson(e);f.workspaceId=d.id;return f};Blockly.Events.Abstract=function(b){b&&(this.blockId=b.id,this.workspaceId=b.workspace.id);this.group=Blockly.Events.group_;this.recordUndo=Blockly.Events.recordUndo};Blockly.Events.Abstract.prototype.toJson=function(){var b={type:this.type};this.blockId&&(b.blockId=this.blockId);this.group&&(b.group=this.group);return b};Blockly.Events.Abstract.prototype.fromJson=function(b){this.blockId=b.blockId;this.group=b.group};Blockly.Events.Abstract.prototype.isNull=function(){return !1};Blockly.Events.Abstract.prototype.run=function(b){};Blockly.Events.Create=function(b){b&&(Blockly.Events.Create.superClass_.constructor.call(this,b),this.xml=b.workspace.rendered?Blockly.Xml.blockToDomWithXY(b):Blockly.Xml.blockToDom(b),this.ids=Blockly.Events.getDescendantIds_(b))};goog.inherits(Blockly.Events.Create,Blockly.Events.Abstract);Blockly.Events.Create.prototype.type=Blockly.Events.CREATE;Blockly.Events.Create.prototype.toJson=function(){var b=Blockly.Events.Create.superClass_.toJson.call(this);b.xml=Blockly.Xml.domToText(this.xml);b.ids=this.ids;return b};Blockly.Events.Create.prototype.fromJson=function(b){Blockly.Events.Create.superClass_.fromJson.call(this,b);this.xml=Blockly.Xml.textToDom("<xml>"+b.xml+"</xml>").firstChild;this.ids=b.ids};Blockly.Events.Create.prototype.run=function(f){var e=Blockly.Workspace.getById(this.workspaceId);if(f){f=goog.dom.createDom("xml"),f.appendChild(this.xml),Blockly.Xml.domToWorkspace(f,e)}else{f=0;for(var h;h=this.ids[f];f++){var g=e.getBlockById(h);g?g.dispose(!1,!1):h==this.blockId&&console.warn("Can't uncreate non-existant block: "+h)}}};Blockly.Events.Delete=function(b){if(b){if(b.getParent()){throw"Connected blocks cannot be deleted."}Blockly.Events.Delete.superClass_.constructor.call(this,b);this.oldXml=b.workspace.rendered?Blockly.Xml.blockToDomWithXY(b):Blockly.Xml.blockToDom(b);this.ids=Blockly.Events.getDescendantIds_(b)}};goog.inherits(Blockly.Events.Delete,Blockly.Events.Abstract);Blockly.Events.Delete.prototype.type=Blockly.Events.DELETE;Blockly.Events.Delete.prototype.toJson=function(){var b=Blockly.Events.Delete.superClass_.toJson.call(this);b.ids=this.ids;return b};Blockly.Events.Delete.prototype.fromJson=function(b){Blockly.Events.Delete.superClass_.fromJson.call(this,b);this.ids=b.ids};Blockly.Events.Delete.prototype.run=function(f){var e=Blockly.Workspace.getById(this.workspaceId);if(f){f=0;for(var h;h=this.ids[f];f++){var g=e.getBlockById(h);g?g.dispose(!1,!1):h==this.blockId&&console.warn("Can't delete non-existant block: "+h)}}else{f=goog.dom.createDom("xml"),f.appendChild(this.oldXml),Blockly.Xml.domToWorkspace(f,e)}};Blockly.Events.Change=function(g,f,j,i,h){g&&(Blockly.Events.Change.superClass_.constructor.call(this,g),this.element=f,this.name=j,this.oldValue=i,this.newValue=h)};goog.inherits(Blockly.Events.Change,Blockly.Events.Abstract);Blockly.Events.Change.prototype.type=Blockly.Events.CHANGE;Blockly.Events.Change.prototype.toJson=function(){var b=Blockly.Events.Change.superClass_.toJson.call(this);b.element=this.element;this.name&&(b.name=this.name);b.newValue=this.newValue;return b};Blockly.Events.Change.prototype.fromJson=function(b){Blockly.Events.Change.superClass_.fromJson.call(this,b);this.element=b.element;this.name=b.name;this.newValue=b.newValue};Blockly.Events.Change.prototype.isNull=function(){return this.oldValue==this.newValue};Blockly.Events.Change.prototype.run=function(f){var e=Blockly.Workspace.getById(this.workspaceId).getBlockById(this.blockId);if(e){switch(e.mutator&&e.mutator.setVisible(!1),f=f?this.newValue:this.oldValue,this.element){case"field":(e=e.getField(this.name))?(e.callValidator(f),e.setValue(f)):console.warn("Can't set non-existant field: "+this.name);break;case"comment":e.setCommentText(f||null);break;case"collapsed":e.setCollapsed(f);break;case"disabled":e.setDisabled(f);break;case"inline":e.setInputsInline(f);break;case"mutation":var h="";e.mutationToDom&&(h=(h=e.mutationToDom())&&Blockly.Xml.domToText(h));if(e.domToMutation){f=f||"<mutation></mutation>";var g=Blockly.Xml.textToDom("<xml>"+f+"</xml>");e.domToMutation(g.firstChild)}Blockly.Events.fire(new Blockly.Events.Change(e,"mutation",null,h,f));break;default:console.warn("Unknown change type: "+this.element)}}else{console.warn("Can't change non-existant block: "+this.blockId)}};Blockly.Events.Move=function(b){b&&(Blockly.Events.Move.superClass_.constructor.call(this,b),b=this.currentLocation_(),this.oldParentId=b.parentId,this.oldInputName=b.inputName,this.oldCoordinate=b.coordinate)};goog.inherits(Blockly.Events.Move,Blockly.Events.Abstract);Blockly.Events.Move.prototype.type=Blockly.Events.MOVE;Blockly.Events.Move.prototype.toJson=function(){var b=Blockly.Events.Move.superClass_.toJson.call(this);this.newParentId&&(b.newParentId=this.newParentId);this.newInputName&&(b.newInputName=this.newInputName);this.newCoordinate&&(b.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y));return b};Blockly.Events.Move.prototype.fromJson=function(b){Blockly.Events.Move.superClass_.fromJson.call(this,b);this.newParentId=b.newParentId;this.newInputName=b.newInputName;b.newCoordinate&&(b=b.newCoordinate.split(","),this.newCoordinate=new goog.math.Coordinate(parseFloat(b[0]),parseFloat(b[1])))};Blockly.Events.Move.prototype.recordNew=function(){var b=this.currentLocation_();this.newParentId=b.parentId;this.newInputName=b.inputName;this.newCoordinate=b.coordinate};Blockly.Events.Move.prototype.currentLocation_=function(){var e=Blockly.Workspace.getById(this.workspaceId).getBlockById(this.blockId),d={},f=e.getParent();if(f){if(d.parentId=f.id,e=f.getInputWithBlock(e)){d.inputName=e.name}}else{d.coordinate=e.getRelativeToSurfaceXY()}return d};Blockly.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&goog.math.Coordinate.equals(this.oldCoordinate,this.newCoordinate)};Blockly.Events.Move.prototype.run=function(i){var h=Blockly.Workspace.getById(this.workspaceId),n=h.getBlockById(this.blockId);if(n){var m=i?this.newParentId:this.oldParentId,l=i?this.newInputName:this.oldInputName;i=i?this.newCoordinate:this.oldCoordinate;var k=null;if(m&&(k=h.getBlockById(m),!k)){console.warn("Can't connect to non-existant block: "+m);return}n.getParent()&&n.unplug();if(i){l=n.getRelativeToSurfaceXY(),n.moveBy(i.x-l.x,i.y-l.y)}else{var n=n.outputConnection||n.previousConnection,j;if(l){if(h=k.getInput(l)){j=h.connection}}else{n.type==Blockly.PREVIOUS_STATEMENT&&(j=k.nextConnection)}j?n.connect(j):console.warn("Can't connect to non-existant input: "+l)}}else{console.warn("Can't move non-existant block: "+this.blockId)}};Blockly.Events.Ui=function(f,e,h,g){Blockly.Events.Ui.superClass_.constructor.call(this,f);this.element=e;this.oldValue=h;this.newValue=g;this.recordUndo=!1};goog.inherits(Blockly.Events.Ui,Blockly.Events.Abstract);Blockly.Events.Ui.prototype.type=Blockly.Events.UI;Blockly.Events.Ui.prototype.toJson=function(){var b=Blockly.Events.Ui.superClass_.toJson.call(this);b.element=this.element;void 0!==this.newValue&&(b.newValue=this.newValue);return b};Blockly.Events.Ui.prototype.fromJson=function(b){Blockly.Events.Ui.superClass_.fromJson.call(this,b);this.element=b.element;this.newValue=b.newValue};Blockly.Events.disableOrphans=function(e){if(e.type==Blockly.Events.MOVE||e.type==Blockly.Events.CREATE){Blockly.Events.disable();if(e=Blockly.Workspace.getById(e.workspaceId).getBlockById(e.blockId)){if(e.getParent()&&!e.getParent().disabled){e=e.getDescendants();for(var d=0,f;f=e[d];d++){f.setDisabled(!1)}}else{if((e.outputConnection||e.previousConnection)&&Blockly.dragMode_==Blockly.DRAG_NONE){do{e.setDisabled(!0),e=e.getNextBlock()}while(e)}}}Blockly.Events.enable()}};"use strict";Blockly.Msg={};goog.getMsgOrig=goog.getMsg;goog.getMsg=function(e,d){var f=goog.getMsg.blocklyMsgMap[e];f&&(e=Blockly.Msg[f]);return goog.getMsgOrig(e,d)};goog.getMsg.blocklyMsgMap={Today:"TODAY"};"use strict";Blockly.FieldTextInput=function(d,c){Blockly.FieldTextInput.superClass_.constructor.call(this,d,c)};goog.inherits(Blockly.FieldTextInput,Blockly.Field);Blockly.FieldTextInput.FONTSIZE=11;Blockly.FieldTextInput.prototype.CURSOR="text";Blockly.FieldTextInput.prototype.spellcheck_=!0;Blockly.FieldTextInput.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this);Blockly.FieldTextInput.superClass_.dispose.call(this)};Blockly.FieldTextInput.prototype.setValue=function(d){if(null!==d){if(this.sourceBlock_){var c=this.callValidator(d);null!==c&&(d=c)}Blockly.Field.prototype.setValue.call(this,d)}};Blockly.FieldTextInput.prototype.setText=function(b){null!==b&&(b=String(b),b!==this.text_&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.text_,b)),Blockly.Field.prototype.setText.call(this,b)))};Blockly.FieldTextInput.prototype.setSpellcheck=function(b){this.spellcheck_=b};Blockly.FieldTextInput.prototype.showEditor_=function(g){this.workspace_=this.sourceBlock_.workspace;g=g||!1;if(!g&&(goog.userAgent.MOBILE||goog.userAgent.ANDROID||goog.userAgent.IPAD)){var f=this;Blockly.prompt(Blockly.Msg.CHANGE_VALUE_TITLE,this.text_,function(b){f.sourceBlock_&&(b=f.callValidator(b));f.setValue(b)})}else{Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_());var j=Blockly.WidgetDiv.DIV,i=goog.dom.createDom("INPUT","blocklyHtmlInput");i.setAttribute("spellcheck",this.spellcheck_);var h=Blockly.FieldTextInput.FONTSIZE*this.workspace_.scale+"pt";j.style.fontSize=h;i.style.fontSize=h;Blockly.FieldTextInput.htmlInput_=i;j.appendChild(i);i.value=i.defaultValue=this.text_;i.oldValue_=null;this.validate_();this.resizeEditor_();g||(i.focus(),i.select());i.onKeyDownWrapper_=Blockly.bindEventWithChecks_(i,"keydown",this,this.onHtmlInputKeyDown_);i.onKeyUpWrapper_=Blockly.bindEventWithChecks_(i,"keyup",this,this.onHtmlInputChange_);i.onKeyPressWrapper_=Blockly.bindEventWithChecks_(i,"keypress",this,this.onHtmlInputChange_);i.onWorkspaceChangeWrapper_=this.resizeEditor_.bind(this);this.workspace_.addChangeListener(i.onWorkspaceChangeWrapper_)}};Blockly.FieldTextInput.prototype.onHtmlInputKeyDown_=function(d){var c=Blockly.FieldTextInput.htmlInput_;13==d.keyCode?Blockly.WidgetDiv.hide():27==d.keyCode?(c.value=c.defaultValue,Blockly.WidgetDiv.hide()):9==d.keyCode&&(Blockly.WidgetDiv.hide(),this.sourceBlock_.tab(this,!d.shiftKey),d.preventDefault())};Blockly.FieldTextInput.prototype.onHtmlInputChange_=function(d){d=Blockly.FieldTextInput.htmlInput_;var c=d.value;c!==d.oldValue_?(d.oldValue_=c,this.setValue(c),this.validate_()):goog.userAgent.WEBKIT&&this.sourceBlock_.render();this.resizeEditor_();Blockly.svgResize(this.sourceBlock_.workspace)};Blockly.FieldTextInput.prototype.validate_=function(){var d=!0;goog.asserts.assertObject(Blockly.FieldTextInput.htmlInput_);var c=Blockly.FieldTextInput.htmlInput_;this.sourceBlock_&&(d=this.callValidator(c.value));null===d?Blockly.utils.addClass(c,"blocklyInvalidInput"):Blockly.utils.removeClass(c,"blocklyInvalidInput")};Blockly.FieldTextInput.prototype.resizeEditor_=function(){var e=Blockly.WidgetDiv.DIV,d=this.fieldGroup_.getBBox();e.style.width=d.width*this.workspace_.scale+"px";e.style.height=d.height*this.workspace_.scale+"px";d=this.getAbsoluteXY_();if(this.sourceBlock_.RTL){var f=this.getScaledBBox_();d.x+=f.width;d.x-=e.offsetWidth}d.y+=1;goog.userAgent.GECKO&&Blockly.WidgetDiv.DIV.style.top&&(--d.x,--d.y);goog.userAgent.WEBKIT&&(d.y-=3);e.style.left=d.x+"px";e.style.top=d.y+"px"};Blockly.FieldTextInput.prototype.widgetDispose_=function(){var b=this;return function(){var a=Blockly.FieldTextInput.htmlInput_,d=a.value;if(b.sourceBlock_){if(d=b.callValidator(d),null===d){d=a.defaultValue}else{if(b.onFinishEditing_){b.onFinishEditing_(d)}}}b.setText(d);b.sourceBlock_.rendered&&b.sourceBlock_.render();Blockly.unbindEvent_(a.onKeyDownWrapper_);Blockly.unbindEvent_(a.onKeyUpWrapper_);Blockly.unbindEvent_(a.onKeyPressWrapper_);b.workspace_.removeChangeListener(a.onWorkspaceChangeWrapper_);Blockly.FieldTextInput.htmlInput_=null;Blockly.Events.setGroup(!1);a=Blockly.WidgetDiv.DIV.style;a.width="auto";a.height="auto";a.fontSize=""}};Blockly.FieldTextInput.numberValidator=function(b){console.warn("Blockly.FieldTextInput.numberValidator is deprecated. Use Blockly.FieldNumber instead.");if(null===b){return null}b=String(b);b=b.replace(/O/ig,"0");b=b.replace(/,/g,"");b=parseFloat(b||0);return isNaN(b)?null:String(b)};Blockly.FieldTextInput.nonnegativeIntegerValidator=function(b){(b=Blockly.FieldTextInput.numberValidator(b))&&(b=String(Math.max(0,Math.floor(b))));return b};"use strict";Blockly.FieldAngle=function(d,c){this.symbol_=Blockly.utils.createSvgElement("tspan",{},null);this.symbol_.appendChild(document.createTextNode("\u00b0"));d=d&&!isNaN(d)?String(d):"0";Blockly.FieldAngle.superClass_.constructor.call(this,d,c)};goog.inherits(Blockly.FieldAngle,Blockly.FieldTextInput);Blockly.FieldAngle.ROUND=15;Blockly.FieldAngle.HALF=50;Blockly.FieldAngle.CLOCKWISE=!1;Blockly.FieldAngle.OFFSET=0;Blockly.FieldAngle.WRAP=360;Blockly.FieldAngle.RADIUS=Blockly.FieldAngle.HALF-1;Blockly.FieldAngle.prototype.dispose_=function(){var b=this;return function(){Blockly.FieldAngle.superClass_.dispose_.call(b)();b.gauge_=null;b.clickWrapper_&&Blockly.unbindEvent_(b.clickWrapper_);b.moveWrapper1_&&Blockly.unbindEvent_(b.moveWrapper1_);b.moveWrapper2_&&Blockly.unbindEvent_(b.moveWrapper2_)}};Blockly.FieldAngle.prototype.showEditor_=function(){Blockly.FieldAngle.superClass_.showEditor_.call(this,goog.userAgent.MOBILE||goog.userAgent.ANDROID||goog.userAgent.IPAD);var e=Blockly.WidgetDiv.DIV;if(e.firstChild){var e=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:2*Blockly.FieldAngle.HALF+"px",width:2*Blockly.FieldAngle.HALF+"px"},e),d=Blockly.utils.createSvgElement("circle",{cx:Blockly.FieldAngle.HALF,cy:Blockly.FieldAngle.HALF,r:Blockly.FieldAngle.RADIUS,"class":"blocklyAngleCircle"},e);this.gauge_=Blockly.utils.createSvgElement("path",{"class":"blocklyAngleGauge"},e);this.line_=Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF,y1:Blockly.FieldAngle.HALF,"class":"blocklyAngleLine"},e);for(var f=0;360>f;f+=15){Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS,y1:Blockly.FieldAngle.HALF,x2:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS-(0==f%45?10:5),y2:Blockly.FieldAngle.HALF,"class":"blocklyAngleMarks",transform:"rotate("+f+","+Blockly.FieldAngle.HALF+","+Blockly.FieldAngle.HALF+")"},e)}e.style.marginLeft=15-Blockly.FieldAngle.RADIUS+"px";this.clickWrapper_=Blockly.bindEvent_(e,"click",this,Blockly.WidgetDiv.hide);this.moveWrapper1_=Blockly.bindEvent_(d,"mousemove",this,this.onMouseMove);this.moveWrapper2_=Blockly.bindEvent_(this.gauge_,"mousemove",this,this.onMouseMove);this.updateGraph_()}};Blockly.FieldAngle.prototype.onMouseMove=function(e){var d=this.gauge_.ownerSVGElement.getBoundingClientRect(),f=e.clientX-d.left-Blockly.FieldAngle.HALF;e=e.clientY-d.top-Blockly.FieldAngle.HALF;d=Math.atan(-e/f);isNaN(d)||(d=goog.math.toDegrees(d),0>f?d+=180:0<e&&(d+=360),d=Blockly.FieldAngle.CLOCKWISE?Blockly.FieldAngle.OFFSET+360-d:d-Blockly.FieldAngle.OFFSET,Blockly.FieldAngle.ROUND&&(d=Math.round(d/Blockly.FieldAngle.ROUND)*Blockly.FieldAngle.ROUND),d=this.callValidator(d),Blockly.FieldTextInput.htmlInput_.value=d,this.setValue(d),this.validate_(),this.resizeEditor_())};Blockly.FieldAngle.prototype.setText=function(b){Blockly.FieldAngle.superClass_.setText.call(this,b);this.textElement_&&(this.updateGraph_(),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.symbol_,this.textElement_.firstChild):this.textElement_.appendChild(this.symbol_),this.size_.width=0)};Blockly.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var i=Number(this.getText())+Blockly.FieldAngle.OFFSET,h=goog.math.toRadians(i),i=["M ",Blockly.FieldAngle.HALF,",",Blockly.FieldAngle.HALF],n=Blockly.FieldAngle.HALF,m=Blockly.FieldAngle.HALF;if(!isNaN(h)){var l=goog.math.toRadians(Blockly.FieldAngle.OFFSET),k=Math.cos(l)*Blockly.FieldAngle.RADIUS,j=Math.sin(l)*-Blockly.FieldAngle.RADIUS;Blockly.FieldAngle.CLOCKWISE&&(h=2*l-h);n+=Math.cos(h)*Blockly.FieldAngle.RADIUS;m-=Math.sin(h)*Blockly.FieldAngle.RADIUS;h=Math.abs(Math.floor((h-l)/Math.PI)%2);Blockly.FieldAngle.CLOCKWISE&&(h=1-h);i.push(" l ",k,",",j," A ",Blockly.FieldAngle.RADIUS,",",Blockly.FieldAngle.RADIUS," 0 ",h," ",Number(Blockly.FieldAngle.CLOCKWISE)," ",n,",",m," z")}this.gauge_.setAttribute("d",i.join(""));this.line_.setAttribute("x2",n);this.line_.setAttribute("y2",m)}};Blockly.FieldAngle.prototype.classValidator=function(b){if(null===b){return null}b=parseFloat(b||0);if(isNaN(b)){return null}b%=360;0>b&&(b+=360);b>Blockly.FieldAngle.WRAP&&(b-=360);return String(b)};"use strict";Blockly.FieldCheckbox=function(d,c){Blockly.FieldCheckbox.superClass_.constructor.call(this,"",c);this.setValue(d)};goog.inherits(Blockly.FieldCheckbox,Blockly.Field);Blockly.FieldCheckbox.CHECK_CHAR="\u2713";Blockly.FieldCheckbox.prototype.CURSOR="default";Blockly.FieldCheckbox.prototype.init=function(){if(!this.fieldGroup_){Blockly.FieldCheckbox.superClass_.init.call(this);this.checkElement_=Blockly.utils.createSvgElement("text",{"class":"blocklyText blocklyCheckbox",x:-3,y:14},this.fieldGroup_);var b=document.createTextNode(Blockly.FieldCheckbox.CHECK_CHAR);this.checkElement_.appendChild(b);this.checkElement_.style.display=this.state_?"block":"none"}};Blockly.FieldCheckbox.prototype.getValue=function(){return String(this.state_).toUpperCase()};Blockly.FieldCheckbox.prototype.setValue=function(b){b="string"==typeof b?"TRUE"==b.toUpperCase():!!b;this.state_!==b&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.state_,b)),this.state_=b,this.checkElement_&&(this.checkElement_.style.display=b?"block":"none"))};Blockly.FieldCheckbox.prototype.showEditor_=function(){var b=!this.state_;this.sourceBlock_&&(b=this.callValidator(b));null!==b&&this.setValue(String(b).toUpperCase())};"use strict";Blockly.FieldColour=function(d,c){Blockly.FieldColour.superClass_.constructor.call(this,d,c);this.setText(Blockly.Field.NBSP+Blockly.Field.NBSP+Blockly.Field.NBSP)};goog.inherits(Blockly.FieldColour,Blockly.Field);Blockly.FieldColour.prototype.colours_=null;Blockly.FieldColour.prototype.columns_=0;Blockly.FieldColour.prototype.init=function(){Blockly.FieldColour.superClass_.init.call(this);this.borderRect_.style.fillOpacity=1;this.setValue(this.getValue())};Blockly.FieldColour.prototype.CURSOR="default";Blockly.FieldColour.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this);Blockly.FieldColour.superClass_.dispose.call(this)};Blockly.FieldColour.prototype.getValue=function(){return this.colour_};Blockly.FieldColour.prototype.setValue=function(b){this.sourceBlock_&&Blockly.Events.isEnabled()&&this.colour_!=b&&Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.colour_,b));this.colour_=b;this.borderRect_&&(this.borderRect_.style.fill=b)};Blockly.FieldColour.prototype.getText=function(){var d=this.colour_,c=d.match(/^#(.)\1(.)\2(.)\3$/);c&&(d="#"+c[1]+c[2]+c[3]);return d};Blockly.FieldColour.COLOURS=goog.ui.ColorPicker.SIMPLE_GRID_COLORS;Blockly.FieldColour.COLUMNS=7;Blockly.FieldColour.prototype.setColours=function(b){this.colours_=b;return this};Blockly.FieldColour.prototype.setColumns=function(b){this.columns_=b;return this};Blockly.FieldColour.prototype.showEditor_=function(){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,Blockly.FieldColour.widgetDispose_);var i=new goog.ui.ColorPicker;i.setSize(this.columns_||Blockly.FieldColour.COLUMNS);i.setColors(this.colours_||Blockly.FieldColour.COLOURS);var h=goog.dom.getViewportSize(),n=goog.style.getViewportPageOffset(document),m=this.getAbsoluteXY_(),l=this.getScaledBBox_();i.render(Blockly.WidgetDiv.DIV);i.setSelectedColor(this.getValue());var k=goog.style.getSize(i.getElement());m.y=m.y+k.height+l.height>=h.height+n.y?m.y-(k.height-1):m.y+(l.height-1);this.sourceBlock_.RTL?(m.x+=l.width,m.x-=k.width,m.x<n.x&&(m.x=n.x)):m.x>h.width+n.x-k.width&&(m.x=h.width+n.x-k.width);Blockly.WidgetDiv.position(m.x,m.y,h,n,this.sourceBlock_.RTL);var j=this;Blockly.FieldColour.changeEventKey_=goog.events.listen(i,goog.ui.ColorPicker.EventType.CHANGE,function(b){b=b.target.getSelectedColor()||"#000000";Blockly.WidgetDiv.hide();j.sourceBlock_&&(b=j.callValidator(b));null!==b&&j.setValue(b)})};Blockly.FieldColour.widgetDispose_=function(){Blockly.FieldColour.changeEventKey_&&goog.events.unlistenByKey(Blockly.FieldColour.changeEventKey_);Blockly.Events.setGroup(!1)};"use strict";Blockly.FieldDropdown=function(e,d){this.menuGenerator_=e;this.trimOptions_();var f=this.getOptions()[0];Blockly.FieldDropdown.superClass_.constructor.call(this,f[1],d)};goog.inherits(Blockly.FieldDropdown,Blockly.Field);Blockly.FieldDropdown.CHECKMARK_OVERHANG=25;Blockly.FieldDropdown.ARROW_CHAR=goog.userAgent.ANDROID?"\u25bc":"\u25be";Blockly.FieldDropdown.prototype.CURSOR="default";Blockly.FieldDropdown.prototype.value_="";Blockly.FieldDropdown.prototype.imageElement_=null;Blockly.FieldDropdown.prototype.imageJson_=null;Blockly.FieldDropdown.prototype.init=function(){if(!this.fieldGroup_){this.arrow_=Blockly.utils.createSvgElement("tspan",{},null);this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?Blockly.FieldDropdown.ARROW_CHAR+" ":" "+Blockly.FieldDropdown.ARROW_CHAR));Blockly.FieldDropdown.superClass_.init.call(this);var b=this.text_;this.text_=null;this.setText(b)}};Blockly.FieldDropdown.prototype.showEditor_=function(){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,null);var j=this,i=new goog.ui.Menu;i.setRightToLeft(this.sourceBlock_.RTL);for(var p=this.getOptions(),o=0;o<p.length;o++){var n=p[o][0],m=p[o][1];if("object"==typeof n){var l=new Image(n.width,n.height);l.src=n.src;l.alt=n.alt||"";n=l}n=new goog.ui.MenuItem(n);n.setRightToLeft(this.sourceBlock_.RTL);n.setValue(m);n.setCheckable(!0);i.addChild(n,!0);n.setChecked(m==this.value_)}goog.events.listen(i,goog.ui.Component.EventType.ACTION,function(a){if(a=a.target){j.onItemSelected(this,a)}Blockly.WidgetDiv.hideIfOwner(j);Blockly.Events.setGroup(!1)});i.getHandler().listen(i.getElement(),goog.events.EventType.TOUCHSTART,function(b){this.getOwnerControl(b.target).handleMouseDown(b)});i.getHandler().listen(i.getElement(),goog.events.EventType.TOUCHEND,function(b){this.getOwnerControl(b.target).performActionInternal(b)});p=goog.dom.getViewportSize();o=goog.style.getViewportPageOffset(document);m=this.getAbsoluteXY_();n=this.getScaledBBox_();i.render(Blockly.WidgetDiv.DIV);l=i.getElement();Blockly.utils.addClass(l,"blocklyDropdownMenu");var k=goog.style.getSize(l);k.height=l.scrollHeight;m.y=m.y+k.height+n.height>=p.height+o.y?m.y-(k.height+2):m.y+n.height;this.sourceBlock_.RTL?(m.x+=n.width,m.x+=Blockly.FieldDropdown.CHECKMARK_OVERHANG,m.x<o.x+k.width&&(m.x=o.x+k.width)):(m.x-=Blockly.FieldDropdown.CHECKMARK_OVERHANG,m.x>p.width+o.x-k.width&&(m.x=p.width+o.x-k.width));Blockly.WidgetDiv.position(m.x,m.y,p,o,this.sourceBlock_.RTL);i.setAllowAutoFocus(!0);l.focus()};Blockly.FieldDropdown.prototype.onItemSelected=function(e,d){var f=d.getValue();this.sourceBlock_&&(f=this.callValidator(f));null!==f&&this.setValue(f)};Blockly.FieldDropdown.prototype.trimOptions_=function(){this.suffixField=this.prefixField=null;var i=this.menuGenerator_;if(goog.isArray(i)){for(var h=!1,n=0;n<i.length;n++){var m=i[n][0];"string"==typeof m?i[n][0]=Blockly.utils.replaceMessageReferences(m):(null!=m.alt&&(i[n][0].alt=Blockly.utils.replaceMessageReferences(m.alt)),h=!0)}if(!(h||2>i.length)){for(var l=[],n=0;n<i.length;n++){l.push(i[n][0])}n=Blockly.utils.shortestStringLength(l);h=Blockly.utils.commonWordPrefix(l,n);m=Blockly.utils.commonWordSuffix(l,n);if((h||m)&&!(n<=h+m)){h&&(this.prefixField=l[0].substring(0,h-1));m&&(this.suffixField=l[0].substr(1-m));l=[];for(n=0;n<i.length;n++){var k=i[n][0],j=i[n][1],k=k.substring(h,k.length-m);l[n]=[k,j]}this.menuGenerator_=l}}}};Blockly.FieldDropdown.prototype.isOptionListDynamic=function(){return goog.isFunction(this.menuGenerator_)};Blockly.FieldDropdown.prototype.getOptions=function(){return goog.isFunction(this.menuGenerator_)?this.menuGenerator_.call(this):this.menuGenerator_};Blockly.FieldDropdown.prototype.getValue=function(){return this.value_};Blockly.FieldDropdown.prototype.setValue=function(e){if(null!==e&&e!==this.value_){this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.value_,e));this.value_=e;for(var d=this.getOptions(),f=0;f<d.length;f++){if(d[f][1]==e){e=d[f][0];"object"==typeof e?(this.imageJson_=e,this.setText(e.alt)):(this.imageJson_=null,this.setText(e));return}}this.setText(e)}};Blockly.FieldDropdown.prototype.render_=function(){if(this.visible_){this.sourceBlock_&&this.arrow_&&(this.arrow_.style.fill=this.sourceBlock_.getColour());goog.dom.removeChildren(this.textElement_);goog.dom.removeNode(this.imageElement_);this.imageElement_=null;if(this.imageJson_){this.imageElement_=Blockly.utils.createSvgElement("image",{y:5,height:this.imageJson_.height+"px",width:this.imageJson_.width+"px"},this.fieldGroup_);this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.imageJson_.src);this.textElement_.appendChild(this.arrow_);var b=Blockly.Field.getCachedWidth(this.arrow_);this.size_.height=Number(this.imageJson_.height)+19;this.size_.width=Number(this.imageJson_.width)+b;this.sourceBlock_.RTL?(this.imageElement_.setAttribute("x",b),this.textElement_.setAttribute("x",-1)):(this.textElement_.setAttribute("text-anchor","end"),this.textElement_.setAttribute("x",this.size_.width+1))}else{b=document.createTextNode(this.getDisplayText_()),this.textElement_.appendChild(b),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textElement_.firstChild):this.textElement_.appendChild(this.arrow_),this.textElement_.setAttribute("text-anchor","start"),this.textElement_.setAttribute("x",0),this.size_.height=Blockly.BlockSvg.MIN_BLOCK_Y,this.size_.width=Blockly.Field.getCachedWidth(this.textElement_)}this.borderRect_.setAttribute("height",this.size_.height-9);this.borderRect_.setAttribute("width",this.size_.width+Blockly.BlockSvg.SEP_SPACE_X)}else{this.size_.width=0}};Blockly.FieldDropdown.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this);Blockly.FieldDropdown.superClass_.dispose.call(this)};"use strict";Blockly.FieldImage=function(f,e,h,g){this.sourceBlock_=null;this.height_=Number(h);this.width_=Number(e);this.size_=new goog.math.Size(this.width_,this.height_+2*Blockly.BlockSvg.INLINE_PADDING_Y);this.text_=g||"";this.setValue(f)};goog.inherits(Blockly.FieldImage,Blockly.Field);Blockly.FieldImage.prototype.EDITABLE=!1;Blockly.FieldImage.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null),this.visible_||(this.fieldGroup_.style.display="none"),this.imageElement_=Blockly.utils.createSvgElement("image",{height:this.height_+"px",width:this.width_+"px"},this.fieldGroup_),this.setValue(this.src_),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.setTooltip(this.sourceBlock_),Blockly.Tooltip.bindMouseEvents(this.imageElement_))};Blockly.FieldImage.prototype.dispose=function(){goog.dom.removeNode(this.fieldGroup_);this.imageElement_=this.fieldGroup_=null};Blockly.FieldImage.prototype.setTooltip=function(b){this.imageElement_.tooltip=b};Blockly.FieldImage.prototype.getValue=function(){return this.src_};Blockly.FieldImage.prototype.setValue=function(b){null!==b&&(this.src_=b,this.imageElement_&&this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",b||""))};Blockly.FieldImage.prototype.setText=function(b){null!==b&&(this.text_=b)};Blockly.FieldImage.prototype.render_=function(){};Blockly.FieldImage.prototype.updateWidth=function(){};"use strict";Blockly.FieldNumber=function(g,f,j,i,h){g=g&&!isNaN(g)?String(g):"0";Blockly.FieldNumber.superClass_.constructor.call(this,g,h);this.setConstraints(f,j,i)};goog.inherits(Blockly.FieldNumber,Blockly.FieldTextInput);Blockly.FieldNumber.prototype.setConstraints=function(e,d,f){f=parseFloat(f);this.precision_=isNaN(f)?0:f;e=parseFloat(e);this.min_=isNaN(e)?-Infinity:e;d=parseFloat(d);this.max_=isNaN(d)?Infinity:d;this.setValue(this.callValidator(this.getValue()))};Blockly.FieldNumber.prototype.classValidator=function(b){if(null===b){return null}b=String(b);b=b.replace(/O/ig,"0");b=b.replace(/,/g,"");b=parseFloat(b||0);if(isNaN(b)){return null}this.precision_&&isFinite(b)&&(b=Math.round(b/this.precision_)*this.precision_);b=goog.math.clamp(b,this.min_,this.max_);return String(b)};"use strict";Blockly.Variables={};Blockly.Variables.allUsedVariables=function(i){var h;if(i instanceof Blockly.Block){h=i.getDescendants()}else{if(i.getAllBlocks){h=i.getAllBlocks()}else{throw"Not Block or Workspace: "+i}}i=Object.create(null);for(var n=0;n<h.length;n++){var m=h[n].getVars();if(m){for(var l=0;l<m.length;l++){var k=m[l];k&&(i[k.toLowerCase()]=k)}}}h=[];for(var j in i){h.push(i[j])}return h};Blockly.Variables.allVariables=function(b){b instanceof Blockly.Block&&console.warn("Deprecated call to Blockly.Variables.allVariables with a block instead of a workspace.  You may want Blockly.Variables.allUsedVariables");return b.variableList};Blockly.Variables.flyoutCategory=function(f){var e=f.variableList;e.sort(goog.string.caseInsensitiveCompare);var h=[],g=goog.dom.createDom("button");g.setAttribute("text",Blockly.Msg.NEW_VARIABLE);g.setAttribute("callbackKey","CREATE_VARIABLE");f.registerButtonCallback("CREATE_VARIABLE",function(b){Blockly.Variables.createVariable(b.getTargetWorkspace())});h.push(g);if(0<e.length){for(Blockly.Blocks.variables_set&&(f=Blockly.Blocks.math_change?8:24,g='<xml><block type="variables_set" gap="'+f+'"><field name="VAR">'+e[0]+"</field></block></xml>",g=Blockly.Xml.textToDom(g).firstChild,h.push(g)),Blockly.Blocks.math_change&&(f=Blockly.Blocks.variables_get?20:8,g='<xml><block type="math_change" gap="'+f+'"><field name="VAR">'+e[0]+'</field><value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value></block></xml>',g=Blockly.Xml.textToDom(g).firstChild,h.push(g)),f=0;f<e.length;f++){Blockly.Blocks.variables_get&&(g='<xml><block type="variables_get" gap="8"><field name="VAR">'+e[f]+"</field></block></xml>",g=Blockly.Xml.textToDom(g).firstChild,h.push(g))}}return h};Blockly.Variables.generateUniqueName=function(i){i=i.variableList;var h="";if(i.length){for(var n=1,m=0,l="ijkmnopqrstuvwxyzabcdefgh".charAt(m);!h;){for(var k=!1,j=0;j<i.length;j++){if(i[j].toLowerCase()==l){k=!0;break}}k?(m++,25==m&&(m=0,n++),l="ijkmnopqrstuvwxyzabcdefgh".charAt(m),1<n&&(l+=n)):h=l}}else{h="i"}return h};Blockly.Variables.createVariable=function(e,d){var f=function(a){Blockly.Variables.promptName(Blockly.Msg.NEW_VARIABLE_TITLE,a,function(b){b?-1!=e.variableIndexOf(b)?Blockly.alert(Blockly.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",b.toLowerCase()),function(){f(b)}):(e.createVariable(b),d&&d(b)):d&&d(null)})};f("")};Blockly.Variables.promptName=function(e,d,f){Blockly.prompt(e,d,function(b){b&&(b=b.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),b==Blockly.Msg.RENAME_VARIABLE||b==Blockly.Msg.NEW_VARIABLE)&&(b=null);f(b)})};"use strict";Blockly.FieldVariable=function(d,c){Blockly.FieldVariable.superClass_.constructor.call(this,Blockly.FieldVariable.dropdownCreate,c);this.setValue(d||"")};goog.inherits(Blockly.FieldVariable,Blockly.FieldDropdown);Blockly.FieldVariable.prototype.renameVarItemIndex_=-1;Blockly.FieldVariable.prototype.deleteVarItemIndex_=-1;Blockly.FieldVariable.prototype.init=function(){this.fieldGroup_||(Blockly.FieldVariable.superClass_.init.call(this),this.getValue()||this.setValue(Blockly.Variables.generateUniqueName(this.sourceBlock_.isInFlyout?this.sourceBlock_.workspace.targetWorkspace:this.sourceBlock_.workspace)),this.sourceBlock_.isInFlyout||this.sourceBlock_.workspace.createVariable(this.getValue()))};Blockly.FieldVariable.prototype.setSourceBlock=function(b){goog.asserts.assert(!b.isShadow(),"Variable fields are not allowed to exist on shadow blocks.");Blockly.FieldVariable.superClass_.setSourceBlock.call(this,b)};Blockly.FieldVariable.prototype.getValue=function(){return this.getText()};Blockly.FieldVariable.prototype.setValue=function(b){this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.value_,b));this.value_=b;this.setText(b)};Blockly.FieldVariable.dropdownCreate=function(){var e=this.sourceBlock_&&this.sourceBlock_.workspace?this.sourceBlock_.workspace.variableList.slice(0):[],d=this.getText();d&&-1==e.indexOf(d)&&e.push(d);e.sort(goog.string.caseInsensitiveCompare);this.renameVarItemIndex_=e.length;e.push(Blockly.Msg.RENAME_VARIABLE);this.deleteVarItemIndex_=e.length;e.push(Blockly.Msg.DELETE_VARIABLE.replace("%1",d));for(var d=[],f=0;f<e.length;f++){d[f]=[e[f],e[f]]}return d};Blockly.FieldVariable.prototype.onItemSelected=function(g,f){var j=f.getValue();if(this.sourceBlock_){var i=this.sourceBlock_.workspace;if(0<=this.renameVarItemIndex_&&g.getChildAt(this.renameVarItemIndex_)===f){var h=this.getText();Blockly.hideChaff();Blockly.Variables.promptName(Blockly.Msg.RENAME_VARIABLE_TITLE.replace("%1",h),h,function(b){b&&i.renameVariable(h,b)});return}if(0<=this.deleteVarItemIndex_&&g.getChildAt(this.deleteVarItemIndex_)===f){i.deleteVariable(this.getText());return}j=this.callValidator(j)}null!==j&&this.setValue(j)};"use strict";Blockly.Generator=function(b){this.name_=b;this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")};Blockly.Generator.NAME_TYPE="generated_function";Blockly.Generator.prototype.INFINITE_LOOP_TRAP=null;Blockly.Generator.prototype.STATEMENT_PREFIX=null;Blockly.Generator.prototype.INDENT="  ";Blockly.Generator.prototype.COMMENT_WRAP=60;Blockly.Generator.prototype.ORDER_OVERRIDES=[];Blockly.Generator.prototype.workspaceToCode=function(g){g||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),g=Blockly.getMainWorkspace());var f=[];this.init(g);g=g.getTopBlocks(!0);for(var j=0,i;i=g[j];j++){var h=this.blockToCode(i);goog.isArray(h)&&(h=h[0]);h&&(i.outputConnection&&this.scrubNakedValue&&(h=this.scrubNakedValue(h)),f.push(h))}f=f.join("\n");f=this.finish(f);f=f.replace(/^\s+\n/,"");f=f.replace(/\n\s+$/,"\n");return f=f.replace(/[ \t]+\n/g,"\n")};Blockly.Generator.prototype.prefixLines=function(d,c){return c+d.replace(/(?!\n$)\n/g,"\n"+c)};Blockly.Generator.prototype.allNestedComments=function(f){var e=[];f=f.getDescendants();for(var h=0;h<f.length;h++){var g=f[h].getCommentText();g&&e.push(g)}e.length&&e.push("");return e.join("\n")};Blockly.Generator.prototype.blockToCode=function(e){if(!e){return""}if(e.disabled){return this.blockToCode(e.getNextBlock())}var d=this[e.type];goog.asserts.assertFunction(d,'Language "%s" does not know how to generate code for block type "%s".',this.name_,e.type);d=d.call(e,e);if(goog.isArray(d)){return goog.asserts.assert(e.outputConnection,'Expecting string from statement block "%s".',e.type),[this.scrub_(e,d[0]),d[1]]}if(goog.isString(d)){var f=e.id.replace(/\$/g,"$$$$");this.STATEMENT_PREFIX&&(d=this.STATEMENT_PREFIX.replace(/%1/g,"'"+f+"'")+d);return this.scrub_(e,d)}if(null===d){return""}goog.asserts.fail("Invalid code generated: %s",d)};Blockly.Generator.prototype.valueToCode=function(h,g,l){isNaN(l)&&goog.asserts.fail('Expecting valid order from block "%s".',h.type);var k=h.getInputTargetBlock(g);if(!k){return""}g=this.blockToCode(k);if(""===g){return""}goog.asserts.assertArray(g,'Expecting tuple from value block "%s".',k.type);h=g[0];g=g[1];isNaN(g)&&goog.asserts.fail('Expecting valid order from value block "%s".',k.type);if(!h){return""}var k=!1,j=Math.floor(l),i=Math.floor(g);if(j<=i&&(j!=i||0!=j&&99!=j)){for(k=!0,j=0;j<this.ORDER_OVERRIDES.length;j++){if(this.ORDER_OVERRIDES[j][0]==l&&this.ORDER_OVERRIDES[j][1]==g){k=!1;break}}}k&&(h="("+h+")");return h};Blockly.Generator.prototype.statementToCode=function(f,e){var h=f.getInputTargetBlock(e),g=this.blockToCode(h);goog.asserts.assertString(g,'Expecting code from statement block "%s".',h&&h.type);g&&(g=this.prefixLines(g,this.INDENT));return g};Blockly.Generator.prototype.addLoopTrap=function(d,c){c=c.replace(/\$/g,"$$$$");this.INFINITE_LOOP_TRAP&&(d=this.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+c+"'")+d);this.STATEMENT_PREFIX&&(d+=this.prefixLines(this.STATEMENT_PREFIX.replace(/%1/g,"'"+c+"'"),this.INDENT));return d};Blockly.Generator.prototype.RESERVED_WORDS_="";Blockly.Generator.prototype.addReservedWords=function(b){this.RESERVED_WORDS_+=b+","};Blockly.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}";Blockly.Generator.prototype.provideFunction_=function(f,e){if(!this.definitions_[f]){var h=this.variableDB_.getDistinctName(f,Blockly.Procedures.NAME_TYPE);this.functionNames_[f]=h;for(var h=e.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,h),g;g!=h;){g=h,h=h.replace(/^((  )*)  /gm,"$1\x00")}h=h.replace(/\0/g,this.INDENT);this.definitions_[f]=h}return this.functionNames_[f]};Blockly.Generator.prototype.init=void 0;Blockly.Generator.prototype.scrub_=void 0;Blockly.Generator.prototype.finish=void 0;Blockly.Generator.prototype.scrubNakedValue=void 0;"use strict";Blockly.Names=function(f,e){this.variablePrefix_=e||"";this.reservedDict_=Object.create(null);if(f){for(var h=f.split(","),g=0;g<h.length;g++){this.reservedDict_[h[g]]=!0}}this.reset()};Blockly.Names.prototype.reset=function(){this.db_=Object.create(null);this.dbReverse_=Object.create(null)};Blockly.Names.prototype.getName=function(g,f){var j=g.toLowerCase()+"_"+f,i=f==Blockly.Variables.NAME_TYPE?this.variablePrefix_:"";if(j in this.db_){return i+this.db_[j]}var h=this.getDistinctName(g,f);this.db_[j]=h.substr(i.length);return h};Blockly.Names.prototype.getDistinctName=function(f,e){for(var h=this.safeName_(f),g="";this.dbReverse_[h+g]||h+g in this.reservedDict_;){g=g?g+1:2}h+=g;this.dbReverse_[h]=!0;return(e==Blockly.Variables.NAME_TYPE?this.variablePrefix_:"")+h};Blockly.Names.prototype.safeName_=function(b){b?(b=encodeURI(b.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(b[0])&&(b="my_"+b)):b="unnamed";return b};Blockly.Names.equals=function(d,c){return d.toLowerCase()==c.toLowerCase()};"use strict";Blockly.Procedures={};Blockly.Procedures.allProcedures=function(g){g=g.getAllBlocks();for(var f=[],j=[],i=0;i<g.length;i++){if(g[i].getProcedureDef){var h=g[i].getProcedureDef();h&&(h[2]?f.push(h):j.push(h))}}j.sort(Blockly.Procedures.procTupleComparator_);f.sort(Blockly.Procedures.procTupleComparator_);return[j,f]};Blockly.Procedures.procTupleComparator_=function(d,c){return d[0].toLowerCase().localeCompare(c[0].toLowerCase())};Blockly.Procedures.findLegalName=function(e,d){if(d.isInFlyout){return e}for(;!Blockly.Procedures.isLegalName_(e,d.workspace,d);){var f=e.match(/^(.*?)(\d+)$/);e=f?f[1]+(parseInt(f[2],10)+1):e+"2"}return e};Blockly.Procedures.isLegalName_=function(g,f,j){f=f.getAllBlocks();for(var i=0;i<f.length;i++){if(f[i]!=j&&f[i].getProcedureDef){var h=f[i].getProcedureDef();if(Blockly.Names.equals(h[0],g)){return !1}}}return !0};Blockly.Procedures.rename=function(f){f=f.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");var e=Blockly.Procedures.findLegalName(f,this.sourceBlock_),h=this.text_;if(h!=f&&h!=e){f=this.sourceBlock_.workspace.getAllBlocks();for(var g=0;g<f.length;g++){f[g].renameProcedure&&f[g].renameProcedure(h,e)}}return e};Blockly.Procedures.flyoutCategory=function(g){function f(o,k){for(var s=0;s<o.length;s++){var r=o[s][0],q=o[s][1],p=goog.dom.createDom("block");p.setAttribute("type",k);p.setAttribute("gap",16);var n=goog.dom.createDom("mutation");n.setAttribute("name",r);p.appendChild(n);for(r=0;r<q.length;r++){var c=goog.dom.createDom("arg");c.setAttribute("name",q[r]);n.appendChild(c)}j.push(p)}}var j=[];if(Blockly.Blocks.procedures_defnoreturn){var i=goog.dom.createDom("block");i.setAttribute("type","procedures_defnoreturn");i.setAttribute("gap",16);var h=goog.dom.createDom("field",null,Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE);h.setAttribute("name","NAME");i.appendChild(h);j.push(i)}Blockly.Blocks.procedures_defreturn&&(i=goog.dom.createDom("block"),i.setAttribute("type","procedures_defreturn"),i.setAttribute("gap",16),h=goog.dom.createDom("field",null,Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE),h.setAttribute("name","NAME"),i.appendChild(h),j.push(i));Blockly.Blocks.procedures_ifreturn&&(i=goog.dom.createDom("block"),i.setAttribute("type","procedures_ifreturn"),i.setAttribute("gap",16),j.push(i));j.length&&j[j.length-1].setAttribute("gap",24);g=Blockly.Procedures.allProcedures(g);f(g[0],"procedures_callnoreturn");f(g[1],"procedures_callreturn");return j};Blockly.Procedures.getCallers=function(h,g){for(var l=[],k=g.getAllBlocks(),j=0;j<k.length;j++){if(k[j].getProcedureCall){var i=k[j].getProcedureCall();i&&Blockly.Names.equals(i,h)&&l.push(k[j])}}return l};Blockly.Procedures.mutateCallers=function(i){var h=Blockly.Events.recordUndo,n=i.getProcedureDef()[0],m=i.mutationToDom(!0);i=Blockly.Procedures.getCallers(n,i.workspace);for(var n=0,l;l=i[n];n++){var k=l.mutationToDom(),k=k&&Blockly.Xml.domToText(k);l.domToMutation(m);var j=l.mutationToDom(),j=j&&Blockly.Xml.domToText(j);k!=j&&(Blockly.Events.recordUndo=!1,Blockly.Events.fire(new Blockly.Events.Change(l,"mutation",null,k,j)),Blockly.Events.recordUndo=h)}};Blockly.Procedures.getDefinition=function(g,f){for(var j=f.getTopBlocks(!1),i=0;i<j.length;i++){if(j[i].getProcedureDef){var h=j[i].getProcedureDef();if(h&&Blockly.Names.equals(h[0],g)){return j[i]}}}return null};"use strict";Blockly.FlyoutButton=function(f,e,h,g){this.workspace_=f;this.targetWorkspace_=e;this.text_=h.getAttribute("text");this.position_=new goog.math.Coordinate(0,0);this.isLabel_=g;this.callback_=null;f=h.getAttribute("callbackKey");this.isLabel_&&f?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||f&&e.getButtonCallback(f)?this.callback_=e.getButtonCallback(f):console.warn("Buttons should have callbacks. Button text: "+this.text_);this.cssClass_=h.getAttribute("web-class")||null};Blockly.FlyoutButton.MARGIN=5;Blockly.FlyoutButton.prototype.width=0;Blockly.FlyoutButton.prototype.height=0;Blockly.FlyoutButton.prototype.createDom=function(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass_&&(e+=" "+this.cssClass_);this.svgGroup_=Blockly.utils.createSvgElement("g",{"class":e},this.workspace_.getCanvas());if(!this.isLabel_){var d=Blockly.utils.createSvgElement("rect",{"class":"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_)}var e=Blockly.utils.createSvgElement("rect",{"class":this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_),f=Blockly.utils.createSvgElement("text",{"class":this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);f.textContent=this.text_;this.width=f.getComputedTextLength()+2*Blockly.FlyoutButton.MARGIN;this.height=20;this.isLabel_||(d.setAttribute("width",this.width),d.setAttribute("height",this.height));e.setAttribute("width",this.width);e.setAttribute("height",this.height);f.setAttribute("x",this.width/2);f.setAttribute("y",this.height-Blockly.FlyoutButton.MARGIN);this.updateTransform_();return this.svgGroup_};Blockly.FlyoutButton.prototype.show=function(){this.updateTransform_();this.svgGroup_.setAttribute("display","block")};Blockly.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")};Blockly.FlyoutButton.prototype.moveTo=function(d,c){this.position_.x=d;this.position_.y=c;this.updateTransform_()};Blockly.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_};Blockly.FlyoutButton.prototype.dispose=function(){this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null);this.targetWorkspace_=this.workspace_=null};Blockly.FlyoutButton.prototype.onMouseUp=function(b){b.preventDefault();b.stopPropagation();Blockly.Flyout.terminateDrag_();this.callback_&&this.callback_(this)};"use strict";Blockly.Flyout=function(b){b.getMetrics=this.getMetrics_.bind(this);b.setMetrics=this.setMetrics_.bind(this);this.workspace_=new Blockly.WorkspaceSvg(b);this.workspace_.isFlyout=!0;this.RTL=!!b.RTL;this.horizontalLayout_=b.horizontalLayout;this.toolboxPosition_=b.toolboxPosition;this.eventWrappers_=[];this.backgroundButtons_=[];this.buttons_=[];this.listeners_=[];this.permanentlyDisabled_=[];this.startDragMouseX_=this.startDragMouseY_=0};Blockly.Flyout.startFlyout_=null;Blockly.Flyout.startDownEvent_=null;Blockly.Flyout.startBlock_=null;Blockly.Flyout.onMouseUpWrapper_=null;Blockly.Flyout.onMouseMoveWrapper_=null;Blockly.Flyout.onMouseMoveBlockWrapper_=null;Blockly.Flyout.prototype.autoClose=!0;Blockly.Flyout.prototype.isVisible_=!1;Blockly.Flyout.prototype.containerVisible_=!0;Blockly.Flyout.prototype.CORNER_RADIUS=8;Blockly.Flyout.prototype.DRAG_RADIUS=10;Blockly.Flyout.prototype.MARGIN=Blockly.Flyout.prototype.CORNER_RADIUS;Blockly.Flyout.prototype.GAP_X=3*Blockly.Flyout.prototype.MARGIN;Blockly.Flyout.prototype.GAP_Y=3*Blockly.Flyout.prototype.MARGIN;Blockly.Flyout.prototype.SCROLLBAR_PADDING=2;Blockly.Flyout.prototype.width_=0;Blockly.Flyout.prototype.height_=0;Blockly.Flyout.prototype.dragMode_=Blockly.DRAG_NONE;Blockly.Flyout.prototype.dragAngleRange_=70;Blockly.Flyout.prototype.createDom=function(b){this.svgGroup_=Blockly.utils.createSvgElement(b,{"class":"blocklyFlyout",style:"display: none"},null);this.svgBackground_=Blockly.utils.createSvgElement("path",{"class":"blocklyFlyoutBackground"},this.svgGroup_);this.svgGroup_.appendChild(this.workspace_.createDom());return this.svgGroup_};Blockly.Flyout.prototype.init=function(b){this.targetWorkspace_=b;this.workspace_.targetWorkspace=b;this.scrollbar_=new Blockly.Scrollbar(this.workspace_,this.horizontalLayout_,!1,"blocklyFlyoutScrollbar");this.hide();Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.wheel_));this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace_.addChangeListener(this.filterWrapper_));Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_))};Blockly.Flyout.prototype.dispose=function(){this.hide();Blockly.unbindEvent_(this.eventWrappers_);this.filterWrapper_&&(this.targetWorkspace_.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null);this.scrollbar_&&(this.scrollbar_.dispose(),this.scrollbar_=null);this.workspace_&&(this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null);this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null);this.targetWorkspace_=this.svgBackground_=null};Blockly.Flyout.prototype.getWidth=function(){return this.width_};Blockly.Flyout.prototype.getHeight=function(){return this.height_};Blockly.Flyout.prototype.getMetrics_=function(){if(!this.isVisible()){return null}try{var h=this.workspace_.getCanvas().getBBox()}catch(i){h={height:0,y:0,width:0,x:0}}var g=this.SCROLLBAR_PADDING,l=this.SCROLLBAR_PADDING;if(this.horizontalLayout_){this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM&&(g=0);var k=this.height_;this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP&&(k-=this.SCROLLBAR_PADDING);var j=this.width_-2*this.SCROLLBAR_PADDING}else{l=0,k=this.height_-2*this.SCROLLBAR_PADDING,j=this.width_,this.RTL||(j-=this.SCROLLBAR_PADDING)}return{viewHeight:k,viewWidth:j,contentHeight:(h.height+2*this.MARGIN)*this.workspace_.scale,contentWidth:(h.width+2*this.MARGIN)*this.workspace_.scale,viewTop:-this.workspace_.scrollY,viewLeft:-this.workspace_.scrollX,contentTop:h.y,contentLeft:h.x,absoluteTop:g,absoluteLeft:l}};Blockly.Flyout.prototype.setMetrics_=function(d){var c=this.getMetrics_();c&&(!this.horizontalLayout_&&goog.isNumber(d.y)?this.workspace_.scrollY=-c.contentHeight*d.y:this.horizontalLayout_&&goog.isNumber(d.x)&&(this.workspace_.scrollX=-c.contentWidth*d.x),this.workspace_.translate(this.workspace_.scrollX+c.absoluteLeft,this.workspace_.scrollY+c.absoluteTop))};Blockly.Flyout.prototype.position=function(){if(this.isVisible()){var e=this.targetWorkspace_.getMetrics();if(e){this.setBackgroundPath_(this.horizontalLayout_?e.viewWidth-2*this.CORNER_RADIUS:this.width_-this.CORNER_RADIUS,this.horizontalLayout_?this.height_-this.CORNER_RADIUS:e.viewHeight-2*this.CORNER_RADIUS);var d=e.absoluteLeft;this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT&&(d+=e.viewWidth,d-=this.width_);var f=e.absoluteTop;this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM&&(f+=e.viewHeight,f-=this.height_);this.horizontalLayout_?this.width_=e.viewWidth:this.height_=e.viewHeight;this.svgGroup_.setAttribute("width",this.width_);this.svgGroup_.setAttribute("height",this.height_);Blockly.utils.setCssTransform(this.svgGroup_,"translate("+d+"px,"+f+"px)");this.scrollbar_&&(this.scrollbar_.setOrigin(d,f),this.scrollbar_.resize())}}};Blockly.Flyout.prototype.setBackgroundPath_=function(d,c){this.horizontalLayout_?this.setBackgroundPathHorizontal_(d,c):this.setBackgroundPathVertical_(d,c)};Blockly.Flyout.prototype.setBackgroundPathVertical_=function(f,e){var h=this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT,g=f+this.CORNER_RADIUS,g=["M "+(h?g:0)+",0"];g.push("h",h?-f:f);g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,h?0:1,h?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS);g.push("v",Math.max(0,e));g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,h?0:1,h?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS);g.push("h",h?f:-f);g.push("z");this.svgBackground_.setAttribute("d",g.join(" "))};Blockly.Flyout.prototype.setBackgroundPathHorizontal_=function(f,e){var h=this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP,g=["M 0,"+(h?0:this.CORNER_RADIUS)];h?(g.push("h",f+2*this.CORNER_RADIUS),g.push("v",e),g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),g.push("h",-1*f),g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),g.push("h",f),g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),g.push("v",e),g.push("h",-f-2*this.CORNER_RADIUS));g.push("z");this.svgBackground_.setAttribute("d",g.join(" "))};Blockly.Flyout.prototype.scrollToStart=function(){this.scrollbar_.set(this.horizontalLayout_&&this.RTL?Infinity:0)};Blockly.Flyout.prototype.wheel_=function(e){var d=this.horizontalLayout_?e.deltaX:e.deltaY;if(d){goog.userAgent.GECKO&&(d*=10);var f=this.getMetrics_(),d=this.horizontalLayout_?f.viewLeft+d:f.viewTop+d,d=Math.min(d,this.horizontalLayout_?f.contentWidth-f.viewWidth:f.contentHeight-f.viewHeight),d=Math.max(d,0);this.scrollbar_.set(d)}e.preventDefault();e.stopPropagation()};Blockly.Flyout.prototype.isVisible=function(){return this.isVisible_};Blockly.Flyout.prototype.setVisible=function(d){var c=d!=this.isVisible();this.isVisible_=d;c&&this.updateDisplay_()};Blockly.Flyout.prototype.setContainerVisible=function(d){var c=d!=this.containerVisible_;this.containerVisible_=d;c&&this.updateDisplay_()};Blockly.Flyout.prototype.updateDisplay_=function(){var b;b=this.containerVisible_?this.isVisible():!1;this.svgGroup_.style.display=b?"block":"none";this.scrollbar_.setContainerVisible(b)};Blockly.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var d=0,c;c=this.listeners_[d];d++){Blockly.unbindEvent_(c)}this.listeners_.length=0;this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}};Blockly.Flyout.prototype.show=function(i){this.workspace_.setResizesEnabled(!1);this.hide();this.clearOldBlocks_();"string"==typeof i&&(i=this.workspace_.targetWorkspace.getToolboxCategoryCallback(i),goog.asserts.assert(goog.isFunction(i),"Couldn't find a callback function when opening a toolbox category."),i=i(this.workspace_.targetWorkspace),goog.asserts.assert(goog.isArray(i),"The result of a toolbox category callback must be an array."));this.setVisible(!0);for(var h=[],n=[],m=this.permanentlyDisabled_.length=0,l;l=i[m];m++){if(l.tagName){var k=l.tagName.toUpperCase(),j=this.horizontalLayout_?this.GAP_X:this.GAP_Y;if("BLOCK"==k){k=Blockly.Xml.domToBlock(l,this.workspace_),k.disabled&&this.permanentlyDisabled_.push(k),h.push({type:"block",block:k}),l=parseInt(l.getAttribute("gap"),10),n.push(isNaN(l)?j:l)}else{if("SEP"==l.tagName.toUpperCase()){l=parseInt(l.getAttribute("gap"),10),!isNaN(l)&&0<n.length?n[n.length-1]=l:n.push(j)}else{if("BUTTON"==k||"LABEL"==k){l=new Blockly.FlyoutButton(this.workspace_,this.targetWorkspace_,l,"LABEL"==k),h.push({type:"button",button:l}),n.push(j)}}}}}this.layout_(h,n);this.listeners_.push(Blockly.bindEventWithChecks_(this.svgBackground_,"mouseover",this,function(){for(var e=this.workspace_.getTopBlocks(!1),d=0,f;f=e[d];d++){f.removeSelect()}}));this.horizontalLayout_?this.height_=0:this.width_=0;this.workspace_.setResizesEnabled(!0);this.reflow();this.filterForCapacity_();this.position();this.reflowWrapper_=this.reflow.bind(this);this.workspace_.addChangeListener(this.reflowWrapper_)};Blockly.Flyout.prototype.layout_=function(r,q){this.workspace_.scale=this.targetWorkspace_.scale;var p=this.MARGIN,o=this.RTL?p:p+Blockly.BlockSvg.TAB_WIDTH;this.horizontalLayout_&&this.RTL&&(r=r.reverse());for(var n=0,m;m=r[n];n++){if("block"==m.type){m=m.block;for(var l=m.getDescendants(),j=0,i;i=l[j];j++){i.isInFlyout=!0}m.render();l=m.getSvgRoot();j=m.getHeightWidth();i=m.outputConnection?Blockly.BlockSvg.TAB_WIDTH:0;this.horizontalLayout_&&(o+=i);m.moveBy(this.horizontalLayout_&&this.RTL?o+j.width-i:o,p);this.horizontalLayout_?o+=j.width+q[n]-i:p+=j.height+q[n];j=Blockly.utils.createSvgElement("rect",{"fill-opacity":0},null);j.tooltip=m;Blockly.Tooltip.bindMouseEvents(j);this.workspace_.getCanvas().insertBefore(j,m.getSvgRoot());m.flyoutRect_=j;this.backgroundButtons_[n]=j;this.addBlockListeners_(l,m,j)}else{"button"==m.type&&(m=m.button,l=m.createDom(),m.moveTo(o,p),m.show(),Blockly.bindEventWithChecks_(l,"mouseup",m,m.onMouseUp),this.buttons_.push(m),this.horizontalLayout_?o+=m.width+q[n]:p+=m.height+q[n])}}};Blockly.Flyout.prototype.clearOldBlocks_=function(){for(var e=this.workspace_.getTopBlocks(!1),d=0,f;f=e[d];d++){f.workspace==this.workspace_&&f.dispose(!1,!1)}for(d=0;e=this.backgroundButtons_[d];d++){goog.dom.removeNode(e)}for(d=this.backgroundButtons_.length=0;e=this.buttons_[d];d++){e.dispose()}this.buttons_.length=0};Blockly.Flyout.prototype.addBlockListeners_=function(e,d,f){this.listeners_.push(Blockly.bindEventWithChecks_(e,"mousedown",null,this.blockMouseDown_(d)));this.listeners_.push(Blockly.bindEventWithChecks_(f,"mousedown",null,this.blockMouseDown_(d)));this.listeners_.push(Blockly.bindEvent_(e,"mouseover",d,d.addSelect));this.listeners_.push(Blockly.bindEvent_(e,"mouseout",d,d.removeSelect));this.listeners_.push(Blockly.bindEvent_(f,"mouseover",d,d.addSelect));this.listeners_.push(Blockly.bindEvent_(f,"mouseout",d,d.removeSelect))};Blockly.Flyout.blockRightClick_=function(d,c){Blockly.terminateDrag_();Blockly.hideChaff(!0);c.showContextMenu_(d);Blockly.Touch.clearTouchIdentifier()};Blockly.Flyout.prototype.blockMouseDown_=function(d){var c=this;return function(a){Blockly.utils.isRightButton(a)?Blockly.Flyout.blockRightClick_(a,d):(Blockly.terminateDrag_(),Blockly.hideChaff(!0),Blockly.Css.setCursor(Blockly.Css.Cursor.CLOSED),c.startDragMouseY_=a.clientY,c.startDragMouseX_=a.clientX,Blockly.Flyout.startDownEvent_=a,Blockly.Flyout.startBlock_=d,Blockly.Flyout.startFlyout_=c,Blockly.Flyout.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",c,c.onMouseUp_),Blockly.Flyout.onMouseMoveBlockWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",c,c.onMouseMoveBlock_));a.stopPropagation();a.preventDefault()}};Blockly.Flyout.prototype.onMouseDown_=function(b){Blockly.utils.isRightButton(b)?Blockly.Touch.clearTouchIdentifier():(Blockly.hideChaff(!0),this.dragMode_=Blockly.DRAG_FREE,this.startDragMouseY_=b.clientY,this.startDragMouseX_=b.clientX,Blockly.Flyout.startFlyout_=this,Blockly.Flyout.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.onMouseMove_),Blockly.Flyout.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,Blockly.Flyout.terminateDrag_),b.preventDefault(),b.stopPropagation())};Blockly.Flyout.prototype.onMouseUp_=function(b){this.workspace_.isDragging()||(Blockly.Touch.clearTouchIdentifier(),this.autoClose?this.createBlockFunc_(Blockly.Flyout.startBlock_)(Blockly.Flyout.startDownEvent_):Blockly.WidgetDiv.isVisible()||Blockly.Events.fire(new Blockly.Events.Ui(Blockly.Flyout.startBlock_,"click",void 0,void 0)));Blockly.terminateDrag_()};Blockly.Flyout.prototype.onMouseMove_=function(e){var d=this.getMetrics_();if(this.horizontalLayout_){if(!(0>d.contentWidth-d.viewWidth)){var f=e.clientX-this.startDragMouseX_;this.startDragMouseX_=e.clientX;e=d.viewLeft-f;e=goog.math.clamp(e,0,d.contentWidth-d.viewWidth);this.scrollbar_.set(e)}}else{0>d.contentHeight-d.viewHeight||(f=e.clientY-this.startDragMouseY_,this.startDragMouseY_=e.clientY,e=d.viewTop-f,e=goog.math.clamp(e,0,d.contentHeight-d.viewHeight),this.scrollbar_.set(e))}};Blockly.Flyout.prototype.onMouseMoveBlock_=function(b){"mousemove"==b.type&&1>=b.clientX&&0==b.clientY&&0==b.button||(this.determineDragIntention_(b.clientX-Blockly.Flyout.startDownEvent_.clientX,b.clientY-Blockly.Flyout.startDownEvent_.clientY)?(Blockly.longStop_(),this.createBlockFunc_(Blockly.Flyout.startBlock_)(Blockly.Flyout.startDownEvent_)):this.dragMode_==Blockly.DRAG_FREE&&(Blockly.longStop_(),this.onMouseMove_(b)));b.stopPropagation()};Blockly.Flyout.prototype.determineDragIntention_=function(d,c){if(this.dragMode_==Blockly.DRAG_FREE){return !1}if(Math.sqrt(d*d+c*c)<this.DRAG_RADIUS){return this.dragMode_=Blockly.DRAG_STICKY,!1}if(this.isDragTowardWorkspace_(d,c)||!this.scrollbar_.isVisible()){return !0}this.dragMode_=Blockly.DRAG_FREE;return !1};Blockly.Flyout.prototype.isDragTowardWorkspace_=function(f,e){var h=Math.atan2(e,f)/Math.PI*180,g=this.dragAngleRange_;if(this.horizontalLayout_){if(h<90+g&&h>90-g||h>-90-g&&h<-90+g){return !0}}else{if(h<g&&h>-g||h<-180+g||h>180-g){return !0}}return !1};Blockly.Flyout.prototype.createBlockFunc_=function(d){var c=this;return function(h){if(!Blockly.utils.isRightButton(h)&&!d.disabled){Blockly.Events.disable();c.targetWorkspace_.setResizesEnabled(!1);try{var g=c.placeNewBlock_(d)}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&(Blockly.Events.setGroup(!0),Blockly.Events.fire(new Blockly.Events.Create(g)));c.autoClose?c.hide():c.filterForCapacity_();if(goog.userAgent.IE||goog.userAgent.EDGE){for(var b=g.getDescendants(),a=b.length-1;0<=a;a--){b[a].render(!1)}}g.onMouseDown_(h);Blockly.dragMode_=Blockly.DRAG_FREE;g.setDragging_(!0);g.moveToDragSurface_()}}};Blockly.Flyout.prototype.placeNewBlock_=function(g){var f=this.targetWorkspace_,j=g.getSvgRoot();if(!j){throw"originBlock is not rendered."}var j=f.isMutator?this.workspace_.getSvgXY(j):Blockly.utils.getInjectionDivXY_(j),i=this.workspace_.scrollX,h=this.workspace_.scale;j.x+=i/h-i;this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT&&(i=f.getMetrics().viewWidth-this.width_,h=f.scale,j.x+=i/h-i);i=this.workspace_.scrollY;h=this.workspace_.scale;j.y+=i/h-i;this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM&&(i=f.getMetrics().viewHeight-this.height_,h=f.scale,j.y+=i/h-i);g=Blockly.Xml.blockToDom(g);g=Blockly.Xml.domToBlock(g,f);h=g.getSvgRoot();if(!h){throw"block is not rendered."}h=f.isMutator?f.getSvgXY(h):Blockly.utils.getInjectionDivXY_(h);h.x+=f.scrollX/f.scale-f.scrollX;h.y+=f.scrollY/f.scale-f.scrollY;f.toolbox_&&!f.scrollbar&&(h.x+=f.toolbox_.getWidth()/f.scale,h.y+=f.toolbox_.getHeight()/f.scale);g.moveBy(j.x-h.x,j.y-h.y);return g};Blockly.Flyout.prototype.filterForCapacity_=function(){for(var g=this.targetWorkspace_.remainingCapacity(),f=this.workspace_.getTopBlocks(!1),j=0,i;i=f[j];j++){if(-1==this.permanentlyDisabled_.indexOf(i)){var h=i.getDescendants();i.setDisabled(h.length>g)}}};Blockly.Flyout.prototype.getClientRect=function(){if(!this.svgGroup_){return null}var f=this.svgGroup_.getBoundingClientRect(),e=f.left,h=f.top,g=f.width,f=f.height;return this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP?new goog.math.Rect(-1000000000,h-1000000000,2000000000,1000000000+f):this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM?new goog.math.Rect(-1000000000,h,2000000000,1000000000+f):this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT?new goog.math.Rect(e-1000000000,-1000000000,1000000000+g,2000000000):new goog.math.Rect(e,-1000000000,1000000000+g,2000000000)};Blockly.Flyout.terminateDrag_=function(){Blockly.Flyout.startFlyout_&&(Blockly.Flyout.startFlyout_.dragMode_==Blockly.DRAG_FREE&&Blockly.Touch.clearTouchIdentifier(),Blockly.Flyout.startFlyout_.dragMode_=Blockly.DRAG_NONE,Blockly.Flyout.startFlyout_=null);Blockly.Flyout.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Flyout.onMouseUpWrapper_),Blockly.Flyout.onMouseUpWrapper_=null);Blockly.Flyout.onMouseMoveBlockWrapper_&&(Blockly.unbindEvent_(Blockly.Flyout.onMouseMoveBlockWrapper_),Blockly.Flyout.onMouseMoveBlockWrapper_=null);Blockly.Flyout.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Flyout.onMouseMoveWrapper_),Blockly.Flyout.onMouseMoveWrapper_=null);Blockly.Flyout.startDownEvent_=null;Blockly.Flyout.startBlock_=null};Blockly.Flyout.prototype.reflowHorizontal=function(i){this.workspace_.scale=this.targetWorkspace_.scale;for(var h=0,n=0,m;m=i[n];n++){h=Math.max(h,m.getHeightWidth().height)}h+=1.5*this.MARGIN;h*=this.workspace_.scale;h+=Blockly.Scrollbar.scrollbarThickness;if(this.height_!=h){for(n=0;m=i[n];n++){var l=m.getHeightWidth();if(m.flyoutRect_){m.flyoutRect_.setAttribute("width",l.width);m.flyoutRect_.setAttribute("height",l.height);var k=m.outputConnection?Blockly.BlockSvg.TAB_WIDTH:0,j=m.getRelativeToSurfaceXY();m.flyoutRect_.setAttribute("y",j.y);m.flyoutRect_.setAttribute("x",this.RTL?j.x-l.width+k:j.x-k);(l=m.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0)&&m.moveBy(0,l);m.flyoutRect_.setAttribute("y",j.y)}}this.height_=h;this.targetWorkspace_.resize()}};Blockly.Flyout.prototype.reflowVertical=function(i){this.workspace_.scale=this.targetWorkspace_.scale;for(var h=0,n=0,m;m=i[n];n++){var l=m.getHeightWidth().width;m.outputConnection&&(l-=Blockly.BlockSvg.TAB_WIDTH);h=Math.max(h,l)}for(n=0;m=this.buttons_[n];n++){h=Math.max(h,m.width)}h+=1.5*this.MARGIN+Blockly.BlockSvg.TAB_WIDTH;h*=this.workspace_.scale;h+=Blockly.Scrollbar.scrollbarThickness;if(this.width_!=h){for(n=0;m=i[n];n++){l=m.getHeightWidth();if(this.RTL){var k=m.getRelativeToSurfaceXY().x,j=h/this.workspace_.scale-this.MARGIN,j=j-Blockly.BlockSvg.TAB_WIDTH;m.moveBy(j-k,0)}m.flyoutRect_&&(m.flyoutRect_.setAttribute("width",l.width),m.flyoutRect_.setAttribute("height",l.height),j=m.outputConnection?Blockly.BlockSvg.TAB_WIDTH:0,k=m.getRelativeToSurfaceXY(),m.flyoutRect_.setAttribute("x",this.RTL?k.x-l.width+j:k.x-j),(l=m.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0)&&m.moveBy(0,l),m.flyoutRect_.setAttribute("y",k.y))}this.width_=h;this.targetWorkspace_.resize()}};Blockly.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_);var b=this.workspace_.getTopBlocks(!1);this.horizontalLayout_?this.reflowHorizontal(b):this.reflowVertical(b);this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)};"use strict";Blockly.Toolbox=function(b){this.workspace_=b;this.RTL=b.options.RTL;this.horizontalLayout_=b.options.horizontalLayout;this.toolboxPosition=b.options.toolboxPosition;this.config_={indentWidth:19,cssRoot:"blocklyTreeRoot",cssHideRoot:"blocklyHidden",cssItem:"",cssTreeRow:"blocklyTreeRow",cssItemLabel:"blocklyTreeLabel",cssTreeIcon:"blocklyTreeIcon",cssExpandedFolderIcon:"blocklyTreeIconOpen",cssFileIcon:"blocklyTreeIconNone",cssSelectedRow:"blocklyTreeSelected"};this.treeSeparatorConfig_={cssTreeRow:"blocklyTreeSeparator"};this.horizontalLayout_&&(this.config_.cssTreeRow+=b.RTL?" blocklyHorizontalTreeRtl":" blocklyHorizontalTree",this.treeSeparatorConfig_.cssTreeRow="blocklyTreeSeparatorHorizontal "+(b.RTL?"blocklyHorizontalTreeRtl":"blocklyHorizontalTree"),this.config_.cssTreeIcon="")};Blockly.Toolbox.prototype.width=0;Blockly.Toolbox.prototype.height=0;Blockly.Toolbox.prototype.selectedOption_=null;Blockly.Toolbox.prototype.lastCategory_=null;Blockly.Toolbox.prototype.init=function(){var d=this.workspace_,c=this.workspace_.getParentSvg();this.HtmlDiv=goog.dom.createDom("DIV","blocklyToolboxDiv");this.HtmlDiv.setAttribute("dir",d.RTL?"RTL":"LTR");c.parentNode.insertBefore(this.HtmlDiv,c);Blockly.bindEventWithChecks_(this.HtmlDiv,"mousedown",this,function(b){Blockly.utils.isRightButton(b)||b.target==this.HtmlDiv?Blockly.hideChaff(!1):Blockly.hideChaff(!0);Blockly.Touch.clearTouchIdentifier()});this.flyout_=new Blockly.Flyout({disabledPatternId:d.options.disabledPatternId,parentWorkspace:d,RTL:d.RTL,oneBasedIndex:d.options.oneBasedIndex,horizontalLayout:d.horizontalLayout,toolboxPosition:d.options.toolboxPosition});goog.dom.insertSiblingAfter(this.flyout_.createDom("svg"),this.workspace_.getParentSvg());this.flyout_.init(d);this.config_.cleardotPath=d.options.pathToMedia+"1x1.gif";this.config_.cssCollapsedFolderIcon="blocklyTreeIconClosed"+(d.RTL?"Rtl":"Ltr");this.tree_=c=new Blockly.Toolbox.TreeControl(this,this.config_);c.setShowRootNode(!1);c.setShowLines(!1);c.setShowExpandIcons(!1);c.setSelectedItem(null);d=this.populate_(d.options.languageTree);c.render(this.HtmlDiv);d&&c.setSelectedItem(d);this.addColour_();this.position()};Blockly.Toolbox.prototype.dispose=function(){this.flyout_.dispose();this.tree_.dispose();goog.dom.removeNode(this.HtmlDiv);this.lastCategory_=this.workspace_=null};Blockly.Toolbox.prototype.getWidth=function(){return this.width};Blockly.Toolbox.prototype.getHeight=function(){return this.height};Blockly.Toolbox.prototype.position=function(){var d=this.HtmlDiv;if(d){var c=this.workspace_.getParentSvg(),c=Blockly.svgSize(c);this.horizontalLayout_?(d.style.left="0",d.style.height="auto",d.style.width=c.width+"px",this.height=d.offsetHeight,this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?d.style.top="0":d.style.bottom="0"):(this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT?d.style.right="0":d.style.left="0",d.style.height=c.height+"px",this.width=d.offsetWidth);this.flyout_.position()}};Blockly.Toolbox.prototype.populate_=function(b){this.tree_.removeChildren();this.tree_.blocks=[];this.hasColours_=!1;b=this.syncTrees_(b,this.tree_,this.workspace_.options.pathToMedia);if(this.tree_.blocks.length){throw"Toolbox cannot have both blocks and categories in the root level."}this.workspace_.resizeContents();return b};Blockly.Toolbox.prototype.syncTrees_=function(j,i,p){for(var o=null,n=null,m=0,l;l=j.childNodes[m];m++){if(l.tagName){switch(l.tagName.toUpperCase()){case"CATEGORY":n=this.tree_.createNode(l.getAttribute("name"));n.catId=l.getAttribute("id");n.blocks=[];i.add(n);var k=l.getAttribute("custom");k?n.blocks=k:(k=this.syncTrees_(l,n,p))&&(o=k);k=l.getAttribute("colour");goog.isString(k)?(k.match(/^#[0-9a-fA-F]{6}$/)?n.hexColour=k:n.hexColour=Blockly.hueToRgb(k),this.hasColours_=!0):n.hexColour="";"true"==l.getAttribute("expanded")?(n.blocks.length&&(o=n),n.setExpanded(!0)):n.setExpanded(!1);n=l;break;case"SEP":n&&("CATEGORY"==n.tagName.toUpperCase()?i.add(new Blockly.Toolbox.TreeSeparator(this.treeSeparatorConfig_)):(l=parseFloat(l.getAttribute("gap")),!isNaN(l)&&n&&n.setAttribute("gap",l)));break;case"BLOCK":case"SHADOW":case"LABEL":case"BUTTON":i.blocks.push(l),n=l}}}return o};Blockly.Toolbox.prototype.addColour_=function(g){g=(g||this.tree_).getChildren();for(var f=0,j;j=g[f];f++){var i=j.getRowElement();if(i){var h=this.hasColours_?"8px solid "+(j.hexColour||"#ddd"):"none";this.workspace_.RTL?i.style.borderRight=h:i.style.borderLeft=h}this.addColour_(j)}};Blockly.Toolbox.prototype.clearSelection=function(){this.tree_.setSelectedItem(null)};Blockly.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv){return null}var f=this.HtmlDiv.getBoundingClientRect(),e=f.left,h=f.top,g=f.width,f=f.height;return this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT?new goog.math.Rect(-10000000,-10000000,10000000+e+g,20000000):this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT?new goog.math.Rect(e,-10000000,10000000+g,20000000):this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?new goog.math.Rect(-10000000,-10000000,20000000,10000000+h+f):new goog.math.Rect(0,h,20000000,10000000+g)};Blockly.Toolbox.prototype.refreshSelection=function(){var b=this.tree_.getSelectedItem();b&&b.blocks&&this.flyout_.show(b.blocks)};Blockly.Toolbox.TreeControl=function(d,c){this.toolbox_=d;goog.ui.tree.TreeControl.call(this,goog.html.SafeHtml.EMPTY,c)};goog.inherits(Blockly.Toolbox.TreeControl,goog.ui.tree.TreeControl);Blockly.Toolbox.TreeControl.prototype.enterDocument=function(){Blockly.Toolbox.TreeControl.superClass_.enterDocument.call(this);if(goog.events.BrowserFeature.TOUCH_ENABLED){var b=this.getElement();Blockly.bindEventWithChecks_(b,goog.events.EventType.TOUCHSTART,this,this.handleTouchEvent_)}};Blockly.Toolbox.TreeControl.prototype.handleTouchEvent_=function(d){d.preventDefault();var c=this.getNodeFromEvent_(d);c&&d.type===goog.events.EventType.TOUCHSTART&&setTimeout(function(){c.onMouseDown(d)},1)};Blockly.Toolbox.TreeControl.prototype.createNode=function(b){return new Blockly.Toolbox.TreeNode(this.toolbox_,b?goog.html.SafeHtml.htmlEscape(b):goog.html.SafeHtml.EMPTY,this.getConfig(),this.getDomHelper())};Blockly.Toolbox.TreeControl.prototype.setSelectedItem=function(e){var d=this.toolbox_;if(e!=this.selectedItem_&&e!=d.tree_){d.lastCategory_&&(d.lastCategory_.getRowElement().style.backgroundColor="");if(e){var f=e.hexColour||"#57e";e.getRowElement().style.backgroundColor=f;d.addColour_(e)}f=this.getSelectedItem();goog.ui.tree.TreeControl.prototype.setSelectedItem.call(this,e);e&&e.blocks&&e.blocks.length?(d.flyout_.show(e.blocks),d.lastCategory_!=e&&d.flyout_.scrollToStart()):d.flyout_.hide();f!=e&&f!=this&&(f=new Blockly.Events.Ui(null,"category",f&&f.getHtml(),e&&e.getHtml()),f.workspaceId=d.workspace_.id,Blockly.Events.fire(f));e&&(d.lastCategory_=e)}};Blockly.Toolbox.TreeNode=function(f,e,h,g){goog.ui.tree.TreeNode.call(this,e,h,g);f&&(e=function(){Blockly.svgResize(f.workspace_)},goog.events.listen(f.tree_,goog.ui.tree.BaseNode.EventType.EXPAND,e),goog.events.listen(f.tree_,goog.ui.tree.BaseNode.EventType.COLLAPSE,e))};goog.inherits(Blockly.Toolbox.TreeNode,goog.ui.tree.TreeNode);Blockly.Toolbox.TreeNode.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.create("span")};Blockly.Toolbox.TreeNode.prototype.onMouseDown=function(b){this.hasChildren()&&this.isUserCollapsible_?(this.toggle(),this.select()):this.isSelected()?this.getTree().setSelectedItem(null):this.select();this.updateRow()};Blockly.Toolbox.TreeNode.prototype.onDoubleClick_=function(b){};Blockly.Toolbox.TreeNode.prototype.onKeyDown=function(f){if(this.tree.toolbox_.horizontalLayout_){var e={},h=goog.events.KeyCodes.DOWN,g=goog.events.KeyCodes.UP;e[goog.events.KeyCodes.RIGHT]=this.rightToLeft_?g:h;e[goog.events.KeyCodes.LEFT]=this.rightToLeft_?h:g;e[goog.events.KeyCodes.UP]=goog.events.KeyCodes.LEFT;e[goog.events.KeyCodes.DOWN]=goog.events.KeyCodes.RIGHT;f.keyCode=e[f.keyCode]||f.keyCode}return Blockly.Toolbox.TreeNode.superClass_.onKeyDown.call(this,f)};Blockly.Toolbox.TreeSeparator=function(b){Blockly.Toolbox.TreeNode.call(this,null,"",b)};goog.inherits(Blockly.Toolbox.TreeSeparator,Blockly.Toolbox.TreeNode);"use strict";Blockly.Css={};Blockly.Css.Cursor={OPEN:"handopen",CLOSED:"handclosed",DELETE:"handdelete"};Blockly.Css.currentCursor_="";Blockly.Css.styleSheet_=null;Blockly.Css.mediaPath_="";Blockly.Css.inject=function(f,e){if(!Blockly.Css.styleSheet_){var h=".blocklyDraggable {}\n";f&&(h+=Blockly.Css.CONTENT.join("\n"),Blockly.FieldDate&&(h+=Blockly.FieldDate.CSS.join("\n")));Blockly.Css.mediaPath_=e.replace(/[\\\/]$/,"");var h=h.replace(/<<<PATH>>>/g,Blockly.Css.mediaPath_),g=document.createElement("style");document.head.insertBefore(g,document.head.firstChild);h=document.createTextNode(h);g.appendChild(h);Blockly.Css.styleSheet_=g.sheet;Blockly.Css.setCursor(Blockly.Css.Cursor.OPEN)}};Blockly.Css.setCursor=function(g){if(Blockly.Css.currentCursor_!=g){Blockly.Css.currentCursor_=g;var f="url("+Blockly.Css.mediaPath_+"/"+g+".cur), auto",j=".blocklyDraggable {\n  cursor: "+f+";\n}\n";Blockly.Css.styleSheet_.deleteRule(0);Blockly.Css.styleSheet_.insertRule(j,0);for(var j=document.getElementsByClassName("blocklyToolboxDiv"),i=0,h;h=j[i];i++){h.style.cursor=g==Blockly.Css.Cursor.DELETE?f:""}document.body.parentNode.style.cursor=g==Blockly.Css.Cursor.OPEN?"":f}};Blockly.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","overflow: visible;","top: 0;","left: 0;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font-family: sans-serif;","font-size: 9pt;","opacity: 0.9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #888;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyText {","cursor: default;","fill: #fff;","font-family: sans-serif;","font-size: 11pt;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyNonEditableText>rect,",".blocklyEditableText>rect {","fill: #fff;","fill-opacity: .6;","}",".blocklyNonEditableText>text,",".blocklyEditableText>text {","fill: #000;","}",".blocklyEditableText:hover>rect {","stroke: #fff;","stroke-width: 2;","}",".blocklyBubbleText {","fill: #000;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyFlyoutButton {","fill: #888;","cursor: default;","}",".blocklyFlyoutButtonShadow {","fill: #666;","}",".blocklyFlyoutButton:hover {","fill: #aaa;","}",".blocklyFlyoutLabel {","cursor: default;","}",".blocklyFlyoutLabelBackground {","opacity: 0;","}",".blocklyFlyoutLabelText {","fill: #000;","}",".blocklySvg text, .blocklyBlockDragSurface text {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyCommentTextarea {","background-color: #ffc;","border: 0;","margin: 0;","padding: 2px;","resize: none;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","font-family: sans-serif;","height: 100%;","margin: 0;","outline: none;","padding: 0 1px;","width: 100%","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal, .blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyZoom>image {","opacity: .4;","}",".blocklyZoom>image:hover {","opacity: .6;","}",".blocklyZoom>image:active {","opacity: .8;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyAngleCircle {","stroke: #444;","stroke-width: 1;","fill: #ddd;","fill-opacity: .8;","}",".blocklyAngleMarks {","stroke: #444;","stroke-width: 1;","}",".blocklyAngleGauge {","fill: #f88;","fill-opacity: .8;","}",".blocklyAngleLine {","stroke: #f00;","stroke-width: 2;","stroke-linecap: round;","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","}",".blocklyDropdownMenu {","padding: 0 !important;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","position: absolute;","z-index: 70;","}",".blocklyTreeRoot {","padding: 4px 0;","}",".blocklyTreeRoot:focus {","outline: none;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",".blocklyHorizontalTree {","float: left;","margin: 1px 5px 8px 0;","}",".blocklyHorizontalTreeRtl {","float: right;","margin: 1px 0 8px 5px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","}",".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: #e4e4e4;","}",".blocklyTreeSeparator {","border-bottom: solid #e5e5e5 1px;","height: 0;","margin: 5px 0;","}",".blocklyTreeSeparatorHorizontal {","border-right: solid #e5e5e5 1px;","width: 0;","padding: 5px 0;","margin: 0 5px;","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","width: 16px;","}",".blocklyTreeIconClosedLtr {","background-position: -32px -1px;","}",".blocklyTreeIconClosedRtl {","background-position: 0px -1px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedLtr {","background-position: -32px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedRtl {","background-position: 0px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeIconNone,",".blocklyTreeSelected>.blocklyTreeIconNone {","background-position: -48px -1px;","}",".blocklyTreeLabel {","cursor: default;","font-family: sans-serif;","font-size: 16px;","padding: 0 3px;","vertical-align: middle;","}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}",".blocklyWidgetDiv .goog-palette {","outline: none;","cursor: default;","}",".blocklyWidgetDiv .goog-palette-table {","border: 1px solid #666;","border-collapse: collapse;","}",".blocklyWidgetDiv .goog-palette-cell {","height: 13px;","width: 15px;","margin: 0;","border: 0;","text-align: center;","vertical-align: middle;","border-right: 1px solid #666;","font-size: 1px;","}",".blocklyWidgetDiv .goog-palette-colorswatch {","position: relative;","height: 13px;","width: 15px;","border: 1px solid #666;","}",".blocklyWidgetDiv .goog-palette-cell-hover .goog-palette-colorswatch {","border: 1px solid #FFF;","}",".blocklyWidgetDiv .goog-palette-cell-selected .goog-palette-colorswatch {","border: 1px solid #000;","color: #fff;","}",".blocklyWidgetDiv .goog-menu {","background: #fff;","border-color: #ccc #666 #666 #ccc;","border-style: solid;","border-width: 1px;","cursor: default;","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .goog-menuitem {","color: #000;","font: normal 13px Arial, sans-serif;","list-style: none;","margin: 0;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyWidgetDiv .goog-menuitem.goog-menuitem-rtl {","padding-left: 7em;","padding-right: 28px;","}",".blocklyWidgetDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyWidgetDiv .goog-menu-noicon .goog-menuitem {","padding-left: 12px;","}",".blocklyWidgetDiv .goog-menu-noaccel .goog-menuitem {","padding-right: 20px;","}",".blocklyWidgetDiv .goog-menuitem-content {","color: #000;","font: normal 13px Arial, sans-serif;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-content {","color: #ccc !important;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-icon {","opacity: 0.3;","-moz-opacity: 0.3;","filter: alpha(opacity=30);","}",".blocklyWidgetDiv .goog-menuitem-highlight,",".blocklyWidgetDiv .goog-menuitem-hover {","background-color: #d6e9f8;","border-color: #d6e9f8;","border-style: dotted;","border-width: 1px 0;","padding-bottom: 3px;","padding-top: 3px;","}",".blocklyWidgetDiv .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-icon {","background-repeat: no-repeat;","height: 16px;","left: 6px;","position: absolute;","right: auto;","vertical-align: middle;","width: 16px;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-icon {","left: auto;","right: 6px;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon {","background: url(//ssl.gstatic.com/editor/editortoolbar.png) no-repeat -512px 0;","}",".blocklyWidgetDiv .goog-menuitem-accel {","color: #999;","direction: ltr;","left: auto;","padding: 0 6px;","position: absolute;","right: 0;","text-align: right;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-accel {","left: 0;","right: auto;","text-align: left;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-hint {","text-decoration: underline;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-separator {","color: #999;","font-size: 12px;","padding-left: 4px;","}",".blocklyWidgetDiv .goog-menuseparator {","border-top: 1px solid #ccc;","margin: 4px 0;","padding: 0;","}",""];"use strict";Blockly.WidgetDiv={};Blockly.WidgetDiv.DIV=null;Blockly.WidgetDiv.owner_=null;Blockly.WidgetDiv.dispose_=null;Blockly.WidgetDiv.createDom=function(){Blockly.WidgetDiv.DIV||(Blockly.WidgetDiv.DIV=goog.dom.createDom("DIV","blocklyWidgetDiv"),document.body.appendChild(Blockly.WidgetDiv.DIV))};Blockly.WidgetDiv.show=function(e,d,f){Blockly.WidgetDiv.hide();Blockly.WidgetDiv.owner_=e;Blockly.WidgetDiv.dispose_=f;e=goog.style.getViewportPageOffset(document);Blockly.WidgetDiv.DIV.style.top=e.y+"px";Blockly.WidgetDiv.DIV.style.direction=d?"rtl":"ltr";Blockly.WidgetDiv.DIV.style.display="block"};Blockly.WidgetDiv.hide=function(){Blockly.WidgetDiv.owner_&&(Blockly.WidgetDiv.owner_=null,Blockly.WidgetDiv.DIV.style.display="none",Blockly.WidgetDiv.DIV.style.left="",Blockly.WidgetDiv.DIV.style.top="",Blockly.WidgetDiv.dispose_&&Blockly.WidgetDiv.dispose_(),Blockly.WidgetDiv.dispose_=null,goog.dom.removeChildren(Blockly.WidgetDiv.DIV))};Blockly.WidgetDiv.isVisible=function(){return !!Blockly.WidgetDiv.owner_};Blockly.WidgetDiv.hideIfOwner=function(b){Blockly.WidgetDiv.owner_==b&&Blockly.WidgetDiv.hide()};Blockly.WidgetDiv.position=function(g,f,j,i,h){f<i.y&&(f=i.y);h?g>j.width+i.x&&(g=j.width+i.x):g<i.x&&(g=i.x);Blockly.WidgetDiv.DIV.style.left=g+"px";Blockly.WidgetDiv.DIV.style.top=f+"px";Blockly.WidgetDiv.DIV.style.height=j.height+"px"};"use strict";Blockly.BlockDragSurfaceSvg=function(b){this.container_=b;this.createDom()};Blockly.BlockDragSurfaceSvg.prototype.SVG_=null;Blockly.BlockDragSurfaceSvg.prototype.dragGroup_=null;Blockly.BlockDragSurfaceSvg.prototype.container_=null;Blockly.BlockDragSurfaceSvg.prototype.scale_=1;Blockly.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=Blockly.utils.createSvgElement("svg",{xmlns:Blockly.SVG_NS,"xmlns:html":Blockly.HTML_NS,"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1","class":"blocklyBlockDragSurface"},this.container_),this.dragGroup_=Blockly.utils.createSvgElement("g",{},this.SVG_))};Blockly.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(b){goog.asserts.assert(0==this.dragGroup_.childNodes.length,"Already dragging a block.");this.dragGroup_.appendChild(b);this.SVG_.style.display="block"};Blockly.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(e,d,f){this.scale_=f;e=e.toFixed(0);d=d.toFixed(0);this.dragGroup_.setAttribute("transform","translate("+e+","+d+") scale("+f+")")};Blockly.BlockDragSurfaceSvg.prototype.translateSurface=function(d,c){d*=this.scale_;c*=this.scale_;d=d.toFixed(0);c=c.toFixed(0);this.SVG_.style.display="block";Blockly.utils.setCssTransform(this.SVG_,"translate3d("+d+"px, "+c+"px, 0px)")};Blockly.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var b=Blockly.utils.getRelativeXY(this.SVG_);return new goog.math.Coordinate(b.x/this.scale_,b.y/this.scale_)};Blockly.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_};Blockly.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild};Blockly.BlockDragSurfaceSvg.prototype.clearAndHide=function(b){b.appendChild(this.getCurrentBlock());this.SVG_.style.display="none";goog.asserts.assert(0==this.dragGroup_.childNodes.length,"Drag group was not cleared.")};"use strict";Blockly.inject=function(h,g){goog.isString(h)&&(h=document.getElementById(h)||document.querySelector(h));if(!goog.dom.contains(document,h)){throw"Error: container is not in current document."}var l=new Blockly.Options(g||{}),k=goog.dom.createDom("div","injectionDiv");h.appendChild(k);var j=Blockly.createDom_(k,l),i=new Blockly.BlockDragSurfaceSvg(k),k=new Blockly.workspaceDragSurfaceSvg(k),l=Blockly.createMainWorkspace_(j,l,i,k);Blockly.init_(l);Blockly.mainWorkspace=l;Blockly.svgResize(l);return l};Blockly.createDom_=function(i,h){i.setAttribute("dir","LTR");goog.ui.Component.setDefaultRightToLeft(h.RTL);Blockly.Css.inject(h.hasCss,h.pathToMedia);var n=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1","class":"blocklySvg"},i),m=Blockly.utils.createSvgElement("defs",{},n),l=String(Math.random()).substring(2),k=Blockly.utils.createSvgElement("filter",{id:"blocklyEmbossFilter"+l},m);Blockly.utils.createSvgElement("feGaussianBlur",{"in":"SourceAlpha",stdDeviation:1,result:"blur"},k);var j=Blockly.utils.createSvgElement("feSpecularLighting",{"in":"blur",surfaceScale:1,specularConstant:0.5,specularExponent:10,"lighting-color":"white",result:"specOut"},k);Blockly.utils.createSvgElement("fePointLight",{x:-5000,y:-10000,z:20000},j);Blockly.utils.createSvgElement("feComposite",{"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},k);Blockly.utils.createSvgElement("feComposite",{"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},k);h.embossFilterId=k.id;k=Blockly.utils.createSvgElement("pattern",{id:"blocklyDisabledPattern"+l,patternUnits:"userSpaceOnUse",width:10,height:10},m);Blockly.utils.createSvgElement("rect",{width:10,height:10,fill:"#aaa"},k);Blockly.utils.createSvgElement("path",{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},k);h.disabledPatternId=k.id;m=Blockly.utils.createSvgElement("pattern",{id:"blocklyGridPattern"+l,patternUnits:"userSpaceOnUse"},m);0<h.gridOptions.length&&0<h.gridOptions.spacing&&(Blockly.utils.createSvgElement("line",{stroke:h.gridOptions.colour},m),1<h.gridOptions.length&&Blockly.utils.createSvgElement("line",{stroke:h.gridOptions.colour},m));h.gridPattern=m;return n};Blockly.createMainWorkspace_=function(g,f,j,i){f.parentWorkspace=null;var h=new Blockly.WorkspaceSvg(f,j,i);h.scale=f.zoomOptions.startScale;g.appendChild(h.createDom("blocklyMainBackground"));!f.hasCategories&&f.languageTree&&(j=h.addFlyout_("svg"),Blockly.utils.insertAfter_(j,g));h.translate(0,0);Blockly.mainWorkspace=h;f.readOnly||f.hasScrollbars||h.addChangeListener(function(){if(Blockly.dragMode_==Blockly.DRAG_NONE){var w=h.getMetrics(),v=w.viewLeft+w.absoluteLeft,u=w.viewTop+w.absoluteTop;if(w.contentTop<u||w.contentTop+w.contentHeight>w.viewHeight+u||w.contentLeft<(f.RTL?w.viewLeft:v)||w.contentLeft+w.contentWidth>(f.RTL?w.viewWidth:w.viewWidth+v)){for(var t=h.getTopBlocks(!1),o=0,e;e=t[o];o++){var s=e.getRelativeToSurfaceXY(),r=e.getHeightWidth(),b=u+25-r.height-s.y;0<b&&e.moveBy(0,b);b=u+w.viewHeight-25-s.y;0>b&&e.moveBy(0,b);b=25+v-s.x-(f.RTL?0:r.width);0<b&&e.moveBy(b,0);s=v+w.viewWidth-25-s.x+(f.RTL?r.width:0);0>s&&e.moveBy(s,0)}}}});Blockly.svgResize(h);Blockly.WidgetDiv.createDom();Blockly.Tooltip.createDom();return h};Blockly.init_=function(e){var d=e.options,f=e.getParentSvg();Blockly.bindEventWithChecks_(f,"contextmenu",null,function(b){Blockly.utils.isTargetInput(b)||b.preventDefault()});f=Blockly.bindEventWithChecks_(window,"resize",null,function(){Blockly.hideChaff(!0);Blockly.svgResize(e)});e.setResizeHandlerWrapper(f);Blockly.inject.bindDocumentEvents_();d.languageTree&&(e.toolbox_?e.toolbox_.init(e):e.flyout_&&(e.flyout_.init(e),e.flyout_.show(d.languageTree.childNodes),e.flyout_.scrollToStart(),e.scrollX=e.flyout_.width_,d.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(e.scrollX*=-1),e.translate(e.scrollX,0)));d.hasScrollbars&&(e.scrollbar=new Blockly.ScrollbarPair(e),e.scrollbar.resize());d.hasSounds&&Blockly.inject.loadSounds_(d.pathToMedia,e)};Blockly.inject.bindDocumentEvents_=function(){Blockly.documentEventsBound_||(Blockly.bindEventWithChecks_(document,"keydown",null,Blockly.onKeyDown_),Blockly.bindEvent_(document,"touchend",null,Blockly.longStop_),Blockly.bindEvent_(document,"touchcancel",null,Blockly.longStop_),document.addEventListener("mouseup",Blockly.onMouseUp_,!1),goog.userAgent.IPAD&&Blockly.bindEventWithChecks_(window,"orientationchange",document,function(){Blockly.svgResize(Blockly.getMainWorkspace())}));Blockly.documentEventsBound_=!0};Blockly.inject.loadSounds_=function(f,e){e.loadAudio_([f+"click.mp3",f+"click.wav",f+"click.ogg"],"click");e.loadAudio_([f+"disconnect.wav",f+"disconnect.mp3",f+"disconnect.ogg"],"disconnect");e.loadAudio_([f+"delete.mp3",f+"delete.ogg",f+"delete.wav"],"delete");var h=[],g=function(){for(;h.length;){Blockly.unbindEvent_(h.pop())}e.preloadAudio_()};h.push(Blockly.bindEventWithChecks_(document,"mousemove",null,g,!0));h.push(Blockly.bindEventWithChecks_(document,"touchstart",null,g,!0))};Blockly.updateToolbox=function(b){console.warn("Deprecated call to Blockly.updateToolbox, use workspace.updateToolbox instead.");Blockly.getMainWorkspace().updateToolbox(b)};"use strict";var CLOSURE_DEFINES={"goog.DEBUG":!1};Blockly.mainWorkspace=null;Blockly.selected=null;Blockly.highlightedConnection_=null;Blockly.localConnection_=null;Blockly.draggingConnections_=[];Blockly.clipboardXml_=null;Blockly.clipboardSource_=null;Blockly.dragMode_=Blockly.DRAG_NONE;Blockly.cache3dSupported_=null;Blockly.hueToRgb=function(b){return goog.color.hsvToHex(b,Blockly.HSV_SATURATION,255*Blockly.HSV_VALUE)};Blockly.svgSize=function(b){return{width:b.cachedWidth_,height:b.cachedHeight_}};Blockly.resizeSvgContents=function(b){b.resizeContents()};Blockly.svgResize=function(f){for(;f.options.parentWorkspace;){f=f.options.parentWorkspace}var e=f.getParentSvg(),h=e.parentNode;if(h){var g=h.offsetWidth,h=h.offsetHeight;e.cachedWidth_!=g&&(e.setAttribute("width",g+"px"),e.cachedWidth_=g);e.cachedHeight_!=h&&(e.setAttribute("height",h+"px"),e.cachedHeight_=h);f.resize()}};Blockly.onKeyDown_=function(d){if(!Blockly.mainWorkspace.options.readOnly&&!Blockly.utils.isTargetInput(d)){var c=!1;if(27==d.keyCode){Blockly.hideChaff()}else{if(8==d.keyCode||46==d.keyCode){d.preventDefault(),Blockly.selected&&Blockly.selected.isDeletable()&&(c=!0)}else{if(d.altKey||d.ctrlKey||d.metaKey){Blockly.selected&&Blockly.selected.isDeletable()&&Blockly.selected.isMovable()&&(67==d.keyCode?(Blockly.hideChaff(),Blockly.copy_(Blockly.selected)):88==d.keyCode&&(Blockly.copy_(Blockly.selected),c=!0)),86==d.keyCode?Blockly.clipboardXml_&&(Blockly.Events.setGroup(!0),Blockly.clipboardSource_.paste(Blockly.clipboardXml_),Blockly.Events.setGroup(!1)):90==d.keyCode&&(Blockly.hideChaff(),Blockly.mainWorkspace.undo(d.shiftKey))}}}c&&(Blockly.Events.setGroup(!0),Blockly.hideChaff(),Blockly.selected.dispose(Blockly.dragMode_!=Blockly.DRAG_FREE,!0),Blockly.highlightedConnection_&&(Blockly.highlightedConnection_.unhighlight(),Blockly.highlightedConnection_=null),Blockly.Events.setGroup(!1))}};Blockly.terminateDrag_=function(){Blockly.BlockSvg.terminateDrag();Blockly.Flyout.terminateDrag_()};Blockly.copy_=function(e){var d=Blockly.Xml.blockToDom(e);Blockly.dragMode_!=Blockly.DRAG_FREE&&Blockly.Xml.deleteNext(d);var f=e.getRelativeToSurfaceXY();d.setAttribute("x",e.RTL?-f.x:f.x);d.setAttribute("y",f.y);Blockly.clipboardXml_=d;Blockly.clipboardSource_=e.workspace};Blockly.duplicate_=function(e){var d=Blockly.clipboardXml_,f=Blockly.clipboardSource_;Blockly.copy_(e);e.workspace.paste(Blockly.clipboardXml_);Blockly.clipboardXml_=d;Blockly.clipboardSource_=f};Blockly.onContextMenu_=function(b){Blockly.utils.isTargetInput(b)||b.preventDefault()};Blockly.hideChaff=function(b){Blockly.Tooltip.hide();Blockly.WidgetDiv.hide();b||(b=Blockly.getMainWorkspace(),b.toolbox_&&b.toolbox_.flyout_&&b.toolbox_.flyout_.autoClose&&b.toolbox_.clearSelection())};Blockly.addChangeListener=function(b){console.warn("Deprecated call to Blockly.addChangeListener, use workspace.addChangeListener instead.");return Blockly.getMainWorkspace().addChangeListener(b)};Blockly.getMainWorkspace=function(){return Blockly.mainWorkspace};Blockly.alert=function(d,c){window.alert(d);c&&c()};Blockly.confirm=function(d,c){c(window.confirm(d))};Blockly.prompt=function(e,d,f){f(window.prompt(e,d))};Blockly.jsonInitFactory_=function(b){return function(){this.jsonInit(b)}};Blockly.defineBlocksWithJsonArray=function(f){for(var e=0,h;h=f[e];e++){var g=h.type;null==g||""===g?console.warn("Block definition #"+e+" in JSON array is missing a type attribute. Skipping."):(Blockly.Blocks[g]&&console.warn("Block definition #"+e+' in JSON array overwrites prior definition of "'+g+'".'),Blockly.Blocks[g]={init:Blockly.jsonInitFactory_(h)})}};Blockly.bindEventWithChecks_=function(v,u,t,s,r){var q=!1,o=function(d){var c=!r;d=Blockly.Touch.splitEventByTouches(d);for(var f=0,e;e=d[f];f++){if(!c||Blockly.Touch.shouldHandleEvent(e)){Blockly.Touch.setClientFromTouch(e),t?s.call(t,e):s(e),q=!0}}};v.addEventListener(u,o,!1);var m=[[v,u,o]];if(u in Blockly.Touch.TOUCH_MAP){for(var l=function(b){o(b);q&&b.preventDefault()},j=0,i;i=Blockly.Touch.TOUCH_MAP[u][j];j++){v.addEventListener(i,l,!1),m.push([v,i,l])}}return m};Blockly.bindEvent_=function(r,q,p,o){var n=function(b){p?o.call(p,b):o(b)};r.addEventListener(q,n,!1);var m=[[r,q,n]];if(q in Blockly.Touch.TOUCH_MAP){for(var l=function(d){if(1==d.changedTouches.length){var c=d.changedTouches[0];d.clientX=c.clientX;d.clientY=c.clientY}n(d);d.preventDefault()},j=0,i;i=Blockly.Touch.TOUCH_MAP[q][j];j++){r.addEventListener(i,l,!1),m.push([r,i,l])}}return m};Blockly.unbindEvent_=function(e){for(;e.length;){var d=e.pop(),f=d[2];d[0].removeEventListener(d[1],f,!1)}return f};Blockly.isNumber=function(b){return !!b.match(/^\s*-?\d+(\.\d+)?\s*$/)};goog.global.console||(goog.global.console={log:function(){},warn:function(){}});goog.global.Blockly||(goog.global.Blockly={});goog.global.Blockly.getMainWorkspace=Blockly.getMainWorkspace;goog.global.Blockly.addChangeListener=Blockly.addChangeListener;"use strict";Blockly.Blocks.io={};Blockly.Blocks.io.HUE=260;Blockly.Blocks.io.helper={getDigitalPins:function(){var d=[],c;for(c in Code.status.maps.digitalPins){d.push([Code.status.maps.digitalPins[c][3]+" - "+Code.status.maps.digitalPins[c][0].replace(/pio\.P/i,"").replace(/_/i,""),c])}return d},getInputDigitalPins:function(){var d=[],c;for(c in Code.status.maps.digitalPins){Code.status.maps.digitalPins[c][1]&&d.push([Code.status.maps.digitalPins[c][3]+" - "+Code.status.maps.digitalPins[c][0].replace(/pio\.P/i,"").replace(/_/i,""),c])}return d},getOutputDigitalPins:function(){var d=[],c;for(c in Code.status.maps.digitalPins){Code.status.maps.digitalPins[c][2]&&d.push([Code.status.maps.digitalPins[c][3]+" - "+Code.status.maps.digitalPins[c][0].replace(/pio\.P/i,"").replace(/_/i,""),c])}return d},getInputOutputDigitalPins:function(){var d=[],c;for(c in Code.status.maps.digitalPins){Code.status.maps.digitalPins[c][1]&&Code.status.maps.digitalPins[c][2]&&d.push([Code.status.maps.digitalPins[c][3]+" - "+Code.status.maps.digitalPins[c][0].replace(/pio\.P/i,"").replace(/_/i,""),c])}return d},getAnalogPins:function(){var d=[],c;for(c in Code.status.maps.analogPins){d.push([Code.status.maps.analogPins[c][1]+" - "+Code.status.maps.analogPins[c][0].replace(/pio\.P/i,"").replace(/_/i,""),c])}return d},getExternalAdcUnits:function(){var d=[],c;for(c in Code.status.maps.externalAdcUnits){Code.status.externalADC[Code.status.maps.externalAdcUnits[c][0]]&&d.push([Code.status.maps.externalAdcUnits[c][0],c])}return d},getExternalAdcChannels:function(e){var d=[],f;for(f=0;f<Code.status.maps.externalAdcUnits[e][1];f++){Code.status.externalADC[Code.status.maps.externalAdcUnits[e][0]]&&d.push(["channel%1".replace("%1",String(f)),f.toString()])}return d},getPwmPins:function(){var d=[],c;for(c in Code.status.maps.pwmPins){d.push([Code.status.maps.pwmPins[c][1]+" - "+Code.status.maps.pwmPins[c][0].replace(/pio\.P/i,"").replace(/_/i,""),c])}return d},getUARTUnits:function(){var d=[],c;for(c in Code.status.maps.uartUnits){d.push([Code.status.maps.uartUnits[c][0],c])}return d}};Blockly.Blocks.output_digital_pin={module:"pio",init:function(){var b=Blockly.Blocks.io.helper.getOutputDigitalPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"PIN");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.output_digital_pin_sel={module:"pio",init:function(){var b=Blockly.Blocks.io.helper.getOutputDigitalPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.OUTPUT_PINS).appendField(new Blockly.FieldDropdown(b),"PIN");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.input_digital_pin={module:"pio",init:function(){var b=Blockly.Blocks.io.helper.getInputDigitalPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"PIN");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.input_digital_pin_sel={module:"pio",init:function(){var b=Blockly.Blocks.io.helper.getInputDigitalPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.INPUT_PINS).appendField(new Blockly.FieldDropdown(b),"PIN");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.pwm_pins={module:"pwm",init:function(){var b=Blockly.Blocks.io.helper.getPwmPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"PIN");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.pwm_pins_sel={module:"pwm",init:function(){var b=Blockly.Blocks.io.helper.getPwmPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.PWM_PINS).appendField(new Blockly.FieldDropdown(b),"PIN");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.analog_pins={module:"adc",init:function(){var b=Blockly.Blocks.io.helper.getAnalogPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"PIN");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.analog_pins_sel={module:"adc",init:function(){var b=Blockly.Blocks.io.helper.getAnalogPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.ANALOG_PINS).appendField(new Blockly.FieldDropdown(b),"PIN");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.uart_units={module:"uart",init:function(){var b=Blockly.Blocks.io.helper.getUARTUnits();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"UNIT");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.external_analog_units={module:"adc",init:function(){var b=Blockly.Blocks.io.helper.getExternalAdcUnits();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"UNIT");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")},onchange:function(d){if(this.workspace.isDragging&&!this.workspace.isDragging()&&"UNIT"==d.name&&(d=this.getFieldValue("UNIT"))){var c=this.parentBlock_.childBlocks_[1].getField("CHANNEL");c.menuGenerator_=Blockly.Blocks.io.helper.getExternalAdcChannels(d);c.setText("channel0");c.setValue("0")}}};Blockly.Blocks.external_analog_channels={module:"adc",init:function(){var b=Blockly.Blocks.io.helper.getExternalAdcUnits(),b=Blockly.Blocks.io.helper.getExternalAdcChannels(b[0][1]);this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"CHANNEL");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")}};Blockly.Blocks.setpwmpin={module:"pwm",init:function(){Blockly.Blocks.io.helper.getPwmPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.setpwmpin);this.appendValueInput("PIN").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.FREQUENCY);this.appendValueInput("FREQUENCY").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.HERTZS).appendField(Blockly.Msg.DUTY);this.appendValueInput("DUTY").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.PERCENT);this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("");this.updateBoardAtFieldChange("PIN");this.updateBoardAtFieldChange("FREQUENCY");this.updateBoardAtFieldChange("DUTY");this.updateBoardAtFieldChange("NUM")}};Blockly.Blocks.setdigitalpin={module:"pio",init:function(){Blockly.Blocks.io.helper.getOutputDigitalPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.setdigitalpin);this.appendValueInput("PIN").setCheck("Number");this.appendDummyInput().appendField(" "+Blockly.Msg.TO+" ").appendField(new Blockly.FieldDropdown([[Blockly.Msg.HIGH,"1"],[Blockly.Msg.LOW,"0"]]),"VALUE");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("");this.updateBoardAtFieldChange("PIN");this.updateBoardAtFieldChange("VALUE")}};Blockly.Blocks.invertdigitalpin={module:"pio",init:function(){Blockly.Blocks.io.helper.getOutputDigitalPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.invertdigitalpin);this.appendValueInput("PIN").setCheck("Number");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("");this.updateBoardAtFieldChange("PIN");this.updateBoardAtFieldChange("VALUE")}};Blockly.Blocks.getdigitalpin={module:"pio",init:function(){Blockly.Blocks.io.helper.getInputDigitalPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.getdigitalpin);this.appendValueInput("PIN").setCheck("Number");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")},hasWatcher:!0};Blockly.Blocks.getanalogpin={module:"adc",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.getanalogpin);this.appendValueInput("PIN").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.IN).appendField(new Blockly.FieldDropdown([["mvolts","mvolts"],["raw","raw"]]),"FORMAT");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")},hasWatcher:!0};Blockly.Blocks.getexternalanalogchannel={module:"adc",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.getexternalanalogchannel);this.appendValueInput("UNIT").setCheck("Number");this.appendValueInput("CHANNEL").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.IN).appendField(new Blockly.FieldDropdown([["mvolts","mvolts"],["raw","raw"]]),"FORMAT");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip("")},hasWatcher:!0};Blockly.Blocks.when_digital_pin={module:"pio",init:function(){Blockly.Blocks.io.helper.getInputDigitalPins();this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.EVENT_WHEN_DIGITAL_PIN);this.appendValueInput("PIN").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.EVENT_WHEN_DIGITAL_CHANGES).appendField(new Blockly.FieldDropdown([[Blockly.Msg.positive_edge,"IntrPosEdge"],[Blockly.Msg.negative_edge,"IntrNegEdge"],[Blockly.Msg.any_edge,"IntrAnyEdge"],[Blockly.Msg.low_level,"IntrLowLevel"],[Blockly.Msg.high_level,"IntrHighLevel"]]),"WHEN");this.appendStatementInput("DO").appendField(Blockly.Msg.DO).setAlign(Blockly.ALIGN_RIGHT);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.io.HUE);this.setTooltip(Blockly.Msg.EVENT_WHEN_DIGITAL_PIN_TOOLTIP)},onchange:function(e){if(this.workspace.isDragging&&!this.workspace.isDragging()){e=0;for(var d=this.workspace.getTopBlocks(!0),f=0;d[f];f++){d[f].getFieldValue("PIN")==this.getFieldValue("PIN")&&d[f].type==this.type&&e++}1<e?(this.setWarningText(Blockly.Msg.WARNING_EVENTS_CAN_ONLY_PROCESSED_IN_ONE_EVENT_BLOCK),this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0)):(this.setWarningText(null),this.isInFlyout||this.setDisabled(!1))}}};"use strict";Blockly.Blocks.i2c={};Blockly.Blocks.i2c.HUE=20;Blockly.Blocks.i2csetspeed={module:"i2c",init:function(){var d=[],c;for(c in Code.status.maps.i2cUnits){d.push([Code.status.maps.i2cUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.i2cSetSpeedFor).appendField(new Blockly.FieldDropdown(d),"MODULE");this.appendDummyInput().appendField(Blockly.Msg.i2cSpeed);this.appendValueInput("SPEED").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.hz);this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.i2c.HUE);this.setTooltip("")}};Blockly.Blocks.i2cstartcondition={module:"i2c",init:function(){var d=[],c;for(c in Code.status.maps.i2cUnits){d.push([Code.status.maps.i2cUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.i2cStartConditionFor).appendField(new Blockly.FieldDropdown(d),"MODULE");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.i2c.HUE);this.setTooltip("")}};Blockly.Blocks.i2cstopcondition={module:"i2c",init:function(){var d=[],c;for(c in Code.status.maps.i2cUnits){d.push([Code.status.maps.i2cUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.i2cStopConditionFor).appendField(new Blockly.FieldDropdown(d),"MODULE");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.i2c.HUE);this.setTooltip("")}};Blockly.Blocks.i2caddress={module:"i2c",init:function(){var d=[],c;for(c in Code.status.maps.i2cUnits){d.push([Code.status.maps.i2cUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.i2cAddress).appendField(new Blockly.FieldDropdown(d),"MODULE");this.appendValueInput("ADDRESS").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg["for"]).appendField(new Blockly.FieldDropdown([[Blockly.Msg.read,"read"],[Blockly.Msg.write,"write"]]),"DIRECTION");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.i2c.HUE);this.setTooltip("")}};Blockly.Blocks.i2cread={module:"i2c",init:function(){var d=[],c;for(c in Code.status.maps.i2cUnits){d.push([Code.status.maps.i2cUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.i2cReadFrom).appendField(new Blockly.FieldDropdown(d),"MODULE");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.i2c.HUE);this.setTooltip("")}};Blockly.Blocks.i2cwrite={module:"i2c",init:function(){var d=[],c;for(c in Code.status.maps.i2cUnits){d.push([Code.status.maps.i2cUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.i2cWriteTo).appendField(new Blockly.FieldDropdown(d),"MODULE");this.appendValueInput("VALUE").setCheck("Number");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.i2c.HUE);this.setTooltip("")}};"use strict";Blockly.Blocks.control={};Blockly.Blocks.control.HUE=290;Blockly.Blocks.wait_for={module:"tmr",init:function(){this.appendDummyInput().appendField(Blockly.Msg.wait_for);this.appendValueInput("TIME").setCheck("Number");this.appendDummyInput().appendField(new Blockly.FieldDropdown([[Blockly.Msg.microseconds,"microseconds"],[Blockly.Msg.milliseconds,"milliseconds"],[Blockly.Msg.seconds,"seconds"]]),"units");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.control.HUE);this.setTooltip("")}};Blockly.Blocks.cpu_sleep={module:"os",init:function(){this.appendDummyInput().appendField(Blockly.Msg.CPU_SLEEP);this.appendValueInput("SECONDS").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.seconds);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.control.HUE);this.setTooltip("")}};"use strict";Blockly.Blocks.events={};Blockly.Blocks.events.HUE=290;Blockly.Blocks.when_board_starts={module:"event",init:function(){this.appendDummyInput().appendField(Blockly.Msg.EVENT_WHEN_BOARD_STARTS);this.appendStatementInput("DO").appendField(Blockly.Msg.DO).setAlign(Blockly.ALIGN_RIGHT);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.events.HUE);this.setTooltip(Blockly.Msg.EVENT_WHEN_BOARD_STARTS_TOOLTIP)},onchange:function(e){if(this.workspace.isDragging&&!this.workspace.isDragging()){if("undefined"!=typeof e.element&&null!=this.warning&&"disabled"==e.element&&e.blockId==this.id){this.setDisabled(!0)}else{"undefined"!=typeof e.element&&"disabled"==e.element&&e.newValue!=e.oldValue&&e.blockId==this.id&&(this.disabledByUser=e.newValue);e=0;for(var d=this.workspace.getTopBlocks(!0),f=0;d[f];f++){d[f].type==this.type&&e++}1<e?(this.setWarningText(Blockly.Msg.WARNING_ONLY_ONE_INSTANCE_ALLOWED),this.isInFlyout||this.setDisabled(!0)):(e=null!=this.warning,this.setWarningText(null),!this.isInFlyout&&e&("undefined"==typeof this.disabledByUser?1:!this.disabledByUser)?this.setDisabled(!1):"undefined"!=typeof this.disabledByUser&&this.setDisabled(this.disabledByUser))}}},section:function(){return"start"}};Blockly.Blocks.thread={module:"event",init:function(){this.appendStatementInput("DO").appendField(Blockly.Msg.FOREVER).setAlign(Blockly.ALIGN_RIGHT);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.events.HUE);this.setTooltip(Blockly.Msg.EVENT_THREAD_TOOLTIP)}};Blockly.Blocks.when_i_receive={module:"event",init:function(){this.appendDummyInput().appendField(Blockly.Msg.EVENT_WHEN_I_RECEIVE).appendField(new Blockly.wc.FieldEvent(Blockly.Msg.DEFAULT_EVENT),"WHEN");this.appendStatementInput("DO").appendField(Blockly.Msg.DO).setAlign(Blockly.ALIGN_RIGHT);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.events.HUE);this.setTooltip(Blockly.Msg.EVENT_WHEN_I_RECEIVE_TOOLTIP)},onchange:function(e){if(this.workspace.isDragging&&!this.workspace.isDragging()){if("undefined"!=typeof e.element&&null!=this.warning&&"disabled"==e.element&&e.blockId==this.id){this.setDisabled(!0)}else{"undefined"!=typeof e.element&&"disabled"==e.element&&e.newValue!=e.oldValue&&e.blockId==this.id&&(this.disabledByUser=e.newValue);e=0;for(var d=this.workspace.getTopBlocks(!0),f=0;d[f];f++){d[f].getFieldValue("WHEN")==this.getFieldValue("WHEN")&&d[f].type==this.type&&e++}1<e?(this.setWarningText(Blockly.Msg.WARNING_EVENTS_CAN_ONLY_PROCESSED_IN_ONE_EVENT_BLOCK),this.isInFlyout||this.setDisabled(!0)):(e=null!=this.warning,this.setWarningText(null),!this.isInFlyout&&e&("undefined"==typeof this.disabledByUser?1:!this.disabledByUser)?this.setDisabled(!1):"undefined"!=typeof this.disabledByUser&&this.setDisabled(this.disabledByUser))}}}};Blockly.Blocks.broadcast={module:"event",init:function(){this.appendDummyInput().appendField(Blockly.Msg.EVENT_BROADCAST).appendField(new Blockly.wc.FieldEvent(Blockly.Msg.DEFAULT_EVENT),"WHEN");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.events.HUE);this.setTooltip(Blockly.Msg.EVENT_BROADCAST_TOOLTIP)}};Blockly.Blocks.broadcast_and_wait={module:"event",init:function(){this.appendDummyInput().appendField(Blockly.Msg.EVENT_BROADCAST).appendField(new Blockly.wc.FieldEvent(Blockly.Msg.DEFAULT_EVENT),"WHEN").appendField(Blockly.Msg.EVENT_BROADCAST_AND_WAIT);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.events.HUE);this.setTooltip(Blockly.Msg.EVENT_BROADCAST_AND_WAIT_TOOLTIP)}};Blockly.Blocks.event_is_being_processed={module:"event",init:function(){this.appendDummyInput().appendField(Blockly.Msg.EVENT_IS_BEING_PROCESSED_P).appendField(new Blockly.wc.FieldEvent(Blockly.Msg.DEFAULT_EVENT),"WHEN").appendField(Blockly.Msg.EVENT_IS_BEING_PROCESSED);this.setOutput(!0,null);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.events.HUE);this.setTooltip(Blockly.Msg.EVENT_IS_BEING_PROCESSED_TOOLTIP)}};Blockly.Blocks.execute_every={module:"event",init:function(){this.appendDummyInput().appendField(Blockly.Msg.EVENT_EVERY);this.appendValueInput("TIME").setCheck("Number");this.appendDummyInput().appendField(new Blockly.FieldDropdown([[Blockly.Msg.milliseconds,"milliseconds"],[Blockly.Msg.seconds,"seconds"]]),"units");this.appendStatementInput("DO").appendField(Blockly.Msg.DO).setAlign(Blockly.ALIGN_RIGHT);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.events.HUE);this.setTooltip(Blockly.Msg.EVENT_EVERY_TOOLTIP)}};"use strict";Blockly.Blocks.variables={};Blockly.Blocks.variables.HUE=330;Blockly.Blocks.variables_get={init:function(){this.setHelpUrl(Blockly.Msg.VARIABLES_GET_HELPURL);this.setColour(Blockly.Blocks.variables.HUE);this.appendDummyInput().appendField(new Blockly.FieldVariable(Blockly.Msg.VARIABLES_DEFAULT_NAME),"VAR");this.setOutput(!0);this.setTooltip(Blockly.Msg.VARIABLES_GET_TOOLTIP);this.contextMenuMsg_=Blockly.Msg.VARIABLES_GET_CREATE_SET},contextMenuType_:"variables_set",customContextMenu:function(e){var d={enabled:!0},f=this.getFieldValue("VAR");d.text=this.contextMenuMsg_.replace("%1",f);f=goog.dom.createDom("field",null,f);f.setAttribute("name","VAR");f=goog.dom.createDom("block",null,f);f.setAttribute("type",this.contextMenuType_);d.callback=Blockly.ContextMenu.callbackFactory(this,f);e.push(d)}};Blockly.Blocks.variables_set={init:function(){this.jsonInit({message0:Blockly.Msg.VARIABLES_SET,args0:[{type:"field_variable",name:"VAR",variable:Blockly.Msg.VARIABLES_DEFAULT_NAME},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,colour:Blockly.Blocks.variables.HUE,tooltip:Blockly.Msg.VARIABLES_SET_TOOLTIP,helpUrl:Blockly.Msg.VARIABLES_SET_HELPURL});this.contextMenuMsg_=Blockly.Msg.VARIABLES_SET_CREATE_GET},contextMenuType_:"variables_get",customContextMenu:Blockly.Blocks.variables_get.customContextMenu};"use strict";Blockly.Blocks.logic={};Blockly.Blocks.constant={};Blockly.Blocks.logic.HUE=210;Blockly.Blocks.controls_if={init:function(){this.setHelpUrl(Blockly.Msg.CONTROLS_IF_HELPURL);this.setColour(Blockly.Blocks.logic.HUE);this.appendValueInput("IF0").setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_IF);this.appendStatementInput("DO0").appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setMutator(new Blockly.Mutator(["controls_if_elseif","controls_if_else"]));var b=this;this.setTooltip(function(){if(b.elseifCount_||b.elseCount_){if(!b.elseifCount_&&b.elseCount_){return Blockly.Msg.CONTROLS_IF_TOOLTIP_2}if(b.elseifCount_&&!b.elseCount_){return Blockly.Msg.CONTROLS_IF_TOOLTIP_3}if(b.elseifCount_&&b.elseCount_){return Blockly.Msg.CONTROLS_IF_TOOLTIP_4}}else{return Blockly.Msg.CONTROLS_IF_TOOLTIP_1}return""});this.elseCount_=this.elseifCount_=0},mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_){return null}var b=document.createElement("mutation");this.elseifCount_&&b.setAttribute("elseif",this.elseifCount_);this.elseCount_&&b.setAttribute("else",1);return b},domToMutation:function(b){this.elseifCount_=parseInt(b.getAttribute("elseif"),10)||0;this.elseCount_=parseInt(b.getAttribute("else"),10)||0;this.updateShape_()},decompose:function(g){var f=g.newBlock("controls_if_if");f.initSvg();for(var j=f.nextConnection,i=1;i<=this.elseifCount_;i++){var h=g.newBlock("controls_if_elseif");h.initSvg();j.connect(h.previousConnection);j=h.nextConnection}this.elseCount_&&(g=g.newBlock("controls_if_else"),g.initSvg(),j.connect(g.previousConnection));return f},compose:function(f){var e=f.nextConnection.targetBlock();this.elseCount_=this.elseifCount_=0;f=[null];for(var h=[null],g=null;e;){switch(e.type){case"controls_if_elseif":this.elseifCount_++;f.push(e.valueConnection_);h.push(e.statementConnection_);break;case"controls_if_else":this.elseCount_++;g=e.statementConnection_;break;default:throw"Unknown block type."}e=e.nextConnection&&e.nextConnection.targetBlock()}this.updateShape_();for(e=1;e<=this.elseifCount_;e++){Blockly.Mutator.reconnect(f[e],this,"IF"+e),Blockly.Mutator.reconnect(h[e],this,"DO"+e)}Blockly.Mutator.reconnect(g,this,"ELSE")},saveConnections:function(f){f=f.nextConnection.targetBlock();for(var e=1;f;){switch(f.type){case"controls_if_elseif":var h=this.getInput("IF"+e),g=this.getInput("DO"+e);f.valueConnection_=h&&h.connection.targetConnection;f.statementConnection_=g&&g.connection.targetConnection;e++;break;case"controls_if_else":g=this.getInput("ELSE");f.statementConnection_=g&&g.connection.targetConnection;break;default:throw"Unknown block type."}f=f.nextConnection&&f.nextConnection.targetBlock()}},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var b=1;this.getInput("IF"+b);){this.removeInput("IF"+b),this.removeInput("DO"+b),b++}for(b=1;b<=this.elseifCount_;b++){this.appendValueInput("IF"+b).setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+b).appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN)}this.elseCount_&&this.appendStatementInput("ELSE").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSE)}};Blockly.Blocks.controls_if_if={init:function(){this.setColour(Blockly.Blocks.logic.HUE);this.appendDummyInput().appendField(Blockly.Msg.CONTROLS_IF_IF_TITLE_IF);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.CONTROLS_IF_IF_TOOLTIP);this.contextMenu=!1}};Blockly.Blocks.controls_if_elseif={init:function(){this.setColour(Blockly.Blocks.logic.HUE);this.appendDummyInput().appendField(Blockly.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.CONTROLS_IF_ELSEIF_TOOLTIP);this.contextMenu=!1}};Blockly.Blocks.controls_if_else={init:function(){this.setColour(Blockly.Blocks.logic.HUE);this.appendDummyInput().appendField(Blockly.Msg.CONTROLS_IF_ELSE_TITLE_ELSE);this.setPreviousStatement(!0);this.setTooltip(Blockly.Msg.CONTROLS_IF_ELSE_TOOLTIP);this.contextMenu=!1}};Blockly.Blocks.controls_ifelse={init:function(){this.jsonInit({message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,colour:Blockly.Blocks.logic.HUE,tooltip:Blockly.Msg.CONTROLS_IF_TOOLTIP_2,helpUrl:Blockly.Msg.CONTROLS_IF_HELPURL})}};Blockly.Blocks.logic_compare={init:function(){var e=[["=","EQ"],["\u2260","NEQ"],["\u200f<\u200f","LT"],["\u200f\u2264\u200f","LTE"],["\u200f>\u200f","GT"],["\u200f\u2265\u200f","GTE"]],d=[["=","EQ"],["\u2260","NEQ"],["<","LT"],["\u2264","LTE"],[">","GT"],["\u2265","GTE"]],e=this.RTL?e:d;this.setHelpUrl(Blockly.Msg.LOGIC_COMPARE_HELPURL);this.setColour(Blockly.Blocks.operators.HUE);this.setOutput(!0,"Boolean");this.appendValueInput("A");this.appendValueInput("B").appendField(new Blockly.FieldDropdown(e),"OP");this.setInputsInline(!0);var f=this;this.setTooltip(function(){var b=f.getFieldValue("OP");return{EQ:Blockly.Msg.LOGIC_COMPARE_TOOLTIP_EQ,NEQ:Blockly.Msg.LOGIC_COMPARE_TOOLTIP_NEQ,LT:Blockly.Msg.LOGIC_COMPARE_TOOLTIP_LT,LTE:Blockly.Msg.LOGIC_COMPARE_TOOLTIP_LTE,GT:Blockly.Msg.LOGIC_COMPARE_TOOLTIP_GT,GTE:Blockly.Msg.LOGIC_COMPARE_TOOLTIP_GTE}[b]});this.prevBlocks_=[null,null]},onchange:function(f){var e=this.getInputTargetBlock("A"),h=this.getInputTargetBlock("B");if(e&&h&&!e.outputConnection.checkType_(h.outputConnection)){Blockly.Events.setGroup(f.group);for(f=0;f<this.prevBlocks_.length;f++){var g=this.prevBlocks_[f];if(g===e||g===h){g.unplug(),g.bumpNeighbours_()}}Blockly.Events.setGroup(!1)}this.prevBlocks_[0]=e;this.prevBlocks_[1]=h}};Blockly.Blocks.logic_operation={init:function(){var d=[[Blockly.Msg.LOGIC_OPERATION_AND,"AND"],[Blockly.Msg.LOGIC_OPERATION_OR,"OR"]];this.setHelpUrl(Blockly.Msg.LOGIC_OPERATION_HELPURL);this.setColour(Blockly.Blocks.operators.HUE);this.setOutput(!0,"Boolean");this.appendValueInput("A").setCheck("Boolean");this.appendValueInput("B").setCheck("Boolean").appendField(new Blockly.FieldDropdown(d),"OP");this.setInputsInline(!0);var c=this;this.setTooltip(function(){var b=c.getFieldValue("OP");return{AND:Blockly.Msg.LOGIC_OPERATION_TOOLTIP_AND,OR:Blockly.Msg.LOGIC_OPERATION_TOOLTIP_OR}[b]})}};Blockly.Blocks.logic_negate={init:function(){this.jsonInit({message0:Blockly.Msg.LOGIC_NEGATE_TITLE,args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",colour:Blockly.Blocks.operators.HUE,tooltip:Blockly.Msg.LOGIC_NEGATE_TOOLTIP,helpUrl:Blockly.Msg.LOGIC_NEGATE_HELPURL})}};Blockly.Blocks.logic_boolean={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[[Blockly.Msg.LOGIC_BOOLEAN_TRUE,"TRUE"],[Blockly.Msg.LOGIC_BOOLEAN_FALSE,"FALSE"]]}],output:"Boolean",colour:Blockly.Blocks.constant.HUE,tooltip:Blockly.Msg.LOGIC_BOOLEAN_TOOLTIP,helpUrl:Blockly.Msg.LOGIC_BOOLEAN_HELPURL})}};Blockly.Blocks.logic_null={init:function(){this.jsonInit({message0:Blockly.Msg.LOGIC_NULL,output:null,colour:Blockly.Blocks.constant.HUE,tooltip:Blockly.Msg.LOGIC_NULL_TOOLTIP,helpUrl:Blockly.Msg.LOGIC_NULL_HELPURL})}};Blockly.Blocks.logic_ternary={init:function(){this.setHelpUrl(Blockly.Msg.LOGIC_TERNARY_HELPURL);this.setColour(Blockly.Blocks.logic.HUE);this.appendValueInput("IF").setCheck("Boolean").appendField(Blockly.Msg.LOGIC_TERNARY_CONDITION);this.appendValueInput("THEN").appendField(Blockly.Msg.LOGIC_TERNARY_IF_TRUE);this.appendValueInput("ELSE").appendField(Blockly.Msg.LOGIC_TERNARY_IF_FALSE);this.setOutput(!0);this.setTooltip(Blockly.Msg.LOGIC_TERNARY_TOOLTIP);this.prevParentConnection_=null},onchange:function(h){var g=this.getInputTargetBlock("THEN"),l=this.getInputTargetBlock("ELSE"),k=this.outputConnection.targetConnection;if((g||l)&&k){for(var j=0;2>j;j++){var i=1==j?g:l;i&&!i.outputConnection.checkType_(k)&&(Blockly.Events.setGroup(h.group),k===this.prevParentConnection_?(this.unplug(),k.getSourceBlock().bumpNeighbours_()):(i.unplug(),i.bumpNeighbours_()),Blockly.Events.setGroup(!1))}}this.prevParentConnection_=k}};"use strict";Blockly.Blocks.MQTT={};Blockly.Blocks.MQTT.HUE=20;Blockly.Blocks.mqtt_publish={module:"mqtt",init:function(){this.appendDummyInput().appendField(Blockly.Msg.MQTT_PUBLISH);this.appendValueInput("PAYLOAD").setCheck(null);this.appendValueInput("TOPIC").setCheck(null).appendField(Blockly.Msg.MQTT_TO_TOPIC);this.appendDummyInput().appendField(Blockly.Msg.MQTT_QOS).appendField(new Blockly.FieldDropdown([["QOS0","0"],["QOS1","1"],["QOS2","2"]]),"QOS");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.MQTT.HUE);this.setTooltip("")},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("clientid",this.clientid);b.setAttribute("host",this.host);b.setAttribute("port",this.port);b.setAttribute("secure",this.secure);b.setAttribute("username",this.username);b.setAttribute("password",this.password);return b},domToMutation:function(b){this.clientid=b.getAttribute("clientid");this.host=b.getAttribute("host");this.port=b.getAttribute("port");this.secure=b.getAttribute("secure");this.username=b.getAttribute("username");this.password=b.getAttribute("password");this.updateShape_()},updateShape_:function(){this.configureMQTT(this)},configureMQTT:function(b){b.workspace.configureMQTT({clientid:b.clientid,host:b.host,port:b.port,secure:b.secure,username:b.username,password:b.password})}};Blockly.Blocks.mqtt_subscribe={module:"mqtt",init:function(){this.appendDummyInput().appendField(Blockly.Msg.MQTT_SUBSCRIBE);this.appendValueInput("TOPIC").setCheck(null);this.appendDummyInput().appendField(Blockly.Msg.MQTT_QOS).appendField(new Blockly.FieldDropdown([["QOS0","0"],["QOS1","1"],["QOS2","2"]]),"QOS").appendField(Blockly.Msg.PROCEDURES_BEFORE_PARAMS+" length, payload");this.appendStatementInput("DO").setCheck(null);this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(230);this.setTooltip("");this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.MQTT.HUE);this.setTooltip("")},onchange:function(e){if(this.workspace.isDragging&&!this.workspace.isDragging()){e=0;for(var d=this.workspace.getTopBlocks(!0),f=0;d[f];f++){Blockly.Lua.valueToCode(d[f],"TOPIC",Blockly.Lua.ORDER_NONE)==Blockly.Lua.valueToCode(this,"TOPIC",Blockly.Lua.ORDER_NONE)&&d[f].type==this.type&&e++}1<e?(this.setWarningText(Blockly.Msg.WARNING_EVENTS_CAN_ONLY_PROCESSED_IN_ONE_EVENT_BLOCK),this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0)):(this.setWarningText(null),this.isInFlyout||this.setDisabled(!1))}},section:function(){return"default"},configureMQTT:Blockly.Blocks.mqtt_publish.configureMQTT,mutationToDom:Blockly.Blocks.mqtt_publish.mutationToDom,domToMutation:Blockly.Blocks.mqtt_publish.domToMutation,updateShape_:Blockly.Blocks.mqtt_publish.updateShape_,customContextMenu:function(e){if(!this.isCollapsed()){var d={enabled:!0},f="length";d.text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1",f);f=goog.dom.createDom("field",null,f);f.setAttribute("name","VAR");f=goog.dom.createDom("block",null,f);f.setAttribute("type","variables_get");d.callback=Blockly.ContextMenu.callbackFactory(this,f);e.push(d);d={enabled:!0};f="payload";d.text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1",f);f=goog.dom.createDom("field",null,f);f.setAttribute("name","VAR");f=goog.dom.createDom("block",null,f);f.setAttribute("type","variables_get");d.callback=Blockly.ContextMenu.callbackFactory(this,f);e.push(d)}}};"use strict";Blockly.Blocks.Wifi={};Blockly.Blocks.Wifi.HUE=20;Blockly.Blocks.wifi_start={module:"net.wf",init:function(){this.appendDummyInput().appendField(Blockly.Msg.WIFI_START);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.Wifi.HUE);this.setTooltip("")},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("wtype",this.wtype);b.setAttribute("ssid",this.ssid);b.setAttribute("password",this.password);return b},domToMutation:function(b){this.wtype=b.getAttribute("wtype");this.ssid=b.getAttribute("ssid");this.password=b.getAttribute("password");this.updateShape_()},updateShape_:function(){this.configureWifi(this)},configureWifi:function(b){b.workspace.configureWifi({wtype:b.wtype,ssid:b.ssid,password:b.password})}};Blockly.Blocks.wifi_stop={module:"net.wf",init:function(){this.appendDummyInput().appendField(Blockly.Msg.WIFI_STOP);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.Wifi.HUE);this.setTooltip("")},configureWifi:Blockly.Blocks.wifi_start.configureWifi,mutationToDom:Blockly.Blocks.wifi_start.mutationToDom,domToMutation:Blockly.Blocks.wifi_start.domToMutation,updateShape_:Blockly.Blocks.wifi_start.updateShape_};"use strict";Blockly.Blocks.sensor={};Blockly.Blocks.sensor.HUE=290;Blockly.Blocks.sensor_attach={module:"sensor",createSensorIfNeeded:function(d){if("undefined"==typeof d.workspace.sensors){return -1}var c=d.workspace.sensorIndexOf(d.name);-1==c&&(d.workspace.createSensor(void 0,Blockly.Sensors.createSetupStructure(!1,d)),c=d.workspace.sensorIndexOf(d.name));return c},init:function(){this.setColour(Blockly.Blocks.sensor.HUE);this.appendDummyInput().appendField(Blockly.Msg.SENSOR_ATTACH,"NAME");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setTooltip(Blockly.Msg.SENSOR_ATTACH_TOOLTIP)},mutationToDom:function(){var d=document.createElement("mutation");d.setAttribute("interface",this["interface"]);d.setAttribute("name",this.name);d.setAttribute("sid",this.sid);for(var c=0;c<this["interface"].split(",").length;c++){d.setAttribute("interface"+c+"_unit",this["interface"+c+"_unit"]),d.setAttribute("interface"+c+"_subunit",this["interface"+c+"_subunit"]),d.setAttribute("interface"+c+"_device",this["interface"+c+"_device"])}return d},domToMutation:function(d){this["interface"]=d.getAttribute("interface");this.name=d.getAttribute("name");this.sid=d.getAttribute("sid");for(var c=0;c<this["interface"].split(",").length;c++){this["interface"+c+"_unit"]=d.getAttribute("interface"+c+"_unit"),this["interface"+c+"_subunit"]=d.getAttribute("interface"+c+"_subunit"),this["interface"+c+"_device"]=d.getAttribute("interface"+c+"_device")}this.updateShape_()},updateShape_:function(){this.createSensorIfNeeded(this);var b=this.sid;"undefined"!=typeof Blockly.Msg[b]&&(b=Blockly.Msg[b]);this.getField("NAME").setText(Blockly.Msg.SENSOR_ATTACH.replace("%1",this.name).replace("%2",b))},customContextMenu:function(d){var c=this;d.push({enabled:!0,text:Blockly.Msg.EDIT_SENSOR,callback:function(){Blockly.Sensors.edit(c);return !1}});d.push({enabled:!0,text:Blockly.Msg.REMOVE_SENSOR,callback:function(){Blockly.Sensors.remove(c);return !1}})}};Blockly.Blocks.sensor_read={module:"sensor",createSensorIfNeeded:Blockly.Blocks.sensor_attach.createSensorIfNeeded,init:function(){this.setColour(Blockly.Blocks.sensor.HUE);this.appendDummyInput().appendField(Blockly.Msg.SENSOR_READ1).appendField(new Blockly.FieldDropdown([["magnitude",""]]),"PROVIDES").appendField(Blockly.Msg.SENSOR_READ2,"NAME");this.setOutput(!0);this.setTooltip(Blockly.Msg.SENSOR_READ_TOOLTIP)},mutationToDom:Blockly.Blocks.sensor_attach.mutationToDom,domToMutation:Blockly.Blocks.sensor_attach.domToMutation,updateShape_:function(){var d=this.createSensorIfNeeded(this);if(-1!=d){var c=[];this.workspace.sensors.provides[d].forEach(function(b,e){c.push([b.id,b.id])});d=this.sid;"undefined"!=typeof Blockly.Msg[d]&&(d=Blockly.Msg[d]);this.getField("NAME").setText(Blockly.Msg.SENSOR_READ2.replace("%1",this.name).replace("%2",d));this.getField("PROVIDES").menuGenerator_=c}},customContextMenu:Blockly.Blocks.sensor_attach.customContextMenu,hasWatcher:!0};Blockly.Blocks.sensor_set={module:"sensor",createSensorIfNeeded:Blockly.Blocks.sensor_attach.createSensorIfNeeded,init:function(){this.setColour(Blockly.Blocks.sensor.HUE);this.appendDummyInput().appendField(Blockly.Msg.SENSOR_SET1).appendField(new Blockly.FieldDropdown([["",""]]),"PROPERTIES").appendField(Blockly.Msg.SENSOR_SET2);this.appendValueInput("VALUE");this.appendDummyInput().appendField("","NAME");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setTooltip(Blockly.Msg.SENSOR_SET_TOOLTIP)},mutationToDom:Blockly.Blocks.sensor_attach.mutationToDom,domToMutation:Blockly.Blocks.sensor_attach.domToMutation,updateShape_:function(){var d=this.createSensorIfNeeded(this);if(-1!=d){var c=[];this.workspace.sensors.properties[d].forEach(function(b,e){c.push([b.id,b.id])});d=this.sid;"undefined"!=typeof Blockly.Msg[d]&&(d=Blockly.Msg[d]);this.getField("NAME").setText(Blockly.Msg.SENSOR_SET3.replace("%1",this.name).replace("%2",d));this.getField("PROPERTIES").menuGenerator_=c}},customContextMenu:Blockly.Blocks.sensor_attach.customContextMenu};Blockly.Blocks.sensor_when={module:"sensor",createSensorIfNeeded:Blockly.Blocks.sensor_attach.createSensorIfNeeded,init:function(){this.setColour(Blockly.Blocks.sensor.HUE);this.appendDummyInput().appendField(Blockly.Msg.SENSOR_WHEN1).appendField(new Blockly.FieldDropdown([["magnitude",""]]),"PROVIDES").appendField(Blockly.Msg.SENSOR_WHEN2,"NAME");this.appendStatementInput("DO").appendField(Blockly.Msg.DO).setAlign(Blockly.ALIGN_RIGHT);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setTooltip(Blockly.Msg.SENSOR_WHEN_TOOLTIP)},mutationToDom:Blockly.Blocks.sensor_attach.mutationToDom,domToMutation:Blockly.Blocks.sensor_attach.domToMutation,updateShape_:function(){var d=this.createSensorIfNeeded(this);if(-1!=d){var c=[];this.workspace.sensors.provides[d].forEach(function(b,e){c.push([b.id,b.id])});d=this.sid;"undefined"!=typeof Blockly.Msg[d]&&(d=Blockly.Msg[d]);this.getField("NAME").setText(Blockly.Msg.SENSOR_WHEN2.replace("%1",this.name).replace("%2",d));this.getField("PROVIDES").menuGenerator_=c}},hasWatcher:!1,customContextMenu:function(f){var e=this;f.push({enabled:!0,text:Blockly.Msg.EDIT_SENSOR,callback:function(){Blockly.Sensors.edit(e);return !1}});f.push({enabled:!0,text:Blockly.Msg.REMOVE_SENSOR,callback:function(){Blockly.Sensors.remove(e);return !1}});if(!this.isCollapsed()){var h={enabled:!0};h.text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1","value");var g=goog.dom.createDom("field",null,"value");g.setAttribute("name","VAR");g=goog.dom.createDom("block",null,g);g.setAttribute("type","variables_get");h.callback=Blockly.ContextMenu.callbackFactory(this,g);f.push(h)}}};"use strict";Blockly.Blocks["try"]={};Blockly.Blocks["try"].HUE=290;Blockly.Blocks.exception_try_container={init:function(){this.setColour(Blockly.Blocks["try"].HUE);this.appendDummyInput().appendField(Blockly.Msg.TEXT_TRY_TITLE);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.TEXT_TRY_TITLE);this.contextMenu=!1;this.finallyCount_=0}};Blockly.Blocks.exception_try_finally={init:function(){this.setColour(Blockly.Blocks["try"].HUE);this.appendDummyInput().appendField(Blockly.Msg.TEXT_FINALLY);this.setPreviousStatement(!0);this.setNextStatement(!1);this.setTooltip(Blockly.Msg.TEXT_FINALLY);this.contextMenu=!0}};Blockly.Blocks.exception_try={init:function(){this.appendStatementInput("TRY0").appendField(Blockly.Msg.TEXT_TRY_TITLE).setAlign(Blockly.ALIGN_RIGHT);this.appendStatementInput("CATCH0").appendField(Blockly.Msg.TEXT_CATCH_TITLE).setAlign(Blockly.ALIGN_RIGHT);this.setTooltip(Blockly.Msg.TEXT_TRY_TOOLTIP);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setColour(Blockly.Blocks["try"].HUE);this.finallyCount_=0;this.setMutator(new Blockly.Mutator(["exception_try_finally"]))},mutationToDom:function(){if(!this.finallyCount_){return null}var b=document.createElement("mutation");this.finallyCount_&&b.setAttribute("finally",this.finallyCount_);return b},domToMutation:function(b){this.finallyCount_=parseInt(b.getAttribute("finally"),10)||0;this.updateShape_()},decompose:function(g){var f=g.newBlock("exception_try_container");f.initSvg();for(var j=f.nextConnection,i=1;i<=this.finallyCount_;i++){var h=g.newBlock("exception_try_finally");h.initSvg();j.connect(h.previousConnection);j=h.nextConnection}return f},compose:function(d){var c=d.nextConnection.targetBlock();this.finallyCount_=0;for(d=[null];c;){switch(c.type){case"exception_try_finally":this.finallyCount_++;d.push(c.finallyConnection_);break;default:throw"Unknown block type."}c=c.nextConnection&&c.nextConnection.targetBlock()}this.updateShape_();for(c=0;c<this.finallyCount_;c++){Blockly.Mutator.reconnect(d[c],this,"FINALLY"+c)}},saveConnections:function(e){e=e.nextConnection.targetBlock();for(var d=0;e;){switch(e.type){case"exception_try_finally":var f=this.getInput("FINALLY"+d);e.finallyConnection_=f&&f.connection.targetConnection;d++;break;default:throw"Unknown block type."}e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_:function(){for(var b=0;this.getInput("FINALLY"+b);){this.removeInput("FINALLY"+b),b++}for(b=0;b<this.finallyCount_;b++){this.appendStatementInput("FINALLY"+b).appendField(Blockly.Msg.TEXT_FINALLY).setAlign(Blockly.ALIGN_RIGHT)}}};Blockly.Blocks.exception_catch_error={init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.TEXT_TRY_CATCH_ERROR).appendField(new Blockly.wc.FieldException("any"),"ERROR");this.appendDummyInput().appendField(" "+Blockly.Msg.TEXT_TRY_CATCHED);this.appendStatementInput("DO").appendField(Blockly.Msg.DO).setAlign(Blockly.ALIGN_RIGHT);this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks["try"].HUE);this.setTooltip("")},onchange:function(b){this.workspace.isDragging&&!this.workspace.isDragging()&&("undefined"!=typeof b.element&&null!=this.warning&&"disabled"==b.element&&b.blockId==this.id?this.setDisabled(!0):("undefined"!=typeof b.element&&"disabled"==b.element&&b.newValue!=b.oldValue&&b.blockId==this.id&&(this.disabledByUser=b.newValue),this.isInBlock("exception_try","CATCH0")?(b=null!=this.warning,this.setWarningText(null),!this.isInFlyout&&b&("undefined"==typeof this.disabledByUser?1:!this.disabledByUser)?this.setDisabled(!1):"undefined"!=typeof this.disabledByUser&&this.setDisabled(this.disabledByUser)):(this.setWarningText(Blockly.Msg.WARNING_CATCH_ERROR_NOT_ALLOWED_HERE),this.isInFlyout||this.setDisabled(!0))))}};Blockly.Blocks.exception_raise_again={init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.TEXT_TRY_CATCH_RAISE_AGAIN);this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks["try"].HUE);this.setTooltip("")},onchange:function(b){this.workspace.isDragging&&!this.workspace.isDragging()&&("undefined"!=typeof b.element&&null!=this.warning&&"disabled"==b.element&&b.blockId==this.id?this.setDisabled(!0):("undefined"!=typeof b.element&&"disabled"==b.element&&b.newValue!=b.oldValue&&b.blockId==this.id&&(this.disabledByUser=b.newValue),this.isInBlock("exception_catch_error")?(b=null!=this.warning,this.setWarningText(null),!this.isInFlyout&&b&("undefined"==typeof this.disabledByUser?1:!this.disabledByUser)?this.setDisabled(!1):"undefined"!=typeof this.disabledByUser&&this.setDisabled(this.disabledByUser)):(this.setWarningText(Blockly.Msg.WARNING_RAISE_ERROR_AGAIN_NOT_ALLOWED_HERE),this.isInFlyout||this.setDisabled(!0))))}};"use strict";Blockly.Blocks.bitlogic={};Blockly.Blocks.bitlogic_msb={init:function(){this.jsonInit({message0:Blockly.Msg.BITLOGIC_MSB_TITLE,args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",colour:Blockly.Blocks.logic.HUE,tooltip:Blockly.Msg.BITLOGIC_MSB_TOOLTIP,helpUrl:Blockly.Msg.BITLOGIC_MSB_HELPURL})}};Blockly.Blocks.bitlogic_lsb={init:function(){this.jsonInit({message0:Blockly.Msg.BITLOGIC_LSB_TITLE,args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",colour:Blockly.Blocks.logic.HUE,tooltip:Blockly.Msg.BITLOGIC_LSB_TOOLTIP,helpUrl:Blockly.Msg.BITLOGIC_LSB_HELPURL})}};"use strict";Blockly.Blocks.servo={};Blockly.Blocks.actuators={};Blockly.Blocks.actuators.HUE=260;Blockly.Blocks.servo_move={module:"servo",init:function(){Blockly.Blocks.io.helper.getPwmPins();this.appendDummyInput().appendField(Blockly.Msg.SERVO_MOVE);this.appendValueInput("PIN").setCheck("Number");this.appendValueInput("VALUE").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.SERVO_MOVE_DEGREES);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.actuators.HUE);this.setTooltip(Blockly.Msg.SERVO_MOVE_TOOLTIP);this.updateBoardAtFieldChange("NUM")},mutationToDom:function(){var b=document.createElement("mutation");"undefined"==typeof this.value&&(this.value=-1);b.setAttribute("value",this.value);return b},domToMutation:function(b){this.value=b.getAttribute("value")}};"use strict";Blockly.Blocks.lists={};Blockly.Blocks.lists.HUE=260;Blockly.Blocks.lists_create_empty={init:function(){this.jsonInit({message0:Blockly.Msg.LISTS_CREATE_EMPTY_TITLE,output:"Array",colour:Blockly.Blocks.lists.HUE,tooltip:Blockly.Msg.LISTS_CREATE_EMPTY_TOOLTIP,helpUrl:Blockly.Msg.LISTS_CREATE_EMPTY_HELPURL})}};Blockly.Blocks.lists_create_with={init:function(){this.setHelpUrl(Blockly.Msg.LISTS_CREATE_WITH_HELPURL);this.setColour(Blockly.Blocks.lists.HUE);this.itemCount_=3;this.updateShape_();this.setOutput(!0,"Array");this.setMutator(new Blockly.Mutator(["lists_create_with_item"]));this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("items",this.itemCount_);return b},domToMutation:function(b){this.itemCount_=parseInt(b.getAttribute("items"),10);this.updateShape_()},decompose:function(g){var f=g.newBlock("lists_create_with_container");f.initSvg();for(var j=f.getInput("STACK").connection,i=0;i<this.itemCount_;i++){var h=g.newBlock("lists_create_with_item");h.initSvg();j.connect(h.previousConnection);j=h.nextConnection}return f},compose:function(e){var d=e.getInputTargetBlock("STACK");for(e=[];d;){e.push(d.valueConnection_),d=d.nextConnection&&d.nextConnection.targetBlock()}for(d=0;d<this.itemCount_;d++){var f=this.getInput("ADD"+d).connection.targetConnection;f&&-1==e.indexOf(f)&&f.disconnect()}this.itemCount_=e.length;this.updateShape_();for(d=0;d<this.itemCount_;d++){Blockly.Mutator.reconnect(e[d],this,"ADD"+d)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");for(var d=0;e;){var f=this.getInput("ADD"+d);e.valueConnection_=f&&f.connection.targetConnection;d++;e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(Blockly.Msg.LISTS_CREATE_EMPTY_TITLE);for(var d=0;d<this.itemCount_;d++){if(!this.getInput("ADD"+d)){var c=this.appendValueInput("ADD"+d);0==d&&c.appendField(Blockly.Msg.LISTS_CREATE_WITH_INPUT_WITH)}}for(;this.getInput("ADD"+d);){this.removeInput("ADD"+d),d++}}};Blockly.Blocks.lists_create_with_container={init:function(){this.setColour(Blockly.Blocks.lists.HUE);this.appendDummyInput().appendField(Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD);this.appendStatementInput("STACK");this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP);this.contextMenu=!1}};Blockly.Blocks.lists_create_with_item={init:function(){this.setColour(Blockly.Blocks.lists.HUE);this.appendDummyInput().appendField(Blockly.Msg.LISTS_CREATE_WITH_ITEM_TITLE);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP);this.contextMenu=!1}};Blockly.Blocks.lists_repeat={init:function(){this.jsonInit({message0:Blockly.Msg.LISTS_REPEAT_TITLE,args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",colour:Blockly.Blocks.lists.HUE,tooltip:Blockly.Msg.LISTS_REPEAT_TOOLTIP,helpUrl:Blockly.Msg.LISTS_REPEAT_HELPURL})}};Blockly.Blocks.lists_length={init:function(){this.jsonInit({message0:Blockly.Msg.LISTS_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",colour:Blockly.Blocks.lists.HUE,tooltip:Blockly.Msg.LISTS_LENGTH_TOOLTIP,helpUrl:Blockly.Msg.LISTS_LENGTH_HELPURL})}};Blockly.Blocks.lists_isEmpty={init:function(){this.jsonInit({message0:Blockly.Msg.LISTS_ISEMPTY_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",colour:Blockly.Blocks.lists.HUE,tooltip:Blockly.Msg.LISTS_ISEMPTY_TOOLTIP,helpUrl:Blockly.Msg.LISTS_ISEMPTY_HELPURL})}};Blockly.Blocks.lists_indexOf={init:function(){var b=[[Blockly.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[Blockly.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(Blockly.Msg.LISTS_INDEX_OF_HELPURL);this.setColour(Blockly.Blocks.lists.HUE);this.setOutput(!0,"Number");this.appendValueInput("VALUE").setCheck("Array").appendField(Blockly.Msg.LISTS_INDEX_OF_INPUT_IN_LIST);this.appendValueInput("FIND").appendField(new Blockly.FieldDropdown(b),"END");this.setInputsInline(!0);this.setTooltip(function(){return Blockly.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")})}};Blockly.Blocks.lists_getIndex={init:function(){var d=[[Blockly.Msg.LISTS_GET_INDEX_GET,"GET"],[Blockly.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[Blockly.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[Blockly.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[Blockly.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[Blockly.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[Blockly.Msg.LISTS_GET_INDEX_LAST,"LAST"],[Blockly.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]];this.setHelpUrl(Blockly.Msg.LISTS_GET_INDEX_HELPURL);this.setColour(Blockly.Blocks.lists.HUE);d=new Blockly.FieldDropdown(d,function(b){this.sourceBlock_.updateStatement_("REMOVE"==b)});this.appendValueInput("VALUE").setCheck("Array").appendField(Blockly.Msg.LISTS_GET_INDEX_INPUT_IN_LIST);this.appendDummyInput().appendField(d,"MODE").appendField("","SPACE");this.appendDummyInput("AT");Blockly.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(Blockly.Msg.LISTS_GET_INDEX_TAIL);this.setInputsInline(!0);this.setOutput(!0);this.updateAt_(!0);var c=this;this.setTooltip(function(){var b=c.getFieldValue("MODE"),g=c.getFieldValue("WHERE"),f="";switch(b+" "+g){case"GET FROM_START":case"GET FROM_END":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":f=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}if("FROM_START"==g||"FROM_END"==g){f+="  "+("FROM_START"==g?Blockly.Msg.LISTS_INDEX_FROM_START_TOOLTIP:Blockly.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",c.workspace.options.oneBasedIndex?"#1":"#0")}return f})},mutationToDom:function(){var d=document.createElement("mutation");d.setAttribute("statement",!this.outputConnection);var c=this.getInput("AT").type==Blockly.INPUT_VALUE;d.setAttribute("at",c);return d},domToMutation:function(d){var c="true"==d.getAttribute("statement");this.updateStatement_(c);d="false"!=d.getAttribute("at");this.updateAt_(d)},updateStatement_:function(b){b!=!this.outputConnection&&(this.unplug(!0,!0),b?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(d){this.removeInput("AT");this.removeInput("ORDINAL",!0);d?(this.appendValueInput("AT").setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var c=new Blockly.FieldDropdown(this.WHERE_OPTIONS,function(a){var g="FROM_START"==a||"FROM_END"==a;if(g!=d){var f=this.sourceBlock_;f.updateAt_(g);f.setFieldValue(a,"WHERE");return null}});this.getInput("AT").appendField(c,"WHERE");Blockly.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};Blockly.Blocks.lists_setIndex={init:function(){var d=[[Blockly.Msg.LISTS_SET_INDEX_SET,"SET"],[Blockly.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[Blockly.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[Blockly.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[Blockly.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[Blockly.Msg.LISTS_GET_INDEX_LAST,"LAST"],[Blockly.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]];this.setHelpUrl(Blockly.Msg.LISTS_SET_INDEX_HELPURL);this.setColour(Blockly.Blocks.lists.HUE);this.appendValueInput("LIST").setCheck("Array").appendField(Blockly.Msg.LISTS_SET_INDEX_INPUT_IN_LIST);this.appendDummyInput().appendField(new Blockly.FieldDropdown(d),"MODE").appendField("","SPACE");this.appendDummyInput("AT");this.appendValueInput("TO").appendField(Blockly.Msg.LISTS_SET_INDEX_INPUT_TO);this.setInputsInline(!0);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.LISTS_SET_INDEX_TOOLTIP);this.updateAt_(!0);var c=this;this.setTooltip(function(){var b=c.getFieldValue("MODE"),g=c.getFieldValue("WHERE"),f="";switch(b+" "+g){case"SET FROM_START":case"SET FROM_END":f=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":f=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":f=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":f=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":f=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":f=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":f=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":f=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}if("FROM_START"==g||"FROM_END"==g){f+="  "+Blockly.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",c.workspace.options.oneBasedIndex?"#1":"#0")}return f})},mutationToDom:function(){var d=document.createElement("mutation"),c=this.getInput("AT").type==Blockly.INPUT_VALUE;d.setAttribute("at",c);return d},domToMutation:function(b){b="false"!=b.getAttribute("at");this.updateAt_(b)},updateAt_:function(d){this.removeInput("AT");this.removeInput("ORDINAL",!0);d?(this.appendValueInput("AT").setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var c=new Blockly.FieldDropdown(this.WHERE_OPTIONS,function(a){var g="FROM_START"==a||"FROM_END"==a;if(g!=d){var f=this.sourceBlock_;f.updateAt_(g);f.setFieldValue(a,"WHERE");return null}});this.moveInputBefore("AT","TO");this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO");this.getInput("AT").appendField(c,"WHERE")}};Blockly.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[Blockly.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[Blockly.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[Blockly.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]];this.WHERE_OPTIONS_2=[[Blockly.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[Blockly.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[Blockly.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]];this.setHelpUrl(Blockly.Msg.LISTS_GET_SUBLIST_HELPURL);this.setColour(Blockly.Blocks.lists.HUE);this.appendValueInput("LIST").setCheck("Array").appendField(Blockly.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);this.appendDummyInput("AT1");this.appendDummyInput("AT2");Blockly.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(Blockly.Msg.LISTS_GET_SUBLIST_TAIL);this.setInputsInline(!0);this.setOutput(!0,"Array");this.updateAt_(1,!0);this.updateAt_(2,!0);this.setTooltip(Blockly.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var d=document.createElement("mutation"),c=this.getInput("AT1").type==Blockly.INPUT_VALUE;d.setAttribute("at1",c);c=this.getInput("AT2").type==Blockly.INPUT_VALUE;d.setAttribute("at2",c);return d},domToMutation:function(d){var c="true"==d.getAttribute("at1");d="true"==d.getAttribute("at2");this.updateAt_(1,c);this.updateAt_(2,d)},updateAt_:function(e,d){this.removeInput("AT"+e);this.removeInput("ORDINAL"+e,!0);d?(this.appendValueInput("AT"+e).setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e);var f=new Blockly.FieldDropdown(this["WHERE_OPTIONS_"+e],function(g){var b="FROM_START"==g||"FROM_END"==g;if(b!=d){var a=this.sourceBlock_;a.updateAt_(e,b);a.setFieldValue(g,"WHERE"+e);return null}});this.getInput("AT"+e).appendField(f,"WHERE"+e);1==e&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"));Blockly.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};Blockly.Blocks.lists_sort={init:function(){this.jsonInit({message0:Blockly.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[Blockly.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[Blockly.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[Blockly.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[Blockly.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[Blockly.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",colour:Blockly.Blocks.lists.HUE,tooltip:Blockly.Msg.LISTS_SORT_TOOLTIP,helpUrl:Blockly.Msg.LISTS_SORT_HELPURL})}};Blockly.Blocks.lists_split={init:function(){var d=this,c=new Blockly.FieldDropdown([[Blockly.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[Blockly.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(a){d.updateType_(a)});this.setHelpUrl(Blockly.Msg.LISTS_SPLIT_HELPURL);this.setColour(Blockly.Blocks.lists.HUE);this.appendValueInput("INPUT").setCheck("String").appendField(c,"MODE");this.appendValueInput("DELIM").setCheck("String").appendField(Blockly.Msg.LISTS_SPLIT_WITH_DELIMITER);this.setInputsInline(!0);this.setOutput(!0,"Array");this.setTooltip(function(){var a=d.getFieldValue("MODE");if("SPLIT"==a){return Blockly.Msg.LISTS_SPLIT_TOOLTIP_SPLIT}if("JOIN"==a){return Blockly.Msg.LISTS_SPLIT_TOOLTIP_JOIN}throw"Unknown mode: "+a})},updateType_:function(b){"SPLIT"==b?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("mode",this.getFieldValue("MODE"));return b},domToMutation:function(b){this.updateType_(b.getAttribute("mode"))}};"use strict";Blockly.Blocks.procedures={};Blockly.Blocks.procedures.HUE=290;Blockly.Blocks.procedures_defnoreturn={init:function(){var b=new Blockly.FieldTextInput("",Blockly.Procedures.rename);b.setSpellcheck(!1);this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(b,"NAME").appendField("","PARAMS");this.setMutator(new Blockly.Mutator(["procedures_mutatorarg"]));(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&Blockly.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(Blockly.Msg.PROCEDURES_DEFNORETURN_COMMENT);this.setColour(Blockly.Blocks.procedures.HUE);this.setTooltip(Blockly.Msg.PROCEDURES_DEFNORETURN_TOOLTIP);this.setHelpUrl(Blockly.Msg.PROCEDURES_DEFNORETURN_HELPURL);this.arguments_=[];this.setStatements_(!0);this.statementConnection_=null},setStatements_:function(b){this.hasStatements_!==b&&(b?(this.appendStatementInput("STACK").appendField(Blockly.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=b)},updateParams_:function(){for(var e=!1,d={},f=0;f<this.arguments_.length;f++){if(d["arg_"+this.arguments_[f].toLowerCase()]){e=!0;break}d["arg_"+this.arguments_[f].toLowerCase()]=!0}e?this.setWarningText(Blockly.Msg.PROCEDURES_DEF_DUPLICATE_WARNING):this.setWarningText(null);e="";this.arguments_.length&&(e=Blockly.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", "));Blockly.Events.disable();try{this.setFieldValue(e,"PARAMS")}finally{Blockly.Events.enable()}},mutationToDom:function(f){var e=document.createElement("mutation");f&&e.setAttribute("name",this.getFieldValue("NAME"));for(var h=0;h<this.arguments_.length;h++){var g=document.createElement("arg");g.setAttribute("name",this.arguments_[h]);f&&this.paramIds_&&g.setAttribute("paramId",this.paramIds_[h]);e.appendChild(g)}this.hasStatements_||e.setAttribute("statements","false");return e},domToMutation:function(e){this.arguments_=[];for(var d=0,f;f=e.childNodes[d];d++){"arg"==f.nodeName.toLowerCase()&&this.arguments_.push(f.getAttribute("name"))}this.updateParams_();Blockly.Procedures.mutateCallers(this);this.setStatements_("false"!==e.getAttribute("statements"))},decompose:function(g){var f=g.newBlock("procedures_mutatorcontainer");f.initSvg();this.getInput("RETURN")?f.setFieldValue(this.hasStatements_?"TRUE":"FALSE","STATEMENTS"):f.getInput("STATEMENT_INPUT").setVisible(!1);for(var j=f.getInput("STACK").connection,i=0;i<this.arguments_.length;i++){var h=g.newBlock("procedures_mutatorarg");h.initSvg();h.setFieldValue(this.arguments_[i],"NAME");h.oldLocation=i;j.connect(h.previousConnection);j=h.nextConnection}Blockly.Procedures.mutateCallers(this);return f},compose:function(d){this.arguments_=[];this.paramIds_=[];for(var c=d.getInputTargetBlock("STACK");c;){this.arguments_.push(c.getFieldValue("NAME")),this.paramIds_.push(c.id),c=c.nextConnection&&c.nextConnection.targetBlock()}this.updateParams_();Blockly.Procedures.mutateCallers(this);d=d.getFieldValue("STATEMENTS");if(null!==d&&(d="TRUE"==d,this.hasStatements_!=d)){if(d){this.setStatements_(!0),Blockly.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null}else{d=this.getInput("STACK").connection;if(this.statementConnection_=d.targetConnection){d=d.targetBlock(),d.unplug(),d.bumpNeighbours_()}this.setStatements_(!1)}}},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},renameVar:function(g,f){for(var j=!1,i=0;i<this.arguments_.length;i++){Blockly.Names.equals(g,this.arguments_[i])&&(this.arguments_[i]=f,j=!0)}if(j&&(this.updateParams_(),this.mutator.isVisible())){for(var j=this.mutator.workspace_.getAllBlocks(),i=0,h;h=j[i];i++){"procedures_mutatorarg"==h.type&&Blockly.Names.equals(g,h.getFieldValue("NAME"))&&h.setFieldValue(f,"NAME")}}},customContextMenu:function(g){var f={enabled:!0},j=this.getFieldValue("NAME");f.text=Blockly.Msg.PROCEDURES_CREATE_DO.replace("%1",j);var i=goog.dom.createDom("mutation");i.setAttribute("name",j);for(var h=0;h<this.arguments_.length;h++){j=goog.dom.createDom("arg"),j.setAttribute("name",this.arguments_[h]),i.appendChild(j)}i=goog.dom.createDom("block",null,i);i.setAttribute("type",this.callType_);f.callback=Blockly.ContextMenu.callbackFactory(this,i);g.push(f);if(!this.isCollapsed()){for(h=0;h<this.arguments_.length;h++){f={enabled:!0},j=this.arguments_[h],f.text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1",j),i=goog.dom.createDom("field",null,j),i.setAttribute("name","VAR"),i=goog.dom.createDom("block",null,i),i.setAttribute("type","variables_get"),f.callback=Blockly.ContextMenu.callbackFactory(this,i),g.push(f)}}},callType_:"procedures_callnoreturn"};Blockly.Blocks.procedures_defreturn={init:function(){var b=new Blockly.FieldTextInput("",Blockly.Procedures.rename);b.setSpellcheck(!1);this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(b,"NAME").appendField("","PARAMS");this.appendValueInput("RETURN").setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN);this.setMutator(new Blockly.Mutator(["procedures_mutatorarg"]));(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&Blockly.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(Blockly.Msg.PROCEDURES_DEFRETURN_COMMENT);this.setColour(Blockly.Blocks.procedures.HUE);this.setTooltip(Blockly.Msg.PROCEDURES_DEFRETURN_TOOLTIP);this.setHelpUrl(Blockly.Msg.PROCEDURES_DEFRETURN_HELPURL);this.arguments_=[];this.setStatements_(!0);this.statementConnection_=null},setStatements_:Blockly.Blocks.procedures_defnoreturn.setStatements_,updateParams_:Blockly.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:Blockly.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_defnoreturn.domToMutation,decompose:Blockly.Blocks.procedures_defnoreturn.decompose,compose:Blockly.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:Blockly.Blocks.procedures_defnoreturn.getVars,renameVar:Blockly.Blocks.procedures_defnoreturn.renameVar,customContextMenu:Blockly.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"};Blockly.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TITLE);this.appendStatementInput("STACK");this.appendDummyInput("STATEMENT_INPUT").appendField(Blockly.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new Blockly.FieldCheckbox("TRUE"),"STATEMENTS");this.setColour(Blockly.Blocks.procedures.HUE);this.setTooltip(Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP);this.contextMenu=!1}};Blockly.Blocks.procedures_mutatorarg={init:function(){var b=new Blockly.FieldTextInput("x",this.validator_);this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(b,"NAME");this.setPreviousStatement(!0);this.setNextStatement(!0);this.setColour(Blockly.Blocks.procedures.HUE);this.setTooltip(Blockly.Msg.PROCEDURES_MUTATORARG_TOOLTIP);this.contextMenu=!1;b.onFinishEditing_=this.createNewVar_;b.onFinishEditing_("x")},validator_:function(b){return(b=b.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""))||null},createNewVar_:function(d){var c=this.sourceBlock_;c&&c.workspace&&c.workspace.options&&c.workspace.options.parentWorkspace&&c.workspace.options.parentWorkspace.createVariable(d)}};Blockly.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField(this.id,"NAME");this.setPreviousStatement(!0);this.setNextStatement(!0);this.setColour(Blockly.Blocks.procedures.HUE);this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLNORETURN_HELPURL);this.arguments_=[];this.quarkConnections_={};this.quarkIds_=null},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(d,c){Blockly.Names.equals(d,this.getProcedureCall())&&(this.setFieldValue(c,"NAME"),this.setTooltip((this.outputConnection?Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP:Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",c)))},setProcedureParameters_:function(h,g){var l=Blockly.Procedures.getDefinition(this.getProcedureCall(),this.workspace),k=l&&l.mutator&&l.mutator.isVisible();k||(this.quarkConnections_={},this.quarkIds_=null);if(g){if(goog.array.equals(this.arguments_,h)){this.quarkIds_=g}else{if(g.length!=h.length){throw"Error: paramNames and paramIds must be the same length."}this.setCollapsed(!1);this.quarkIds_||(this.quarkConnections_={},h.join("\n")==this.arguments_.join("\n")?this.quarkIds_=g:this.quarkIds_=[]);l=this.rendered;this.rendered=!1;for(var j=0;j<this.arguments_.length;j++){var i=this.getInput("ARG"+j);i&&(i=i.connection.targetConnection,this.quarkConnections_[this.quarkIds_[j]]=i,k&&i&&-1==g.indexOf(this.quarkIds_[j])&&(i.disconnect(),i.getSourceBlock().bumpNeighbours_()))}this.arguments_=[].concat(h);this.updateShape_();if(this.quarkIds_=g){for(j=0;j<this.arguments_.length;j++){k=this.quarkIds_[j],k in this.quarkConnections_&&(i=this.quarkConnections_[k],Blockly.Mutator.reconnect(i,this,"ARG"+j)||delete this.quarkConnections_[k])}}(this.rendered=l)&&this.render()}}},updateShape_:function(){for(var d=0;d<this.arguments_.length;d++){var c=this.getField("ARGNAME"+d);if(c){Blockly.Events.disable();try{c.setValue(this.arguments_[d])}finally{Blockly.Events.enable()}}else{c=new Blockly.FieldLabel(this.arguments_[d]),this.appendValueInput("ARG"+d).setAlign(Blockly.ALIGN_RIGHT).appendField(c,"ARGNAME"+d).init()}}for(;this.getInput("ARG"+d);){this.removeInput("ARG"+d),d++}if(d=this.getInput("TOPROW")){this.arguments_.length?this.getField("WITH")||(d.appendField(Blockly.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),d.init()):this.getField("WITH")&&d.removeField("WITH")}},mutationToDom:function(){var e=document.createElement("mutation");e.setAttribute("name",this.getProcedureCall());for(var d=0;d<this.arguments_.length;d++){var f=document.createElement("arg");f.setAttribute("name",this.arguments_[d]);e.appendChild(f)}return e},domToMutation:function(g){var f=g.getAttribute("name");this.renameProcedure(this.getProcedureCall(),f);for(var f=[],j=[],i=0,h;h=g.childNodes[i];i++){"arg"==h.nodeName.toLowerCase()&&(f.push(h.getAttribute("name")),j.push(h.getAttribute("paramId")))}this.setProcedureParameters_(f,j)},renameVar:function(e,d){for(var f=0;f<this.arguments_.length;f++){Blockly.Names.equals(e,this.arguments_[f])&&(this.arguments_[f]=d,this.getField("ARGNAME"+f).setValue(d))}},onchange:function(f){if(this.workspace&&!this.workspace.isFlyout){if(f.type==Blockly.Events.CREATE&&-1!=f.ids.indexOf(this.id)){var e=this.getProcedureCall(),e=Blockly.Procedures.getDefinition(e,this.workspace);!e||e.type==this.defType_&&JSON.stringify(e.arguments_)==JSON.stringify(this.arguments_)||(e=null);if(!e){Blockly.Events.setGroup(f.group);f=goog.dom.createDom("xml");e=goog.dom.createDom("block");e.setAttribute("type",this.defType_);var h=this.getRelativeToSurfaceXY(),g=h.y+2*Blockly.SNAP_RADIUS;e.setAttribute("x",h.x+Blockly.SNAP_RADIUS*(this.RTL?-1:1));e.setAttribute("y",g);h=this.mutationToDom();e.appendChild(h);h=goog.dom.createDom("field");h.setAttribute("name","NAME");h.appendChild(document.createTextNode(this.getProcedureCall()));e.appendChild(h);f.appendChild(e);Blockly.Xml.domToWorkspace(f,this.workspace);Blockly.Events.setGroup(!1)}}else{f.type==Blockly.Events.DELETE&&(e=this.getProcedureCall(),e=Blockly.Procedures.getDefinition(e,this.workspace),e||(Blockly.Events.setGroup(f.group),this.dispose(!0,!1),Blockly.Events.setGroup(!1)))}}},customContextMenu:function(f){var e={enabled:!0};e.text=Blockly.Msg.PROCEDURES_HIGHLIGHT_DEF;var h=this.getProcedureCall(),g=this.workspace;e.callback=function(){var b=Blockly.Procedures.getDefinition(h,g);b&&b.select()};f.push(e)},defType_:"procedures_defnoreturn"};Blockly.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME");this.setOutput(!0);this.setColour(Blockly.Blocks.procedures.HUE);this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLRETURN_HELPURL);this.arguments_=[];this.quarkConnections_={};this.quarkIds_=null},getProcedureCall:Blockly.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:Blockly.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:Blockly.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:Blockly.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:Blockly.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_callnoreturn.domToMutation,renameVar:Blockly.Blocks.procedures_callnoreturn.renameVar,onchange:Blockly.Blocks.procedures_callnoreturn.onchange,customContextMenu:Blockly.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"};Blockly.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_IF);this.appendValueInput("VALUE").appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN);this.setInputsInline(!0);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setColour(Blockly.Blocks.procedures.HUE);this.setTooltip(Blockly.Msg.PROCEDURES_IFRETURN_TOOLTIP);this.setHelpUrl(Blockly.Msg.PROCEDURES_IFRETURN_HELPURL);this.hasReturnValue_=!0},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("value",Number(this.hasReturnValue_));return b},domToMutation:function(b){this.hasReturnValue_=1==b.getAttribute("value");this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(d){if(this.workspace.isDragging&&!this.workspace.isDragging()){d=!1;var c=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(c.type)){d=!0;break}c=c.getSurroundParent()}while(c);d?("procedures_defnoreturn"==c.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=c.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setDisabled(!1)):(this.setWarningText(Blockly.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};"use strict";Blockly.Blocks.lora={};Blockly.Blocks.lora.HUE=20;Blockly.Blocks.lora_configure={module:"lora",init:function(){var b=[];b.push(["868","lora.BAND868"]);b.push(["433","lora.BAND433"]);this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.configureLora).appendField(new Blockly.FieldDropdown(b),"BAND");this.appendDummyInput().appendField(" "+Blockly.Msg.MHZ+" "+Blockly.Msg.BAND);this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_deveui={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_DEVEUI);this.appendValueInput("DEVEUI");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_appeui={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_APPEUI);this.appendValueInput("APPEUI");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_devaddr={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_DEVADDR);this.appendValueInput("DEVADDR");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_nwkskey={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_NWKSKEY);this.appendValueInput("NWKSKEY");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_appskey={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_APPSKEY);this.appendValueInput("APPSKEY");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_appkey={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_APPKEY);this.appendValueInput("APPKEY");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_adr={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_ADR);this.appendDummyInput().appendField(new Blockly.FieldDropdown([[Blockly.Msg.TRUE,"1"],[Blockly.Msg.FALSE,"0"]]),"ON_OFF");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_dr={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_DR);this.appendDummyInput().appendField(new Blockly.FieldDropdown([["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"]]),"DR");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_set_retx={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_SET_RETX);this.appendDummyInput().appendField(new Blockly.FieldDropdown([["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"]]),"RETX");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")}};Blockly.Blocks.lora_join={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_JOIN);this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("band",this.band);b.setAttribute("activation",this.activation);b.setAttribute("dr",this.dr);b.setAttribute("adr",this.adr);b.setAttribute("retx",this.retx);b.setAttribute("deveui",this.deveui);b.setAttribute("appeui",this.appeui);b.setAttribute("appkey",this.appkey);b.setAttribute("devaddr",this.devaddr);b.setAttribute("nwkskey",this.nwkskey);b.setAttribute("appskey",this.appskey);return b},domToMutation:function(b){this["interface"]=b.getAttribute("interface");this.band=b.getAttribute("band");this.activation=b.getAttribute("activation");this.dr=b.getAttribute("dr");this.adr=b.getAttribute("adr");this.retx=b.getAttribute("retx");this.deveui=b.getAttribute("deveui");this.appeui=b.getAttribute("appeui");this.appkey=b.getAttribute("appkey");this.devaddr=b.getAttribute("devaddr");this.nwkskey=b.getAttribute("nwkskey");this.appskey=b.getAttribute("appskey");this.updateShape_()},updateShape_:function(){this.configureLora(this)},configureLora:function(b){b.workspace.configureLora({band:b.band,activation:b.activation,dr:b.dr,retx:b.retx,adr:b.adr,deveui:b.deveui,appeui:b.appeui,appkey:b.appkey,devaddr:b.devaddr,nwkskey:b.nwkskey,appskey:b.appskey})}};Blockly.Blocks.lora_tx={module:"lora",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.LORA_TX);this.appendDummyInput().appendField(new Blockly.FieldDropdown([[Blockly.Msg.LORA_CONFIRMED,"1"],[Blockly.Msg.LORA_UNCONFIRMED,"0"]]),"CONF").appendField(Blockly.Msg.LORA_FRAME);this.appendValueInput("PORT").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.LORA_PAYLOAD);this.appendValueInput("PAYLOAD");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip("")},configureLora:Blockly.Blocks.lora_join.configureLora,mutationToDom:Blockly.Blocks.lora_join.mutationToDom,domToMutation:Blockly.Blocks.lora_join.domToMutation,updateShape_:Blockly.Blocks.lora_join.updateShape_};Blockly.Blocks.when_i_receive_a_lora_frame={module:"lora",init:function(){this.appendDummyInput().appendField(Blockly.Msg.EVENT_WHEN_I_RECEIVE_A_LORA_FRAME+" "+Blockly.Msg.PROCEDURES_BEFORE_PARAMS+" port, payload");this.appendStatementInput("DO").appendField(Blockly.Msg.DO).setAlign(Blockly.ALIGN_RIGHT);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.lora.HUE);this.setTooltip(Blockly.Msg.EVENT_WHEN_I_RECEIVE_A_LORA_FRAME_TOOLTIP)},onchange:function(e){if(this.workspace.isDragging&&!this.workspace.isDragging()){e=0;for(var d=this.workspace.getTopBlocks(!0),f=0;d[f];f++){d[f].type==this.type&&e++}1<e?(this.setWarningText(Blockly.Msg.WARNING_ONLY_ONE_INSTANCE_ALLOWED),this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0)):(this.setWarningText(null),this.isInFlyout||this.setDisabled(!1))}},section:function(){return"declaration"},customContextMenu:function(e){if(!this.isCollapsed()){var d={enabled:!0},f="port";d.text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1",f);f=goog.dom.createDom("field",null,f);f.setAttribute("name","VAR");f=goog.dom.createDom("block",null,f);f.setAttribute("type","variables_get");d.callback=Blockly.ContextMenu.callbackFactory(this,f);e.push(d);d={enabled:!0};f="payload";d.text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1",f);f=goog.dom.createDom("field",null,f);f.setAttribute("name","VAR");f=goog.dom.createDom("block",null,f);f.setAttribute("type","variables_get");d.callback=Blockly.ContextMenu.callbackFactory(this,f);e.push(d)}}};"use strict";Blockly.Blocks.math={};Blockly.Blocks.math.HUE=230;Blockly.Blocks.math_number={init:function(){this.setHelpUrl(Blockly.Msg.MATH_NUMBER_HELPURL);this.setColour(Blockly.Blocks.constant.HUE);this.appendDummyInput().appendField(new Blockly.FieldNumber("0"),"NUM");this.setOutput(!0,"Number");var b=this;this.setTooltip(function(){var a=b.getParent();return a&&a.getInputsInline()&&a.tooltip||Blockly.Msg.MATH_NUMBER_TOOLTIP})}};Blockly.Blocks.math_arithmetic={init:function(){this.jsonInit({message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[[Blockly.Msg.MATH_ADDITION_SYMBOL,"ADD"],[Blockly.Msg.MATH_SUBTRACTION_SYMBOL,"MINUS"],[Blockly.Msg.MATH_MULTIPLICATION_SYMBOL,"MULTIPLY"],[Blockly.Msg.MATH_DIVISION_SYMBOL,"DIVIDE"],[Blockly.Msg.MATH_POWER_SYMBOL,"POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",colour:Blockly.Blocks.math.HUE,helpUrl:Blockly.Msg.MATH_ARITHMETIC_HELPURL});var b=this;this.setTooltip(function(){var a=b.getFieldValue("OP");return{ADD:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_ADD,MINUS:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS,MULTIPLY:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY,DIVIDE:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE,POWER:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_POWER}[a]})}};Blockly.Blocks.math_single={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[[Blockly.Msg.MATH_SINGLE_OP_ROOT,"ROOT"],[Blockly.Msg.MATH_SINGLE_OP_ABSOLUTE,"ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:Blockly.Blocks.math.HUE,helpUrl:Blockly.Msg.MATH_SINGLE_HELPURL});var b=this;this.setTooltip(function(){var a=b.getFieldValue("OP");return{ROOT:Blockly.Msg.MATH_SINGLE_TOOLTIP_ROOT,ABS:Blockly.Msg.MATH_SINGLE_TOOLTIP_ABS,NEG:Blockly.Msg.MATH_SINGLE_TOOLTIP_NEG,LN:Blockly.Msg.MATH_SINGLE_TOOLTIP_LN,LOG10:Blockly.Msg.MATH_SINGLE_TOOLTIP_LOG10,EXP:Blockly.Msg.MATH_SINGLE_TOOLTIP_EXP,POW10:Blockly.Msg.MATH_SINGLE_TOOLTIP_POW10}[a]})}};Blockly.Blocks.math_trig={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[[Blockly.Msg.MATH_TRIG_SIN,"SIN"],[Blockly.Msg.MATH_TRIG_COS,"COS"],[Blockly.Msg.MATH_TRIG_TAN,"TAN"],[Blockly.Msg.MATH_TRIG_ASIN,"ASIN"],[Blockly.Msg.MATH_TRIG_ACOS,"ACOS"],[Blockly.Msg.MATH_TRIG_ATAN,"ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:Blockly.Blocks.math.HUE,helpUrl:Blockly.Msg.MATH_TRIG_HELPURL});var b=this;this.setTooltip(function(){var a=b.getFieldValue("OP");return{SIN:Blockly.Msg.MATH_TRIG_TOOLTIP_SIN,COS:Blockly.Msg.MATH_TRIG_TOOLTIP_COS,TAN:Blockly.Msg.MATH_TRIG_TOOLTIP_TAN,ASIN:Blockly.Msg.MATH_TRIG_TOOLTIP_ASIN,ACOS:Blockly.Msg.MATH_TRIG_TOOLTIP_ACOS,ATAN:Blockly.Msg.MATH_TRIG_TOOLTIP_ATAN}[a]})}};Blockly.Blocks.math_constant={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\u00bd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",colour:Blockly.Blocks.constant.HUE,tooltip:Blockly.Msg.MATH_CONSTANT_TOOLTIP,helpUrl:Blockly.Msg.MATH_CONSTANT_HELPURL})}};Blockly.Blocks.math_number_property={init:function(){var b=[[Blockly.Msg.MATH_IS_EVEN,"EVEN"],[Blockly.Msg.MATH_IS_ODD,"ODD"],[Blockly.Msg.MATH_IS_PRIME,"PRIME"],[Blockly.Msg.MATH_IS_WHOLE,"WHOLE"],[Blockly.Msg.MATH_IS_POSITIVE,"POSITIVE"],[Blockly.Msg.MATH_IS_NEGATIVE,"NEGATIVE"],[Blockly.Msg.MATH_IS_DIVISIBLE_BY,"DIVISIBLE_BY"]];this.setColour(Blockly.Blocks.math.HUE);this.appendValueInput("NUMBER_TO_CHECK").setCheck("Number");b=new Blockly.FieldDropdown(b,function(c){this.sourceBlock_.updateShape_("DIVISIBLE_BY"==c)});this.appendDummyInput().appendField(b,"PROPERTY");this.setInputsInline(!0);this.setOutput(!0,"Boolean");this.setTooltip(Blockly.Msg.MATH_IS_TOOLTIP)},mutationToDom:function(){var d=document.createElement("mutation"),c="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");d.setAttribute("divisor_input",c);return d},domToMutation:function(b){b="true"==b.getAttribute("divisor_input");this.updateShape_(b)},updateShape_:function(d){var c=this.getInput("DIVISOR");d?c||this.appendValueInput("DIVISOR").setCheck("Number"):c&&this.removeInput("DIVISOR")}};Blockly.Blocks.math_change={init:function(){this.jsonInit({message0:Blockly.Msg.MATH_CHANGE_TITLE,args0:[{type:"field_variable",name:"VAR",variable:Blockly.Msg.MATH_CHANGE_TITLE_ITEM},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,colour:Blockly.Blocks.variables.HUE,helpUrl:Blockly.Msg.MATH_CHANGE_HELPURL});var b=this;this.setTooltip(function(){return Blockly.Msg.MATH_CHANGE_TOOLTIP.replace("%1",b.getFieldValue("VAR"))})}};Blockly.Blocks.math_round={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[[Blockly.Msg.MATH_ROUND_OPERATOR_ROUND,"ROUND"],[Blockly.Msg.MATH_ROUND_OPERATOR_ROUNDUP,"ROUNDUP"],[Blockly.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN,"ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:Blockly.Blocks.math.HUE,tooltip:Blockly.Msg.MATH_ROUND_TOOLTIP,helpUrl:Blockly.Msg.MATH_ROUND_HELPURL})}};Blockly.Blocks.math_on_list={init:function(){var d=[[Blockly.Msg.MATH_ONLIST_OPERATOR_SUM,"SUM"],[Blockly.Msg.MATH_ONLIST_OPERATOR_MIN,"MIN"],[Blockly.Msg.MATH_ONLIST_OPERATOR_MAX,"MAX"],[Blockly.Msg.MATH_ONLIST_OPERATOR_AVERAGE,"AVERAGE"],[Blockly.Msg.MATH_ONLIST_OPERATOR_MEDIAN,"MEDIAN"],[Blockly.Msg.MATH_ONLIST_OPERATOR_MODE,"MODE"],[Blockly.Msg.MATH_ONLIST_OPERATOR_STD_DEV,"STD_DEV"],[Blockly.Msg.MATH_ONLIST_OPERATOR_RANDOM,"RANDOM"]],c=this;this.setHelpUrl(Blockly.Msg.MATH_ONLIST_HELPURL);this.setColour(Blockly.Blocks.math.HUE);this.setOutput(!0,"Number");d=new Blockly.FieldDropdown(d,function(b){c.updateType_(b)});this.appendValueInput("LIST").setCheck("Array").appendField(d,"OP");this.setTooltip(function(){var b=c.getFieldValue("OP");return{SUM:Blockly.Msg.MATH_ONLIST_TOOLTIP_SUM,MIN:Blockly.Msg.MATH_ONLIST_TOOLTIP_MIN,MAX:Blockly.Msg.MATH_ONLIST_TOOLTIP_MAX,AVERAGE:Blockly.Msg.MATH_ONLIST_TOOLTIP_AVERAGE,MEDIAN:Blockly.Msg.MATH_ONLIST_TOOLTIP_MEDIAN,MODE:Blockly.Msg.MATH_ONLIST_TOOLTIP_MODE,STD_DEV:Blockly.Msg.MATH_ONLIST_TOOLTIP_STD_DEV,RANDOM:Blockly.Msg.MATH_ONLIST_TOOLTIP_RANDOM}[b]})},updateType_:function(b){"MODE"==b?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("op",this.getFieldValue("OP"));return b},domToMutation:function(b){this.updateType_(b.getAttribute("op"))}};Blockly.Blocks.math_modulo={init:function(){this.jsonInit({message0:Blockly.Msg.MATH_MODULO_TITLE,args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",colour:Blockly.Blocks.math.HUE,tooltip:Blockly.Msg.MATH_MODULO_TOOLTIP,helpUrl:Blockly.Msg.MATH_MODULO_HELPURL})}};Blockly.Blocks.math_constrain={init:function(){this.jsonInit({message0:Blockly.Msg.MATH_CONSTRAIN_TITLE,args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",colour:Blockly.Blocks.math.HUE,tooltip:Blockly.Msg.MATH_CONSTRAIN_TOOLTIP,helpUrl:Blockly.Msg.MATH_CONSTRAIN_HELPURL})}};Blockly.Blocks.math_random_int={init:function(){this.jsonInit({message0:Blockly.Msg.MATH_RANDOM_INT_TITLE,args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",colour:Blockly.Blocks.math.HUE,tooltip:Blockly.Msg.MATH_RANDOM_INT_TOOLTIP,helpUrl:Blockly.Msg.MATH_RANDOM_INT_HELPURL})}};Blockly.Blocks.math_random_float={init:function(){this.jsonInit({message0:Blockly.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM,output:"Number",colour:Blockly.Blocks.math.HUE,tooltip:Blockly.Msg.MATH_RANDOM_FLOAT_TOOLTIP,helpUrl:Blockly.Msg.MATH_RANDOM_FLOAT_HELPURL})}};"use strict";Blockly.Blocks.colour={};Blockly.Blocks.colour.HUE=20;Blockly.Blocks.colour_picker={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",colour:Blockly.Blocks.colour.HUE,helpUrl:Blockly.Msg.COLOUR_PICKER_HELPURL});var b=this;this.setTooltip(function(){var a=b.getParent();return a&&a.getInputsInline()&&a.tooltip||Blockly.Msg.COLOUR_PICKER_TOOLTIP})}};Blockly.Blocks.colour_random={init:function(){this.jsonInit({message0:Blockly.Msg.COLOUR_RANDOM_TITLE,output:"Colour",colour:Blockly.Blocks.colour.HUE,tooltip:Blockly.Msg.COLOUR_RANDOM_TOOLTIP,helpUrl:Blockly.Msg.COLOUR_RANDOM_HELPURL})}};Blockly.Blocks.colour_rgb={init:function(){this.setHelpUrl(Blockly.Msg.COLOUR_RGB_HELPURL);this.setColour(Blockly.Blocks.colour.HUE);this.appendValueInput("RED").setCheck("Number").setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.COLOUR_RGB_TITLE).appendField(Blockly.Msg.COLOUR_RGB_RED);this.appendValueInput("GREEN").setCheck("Number").setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.COLOUR_RGB_GREEN);this.appendValueInput("BLUE").setCheck("Number").setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.COLOUR_RGB_BLUE);this.setOutput(!0,"Colour");this.setTooltip(Blockly.Msg.COLOUR_RGB_TOOLTIP)}};Blockly.Blocks.colour_blend={init:function(){this.setHelpUrl(Blockly.Msg.COLOUR_BLEND_HELPURL);this.setColour(Blockly.Blocks.colour.HUE);this.appendValueInput("COLOUR1").setCheck("Colour").setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.COLOUR_BLEND_TITLE).appendField(Blockly.Msg.COLOUR_BLEND_COLOUR1);this.appendValueInput("COLOUR2").setCheck("Colour").setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.COLOUR_BLEND_COLOUR2);this.appendValueInput("RATIO").setCheck("Number").setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.COLOUR_BLEND_RATIO);this.setOutput(!0,"Colour");this.setTooltip(Blockly.Msg.COLOUR_BLEND_TOOLTIP)}};"use strict";Blockly.Blocks.threads={};Blockly.Blocks.threads.HUE=20;Blockly.Blocks.threads.renameVar=function(f,e,h){f=f.getField("THID");Blockly.Names.equals(e,f.getValue())&&f.setValue(h);f.menuGenerator_=Blockly.Blocks.threads.dropdownVariables();e==h&&"newVariable"==e&&f.menuGenerator_.push([e,h]);for(var g=0;g<f.menuGenerator_.length;g++){Blockly.Names.equals(e,f.menuGenerator_[g][0])&&(f.menuGenerator_[g][0]=h,f.menuGenerator_[g][1]=h)}};Blockly.Blocks.threads.dropdownVariables=function(){var f=Code.workspace.blocks.getAllBlocks(),e=[],h;e.push(["all","all"]);for(var g=0;g<f.length;g++){"thread_start"==f[g].type&&(h=Blockly.Lua.valueToCode(f[g],"THID",Blockly.Lua.ORDER_NONE),e.push([h,h]))}return e};Blockly.Blocks.thread_start={init:function(){this.appendDummyInput().appendField(Blockly.Msg.thread_start);this.appendStatementInput("DO").setCheck(null).setAlign(Blockly.ALIGN_RIGHT);this.appendValueInput("THID").setCheck(null).appendField(Blockly.Msg.THREAD_RETURN);this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT);this.setColour(Blockly.Blocks.threads.HUE);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}};Blockly.Blocks.thread_create={init:function(){this.appendDummyInput().appendField(Blockly.Msg.thread_create);this.appendStatementInput("DO").setCheck(null).setAlign(Blockly.ALIGN_RIGHT);this.appendValueInput("THID").setCheck(null).appendField(Blockly.Msg.THREAD_RETURN);this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT);this.setColour(Blockly.Blocks.threads.HUE);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}};Blockly.Blocks.thread_suspend={init:function(){this.appendDummyInput().appendField(Blockly.Msg.thread_suspend).appendField(new Blockly.FieldDropdown(Blockly.Blocks.threads.dropdownVariables()),"THID");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.threads.HUE);this.setTooltip("");this.setHelpUrl("http://www.example.com/")},renameVar:function(d,c){Blockly.Blocks.threads.renameVar(this,d,c)}};Blockly.Blocks.thread_stop={init:function(){this.appendDummyInput().appendField(Blockly.Msg.thread_stop).appendField(new Blockly.FieldDropdown(Blockly.Blocks.threads.dropdownVariables()),"THID");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.threads.HUE);this.setTooltip("");this.setHelpUrl("http://www.example.com/")},renameVar:function(d,c){Blockly.Blocks.threads.renameVar(this,d,c)}};Blockly.Blocks.thread_resume={init:function(){this.appendDummyInput().appendField(Blockly.Msg.thread_resume).appendField(new Blockly.FieldDropdown(Blockly.Blocks.threads.dropdownVariables()),"THID");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.threads.HUE);this.setTooltip("");this.setHelpUrl("http://www.example.com/")},renameVar:function(d,c){Blockly.Blocks.threads.renameVar(this,d,c)}};Blockly.Blocks.thread_sleep={init:function(){this.appendDummyInput().appendField(Blockly.Msg.thread_sleep).appendField(new Blockly.FieldTextInput("1"),"TIME").appendField(new Blockly.FieldDropdown([[Blockly.Msg.microseconds,"microseconds"],[Blockly.Msg.milliseconds,"milliseconds"],[Blockly.Msg.seconds,"seconds"]]),"UNITS");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.threads.HUE);this.setTooltip("");this.setHelpUrl("http://www.example.com/")}};"use strict";Blockly.Blocks.can={};Blockly.Blocks.can.HUE=20;Blockly.Blocks.cansetspeed={module:"can",init:function(){var d=[],c;for(c in Code.status.maps.canUnits){d.push([Code.status.maps.canUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.CAN_SET_SPEED).appendField(new Blockly.FieldDropdown(d),"MODULE");this.appendDummyInput().appendField(Blockly.Msg.TO);this.appendValueInput("SPEED").setCheck("Number");this.appendDummyInput().appendField("Kbps");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.can.HUE);this.setTooltip(Blockly.Msg.CAN_SET_SPEED_TOOLTIP)}};Blockly.Blocks.cansetfilter={module:"can",init:function(){var d=[],c;for(c in Code.status.maps.canUnits){d.push([Code.status.maps.canUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.CAN_SET_FILTER).appendField(new Blockly.FieldDropdown(d),"MODULE").appendField(Blockly.Msg.CAN_SET_FILTER_FROM);this.appendValueInput("FROM").setCheck("Number");this.appendDummyInput().appendField(Blockly.Msg.CAN_SET_FILTER_TO);this.appendValueInput("TO").setCheck("Number");this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.can.HUE);this.setTooltip(Blockly.Msg.CAN_SET_SPEED_TOOLTIP)}};Blockly.Blocks.canread={module:"can",init:function(){var d=[],c;for(c in Code.status.maps.canUnits){d.push([Code.status.maps.canUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.CAN_READ).appendField(new Blockly.FieldDropdown(d),"MODULE").appendField(Blockly.Msg.CAN_GET_TO_FRAME).appendField(new Blockly.wc.FieldCanFrame("frame"),"FRAME");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.can.HUE);this.setTooltip(Blockly.Msg.CAN_READ_TOOLTIP)}};Blockly.Blocks.canframeget={module:"can",init:function(){var d=[],c;for(c in Code.status.maps.canUnits){d.push([Code.status.maps.canUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.CAN_GET).appendField(new Blockly.FieldDropdown([[Blockly.Msg.CAN_GET_IDENTIFIER,"id"],[Blockly.Msg.CAN_GET_TYPE,"type"],[Blockly.Msg.CAN_GET_LEN,"len"],[Blockly.Msg.CAN_GET_D0,"d0"],[Blockly.Msg.CAN_GET_D1,"d1"],[Blockly.Msg.CAN_GET_D2,"d2"],[Blockly.Msg.CAN_GET_D3,"d3"],[Blockly.Msg.CAN_GET_D4,"d4"],[Blockly.Msg.CAN_GET_D5,"d5"],[Blockly.Msg.CAN_GET_D6,"d6"],[Blockly.Msg.CAN_GET_D7,"d7"]]),"FIELD").appendField(Blockly.Msg.CAN_GET_FROM_FRAME).appendField(new Blockly.wc.FieldCanFrame("frame"),"FRAME");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.can.HUE);this.setTooltip(Blockly.Msg.CAN_GET_TOOLTIP)}};Blockly.Blocks.canframeset={module:"can",init:function(){var d=[],c;for(c in Code.status.maps.canUnits){d.push([Code.status.maps.canUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.CAN_SET).appendField(new Blockly.FieldDropdown([[Blockly.Msg.CAN_GET_IDENTIFIER,"id"],[Blockly.Msg.CAN_GET_TYPE,"type"],[Blockly.Msg.CAN_GET_LEN,"len"],[Blockly.Msg.CAN_GET_D0,"d0"],[Blockly.Msg.CAN_GET_D1,"d1"],[Blockly.Msg.CAN_GET_D2,"d2"],[Blockly.Msg.CAN_GET_D3,"d3"],[Blockly.Msg.CAN_GET_D4,"d4"],[Blockly.Msg.CAN_GET_D5,"d5"],[Blockly.Msg.CAN_GET_D6,"d6"],[Blockly.Msg.CAN_GET_D7,"d7"]]),"FIELD").appendField(Blockly.Msg.CAN_SET_TO_FRAME).appendField(new Blockly.wc.FieldCanFrame("frame"),"FRAME");this.appendDummyInput().appendField(Blockly.Msg.CAN_SET_TO_VALUE);this.appendValueInput("VALUE");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.can.HUE);this.setTooltip(Blockly.Msg.CAN_SET_TOOLTIP)},onchange:function(d){if(this.workspace.isDragging&&!this.workspace.isDragging()){d=this.getFieldValue("FIELD");var c=Blockly.Lua.valueToCode(this,"VALUE",Blockly.Lua.ORDER_NONE);"type"==d?"0"!=c&&"1"!=c&&"can.STD"!=c&&"can.EXT"!=c?(this.setWarningText(Blockly.Msg.WARNING_CAN_INVALID_TYPE),this.setDisabled(!0)):(this.setDisabled(!1),this.setWarningText(null)):"d0"==d||"d1"==d||"d2"==d||"d3"==d||"d4"==d||"d5"==d||"d6"==d||"d7"==d?0>parseInt(c)||255<parseInt(c)?(this.setWarningText(Blockly.Msg.WARNING_CAN_INVALID_DATA),this.setDisabled(!0)):(this.setDisabled(!1),this.setWarningText(null)):"len"==d&&(0>parseInt(c)||8<parseInt(c)?(this.setWarningText(Blockly.Msg.WARNING_CAN_INVALID_LEN),this.setDisabled(!0)):(this.setDisabled(!1),this.setWarningText(null)))}}};Blockly.Blocks.canframewrite={module:"can",init:function(){var d=[],c;for(c in Code.status.maps.canUnits){d.push([Code.status.maps.canUnits[c][0],c])}this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.CAN_WRITE).appendField(new Blockly.FieldDropdown(d),"MODULE").appendField(Blockly.Msg.CAN_WRITE_FRAME).appendField(new Blockly.wc.FieldCanFrame("frame"),"FRAME");this.setInputsInline(!0);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null);this.setColour(Blockly.Blocks.can.HUE);this.setTooltip(Blockly.Msg.CAN_WRITE_TOOLTIP)}};Blockly.Blocks.cantype={module:"can",init:function(){this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown([[Blockly.Msg.CAN_STD,"std"],[Blockly.Msg.CAN_EXT,"ext"]]),"TYPE");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.can.HUE);this.setTooltip(Blockly.Msg.CAN_TYPE_TOOLTIP)}};"use strict";Blockly.Blocks.loops={};Blockly.Blocks.loops.HUE=120;Blockly.Blocks.controls_repeat_ext={init:function(){this.jsonInit({message0:Blockly.Msg.CONTROLS_REPEAT_TITLE,args0:[{type:"input_value",name:"TIMES",check:"Number"}],previousStatement:null,nextStatement:null,colour:Blockly.Blocks.loops.HUE,tooltip:Blockly.Msg.CONTROLS_REPEAT_TOOLTIP,helpUrl:Blockly.Msg.CONTROLS_REPEAT_HELPURL});this.appendStatementInput("DO").appendField(Blockly.Msg.CONTROLS_REPEAT_INPUT_DO)}};Blockly.Blocks.controls_repeat={init:function(){this.jsonInit({message0:Blockly.Msg.CONTROLS_REPEAT_TITLE,args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],previousStatement:null,nextStatement:null,colour:Blockly.Blocks.loops.HUE,tooltip:Blockly.Msg.CONTROLS_REPEAT_TOOLTIP,helpUrl:this.getHelpUrl("controls_repeat")});this.appendStatementInput("DO").appendField(Blockly.Msg.CONTROLS_REPEAT_INPUT_DO)}};Blockly.Blocks.controls_whileUntil={init:function(){var d=[[Blockly.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE,"WHILE"],[Blockly.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL,"UNTIL"]];this.setHelpUrl(Blockly.Msg.CONTROLS_WHILEUNTIL_HELPURL);this.setColour(Blockly.Blocks.loops.HUE);this.appendValueInput("BOOL").setCheck("Boolean").appendField(new Blockly.FieldDropdown(d),"MODE");this.appendStatementInput("DO").appendField(Blockly.Msg.CONTROLS_WHILEUNTIL_INPUT_DO);this.setPreviousStatement(!0);this.setNextStatement(!0);var c=this;this.setTooltip(function(){var b=c.getFieldValue("MODE");return{WHILE:Blockly.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE,UNTIL:Blockly.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}[b]})}};Blockly.Blocks.controls_for={init:function(){this.jsonInit({message0:Blockly.Msg.CONTROLS_FOR_TITLE,args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:Blockly.Blocks.loops.HUE,helpUrl:Blockly.Msg.CONTROLS_FOR_HELPURL});this.appendStatementInput("DO").appendField(Blockly.Msg.CONTROLS_FOR_INPUT_DO);var b=this;this.setTooltip(function(){return Blockly.Msg.CONTROLS_FOR_TOOLTIP.replace("%1",b.getFieldValue("VAR"))})},customContextMenu:function(e){if(!this.isCollapsed()){var d={enabled:!0},f=this.getFieldValue("VAR");d.text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1",f);f=goog.dom.createDom("field",null,f);f.setAttribute("name","VAR");f=goog.dom.createDom("block",null,f);f.setAttribute("type","variables_get");d.callback=Blockly.ContextMenu.callbackFactory(this,f);e.push(d)}}};Blockly.Blocks.controls_forEach={init:function(){this.jsonInit({message0:Blockly.Msg.CONTROLS_FOREACH_TITLE,args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],previousStatement:null,nextStatement:null,colour:Blockly.Blocks.loops.HUE,helpUrl:Blockly.Msg.CONTROLS_FOREACH_HELPURL});this.appendStatementInput("DO").appendField(Blockly.Msg.CONTROLS_FOREACH_INPUT_DO);var b=this;this.setTooltip(function(){return Blockly.Msg.CONTROLS_FOREACH_TOOLTIP.replace("%1",b.getFieldValue("VAR"))})},customContextMenu:Blockly.Blocks.controls_for.customContextMenu};Blockly.Blocks.controls_flow_statements={init:function(){var d=[[Blockly.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK,"BREAK"],[Blockly.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE,"CONTINUE"]];this.setHelpUrl(Blockly.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL);this.setColour(Blockly.Blocks.loops.HUE);this.appendDummyInput().appendField(new Blockly.FieldDropdown(d),"FLOW");this.setPreviousStatement(!0);var c=this;this.setTooltip(function(){var b=c.getFieldValue("FLOW");return{BREAK:Blockly.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK,CONTINUE:Blockly.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}[b]})},onchange:function(d){if(this.workspace.isDragging&&!this.workspace.isDragging()){d=!1;var c=this;do{if(-1!=this.LOOP_TYPES.indexOf(c.type)){d=!0;break}c=c.getSurroundParent()}while(c);d?(this.setWarningText(null),this.isInFlyout||this.setDisabled(!1)):(this.setWarningText(Blockly.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0))}},LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]};"use strict";Blockly.Blocks.bitlogic_msb={init:function(){this.jsonInit({message0:Blockly.Msg.BITLOGIC_MSB_TITLE,args0:[{type:"input_value",name:"BOOL",check:"Number"}],output:"Number",colour:Blockly.Blocks.operators.HUE,tooltip:Blockly.Msg.BITLOGIC_MSB_TOOLTIP,helpUrl:Blockly.Msg.BITLOGIC_MSB_HELPURL})}};Blockly.Blocks.bitlogic_lsb={init:function(){this.jsonInit({message0:Blockly.Msg.BITLOGIC_LSB_TITLE,args0:[{type:"input_value",name:"BOOL",check:"Number"}],output:"Number",colour:Blockly.Blocks.operators.HUE,tooltip:Blockly.Msg.BITLOGIC_LSB_TOOLTIP,helpUrl:Blockly.Msg.BITLOGIC_LSB_HELPURL})}};Blockly.Blocks.bitwise_op={module:"bitwise",hasWatcher:!0,init:function(){var b=[];b.push(["&","and"]);b.push(["|","or"]);b.push([">>","rshift"]);b.push(["<<","lshift"]);this.appendValueInput("OP1").setCheck("Number");this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"OP");this.appendValueInput("OP2").setCheck("Number");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.operators.HUE);this.setTooltip(Blockly.Msg.BITWISE_TOOLTIP);this.setHelpUrl(Blockly.Msg.BITWISE_HELPURL)}};Blockly.Blocks.bitwise_unary_op={module:"bitwise",hasWatcher:!0,init:function(){var b=[];b.push(["~","not"]);this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(new Blockly.FieldDropdown(b),"OP");this.appendValueInput("OP1").setCheck("Number");this.setOutput(!0,null);this.setInputsInline(!0);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null);this.setColour(Blockly.Blocks.operators.HUE);this.setTooltip(Blockly.Msg.UNARY_BITWISE_TOOLTIP);this.setHelpUrl(Blockly.Msg.UNARY_BITWISE_HELPURL)}};"use strict";Blockly.Blocks.texts={};Blockly.Blocks.texts.HUE=160;Blockly.Blocks.text={init:function(){this.setHelpUrl(Blockly.Msg.TEXT_TEXT_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.appendDummyInput().appendField(this.newQuote_(!0)).appendField(new Blockly.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1));this.setOutput(!0,"String");var b=this;this.setTooltip(function(){var a=b.getParent();return a&&a.getInputsInline()&&a.tooltip||Blockly.Msg.TEXT_TEXT_TOOLTIP})},newQuote_:function(b){return new Blockly.FieldImage(b==this.RTL?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",12,12,'"')}};Blockly.Blocks.text_join={init:function(){this.setHelpUrl(Blockly.Msg.TEXT_JOIN_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.itemCount_=2;this.updateShape_();this.setOutput(!0,"String");this.setMutator(new Blockly.Mutator(["text_create_join_item"]));this.setTooltip(Blockly.Msg.TEXT_JOIN_TOOLTIP)},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("items",this.itemCount_);return b},domToMutation:function(b){this.itemCount_=parseInt(b.getAttribute("items"),10);this.updateShape_()},decompose:function(g){var f=g.newBlock("text_create_join_container");f.initSvg();for(var j=f.getInput("STACK").connection,i=0;i<this.itemCount_;i++){var h=g.newBlock("text_create_join_item");h.initSvg();j.connect(h.previousConnection);j=h.nextConnection}return f},compose:function(e){var d=e.getInputTargetBlock("STACK");for(e=[];d;){e.push(d.valueConnection_),d=d.nextConnection&&d.nextConnection.targetBlock()}for(d=0;d<this.itemCount_;d++){var f=this.getInput("ADD"+d).connection.targetConnection;f&&-1==e.indexOf(f)&&f.disconnect()}this.itemCount_=e.length;this.updateShape_();for(d=0;d<this.itemCount_;d++){Blockly.Mutator.reconnect(e[d],this,"ADD"+d)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");for(var d=0;e;){var f=this.getInput("ADD"+d);e.valueConnection_=f&&f.connection.targetConnection;d++;e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var d=0;d<this.itemCount_;d++){if(!this.getInput("ADD"+d)){var c=this.appendValueInput("ADD"+d);0==d&&c.appendField(Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH)}}for(;this.getInput("ADD"+d);){this.removeInput("ADD"+d),d++}},newQuote_:Blockly.Blocks.text.newQuote_};Blockly.Blocks.text_create_join_container={init:function(){this.setColour(Blockly.Blocks.texts.HUE);this.appendDummyInput().appendField(Blockly.Msg.TEXT_CREATE_JOIN_TITLE_JOIN);this.appendStatementInput("STACK");this.setTooltip(Blockly.Msg.TEXT_CREATE_JOIN_TOOLTIP);this.contextMenu=!1}};Blockly.Blocks.text_create_join_item={init:function(){this.setColour(Blockly.Blocks.texts.HUE);this.appendDummyInput().appendField(Blockly.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP);this.contextMenu=!1}};Blockly.Blocks.text_append={init:function(){this.setHelpUrl(Blockly.Msg.TEXT_APPEND_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.appendValueInput("TEXT").appendField(Blockly.Msg.TEXT_APPEND_TO).appendField(new Blockly.FieldVariable(Blockly.Msg.TEXT_APPEND_VARIABLE),"VAR").appendField(Blockly.Msg.TEXT_APPEND_APPENDTEXT);this.setPreviousStatement(!0);this.setNextStatement(!0);var b=this;this.setTooltip(function(){return Blockly.Msg.TEXT_APPEND_TOOLTIP.replace("%1",b.getFieldValue("VAR"))})}};Blockly.Blocks.text_length={init:function(){this.jsonInit({message0:Blockly.Msg.TEXT_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",colour:Blockly.Blocks.texts.HUE,tooltip:Blockly.Msg.TEXT_LENGTH_TOOLTIP,helpUrl:Blockly.Msg.TEXT_LENGTH_HELPURL})}};Blockly.Blocks.text_isEmpty={init:function(){this.jsonInit({message0:Blockly.Msg.TEXT_ISEMPTY_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",colour:Blockly.Blocks.texts.HUE,tooltip:Blockly.Msg.TEXT_ISEMPTY_TOOLTIP,helpUrl:Blockly.Msg.TEXT_ISEMPTY_HELPURL})}};Blockly.Blocks.text_indexOf={init:function(){var d=[[Blockly.Msg.TEXT_INDEXOF_OPERATOR_FIRST,"FIRST"],[Blockly.Msg.TEXT_INDEXOF_OPERATOR_LAST,"LAST"]];this.setHelpUrl(Blockly.Msg.TEXT_INDEXOF_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.setOutput(!0,"Number");this.appendValueInput("VALUE").setCheck("String").appendField(Blockly.Msg.TEXT_INDEXOF_INPUT_INTEXT);this.appendValueInput("FIND").setCheck("String").appendField(new Blockly.FieldDropdown(d),"END");Blockly.Msg.TEXT_INDEXOF_TAIL&&this.appendDummyInput().appendField(Blockly.Msg.TEXT_INDEXOF_TAIL);this.setInputsInline(!0);var c=this;this.setTooltip(function(){return Blockly.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",c.workspace.options.oneBasedIndex?"0":"-1")})}};Blockly.Blocks.text_charAt={init:function(){this.WHERE_OPTIONS=[[Blockly.Msg.TEXT_CHARAT_FROM_START,"FROM_START"],[Blockly.Msg.TEXT_CHARAT_FROM_END,"FROM_END"],[Blockly.Msg.TEXT_CHARAT_FIRST,"FIRST"],[Blockly.Msg.TEXT_CHARAT_LAST,"LAST"],[Blockly.Msg.TEXT_CHARAT_RANDOM,"RANDOM"]];this.setHelpUrl(Blockly.Msg.TEXT_CHARAT_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.setOutput(!0,"String");this.appendValueInput("VALUE").setCheck("String").appendField(Blockly.Msg.TEXT_CHARAT_INPUT_INTEXT);this.appendDummyInput("AT");this.setInputsInline(!0);this.updateAt_(!0);var b=this;this.setTooltip(function(){var a=b.getFieldValue("WHERE"),d=Blockly.Msg.TEXT_CHARAT_TOOLTIP;if("FROM_START"==a||"FROM_END"==a){d+="  "+("FROM_START"==a?Blockly.Msg.LISTS_INDEX_FROM_START_TOOLTIP:Blockly.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",b.workspace.options.oneBasedIndex?"#1":"#0")}return d})},mutationToDom:function(){var d=document.createElement("mutation"),c=this.getInput("AT").type==Blockly.INPUT_VALUE;d.setAttribute("at",c);return d},domToMutation:function(b){b="false"!=b.getAttribute("at");this.updateAt_(b)},updateAt_:function(d){this.removeInput("AT");this.removeInput("ORDINAL",!0);d?(this.appendValueInput("AT").setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");Blockly.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(Blockly.Msg.TEXT_CHARAT_TAIL));var c=new Blockly.FieldDropdown(this.WHERE_OPTIONS,function(a){var g="FROM_START"==a||"FROM_END"==a;if(g!=d){var f=this.sourceBlock_;f.updateAt_(g);f.setFieldValue(a,"WHERE");return null}});this.getInput("AT").appendField(c,"WHERE")}};Blockly.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[Blockly.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]];this.WHERE_OPTIONS_2=[[Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[Blockly.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]];this.setHelpUrl(Blockly.Msg.TEXT_GET_SUBSTRING_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.appendValueInput("STRING").setCheck("String").appendField(Blockly.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);this.appendDummyInput("AT1");this.appendDummyInput("AT2");Blockly.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(Blockly.Msg.TEXT_GET_SUBSTRING_TAIL);this.setInputsInline(!0);this.setOutput(!0,"String");this.updateAt_(1,!0);this.updateAt_(2,!0);this.setTooltip(Blockly.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var d=document.createElement("mutation"),c=this.getInput("AT1").type==Blockly.INPUT_VALUE;d.setAttribute("at1",c);c=this.getInput("AT2").type==Blockly.INPUT_VALUE;d.setAttribute("at2",c);return d},domToMutation:function(d){var c="true"==d.getAttribute("at1");d="true"==d.getAttribute("at2");this.updateAt_(1,c);this.updateAt_(2,d)},updateAt_:function(e,d){this.removeInput("AT"+e);this.removeInput("ORDINAL"+e,!0);d?(this.appendValueInput("AT"+e).setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e);2==e&&Blockly.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(Blockly.Msg.TEXT_GET_SUBSTRING_TAIL));var f=new Blockly.FieldDropdown(this["WHERE_OPTIONS_"+e],function(g){var b="FROM_START"==g||"FROM_END"==g;if(b!=d){var a=this.sourceBlock_;a.updateAt_(e,b);a.setFieldValue(g,"WHERE"+e);return null}});this.getInput("AT"+e).appendField(f,"WHERE"+e);1==e&&this.moveInputBefore("AT1","AT2")}};Blockly.Blocks.text_changeCase={init:function(){var b=[[Blockly.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[Blockly.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[Blockly.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(Blockly.Msg.TEXT_CHANGECASE_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.appendValueInput("TEXT").setCheck("String").appendField(new Blockly.FieldDropdown(b),"CASE");this.setOutput(!0,"String");this.setTooltip(Blockly.Msg.TEXT_CHANGECASE_TOOLTIP)}};Blockly.Blocks.text_trim={init:function(){var b=[[Blockly.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[Blockly.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[Blockly.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(Blockly.Msg.TEXT_TRIM_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.appendValueInput("TEXT").setCheck("String").appendField(new Blockly.FieldDropdown(b),"MODE");this.setOutput(!0,"String");this.setTooltip(Blockly.Msg.TEXT_TRIM_TOOLTIP)}};Blockly.Blocks.text_print={init:function(){this.jsonInit({message0:Blockly.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,colour:Blockly.Blocks.texts.HUE,tooltip:Blockly.Msg.TEXT_PRINT_TOOLTIP,helpUrl:Blockly.Msg.TEXT_PRINT_HELPURL})}};Blockly.Blocks.text_prompt_ext={init:function(){var d=[[Blockly.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[Blockly.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(Blockly.Msg.TEXT_PROMPT_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);var c=this,d=new Blockly.FieldDropdown(d,function(b){c.updateType_(b)});this.appendValueInput("TEXT").appendField(d,"TYPE");this.setOutput(!0,"String");this.setTooltip(function(){return"TEXT"==c.getFieldValue("TYPE")?Blockly.Msg.TEXT_PROMPT_TOOLTIP_TEXT:Blockly.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(b){this.outputConnection.setCheck("NUMBER"==b?"Number":"String")},mutationToDom:function(){var b=document.createElement("mutation");b.setAttribute("type",this.getFieldValue("TYPE"));return b},domToMutation:function(b){this.updateType_(b.getAttribute("type"))}};Blockly.Blocks.text_prompt={init:function(){var d=[[Blockly.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[Blockly.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],c=this;this.setHelpUrl(Blockly.Msg.TEXT_PROMPT_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);d=new Blockly.FieldDropdown(d,function(b){c.updateType_(b)});this.appendDummyInput().appendField(d,"TYPE").appendField(this.newQuote_(!0)).appendField(new Blockly.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1));this.setOutput(!0,"String");this.setTooltip(function(){return"TEXT"==c.getFieldValue("TYPE")?Blockly.Msg.TEXT_PROMPT_TOOLTIP_TEXT:Blockly.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},newQuote_:Blockly.Blocks.text.newQuote_,updateType_:Blockly.Blocks.text_prompt_ext.updateType_,mutationToDom:Blockly.Blocks.text_prompt_ext.mutationToDom,domToMutation:Blockly.Blocks.text_prompt_ext.domToMutation};"use strict";Blockly.Blocks.textadds={};Blockly.Blocks.pack_create_container={init:function(){this.setColour(Blockly.Blocks.texts.HUE);this.appendDummyInput().appendField(Blockly.Msg.TEXT_PACK_TITLE1);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.TEXT_PACK_TITLE1);this.contextMenu=!1}};Blockly.Blocks.pack_create_item_with={init:function(){this.setColour(Blockly.Blocks.texts.HUE);this.appendDummyInput().appendField(Blockly.Msg.TEXT_PACK_TITLE2);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.TEXT_PACK_TITLE2);this.contextMenu=!0}};Blockly.Blocks.text_pack={hasWatcher:!0,init:function(){this.setHelpUrl(Blockly.Msg.TEXT_PACK_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.TEXT_PACK_TITLE1);this.appendValueInput("WITH0").appendField(Blockly.Msg.TEXT_PACK_TITLE2).setAlign(Blockly.ALIGN_RIGHT);this.toCount_=this.withCount_=1;this.setOutput(!0,null);this.setMutator(new Blockly.Mutator(["pack_create_item_with"]));this.setTooltip(Blockly.Msg.TEXT_PACK_TOOLTIP);this.setPreviousStatement(!1,null);this.setNextStatement(!1,null)},mutationToDom:function(){if(!this.withCount_&&!this.toCount_){return null}var b=document.createElement("mutation");this.withCount_&&b.setAttribute("with",this.withCount_);this.toCount_&&b.setAttribute("to",this.toCount_);return b},domToMutation:function(b){this.withCount_=parseInt(b.getAttribute("with"),10)||0;this.updateShape_()},decompose:function(g){var f=g.newBlock("pack_create_container");f.initSvg();for(var j=f.nextConnection,i=1;i<=this.withCount_;i++){var h=g.newBlock("pack_create_item_with");h.initSvg();j.connect(h.previousConnection);j=h.nextConnection}return f},compose:function(d){var c=d.nextConnection.targetBlock();this.toCount_=this.withCount_=0;for(d=[null];c;){switch(c.type){case"pack_create_item_with":this.withCount_++;d.push(c.withConnection_);break;default:throw"Unknown block type."}c=c.nextConnection&&c.nextConnection.targetBlock()}this.updateShape_();for(c=1;c<=this.withCount_;c++){Blockly.Mutator.reconnect(d[c],this,"WITH"+c)}},saveConnections:function(e){e=e.nextConnection.targetBlock();for(var d=1;e;){switch(e.type){case"pack_create_item_with":var f=this.getInput("WITH"+d);e.withConnection_=f&&f.connection.targetConnection;d++;break;default:throw"Unknown block type."}e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_:function(){for(var b=1;this.getInput("WITH"+b);){this.removeInput("WITH"+b),b++}for(b=0;b<this.withCount_;b++){this.getInput("WITH"+b)||this.appendValueInput("WITH"+b).appendField(Blockly.Msg.TEXT_PACK_TITLE2).setAlign(Blockly.ALIGN_RIGHT)}}};Blockly.Blocks.unpack_create_container={init:function(){this.setColour(Blockly.Blocks.texts.HUE);this.appendDummyInput().appendField(Blockly.Msg.TEXT_UNPACK_TITLE1);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.TEXT_UNPACK_TITLE1);this.contextMenu=!1}};Blockly.Blocks.unpack_create_item_to={init:function(){this.setColour(Blockly.Blocks.texts.HUE);this.appendDummyInput().appendField(Blockly.Msg.TEXT_UNPACK_TITLE2);this.setPreviousStatement(!0);this.setNextStatement(!0);this.setTooltip(Blockly.Msg.TEXT_UNPACK_TITLE2);this.contextMenu=!0}};Blockly.Blocks.text_unpack={init:function(){this.setHelpUrl(Blockly.Msg.TEXT_UNPACK_HELPURL);this.setColour(Blockly.Blocks.texts.HUE);this.appendValueInput("FROM0").appendField(Blockly.Msg.TEXT_UNPACK_TITLE1);this.appendValueInput("TO0").appendField(Blockly.Msg.TEXT_UNPACK_TITLE2).setAlign(Blockly.ALIGN_RIGHT);this.fromCount_=this.toCount_=1;this.setOutput(!1,null);this.setMutator(new Blockly.Mutator(["unpack_create_item_to"]));this.setTooltip(Blockly.Msg.TEXT_UNPACK_TOOLTIP);this.setPreviousStatement(!0,null);this.setNextStatement(!0,null)},mutationToDom:function(){if(!this.toCount_){return null}var b=document.createElement("mutation");this.toCount_&&b.setAttribute("with",this.toCount_);return b},domToMutation:function(b){this.toCount_=parseInt(b.getAttribute("with"),10)||0;this.updateShape_()},decompose:function(g){var f=g.newBlock("unpack_create_container");f.initSvg();for(var j=f.nextConnection,i=1;i<=this.toCount_;i++){var h=g.newBlock("unpack_create_item_to");h.initSvg();j.connect(h.previousConnection);j=h.nextConnection}return f},compose:function(d){var c=d.nextConnection.targetBlock();this.toCount_=0;for(d=[null];c;){switch(c.type){case"unpack_create_item_to":this.toCount_++;d.push(c.toConnection_);break;default:throw"Unknown block type."}c=c.nextConnection&&c.nextConnection.targetBlock()}this.updateShape_();for(c=1;c<=this.toCount_;c++){Blockly.Mutator.reconnect(d[c],this,"TO"+c)}},saveConnections:function(e){e=e.nextConnection.targetBlock();for(var d=1;e;){switch(e.type){case"unpack_create_item_to":var f=this.getInput("TO"+d);e.toConnection_=f&&f.connection.targetConnection;d++;break;default:throw"Unknown block type."}e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_:function(){for(var b=1;this.getInput("TO"+b);){this.removeInput("TO"+b),b++}for(b=1;this.getInput("FROM"+b);){this.removeInput("FROM"+b),b++}for(b=0;b<this.toCount_;b++){this.getInput("TO"+b)||this.appendValueInput("TO"+b).appendField(Blockly.Msg.TEXT_UNPACK_TITLE2).setAlign(Blockly.ALIGN_RIGHT)}}};"use strict";goog.require("Blockly.Workspace");goog.require("Blockly.Sensors");goog.require("goog.array");goog.require("goog.math");Blockly.Workspace.prototype.getSensors=function(h){if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){var a=require("fs");var g=require("path");var d="boards/defs/sensors.json";var c=g.join(process.cwd(),d);try{var f=a.readFileSync(c,"utf8")}catch(b){return}try{var e=JSON.parse(f);h(e)}catch(b){h(JSON.parse("{}"))}}else{jQuery.ajax({url:Code.folder+"/boards/defs/sensors.json",success:function(i){h(i);return},error:function(){h(JSON.parse("{}"))}})}}else{jQuery.ajax({url:Code.folder+"/boards/defs/sensors.json",success:function(i){h(i);return},error:function(){h(JSON.parse("{}"))}})}};Blockly.Workspace.prototype.wcInit=function(){var b=this;if(typeof this.lora=="undefined"){this.lora={band:"868",activation:"ABP",dr:"4",retx:"0",adr:"false",deveui:"",appeui:"",appkey:"",devaddr:"",nwkskey:"",appskey:""}}if(typeof this.Wifi=="undefined"){this.Wifi={wtype:"STA",ssid:"",password:""}}if(typeof this.MQTT=="undefined"){this.MQTT={clientid:"",host:"",port:"1883",secure:false,username:"",password:""}}if(typeof this.sensors=="undefined"){this.sensors={names:[],provides:[],properties:[],setup:[]}}if(typeof this.allSensors=="undefined"){this.getSensors(function(c){b.allSensors=c})}if(typeof this.events=="undefined"){this.events={builtIn:["event"],names:[]};var a;for(a=0;a<this.events.builtIn.length;a++){this.events.names.push(this.events.builtIn[a])}}if(typeof this.canFrames=="undefined"){this.canFrames={builtIn:["frame"],names:[]};var a;for(a=0;a<this.canFrames.builtIn.length;a++){this.canFrames.names.push(this.canFrames.builtIn[a])}}this.registerToolboxCategoryCallback(Blockly.Sensors.NAME_TYPE,Blockly.Sensors.flyoutCategory);this.registerToolboxCategoryCallback(Blockly.Lora.NAME_TYPE,Blockly.Lora.flyoutCategory);this.registerToolboxCategoryCallback(Blockly.Wifi.NAME_TYPE,Blockly.Wifi.flyoutCategory);this.registerToolboxCategoryCallback(Blockly.MQTT.NAME_TYPE,Blockly.MQTT.flyoutCategory)};Blockly.Workspace.prototype.eventIndexOf=function(b){for(var c=0,a;a=this.events.names[c];c++){if(Blockly.Names.equals(a,b)){return c}}return -1};Blockly.Workspace.prototype.canFrameIndexOf=function(b){for(var c=0,a;a=this.canFrames.names[c];c++){if(Blockly.Names.equals(a,b)){return c}}return -1};Blockly.Workspace.prototype.doCreateEvent=function(c,a){var d=(typeof c!="undefined");if(!d){c=a}var b=this.eventIndexOf(c);if(d){if(b==-1){return -1}else{if(this.eventIndexOf(a)==-1){this.events.names[b]=a}else{return -1}}}else{if(this.eventIndexOf(a)==-1){this.events.names.push(a)}else{return -1}}return this.eventIndexOf(a)};Blockly.Workspace.prototype.doCreateCanFrame=function(c,a){var d=(typeof c!="undefined");if(!d){c=a}var b=this.canFrameIndexOf(c);if(d){if(b==-1){return -1}else{if(this.canFrameIndexOf(a)==-1){this.canFrames.names[b]=a}else{return -1}}}else{if(this.canFrameIndexOf(a)==-1){this.canFrames.names.push(a)}else{return -1}}return this.canFrameIndexOf(a)};Blockly.Workspace.prototype.createEvent=function(d,a){var f=this;var g="";var e=false;if(typeof d!="undefined"){e=true}if(e){var b=this.eventIndexOf(d);if(b<this.events.builtIn.length){Code.showError(Blockly.Msg.ERROR,Blockly.Msg.EVENT_CANNOT_RENAME,function(){});return}}g='<form id="event_form">';g+="<div>";g+='<label for="event_name">'+Blockly.Msg.EVENT_NAME+":&nbsp;&nbsp;</label>";if(e){g+='<input id="event_name" event_name="name" value="'+d+'">'}else{g+='<input id="event_name" name="event_name" value="">'}g+="</div>";g+="</form>";var c=bootbox.dialog({title:e?Blockly.Msg.EDIT_EVENT_TITLE:Blockly.Msg.NEW_EVENT_TITLE,message:g,buttons:{main:{label:e?Blockly.Msg.UPDATE:Blockly.Msg.EVENT_CREATE,clasevent:"btn-primary",callback:function(){var h=jQuery("#event_form").find("#event_name").val();if(h){if((f.eventIndexOf(h)==-1)||(e&&d==h)){var i=f.doCreateEvent(e?d:undefined,h);a.setValue(h);a.setText(h)}else{Code.showError(Blockly.Msg.ERROR,Blockly.Msg.EVENT_ALREADY_EXISTS.replace("%1",h),function(){})}}}},danger:{label:Blockly.Msg.EVENT_CANCEL,clasevent:"btn-danger",callback:function(){}}},closable:false});c.one("shown.bs.modal",function(){c.find("#event_name").focus()})};Blockly.Workspace.prototype.createCanFrame=function(d,a){var f=this;var g="";var e=false;if(typeof d!="undefined"){e=true}if(e){var b=this.canFrameIndexOf(d);if(b<this.canFrames.builtIn.length){Code.showError(Blockly.Msg.ERROR,Blockly.Msg.CAN_FRAME_CANNOT_RENAME,function(){});return}}g='<form id="can_frame_form">';g+="<div>";g+='<label for="frame_name">'+Blockly.Msg.CAN_FRAME_NAME+":&nbsp;&nbsp;</label>";if(e){g+='<input id="frame_name" frame_name="name" value="'+d+'">'}else{g+='<input id="frame_name" name="frame_name" value="">'}g+="</div>";g+="</form>";var c=bootbox.dialog({title:e?Blockly.Msg.EDIT_CAN_FRAME_TITLE:Blockly.Msg.NEW_CAN_FRAME_TITLE,message:g,buttons:{main:{label:e?Blockly.Msg.UPDATE:Blockly.Msg.CAN_FRAME_CREATE,clasevent:"btn-primary",callback:function(){var h=jQuery("#can_frame_form").find("#frame_name").val();if(h){if((f.canFrameIndexOf(h)==-1)||(e&&d==h)){var i=f.doCreateCanFrame(e?d:undefined,h);a.setValue(h);a.setText(h)}else{Code.showError(Blockly.Msg.ERROR,Blockly.Msg.CAN_FRAME_ALREADY_EXISTS.replace("%1",h),function(){})}}}},danger:{label:Blockly.Msg.CAN_FRAME_CANCEL,clasevent:"btn-danger",callback:function(){}}},closable:false});c.one("shown.bs.modal",function(){c.find("#frame_name").focus()})};Blockly.Workspace.prototype.deleteEvent=function(c,a){var b=this.eventIndexOf(c);if(b<this.events.builtIn.length){Code.showError(Blockly.Msg.ERROR,Blockly.Msg.EVENT_CANNOT_REMOVE,function(){})}else{this.events.names.splice(b,1);a.setValue(this.events.names[0]);a.setText(this.events.names[0])}};Blockly.Workspace.prototype.deleteCanFrame=function(c,a){var b=this.canFrameIndexOf(c);if(b<this.canFrames.builtIn.length){Code.showError(Blockly.Msg.ERROR,Blockly.Msg.CAN_FRAME_CANNOT_REMOVE,function(){})}else{this.canFrames.names.splice(b,1);a.setValue(this.canFrames.names[0]);a.setText(this.canFrames.names[0])}};Blockly.Workspace.prototype.sensorIndexOf=function(b){for(var c=0,a;a=this.sensors.names[c];c++){if(Blockly.Names.equals(a,b)){return c}}return -1};Blockly.Workspace.prototype.createSensor=function(c,d){var k=this;var f=(typeof c!="undefined");var b;if(f){b=c}else{b=d.name}var h=this.sensorIndexOf(b);if(f){this.sensors.names[h]=d.name;Code.status.sensors.forEach(function(j,i){if(j.id==d.id){k.sensors.setup[h]=d;k.sensors.provides[h]=j.provides;k.sensors.properties[h]=j.properties}});var a=this.getAllBlocks();for(var g=0;g<a.length;g++){if((a[g].type=="sensor_attach")||(a[g].type=="sensor_read")||(a[g].type=="sensor_set")||(a[g].type=="sensor_when")){if(a[g]["name"]==c){a[g]["interface"]=d["interface"];a[g]["name"]=d.name;for(var e=0;e<a[g]["interface"].split(",").length;e++){a[g]["interface"+e+"_unit"]=d["interface"+e+"_unit"];a[g]["interface"+e+"_subunit"]=d["interface"+e+"_subunit"];a[g]["interface"+e+"_device"]=d["interface"+e+"_device"]}a[g].updateShape_()}}}}else{if(h==-1){this.sensors.names.push(b);h=this.sensorIndexOf(b);Code.status.sensors.forEach(function(j,i){if(j.id==d.id){k.sensors.setup[h]=d;k.sensors.provides[h]=j.provides;k.sensors.properties[h]=j.properties}})}}};Blockly.Workspace.prototype.configureLora=function(a){var c=this;c.lora=a;var e=this.getAllBlocks();for(var b=0;b<e.length;b++){var d=e[b];if((d.type=="lora_join")||(d.type=="lora_tx")){d.band=a.band;d.activation=a.activation;d.dr=a.dr;d.retx=a.retx;d.deveui=a.deveui;d.appeui=a.appeui;d.appkey=a.appkey;d.devaddr=a.devaddr;d.nwkskey=a.nwkskey;d.appskey=a.appskey}}};Blockly.Workspace.prototype.configureWifi=function(a){var c=this;c.Wifi=a;var e=this.getAllBlocks();for(var b=0;b<e.length;b++){var d=e[b];if((d.type=="wifi_start")||(d.type=="wifi_stop")){d.wtype=a.wtype;d.ssid=a.ssid;d.password=a.password}}};Blockly.Workspace.prototype.configureMQTT=function(a){var c=this;c.MQTT=a;var e=this.getAllBlocks();for(var b=0;b<e.length;b++){var d=e[b];if((d.type=="mqtt_publish")||(d.type=="mqtt_subscribe")){d.clientid=a.clientid;d.host=a.host;d.port=a.port;d.secure=a.secure;d.username=a.username;d.password=a.password}}};Blockly.Workspace.prototype.removeSensor=function(c){var a=this.sensorIndexOf(c.name);this.sensors.names.splice(a,1);this.sensors.provides.splice(a,1);this.sensors.properties.splice(a,1);this.sensors.setup.splice(a,1);this.toolbox_.refreshSelection();var d=this.getAllBlocks();for(var b=0;b<d.length;b++){if((d[b].type=="sensor_attach")||(d[b].type=="sensor_read")||(d[b].type=="sensor_set")){if(d[b].name==c.name){d[b].dispose(true)}}}};Blockly.BlockSvg.prototype.addError=function(){Blockly.utils.addClass((this.svgGroup_),"blocklyError");var b=this;do{var a=b.getSvgRoot();a.parentNode.appendChild(a);b=b.getParent()}while(b)};Blockly.BlockSvg.prototype.removeError=function(){Blockly.utils.removeClass((this.svgGroup_),"blocklyError")};Blockly.BlockSvg.prototype.addStart=function(){Blockly.utils.addClass((this.svgGroup_),"blocklyStarted");var b=this;do{var a=b.getSvgRoot();a.parentNode.appendChild(a);b=b.getParent()}while(b)};Blockly.BlockSvg.prototype.removeStart=function(){Blockly.utils.removeClass((this.svgGroup_),"blocklyStarted")};Blockly.Css.CONTENT.push(".blocklyStarted>.blocklyPath {","stroke: #00c800;","stroke-width: 4px;","}");Blockly.Css.CONTENT.push(".blocklyStarted>.blocklyPathLight {","display: none;","}");Blockly.Css.CONTENT.push(".blocklyError>.blocklyPath {","stroke: #ff0000;","stroke-width: 4px;","}");Blockly.Css.CONTENT.push(".blocklyError>.blocklyPathLight {","display: none;","}");Blockly.BlockSvg.prototype.updateColour=function(){if(this.disabled){return}var k=this.getColour();var d=goog.color.hexToRgb(k);if(this.isShadow()){k=goog.color.rgbArrayToHex(d);this.svgPathLight_.style.display="none";this.svgPathDark_.setAttribute("fill",k)}else{this.svgPathLight_.style.display="";var a=goog.color.rgbArrayToHex(goog.color.lighten(d,0.3));var b=goog.color.rgbArrayToHex(goog.color.darken(d,0.2));this.svgPathLight_.setAttribute("stroke",a);this.svgPathDark_.setAttribute("fill",b)}this.svgPath_.setAttribute("fill",k);var j=this.getIcons();for(var c=0;c<j.length;c++){j[c].updateColour()}for(var h=0,g;g=this.inputList[h];h++){for(var e=0,f;f=g.fieldRow[e];e++){f.setText(null)}}};Blockly.WorkspaceSvg.prototype.removeErrors=function(){var b=this.getAllBlocks();for(var a=0;a<b.length;a++){b[a].removeError();b[a].setWarningText(null)}};Blockly.WorkspaceSvg.prototype.removeStarts=function(){var b=this.getAllBlocks();for(var a=0;a<b.length;a++){b[a].removeStart()}};Blockly.Workspace.prototype.migratePinField=function(d){var b=d.childNodes.length;for(var c=0;c<b;c++){var e=d.childNodes[c];var a=e.nodeName.toLowerCase();if(a=="field"){var j=e.getAttribute("name");if(j=="PIN"){var g=goog.dom.createDom("value");g.setAttribute("name","PIN");var h=goog.dom.createDom("shadow");h.setAttribute("type","output_digital_pin");var f=goog.dom.createDom("field");f.setAttribute("name","PIN");f.innerText=e.innerText;h.appendChild(f);g.appendChild(h);d.childNodes[c].outerHTML=g.outerHTML}}}return d};Blockly.Workspace.prototype.migrateExternalADC=function(c){var a=c.childNodes.length;for(var d=0;d<a;d++){var e=c.childNodes[d];var b=e.nodeName.toLowerCase();if(b=="field"){var f=e.getAttribute("name");if(f=="UNIT"){}}}return c};Blockly.Workspace.prototype.migrateTimeField=function(d){var b=d.childNodes.length;for(var c=0;c<b;c++){var e=d.childNodes[c];var a=e.nodeName.toLowerCase();if(a=="field"){var j=e.getAttribute("name");if(j=="time"){var g=goog.dom.createDom("value");g.setAttribute("name","TIME");var h=goog.dom.createDom("shadow");h.setAttribute("type","math_number");var f=goog.dom.createDom("field");f.setAttribute("name","NUM");f.innerText=e.innerText;h.appendChild(f);g.appendChild(h);d.childNodes[c].outerHTML=g.outerHTML}}}return d};Blockly.Workspace.prototype.migrateMutation=function(c){var a=c.childNodes.length;for(var d=0;d<a;d++){var e=c.childNodes[d];var b=e.nodeName.toLowerCase();if(b=="mutation"){if(e.getAttribute("pin")||e.getAttribute("device")||e.getAttribute("unit")){if(e.getAttribute("interface")=="ADC"){if(!e.getAttribute("unit")){e.setAttribute("interface0_unit",1);e.setAttribute("interface0_subunit",e.getAttribute("pin"));e.setAttribute("interface0_device",e.getAttribute("device"))}else{if(!e.getAttribute("unit")){e.setAttribute("unit",1)}e.setAttribute("interface0_unit",e.getAttribute("unit"));e.setAttribute("interface0_subunit",e.getAttribute("pin"));e.setAttribute("interface0_device",e.getAttribute("device"))}}else{if(!e.getAttribute("unit")){e.setAttribute("unit",1)}e.setAttribute("interface0_unit",e.getAttribute("pin"));e.setAttribute("interface0_subunit",e.getAttribute("unit"));e.setAttribute("interface0_device",e.getAttribute("device"))}e.removeAttribute("pin");e.removeAttribute("unit");e.removeAttribute("device")}else{if(e.getAttribute("interface")=="ADC"){}}}}return c};Blockly.Workspace.prototype.migrate=function(c){var a=c.childNodes.length;for(var d=0;d<a;d++){var f=c.childNodes[d];var b=f.nodeName.toLowerCase();var e="";if(typeof f.getAttribute=="function"){e=f.getAttribute("type")}if((e=="setdigitalpin")||(e=="getdigitalpin")||(e=="getanalogpin")||(e=="setpwmpin")||(e=="when_digital_pin")||(e=="servo_move")){f=this.migratePinField(f);f=this.migrate(f)}else{if(e=="wait_for"){f=this.migrateTimeField(f);f=this.migrate(f)}else{if((e=="sensor_read")||(e=="sensor_set")||(e=="sensor_when")){f=this.migrateMutation(f);f=this.migrate(f)}else{if(e=="getexternalanalogchannel"){f=this.migrateExternalADC(f);f=this.migrate(f)}else{f=this.migrate(f)}}}}}return c};Blockly.Workspace.prototype.clear=function(){var a=Blockly.Events.getGroup();if(!a){Blockly.Events.setGroup(true)}while(this.topBlocks_.length){this.topBlocks_[0].dispose()}if(!a){Blockly.Events.setGroup(false)}this.variableList.length=0;this.lora=undefined;this.Wifi=undefined;this.MQTT=undefined;this.sensors=undefined;this.events=undefined;this.canFrames=undefined;this.wcInit()};"use strict";goog.provide("Blockly.Sensors");goog.require("Blockly.Blocks");goog.require("Blockly.Workspace");goog.require("goog.string");goog.require("Blockly.Blocks.io.helper");Blockly.Sensors.NAME_TYPE="SENSOR";Blockly.Sensors.flyoutCategory=function(a){var c=[];var d=a.sensors;var b=goog.dom.createDom("button");b.setAttribute("text",Blockly.Msg.NEW_SENSOR);b.setAttribute("callbackKey","CREATE_SENSOR");a.registerButtonCallback("CREATE_SENSOR",function(e){Blockly.Sensors.createSensor(e.getTargetWorkspace())});c.push(b);d.names.forEach(function(f,k){if(Blockly.Blocks.sensor_attach&&(Code.blockAbstraction==blockAbstraction.Low)){var g=goog.dom.createDom("mutation","");g.setAttribute("interface",d.setup[k]["interface"]);g.setAttribute("sid",d.setup[k].id);g.setAttribute("name",f);for(var j=0;j<d.setup[k]["interface"].split(",").length;j++){g.setAttribute("interface"+j+"_unit",d.setup[k]["interface"+j+"_unit"]);g.setAttribute("interface"+j+"_subunit",d.setup[k]["interface"+j+"_subunit"]);g.setAttribute("interface"+j+"_device",d.setup[k]["interface"+j+"_device"])}var h=goog.dom.createDom("block");h.setAttribute("type","sensor_attach");var m=d.setup[k].id;if(typeof Blockly.Msg[m]!="undefined"){m=Blockly.Msg[m]}var l=goog.dom.createDom("field",null,Blockly.Msg.SENSOR_ACQUIRE.replace("%1",f).replace("%2",m));l.setAttribute("name","NAME");h.appendChild(l);h.appendChild(g);c.push(h)}if(Blockly.Blocks.sensor_when){var e=false;Code.status.sensors.forEach(function(p,i){if(p.id==d.setup[k].id){d.setup.forEach(function(q,r){if(p.id==q.id){if(typeof p.callback=="string"){e=(p.callback=="true")}else{e=p.callback}}})}});if(e){var g=goog.dom.createDom("mutation","");g.setAttribute("interface",d.setup[k]["interface"]);g.setAttribute("sid",d.setup[k].id);g.setAttribute("name",f);for(var j=0;j<d.setup[k]["interface"].split(",").length;j++){g.setAttribute("interface"+j+"_unit",d.setup[k]["interface"+j+"_unit"]);g.setAttribute("interface"+j+"_subunit",d.setup[k]["interface"+j+"_subunit"]);g.setAttribute("interface"+j+"_device",d.setup[k]["interface"+j+"_device"])}var h=goog.dom.createDom("block");h.setAttribute("type","sensor_when");var m=d.setup[k].id;if(typeof Blockly.Msg[m]!="undefined"){m=Blockly.Msg[m]}var l=goog.dom.createDom("field",null,Blockly.Msg.SENSOR_WHEN2.replace("%1",f).replace("%2",m));l.setAttribute("name","NAME");h.appendChild(l);var l=goog.dom.createDom("field",null,a.sensors.provides[k][0].id);l.setAttribute("name","PROVIDES");h.appendChild(l);h.appendChild(l);h.appendChild(g);c.push(h)}}if(Blockly.Blocks.sensor_read){var g=goog.dom.createDom("mutation","");g.setAttribute("interface",d.setup[k]["interface"]);g.setAttribute("sid",d.setup[k].id);g.setAttribute("name",f);for(var j=0;j<d.setup[k]["interface"].split(",").length;j++){g.setAttribute("interface"+j+"_unit",d.setup[k]["interface"+j+"_unit"]);g.setAttribute("interface"+j+"_subunit",d.setup[k]["interface"+j+"_subunit"]);g.setAttribute("interface"+j+"_device",d.setup[k]["interface"+j+"_device"])}var h=goog.dom.createDom("block");h.setAttribute("type","sensor_read");var m=d.setup[k].id;if(typeof Blockly.Msg[m]!="undefined"){m=Blockly.Msg[m]}var l=goog.dom.createDom("field",null,Blockly.Msg.SENSOR_READ2.replace("%1",f).replace("%2",m));l.setAttribute("name","NAME");h.appendChild(l);var l=goog.dom.createDom("field",null,a.sensors.provides[k][0].id);l.setAttribute("name","PROVIDES");h.appendChild(l);h.appendChild(l);h.appendChild(g);c.push(h)}if(Blockly.Blocks.sensor_set&&(a.sensors.properties[k].length>0)){var g=goog.dom.createDom("mutation","");g.setAttribute("interface",d.setup[k]["interface"]);g.setAttribute("sid",d.setup[k].id);g.setAttribute("name",f);for(var j=0;j<d.setup[k]["interface"].split(",").length;j++){g.setAttribute("interface"+j+"_unit",d.setup[k]["interface"+j+"_unit"]);g.setAttribute("interface"+j+"_subunit",d.setup[k]["interface"+j+"_subunit"]);g.setAttribute("interface"+j+"_device",d.setup[k]["interface"+j+"_device"])}var h=goog.dom.createDom("block");h.setAttribute("type","sensor_set");var m=d.setup[k].id;if(typeof Blockly.Msg[m]!="undefined"){m=Blockly.Msg[m]}var l=goog.dom.createDom("field",null,Blockly.Msg.SENSOR_SET3.replace("%1",f).replace("%2",m));l.setAttribute("name","NAME");h.appendChild(l);var l=goog.dom.createDom("field",null,a.sensors.properties[k][0].id);l.setAttribute("name","PROPERTIES");h.appendChild(l);var l=goog.dom.createDom("field",null,"0");l.setAttribute("name","NUM");var o=goog.dom.createDom("shadow",null,l);o.setAttribute("type","math_number");var n=goog.dom.createDom("value",null,o);n.setAttribute("name","VALUE");h.appendChild(n);h.appendChild(l);h.appendChild(g);c.push(h)}});return c};Blockly.Sensors.categoryChanged=function(){var d=this;var c=jQuery("#sensor_form");var a=c.find("#cat").find(":selected").attr("value");if(a==Blockly.Msg.NEW_SENSOR_SELECT_ONE){a=""}c.find(".id").hide();c.find(".sensor_name").hide();c.find(".sensor_interfaces").html("");if(a=="other"){var b='<option data-interface="" value="">'+Blockly.Msg.NEW_SENSOR_SELECT_ONE+"</option>";Code.status.sensors.forEach(function(g){var f=true;d.currentWS.allSensors.sensors.forEach(function(h){if(h.id==g.id){f=false}});if(f){var e=g.id;if(typeof Blockly.Msg[e]!="undefined"){e=Blockly.Msg[e]}b+='<option data-interface="'+g["interface"]+'" value="'+g.id+'">'+e+"</option>"}});c.find("#id").html(b);c.find(".id").show()}else{d.currentWS.allSensors.categories.forEach(function(f){if(f.id==a){var e='<option data-interface="" value="">'+Blockly.Msg.NEW_SENSOR_SELECT_ONE+"</option>";f.sensors.forEach(function(h){var g=null;Code.status.sensors.forEach(function(j){if(j.id==h.id){g=j}});if(g){var i=g.id;if(i.match(/^\d/)){i="S"+i}if(typeof Blockly.Msg[i]!="undefined"){i=Blockly.Msg[i]}else{i=g.id}e+='<option data-interface="'+g["interface"]+'" value="'+g.id+'">'+i+"</option>"}});c.find("#id").html(e);c.find(".id").show()}})}};Blockly.Sensors.InterfaceName=function(c,a){var b="";Code.status.sensors.forEach(function(f,d){if(f.id==c){if(typeof f.interface_name!="undefined"){var e=f.interface_name.split(",")[a];if((typeof e!="undefined")&&(e!="")){b=Blockly.Msg.SENSOR_INT_ATTACHED.replace("%1",e)}else{b=Blockly.Msg.SENSOR_INT_ATTACHED.replace("%1",Blockly.Msg.SENSOR)}}else{b=Blockly.Msg.SENSOR_INT_ATTACHED.replace("%1",Blockly.Msg.SENSOR)}}});return b};Blockly.Sensors.GPIOSelection=function(g,b,f,h){var d="";var c=[];var a="";for(var i in Code.status.maps.digitalPins){c.push([Code.status.maps.digitalPins[i][3]+" - "+Code.status.maps.digitalPins[i][0].replace(/pio\.P/i,"").replace(/_/i,""),i])}var a='<select id="interface'+g+'_unit" name="interface'+g+'_unit">';c.forEach(function(j){a+="<option "+((h&&(j[1]==f["interface"+g+"_unit"]))?"selected":"")+' value="'+j[1]+'">'+j[0]+"</option>"});a+="</select>";var e=Blockly.Sensors.InterfaceName(b,g);if(h){d+="<div>";d+='<label for="gpio">'+e+":&nbsp;&nbsp;</label>"+a;d+="</div>"}else{d+='<div id="GPIO_sensor">';d+='<label for="gpio">'+e+":&nbsp;&nbsp;</label>"+a;d+="</div>"}return d};Blockly.Sensors.I2CSelection=function(g,a,f,h){var c="";var b=[];var d="";for(var i in Code.status.maps.i2cUnits){b.push([Code.status.maps.i2cUnits[i][1],i])}var d='<select id="interface'+g+'_unit" name="interface'+g+'_unit">';b.forEach(function(j){d+="<option "+((h&&(j[1]==f["interface"+g+"_unit"]))?"selected":"")+' value="'+j[1]+'">'+j[0]+"</option>"});d+="</select>";var e=Blockly.Sensors.InterfaceName(a,g);if(h){c+="<div>";c+='<label for="i2c">'+e+":&nbsp;&nbsp;</label>"+d;c+="</div>"}else{c+='<div id="I2C_sensor">';c+='<label for="i2c">'+e+":&nbsp;&nbsp;</label>"+d;c+="</div>"}return c};Blockly.Sensors.UARTSelection=function(f,a,d,g){var b="";var h=[];var e="";for(var i in Code.status.maps.uartUnits){h.push([Code.status.maps.uartUnits[i][1],i])}var e='<select id="interface'+f+'_unit" name="interface'+f+'_unit">';h.forEach(function(j){e+="<option "+((g&&(j[1]==d["interface"+f+"_unit"]))?"selected":"")+' value="'+j[1]+'">'+j[0]+"</option>"});e+="</select>";var c=Blockly.Sensors.InterfaceName(a,f);if(g){b+="<div>";b+='<label for="uart">'+c+":&nbsp;&nbsp;</label>"+e;b+="</div>"}else{b+='<div id="UART_sensor">';b+='<label for="uart">'+c+":&nbsp;&nbsp;</label>"+e;b+="</div>"}return b};Blockly.Sensors.ONEWIRESelection=function(f,a,e,h){var c="";var b=[];var g=[];var g="";for(var i in Code.status.maps.digitalPins){b.push([Code.status.maps.digitalPins[i][3]+" - "+Code.status.maps.digitalPins[i][0].replace(/pio\.P/i,"").replace(/_/i,""),i])}var g='<select id="interface'+f+'_unit" name="interface'+f+'_unit">';b.forEach(function(j){g+="<option "+((h&&(j[1]==e["interface"+f+"_unit"]))?"selected":"")+' value="'+j[1]+'">'+j[0]+"</option>"});g+="</select>";var d=Blockly.Sensors.InterfaceName(a,f);if(h){c+="<div>";c+='<label for="1-wire">'+d+":&nbsp;&nbsp;</label>"+g;c+='<br><label for="device">'+Blockly.Msg.SENSOR_DEVICE_ID+":&nbsp;&nbsp;</label>";c+='<input type="text" value="'+e["interface"+f+"_device"]+'" name="interface'+f+'_device" id="interface'+f+'_device">';c+="</div>"}else{c+='<div id="1-WIRE_sensor">';c+='<label for="1-wire">'+d+":&nbsp;&nbsp;</label>"+g;c+='<br><label for="device">'+Blockly.Msg.SENSOR_DEVICE_ID+":&nbsp;&nbsp;</label>";c+='<input type="text" value="1" name="interface'+f+'_device" id="interface'+f+'_device">';c+="</div>"}return c};Blockly.Sensors.ADCSelection=function(h,a,f,j){var b="";var l=[];var m="";l.push(["ADC1","ADC1",8,1]);for(var k in Code.status.maps.externalAdcUnits){l.push([Code.status.maps.externalAdcUnits[k][0],Code.status.maps.externalAdcUnits[k][0],Code.status.maps.externalAdcUnits[k][1],k])}var m='<select id="interface'+h+'_unit" name="interface'+h+'_unit" onchange="Blockly.Sensors.adcUnitChanged('+h+')">';l.forEach(function(i){m+="<option "+((j&&(i[3]==f["interface"+h+"_unit"]))?"selected":"")+' value="'+i[3]+'">'+i[0]+"</option>"});m+="</select>";var e=[];var c="";var l=1;var g;if(j){l=f["interface"+h+"_unit"]}if(l==1){for(var k in Code.status.maps.analogPins){e.push([Code.status.maps.analogPins[k][1]+" - "+Code.status.maps.analogPins[k][0].replace(/pio\.P/i,"").replace(/_/i,""),k])}}else{for(g=0;g<Code.status.maps.externalAdcUnits[l][1];g++){e.push(["channel%1".replace("%1",String(g)),g.toString()])}}var c='<select id="interface'+h+'_subunit" name="interface'+h+'_subunit">';e.forEach(function(i){c+="<option "+((j&&(i[1]==f["interface"+h+"_subunit"]))?"selected":"")+' value="'+i[1]+'">'+i[0]+"</option>"});c+="</select>";var d=Blockly.Sensors.InterfaceName(a,h);if(j){b+="<div>";b+='<label for="adc">'+d+":&nbsp;&nbsp;</label>"+m+"&nbsp;&nbsp;"+c;b+="</div>"}else{b+='<div class="sensor_interface" id="ADC_sensor">';b+='<label for="adc">'+d+":&nbsp;&nbsp;</label>"+m+"&nbsp;&nbsp;"+c;b+="</div>"}return b};Blockly.Sensors.sensorChanged=function(d,b){var a=jQuery("#sensor_form");var e;if(b){e=a.find("#id").attr("value")}else{e=a.find("#id").find(":selected").attr("value")}if(e==Blockly.Msg.NEW_SENSOR_SELECT_ONE){e=""}var c;if(b){c=a.find("#id").data("interface").split(",")}else{c=a.find("#id").find(":selected").data("interface").split(",")}a.find(".sensor_interfaces").html("");c.forEach(function(h,g){var f="";if(h=="GPIO"){f=Blockly.Sensors.GPIOSelection(g,e,d,b)}else{if(h=="I2C"){f=Blockly.Sensors.I2CSelection(g,e,d,b)}else{if(h=="UART"){f=Blockly.Sensors.UARTSelection(g,e,d,b)}else{if(h=="1-WIRE"){f=Blockly.Sensors.ONEWIRESelection(g,e,d,b)}else{if(h=="ADC"){f=Blockly.Sensors.ADCSelection(g,e,d,b)}}}}}a.find(".sensor_interfaces").append(f)});if((e!="")&&(c!="")){a.find(".sensor_name").show()}else{a.find(".sensor_name").hide()}};Blockly.Sensors.adcUnitChanged=function(c){var a=[];var e;var g=jQuery("#sensor_form");var f=g.find("#interface"+c+"_unit").find(":selected").attr("value");if(f==1){for(var d in Code.status.maps.analogPins){a.push([Code.status.maps.analogPins[d][1]+" - "+Code.status.maps.analogPins[d][0].replace(/pio\.P/i,"").replace(/_/i,""),d])}}else{for(e=0;e<Code.status.maps.externalAdcUnits[f][1];e++){a.push(["channel%1".replace("%1",String(e)),e.toString()])}}var b="";a.forEach(function(h){b+='<option value="'+h[1]+'">'+h[0]+"</option>"});g.find("#interface"+c+"_subunit").html(b)};Blockly.Sensors.createSetupStructure=function(d,e){var a={};if((typeof e=="undefined")||(d)){var c=jQuery("#sensor_form");var f=c.find("#id").find(":selected").attr("value");if(f==Blockly.Msg.NEW_SENSOR_SELECT_ONE){f=""}a.id=f;a.name=c.find("#sensor_name").val();if(d){a["interface"]=c.find("#id").data("interface")}else{a["interface"]=c.find("#id").find(":selected").data("interface")}for(var b=0;b<a["interface"].split(",").length;b++){a["interface"+b+"_unit"]=c.find("#interface"+b+"_unit").val();a["interface"+b+"_subunit"]=c.find("#interface"+b+"_subunit").val();a["interface"+b+"_device"]=c.find("#interface"+b+"_device").val()}}else{a.id=e.sid;a.name=e.name;a["interface"]=e["interface"];for(var b=0;b<e["interface"].split(",").length;b++){a["interface"+b+"_unit"]=e["interface"+b+"_unit"];a["interface"+b+"_subunit"]=e["interface"+b+"_subunit"];a["interface"+b+"_device"]=e["interface"+b+"_device"]}}return a};Blockly.Sensors.createSensor=function(b,a,e){var g="";var c=false;this.currentWS=b;if(typeof e!="undefined"){c=true}if(Code.status.sensors.length==0){Code.showError(MSG.error,MSG.attachBoardForUseThisOption,function(){});return}if(c){var d=""}else{var d='<select onchange="Blockly.Sensors.categoryChanged()" id="cat" name="cat">';d+='<option data-interface="" value="">'+Blockly.Msg.NEW_SENSOR_SELECT_ONE+"</option>";b.allSensors.categories.forEach(function(h){d+='<option value="'+h.id+'">'+Blockly.Msg[h.id]+"</option>"});d+='<option data-interface="" value="other">'+Blockly.Msg.other+"</option>";d+="</select>"}if(c){f="<span>"+e.sid+"</span>";f+='<input type="hidden" id="id" name="id" value="'+e.sid+'" data-interface="'+e["interface"]+'"></input>'}else{var f='<select onchange="Blockly.Sensors.sensorChanged('+e+", "+c+')" id="id" name="id">';f+='<option data-interface="" value="">'+Blockly.Msg.NEW_SENSOR_SELECT_ONE+"</option>";f+="</select>"}g='<form id="sensor_form">';if(d!=""){g+='<label for="id">'+Blockly.Msg.SENSOR_CATEGORY+":&nbsp;&nbsp;</label>"+d+"<br>";g+='<div class="id" style="display: none;">';g+='<label for="id">'+Blockly.Msg.SENSOR+":&nbsp;&nbsp;</label>"+f;g+="</div>"}else{g+='<div class="id">';g+='<label for="id">'+Blockly.Msg.SENSOR+":&nbsp;&nbsp;</label>"+f;g+="</div>"}if(c){g+="<div>";g+='<label for="sensor_name">'+Blockly.Msg.SENSOR_NAME+":&nbsp;&nbsp;</label>";g+='<input id="sensor_name" name="sensor_name" value="'+e.name+'">';g+="</div>"}else{g+='<div class="sensor_name" style="display: none;">';g+='<label for="sensor_name">'+Blockly.Msg.SENSOR_NAME+":&nbsp;&nbsp;</label>";g+='<input id="sensor_name" name="sensor_name" value="'+Blockly.Msg.SENSOR_DEFAULT_NAME+b.sensors.names.length+'">';g+="</div>"}g+='<div class="sensor_interfaces"';g+="</div>";g+="</form>";bootbox.dialog({title:c?Blockly.Msg.EDIT_SENSOR_TITLE:Blockly.Msg.NEW_SENSOR_TITLE,message:g,buttons:{main:{label:c?Blockly.Msg.UPDATE:Blockly.Msg.SENSOR_CREATE,classensor:"btn-primary",callback:function(){var h=jQuery("#sensor_form");var k;if(c){k=h.find("#id").val()}else{k=h.find("#id").find(":selected").attr("value");if(k==Blockly.Msg.NEW_SENSOR_SELECT_ONE){k=""}}var j=h.find("#sensor_name").val();if((b.sensorIndexOf(j)==-1)||(c&&e.name==j)){var i;if(c){i=h.find("#id").data("interface")}else{i=h.find("#id").find(":selected").data("interface")}if((j!="")&&(i!="")){b.createSensor(c?e.name:undefined,Blockly.Sensors.createSetupStructure(c,e));b.toolbox_.refreshSelection()}else{return false}}else{Code.showError(Blockly.Msg.ERROR,Blockly.Msg.SENSOR_ALREADY_EXISTS.replace("%1",j),function(){})}}},danger:{label:Blockly.Msg.SENSOR_CANCEL,classensor:"btn-danger",callback:function(){}}},closable:false,onEscape:true}).on("shown.bs.modal",function(h){Blockly.Sensors.sensorChanged(e,c)})};Blockly.Sensors.edit=function(a){Blockly.Sensors.createSensor(a.workspace,null,a)};Blockly.Sensors.remove=function(a){bootbox.confirm({message:Blockly.Msg.SENSOR_REMOVE_CONFIRM.replace("%1",a.name+" - "+a.sid),buttons:{confirm:{label:Blockly.Msg.YES,className:"btn-success"},cancel:{label:Blockly.Msg.NO,className:"btn-danger"}},callback:function(b){if(b){a.workspace.removeSensor(a)}}})};"use strict";goog.provide("Blockly.Wifi");goog.require("Blockly.Blocks");goog.require("Blockly.Workspace");goog.require("goog.string");Blockly.Wifi.NAME_TYPE="WIFI";Blockly.Wifi.flyoutCategory=function(c){var e=[];var a=c.Wifi;var d=goog.dom.createDom("button");d.setAttribute("text",Blockly.Msg.CONFIGURE_WIFI);d.setAttribute("callbackKey","CONFIGURE_WIFI");c.registerButtonCallback("CONFIGURE_WIFI",function(g){Blockly.Wifi.configure(g.getTargetWorkspace())});e.push(d);if(Blockly.Blocks.wifi_start){var b=goog.dom.createDom("mutation","");b.setAttribute("wtype",a.wtype);b.setAttribute("ssid",a.ssid);b.setAttribute("password",a.password);var f=goog.dom.createDom("block");f.setAttribute("type","wifi_start");f.appendChild(b);e.push(f)}if(Blockly.Blocks.wifi_stop){var b=goog.dom.createDom("mutation","");b.setAttribute("wtype",a.wtype);b.setAttribute("ssid",a.ssid);b.setAttribute("password",a.password);var f=goog.dom.createDom("block");f.setAttribute("type","wifi_stop");f.appendChild(b);e.push(f)}return e};Blockly.Wifi.configure=function(c,b,f){var g="";var e=false;if(typeof f!="undefined"){e=true}var a='<select id="type" name="type" onchange="Blockly.Wifi.wtypeChanged()">';a+='<option data-type="STA" '+(c.Wifi.wtype=="STA"?"selected":"")+' value="STA">STATION</option>';a+="</select>";g='<form id="Wifi_form">';g+="<div>";g+='<label for="type">'+Blockly.Msg.WIFI_TYPE+":&nbsp;&nbsp;</label>"+a;g+="</div>";g+="<div><br>";g+='<div id="STA" style="display: none;">';g+="<div>";g+='<label for="ssid">SSID:&nbsp;&nbsp;</label><input id="ssid" name="ssid" style="width:300px;" value="'+c.Wifi.ssid+'">';g+="</div>";g+="<div>";g+='<label for="password">PASSWORD:&nbsp;&nbsp;</label><input type="password" id="password" name="password" style="width:300px;" value="'+c.Wifi.password+'">';g+="</div>";g+='<div id="AP" style="display: none;">';g+="</div>";g+='<span class="error-msg" id="errors"></span>';g+="</form>";var d=bootbox.dialog({title:Blockly.Msg.WIFI_CONFIG_TITLE,message:g,buttons:{main:{label:Blockly.Msg.CONFIGURE,classensor:"btn-primary",callback:function(){var k=jQuery("#Wifi_form");var j=k.find("#type").find(":selected").attr("value");var l=k.find("#ssid").val().trim();var i=k.find("#password").val().trim();var h=false;k.find("#errors").html("");if(j=="STA"){if(l==""){k.find("#errors").html(k.find("#errors").html()+"<br>"+Blockly.Msg.WIFI_INVALID.replace("%1","SSID"));h=true}if(i==""){k.find("#errors").html(k.find("#errors").html()+"<br>"+Blockly.Msg.WIFI_INVALID.replace("%1","PASSWORD"));h=true}}else{}if(h){return false}c.configureWifi({wtype:j,ssid:l,password:i});c.toolbox_.refreshSelection()}},danger:{label:Blockly.Msg.CANCEL,classensor:"btn-danger",callback:function(){}}},closable:false,onEscape:true});d.bind("shown.bs.modal",function(){jQuery(":checkbox").checkboxpicker({html:true,offLabel:'<span class="glyphicon glyphicon-remove">',onLabel:'<span class="glyphicon glyphicon-ok">'}).on("change",function(){var h=jQuery("#Wifi_form");h.find("#ssid").val(this.checked)}).prop("checked",c.Wifi.ssid=="true");Blockly.Wifi.wtypeChanged()})};Blockly.Wifi.wtypeChanged=function(){var b=jQuery("#Wifi_form");var a=b.find("#type").find(":selected").attr("value");if(a=="STA"){b.find("#STA").show();b.find("#AP").hide()}else{b.find("#STA").hide();b.find("#AP").show()}};"use strict";goog.provide("Blockly.MQTT");goog.require("Blockly.Blocks");goog.require("Blockly.Workspace");goog.require("goog.string");Blockly.MQTT.NAME_TYPE="MQTT";Blockly.MQTT.flyoutCategory=function(b){var a=[];var f=b.MQTT;var e=goog.dom.createDom("button");e.setAttribute("text",Blockly.Msg.CONFIGURE_MQTT);e.setAttribute("callbackKey","CONFIGURE_MQTT");b.registerButtonCallback("CONFIGURE_MQTT",function(j){Blockly.MQTT.configure(j.getTargetWorkspace())});a.push(e);if(Blockly.Blocks.mqtt_subscribe){var c=goog.dom.createDom("mutation","");c.setAttribute("clientid",f.clientid);c.setAttribute("host",f.host);c.setAttribute("port",f.port);c.setAttribute("secure",f.secure);c.setAttribute("username",f.username);c.setAttribute("password",f.password);var d=goog.dom.createDom("block");d.setAttribute("type","mqtt_subscribe");var g=goog.dom.createDom("field",null,"");g.setAttribute("name","TEXT");var i=goog.dom.createDom("shadow");i.setAttribute("type","text");i.appendChild(g);var h=goog.dom.createDom("value");h.setAttribute("name","TOPIC");h.appendChild(i);d.appendChild(h);d.appendChild(c);a.push(d)}if(Blockly.Blocks.mqtt_publish){var c=goog.dom.createDom("mutation","");c.setAttribute("clientid",f.clientid);c.setAttribute("host",f.host);c.setAttribute("port",f.port);c.setAttribute("secure",f.secure);c.setAttribute("username",f.username);c.setAttribute("password",f.password);var d=goog.dom.createDom("block");d.setAttribute("type","mqtt_publish");var g=goog.dom.createDom("field",null,"");g.setAttribute("name","TEXT");var i=goog.dom.createDom("shadow");i.setAttribute("type","text");i.appendChild(g);var h=goog.dom.createDom("value");h.setAttribute("name","PAYLOAD");h.appendChild(i);d.appendChild(h);var g=goog.dom.createDom("field",null,"");g.setAttribute("name","TEXT");var i=goog.dom.createDom("shadow");i.setAttribute("type","text");i.appendChild(g);var h=goog.dom.createDom("value");h.setAttribute("name","TOPIC");h.appendChild(i);d.appendChild(h);d.appendChild(c);a.push(d)}return a};Blockly.MQTT.configure=function(b,a,e){var f="";var d=false;if(typeof e!="undefined"){d=true}f='<form id="MQTT_form">';f+='<label for="clientid">Client ID:&nbsp;&nbsp;</label><input id="clientid" name="clientid" style="width:300px;" value="'+b.MQTT.clientid+'">';f+="</div>";f+="<div>";f+='<label for="host">Host:&nbsp;&nbsp;</label><input type="text" id="host" name="host" style="width:300px;" value="'+b.MQTT.host+'">';f+="</div>";f+="<div>";f+='<label for="port">Port:&nbsp;&nbsp;</label><input type="text" id="port" name="port" style="width:100px;" value="'+b.MQTT.port+'">';f+="</div>";f+="<div>";f+='<label for="secure">Secure:&nbsp;&nbsp;</label><br>';f+='<input id="secure" name="secure" type="checkbox" data-group-cls="btn-group-sm" value="'+b.MQTT.secure+'">';f+="</div>";f+='<div id="credentials" style="display:none;"><br>';f+="<div>";f+='<label for="username">User:&nbsp;&nbsp;</label><input type="text" id="username" name="username" style="width:100px;" value="'+b.MQTT.username+'">';f+="</div>";f+="<div>";f+='<label for="password">Password:&nbsp;&nbsp;</label><input type="password" id="password" name="password" style="width:100px;" value="'+b.MQTT.password+'">';f+="</div>";f+="</div>";f+="</div>";f+="<br><span>"+Blockly.Msg.MQTT_GET_DATA_HELP+"</span><br>";f+='<br><button type="button" class="btn" id="getMQTTData">'+Blockly.Msg.MQTT_GET_DATA+'</button>&nbsp;<span id="waitingMQTT" class="waiting"><i class="spinner icon icon-spinner3"></i></span><br>';f+="</div>";f+='<span class="error-msg" id="errors"></span>';f+="</form>";var c=bootbox.dialog({title:Blockly.Msg.MQTT_CONFIG_TITLE,message:f,buttons:{main:{label:Blockly.Msg.CONFIGURE,classensor:"btn-primary",callback:function(){var k=jQuery("#MQTT_form");var m=k.find("#clientid").val().trim();var j=k.find("#host").val().trim();var g=k.find("#port").val().trim();var l=k.find("#secure").val();var n=(l=="true"?k.find("#username").val().trim():"");var i=(l=="true"?k.find("#password").val().trim():"");var h=false;k.find("#errors").html("");if(m==""){k.find("#errors").html(k.find("#errors").html()+"<br>"+Blockly.Msg.MQTT_INVALID.replace("%1","Client ID"));h=true}if(j==""){k.find("#errors").html(k.find("#errors").html()+"<br>"+Blockly.Msg.MQTT_INVALID.replace("%1","Host"));h=true}if((g=="")||(isNaN(g))){k.find("#errors").html(k.find("#errors").html()+"<br>"+Blockly.Msg.MQTT_INVALID.replace("%1","Port"));h=true}if(parseInt(g)<0){k.find("#errors").html(k.find("#errors").html()+"<br>"+Blockly.Msg.MQTT_INVALID.replace("%1","Port"));h=true}if(h){return false}b.configureMQTT({clientid:m,host:j,port:g,secure:l,username:n,password:i});b.toolbox_.refreshSelection()}},danger:{label:Blockly.Msg.CANCEL,classensor:"btn-danger",callback:function(){}}},closable:false,onEscape:true});c.bind("shown.bs.modal",function(){jQuery(":checkbox").checkboxpicker({html:true,offLabel:'<span class="glyphicon glyphicon-remove">',onLabel:'<span class="glyphicon glyphicon-ok">'}).on("change",function(){var h=jQuery("#MQTT_form");h.find("#secure").val(this.checked);if(this.checked){h.find("#credentials").show()}else{h.find("#credentials").hide()}}).prop("checked",b.MQTT.secure=="true");var g=jQuery("#MQTT_form");g.find("#getMQTTData").click(function(){jQuery("#waitingMQTT").show();jQuery.ajax({url:Code.server+"/?mqttRegister",type:"POST",success:function(h){jQuery("#waitingMQTT").hide();h=JSON.parse(h);if(h.success){jQuery(":checkbox").prop("checked",true);h=JSON.parse(h.result);g.find("#clientid").val("mqtt");g.find("#host").val("mqtt.whitecatboard.org");g.find("#port").val("8883");g.find("#username").val(h.user);g.find("#password").val(h.password)}else{g.find("#errors").html(h.result)}},error:function(){jQuery("#waitingMQTT").hide()}})})})};"use strict";goog.provide("Blockly.Lora");goog.require("Blockly.Blocks");goog.require("Blockly.Workspace");goog.require("goog.string");Blockly.Lora.NAME_TYPE="LORA";Blockly.Lora.flyoutCategory=function(c){var b=[];var a=c.lora;var f=goog.dom.createDom("button");f.setAttribute("text",Blockly.Msg.CONFIGURE_LORA);f.setAttribute("callbackKey","CONFIGURE_LORA");c.registerButtonCallback("CONFIGURE_LORA",function(j){Blockly.Lora.configure(j.getTargetWorkspace())});b.push(f);if(Blockly.Blocks.when_i_receive_a_lora_frame){var e=goog.dom.createDom("block");e.setAttribute("type","when_i_receive_a_lora_frame");b.push(e)}if(Blockly.Blocks.lora_join&&(c.lora.activation=="OTAA")){var d=goog.dom.createDom("mutation","");d.setAttribute("band",a.band);d.setAttribute("activation",a.activation);d.setAttribute("dr",a.dr);d.setAttribute("retx",a.retx);d.setAttribute("adr",a.adr);d.setAttribute("deveui",a.deveui);d.setAttribute("appeui",a.appeui);d.setAttribute("appkey",a.appkey);d.setAttribute("devaddr",a.devaddr);d.setAttribute("nwkskey",a.nwkskey);d.setAttribute("appskey",a.appskey);var e=goog.dom.createDom("block");e.setAttribute("type","lora_join");e.appendChild(d);b.push(e)}if(Blockly.Blocks.lora_tx){var d=goog.dom.createDom("mutation","");d.setAttribute("band",a.band);d.setAttribute("activation",a.activation);d.setAttribute("dr",a.dr);d.setAttribute("retx",a.retx);d.setAttribute("adr",a.adr);d.setAttribute("deveui",a.deveui);d.setAttribute("appeui",a.appeui);d.setAttribute("appkey",a.appkey);d.setAttribute("devaddr",a.devaddr);d.setAttribute("nwkskey",a.nwkskey);d.setAttribute("appskey",a.appskey);var e=goog.dom.createDom("block");e.setAttribute("type","lora_tx");var g=goog.dom.createDom("field",null,"1");g.setAttribute("name","NUM");var i=goog.dom.createDom("shadow");i.setAttribute("type","math_number");i.appendChild(g);var h=goog.dom.createDom("value");h.setAttribute("name","PORT");h.appendChild(i);e.appendChild(h);var g=goog.dom.createDom("field",null,"");g.setAttribute("name","TEXT");var g=goog.dom.createDom("field",null,"");g.setAttribute("name","TEXT");var i=goog.dom.createDom("shadow");i.setAttribute("type","text");i.appendChild(g);var h=goog.dom.createDom("value");h.setAttribute("name","PAYLOAD");h.appendChild(i);e.appendChild(h);e.appendChild(d);b.push(e)}if(Blockly.Blocks.text_pack){var e=goog.dom.createDom("block");e.setAttribute("type","text_pack");b.push(e)}if(Blockly.Blocks.text_unpack){var e=goog.dom.createDom("block");e.setAttribute("type","text_unpack");b.push(e)}return b};Blockly.Lora.configure=function(b,h,d){var c="";var i=false;if(typeof d!="undefined"){i=true}var a='<select id="band" name="band">';a+='<option data-band="868" '+(b.lora.band=="868"?"selected":"")+' value="868">868 (Europe) Mhz</option>';a+='<option data-band="433" '+(b.lora.band=="433"?"selected":"")+' value="433">433 (United States) Mhz</option>';a+="</select>";var j='<select id="activation" name="activation" onchange="Blockly.Lora.activationChanged()">';j+='<option data-band="ABP" '+(b.lora.activation=="ABP"?"selected":"")+' value="ABP">ABP</option>';j+='<option data-band="OTAA" '+(b.lora.activation=="OTAA"?"selected":"")+' value="OTAA">OTAA</option>';j+="</select>";var f='<select id="dr" name="dr">';f+='<option data-dr="0" '+(b.lora.dr=="0"?"selected":"")+' value="0">0</option>';f+='<option data-dr="1" '+(b.lora.dr=="1"?"selected":"")+' value="1">1</option>';f+='<option data-dr="2" '+(b.lora.dr=="2"?"selected":"")+' value="2">2</option>';f+='<option data-dr="3"'+(b.lora.dr=="3"?"selected":"")+' value="3">3</option>';f+='<option data-dr="4" '+(b.lora.dr=="4"?"selected":"")+' value="4">4</option>';f+='<option data-dr="5" '+(b.lora.dr=="5"?"selected":"")+' value="5">5</option>';f+='<option data-dr="6" '+(b.lora.dr=="6"?"selected":"")+' value="6">6</option>';f+='<option data-dr="7" '+(b.lora.dr=="7"?"selected":"")+' value="7">7</option>';f+="</select>";var g='<select id="retx" name="retx">';g+='<option data-retx="0" '+(b.lora.retx=="0"?"selected":"")+' value="0">0</option>';g+='<option data-retx="1" '+(b.lora.retx=="1"?"selected":"")+' value="1">1</option>';g+='<option data-retx="2" '+(b.lora.retx=="2"?"selected":"")+' value="2">2</option>';g+='<option data-retx="3" '+(b.lora.retx=="3"?"selected":"")+' value="3">3</option>';g+='<option data-retx="4" '+(b.lora.retx=="4"?"selected":"")+' value="4">4</option>';g+='<option data-retx="5" '+(b.lora.retx=="5"?"selected":"")+' value="5">5</option>';g+='<option data-retx="6" '+(b.lora.retx=="6"?"selected":"")+' value="6">6</option>';g+='<option data-retx="7" '+(b.lora.retx=="7"?"selected":"")+' value="7">7</option>';g+='<option data-retx="8" '+(b.lora.retx=="8"?"selected":"")+' value="8">8</option>';g+="</select>";c='<form id="lora_form">';c+="<div>";c+='<label for="band">'+Blockly.Msg.LORA_BAND+":&nbsp;&nbsp;</label>"+a;c+="</div>";c+="<div>";c+='<label for="activation">'+Blockly.Msg.LORA_ACTIVATION+":&nbsp;&nbsp;</label>"+j;c+="</div>";c+="<div>";c+='<label for="dr">'+Blockly.Msg.LORA_DR+":&nbsp;&nbsp;</label>"+f;c+="</div>";c+="<div>";c+='<label for="retx">'+Blockly.Msg.LORA_CONFIG_RETX+":&nbsp;&nbsp;</label>"+g;c+="</div>";c+="<div>";c+='<label for="adr">'+Blockly.Msg.LORA_ADR+":&nbsp;&nbsp;</label><br>";c+='<input id="adr" name="adr" type="checkbox" data-group-cls="btn-group-sm" value="'+b.lora.adr+'">';c+="</div>";c+="<div><br>";c+='<div id="OTAA" style="display: none;">';c+='<div style="margin: 0px;border-bottom: 1px solid #e5e5e5;">';c+="<label>"+Blockly.Msg.LORA_ACTIVATION_DATA+"&nbsp;&nbsp;</label>";c+="</div><br>";c+="<div>";c+='<label for="DevEUI">DevEUI:&nbsp;&nbsp;</label><input id="DevEUI" name="DevEUI" style="width:300px;" value="'+b.lora.deveui+'">';c+="</div>";c+="<div>";c+='<label for="AppEUI">AppEUI:&nbsp;&nbsp;</label><input id="AppEUI" name="AppEUI" style="width:300px;" value="'+b.lora.appeui+'">';c+="</div>";c+="<div>";c+='<label for="AppKey">AppKey:&nbsp;&nbsp;</label><input id="AppKey" name="AppKey" style="width:300px;" value="'+b.lora.appkey+'">';c+="</div>";c+="<br><span>"+Blockly.Msg.LORA_GET_OTAA_DATA_HELP+"</span><br>";c+='<br><button type="button" class="btn" id="getOTAAData">'+Blockly.Msg.LORA_GET_DATA+'</button>&nbsp;<span id="waitingOTAA" class="waiting"><i class="spinner icon icon-spinner3"></i></span><br>';c+="</div>";c+='<div id="ABP" style="display: none;">';c+='<div style="margin: 0px;border-bottom: 1px solid #e5e5e5;">';c+="<label>"+Blockly.Msg.LORA_PERSONALIZATION_DATA+"&nbsp;&nbsp;</label>";c+="</div><br>";c+="<div>";c+='<label for="DevAddr">DevAddr:&nbsp;&nbsp;</label><input id="DevAddr" name="DevAddr" style="width:300px;" value="'+b.lora.devaddr+'">';c+="</div>";c+="<div>";c+='<label for="NwkSKey">NwkSKey:&nbsp;&nbsp;</label><input id="NwkSKey" name="NwkSKey" style="width:300px;" value="'+b.lora.nwkskey+'">';c+="</div>";c+="<div>";c+='<label for="AppSKey">AppSKey:&nbsp;&nbsp;</label><input id="AppSKey" name="AppSKey" style="width:300px;" value="'+b.lora.appskey+'">';c+="</div>";c+="<br><span>"+Blockly.Msg.LORA_GET_ABP_DATA_HELP+"</span><br>";c+='<br><button type="button" class="btn" id="getABPData">'+Blockly.Msg.LORA_GET_DATA+'</button>&nbsp;<span id="waitingABP" class="waiting"><i class="spinner icon icon-spinner3"></i></span><br>';c+="</div>";c+='<span class="error-msg" id="errors"></span>';c+="</form>";var e=bootbox.dialog({title:Blockly.Msg.LORA_CONFIG_TITLE,message:c,buttons:{main:{label:Blockly.Msg.CONFIGURE,classensor:"btn-primary",callback:function(){var l=jQuery("#lora_form");var z=l.find("#band").find(":selected").attr("value");var t=l.find("#activation").find(":selected").attr("value");var o=l.find("#dr").find(":selected").attr("value");var u=l.find("#retx").find(":selected").attr("value");var p=l.find("#adr").val();var q=l.find("#DevEUI").val();var k=l.find("#AppEUI").val();var y=l.find("#AppKey").val();var s=l.find("#DevAddr").val();var w=l.find("#NwkSKey").val();var m=l.find("#AppSKey").val();var n=/[0-9A-Fa-f]{16}/;var x=/[0-9A-Fa-f]{32}/;var r=/[0-9A-Fa-f]{8}/;var v=false;l.find("#errors").html("");if(t=="OTAA"){if(!(n.test(q))){l.find("#errors").html(l.find("#errors").html()+"<br>"+Blockly.Msg.LORA_INVALID.replace("%1","DevEUI"));v=true}if(!(n.test(k))){l.find("#errors").html(l.find("#errors").html()+"<br>"+Blockly.Msg.LORA_INVALID.replace("%1","AppEUI"));v=true}if(!(x.test(y))){l.find("#errors").html(l.find("#errors").html()+"<br>"+Blockly.Msg.LORA_INVALID.replace("%1","AppKey"));v=true}}else{if(!(r.test(s))){l.find("#errors").html(l.find("#errors").html()+"<br>"+Blockly.Msg.LORA_INVALID.replace("%1","DevAddr"));v=true}if(!(x.test(w))){l.find("#errors").html(l.find("#errors").html()+"<br>"+Blockly.Msg.LORA_INVALID.replace("%1","NwkSKey"));v=true}if(!(x.test(m))){l.find("#errors").html(l.find("#errors").html()+"<br>"+Blockly.Msg.LORA_INVALID.replace("%1","AppSKey"));v=true}}if(v){return false}b.configureLora({band:z,activation:t,dr:o,retx:u,adr:p,deveui:q,appeui:k,appkey:y,devaddr:s,nwkskey:w,appskey:m});b.toolbox_.refreshSelection()}},danger:{label:Blockly.Msg.CANCEL,classensor:"btn-danger",callback:function(){}}},closable:false});e.bind("shown.bs.modal",function(){var k=jQuery("#lora_form");k.find("#getOTAAData").click(function(){jQuery("#waitingOTAA").show();jQuery.ajax({url:Code.server+"/?nodeRegister",type:"POST",success:function(l){jQuery("#waitingOTAA").hide();l=JSON.parse(l);if(l.success){l=JSON.parse(l.result);k.find("#AppEUI").val(l.OTAA.AppEUI);k.find("#DevEUI").val(l.OTAA.DevEUI);k.find("#AppKey").val(l.OTAA.AppKey)}else{k.find("#errors").html(l.result)}},error:function(){jQuery("#waitingOTAA").hide()}})});k.find("#getABPData").click(function(){jQuery("#waitingABP").show();jQuery.ajax({url:Code.server+"/?nodeRegister",type:"POST",success:function(l){jQuery("#waitingABP").hide();l=JSON.parse(l);if(l.success){l=JSON.parse(l.result);k.find("#DevAddr").val(l.ABP.DevAddr);k.find("#NwkSKey").val(l.ABP.NwkSKey);k.find("#AppSKey").val(l.ABP.AppSKey)}else{k.find("#errors").html(l.result)}},error:function(){jQuery("#waitingABP").hide()}})});jQuery(":checkbox").checkboxpicker({html:true,offLabel:'<span class="glyphicon glyphicon-remove">',onLabel:'<span class="glyphicon glyphicon-ok">'}).on("change",function(){var l=jQuery("#lora_form");l.find("#adr").val(this.checked)}).prop("checked",b.lora.adr=="true");Blockly.Lora.activationChanged()})};Blockly.Lora.activationChanged=function(){var a=jQuery("#lora_form");var b=a.find("#activation").find(":selected").attr("value");if(b=="OTAA"){a.find("#OTAA").show();a.find("#ABP").hide()}else{a.find("#OTAA").hide();a.find("#ABP").show()}};"use strict";goog.provide("Blockly.wc.FieldEvent");goog.require("Blockly.FieldDropdown");goog.require("Blockly.Msg");goog.require("Blockly.Events");goog.require("goog.asserts");goog.require("goog.string");Blockly.wc.FieldEvent=function(b,a){Blockly.wc.FieldEvent.superClass_.constructor.call(this,Blockly.wc.FieldEvent.dropdownCreate,a);this.setValue(b||"")};goog.inherits(Blockly.wc.FieldEvent,Blockly.FieldDropdown);Blockly.wc.FieldEvent.prototype.createEventItemIndex_=-1;Blockly.wc.FieldEvent.prototype.renameEventItemIndex_=-1;Blockly.wc.FieldEvent.prototype.deleteEventIndex_=-1;Blockly.wc.FieldEvent.prototype.setText=function(a){if(a===null){return}if(Blockly.Msg[a]){a=Blockly.Msg[a]}a=String(a);if(a===this.text_){return}this.text_=a;this.size_.width=0;if(this.sourceBlock_&&this.sourceBlock_.rendered){this.sourceBlock_.render();this.sourceBlock_.bumpNeighbours_()}};Blockly.wc.FieldEvent.prototype.setValue=function(d){if(d===null||d===this.value_){return}if(this.sourceBlock_&&Blockly.Events.isEnabled()){Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.value_,d))}if(this.sourceBlock_){this.sourceBlock_.workspace.doCreateEvent(undefined,d)}this.value_=d;var a=this.getOptions();for(var b=0;b<a.length;b++){if(a[b][1]==d){var c=a[b][0];if(typeof c=="object"){this.imageJson_=c;this.setText(c.alt)}else{this.imageJson_=null;this.setText(c)}return}}this.setText(d)};Blockly.wc.FieldEvent.dropdownCreate=function(){if(this.sourceBlock_&&this.sourceBlock_.workspace){var d=this.sourceBlock_.workspace.events.names.slice(0)}else{var d=[]}var b=this.getValue();if(b&&d.indexOf(b)==-1){d.push(b)}this.createEventItemIndex_=d.length;d.push(Blockly.Msg.EVENT_CREATE);this.renameEventItemIndex_=d.length;d.push(Blockly.Msg.RENAME_EVENT);this.deleteEventIndex_=d.length;d.push(Blockly.Msg.DELETE_EVENT.replace("%1",b));var a=[];for(var c=0;c<d.length;c++){if(Blockly.Msg[d[c]]){a[c]=[Blockly.Msg[d[c]],d[c]]}else{a[c]=[d[c],d[c]]}}return a};Blockly.wc.FieldEvent.prototype.onItemSelected=function(e,d){var c=e.getChildCount();var b=d.getValue();if(this.sourceBlock_){var a=this.sourceBlock_.workspace;if(this.renameEventItemIndex_>=0&&e.getChildAt(this.renameEventItemIndex_)===d){a.createEvent(this.getText(),this);return}else{if(this.deleteEventIndex_>=0&&e.getChildAt(this.deleteEventIndex_)===d){a.deleteEvent(this.getText(),this);return}else{if(this.createEventItemIndex_>=0&&e.getChildAt(this.createEventItemIndex_)===d){a.createEvent(undefined,this);return}}}b=this.callValidator(b)}if(b!==null){this.setValue(b)}};"use strict";goog.provide("Blockly.wc.FieldCanFrame");goog.require("Blockly.FieldDropdown");goog.require("Blockly.Msg");goog.require("Blockly.Events");goog.require("goog.asserts");goog.require("goog.string");Blockly.wc.FieldCanFrame=function(b,a){Blockly.wc.FieldCanFrame.superClass_.constructor.call(this,Blockly.wc.FieldCanFrame.dropdownCreate,a);this.setValue(b||"")};goog.inherits(Blockly.wc.FieldCanFrame,Blockly.FieldDropdown);Blockly.wc.FieldCanFrame.prototype.createCanFrameItemIndex_=-1;Blockly.wc.FieldCanFrame.prototype.renameCanFrameItemIndex_=-1;Blockly.wc.FieldCanFrame.prototype.deleteCanFrameIndex_=-1;Blockly.wc.FieldCanFrame.prototype.setText=function(a){if(a===null){return}if(Blockly.Msg[a]){a=Blockly.Msg[a]}a=String(a);if(a===this.text_){return}this.text_=a;this.size_.width=0;if(this.sourceBlock_&&this.sourceBlock_.rendered){this.sourceBlock_.render();this.sourceBlock_.bumpNeighbours_()}};Blockly.wc.FieldCanFrame.prototype.setValue=function(d){if(d===null||d===this.value_){return}if(this.sourceBlock_&&Blockly.Events.isEnabled()){Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.value_,d))}if(this.sourceBlock_){this.sourceBlock_.workspace.doCreateCanFrame(undefined,d)}this.value_=d;var a=this.getOptions();for(var b=0;b<a.length;b++){if(a[b][1]==d){var c=a[b][0];if(typeof c=="object"){this.imageJson_=c;this.setText(c.alt)}else{this.imageJson_=null;this.setText(c)}return}}this.setText(d)};Blockly.wc.FieldCanFrame.dropdownCreate=function(){if(this.sourceBlock_&&this.sourceBlock_.workspace){var d=this.sourceBlock_.workspace.canFrames.names.slice(0)}else{var d=[]}var b=this.getValue();if(b&&d.indexOf(b)==-1){d.push(b)}this.createCanFrameItemIndex_=d.length;d.push(Blockly.Msg.CAN_FRAME_CREATE);this.renameCanFrameItemIndex_=d.length;d.push(Blockly.Msg.RENAME_CAN_FRAME);this.deleteCanFrameIndex_=d.length;d.push(Blockly.Msg.DELETE_CAN_FRAME.replace("%1",b));var a=[];for(var c=0;c<d.length;c++){if(Blockly.Msg[d[c]]){a[c]=[Blockly.Msg[d[c]],d[c]]}else{a[c]=[d[c],d[c]]}}return a};Blockly.wc.FieldCanFrame.prototype.onItemSelected=function(e,d){var c=e.getChildCount();var b=d.getValue();if(this.sourceBlock_){var a=this.sourceBlock_.workspace;if(this.renameCanFrameItemIndex_>=0&&e.getChildAt(this.renameCanFrameItemIndex_)===d){a.createCanFrame(this.getText(),this);return}else{if(this.deleteCanFrameIndex_>=0&&e.getChildAt(this.deleteCanFrameIndex_)===d){a.deleteCanFrame(this.getText(),this);return}else{if(this.createCanFrameItemIndex_>=0&&e.getChildAt(this.createCanFrameItemIndex_)===d){a.createCanFrame(undefined,this);return}}}b=this.callValidator(b)}if(b!==null){this.setValue(b)}};"use strict";goog.provide("Blockly.wc.FieldException");goog.require("Blockly.FieldDropdown");goog.require("Blockly.Msg");goog.require("Blockly.Events");goog.require("goog.asserts");goog.require("goog.string");Blockly.wc.FieldException=function(b,a){Blockly.wc.FieldException.superClass_.constructor.call(this,Blockly.wc.FieldException.dropdownCreate,a);this.setValue(b||"")};goog.inherits(Blockly.wc.FieldException,Blockly.FieldDropdown);Blockly.wc.FieldException.prototype.setText=function(a){if(a===null){return}if(Blockly.Msg[a]){a=Blockly.Msg[a]}a=String(a);if(a===this.text_){return}this.text_=a;this.size_.width=0;if(this.sourceBlock_&&this.sourceBlock_.rendered){this.sourceBlock_.render();this.sourceBlock_.bumpNeighbours_()}};Blockly.wc.FieldException.prototype.setValue=function(d){if(d===null||d===this.value_){return}if(this.sourceBlock_&&Blockly.Events.isEnabled()){Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.value_,d))}if(this.sourceBlock_){this.sourceBlock_.workspace.doCreateEvent(undefined,d)}this.value_=d;var a=this.getOptions();for(var b=0;b<a.length;b++){if(a[b][1]==d){var c=a[b][0];if(typeof c=="object"){this.imageJson_=c;this.setText(c.alt)}else{this.imageJson_=null;this.setText(c)}return}}this.setText(d)};Blockly.wc.FieldException.find=function(d,e){while(d){d=d.targetBlock();if(d){if(typeof d.module!="undefined"){if(typeof Code.status.exceptions[d.module]!="undefined"){for(var c=0;c<Code.status.exceptions[d.module].length;c++){var b=d.module+".error."+Code.status.exceptions[d.module][c];if(e.indexOf(b)==-1){e.push(b)}}}}var a=d.getConnections_();for(var c=0;c<a.length;c++){if(a[c].type==1){Blockly.wc.FieldException.find(a[c],e)}}d=d.nextConnection}}};Blockly.wc.FieldException.dropdownCreate=function(){var e=[];if(this.sourceBlock_&&this.sourceBlock_.workspace){var d=this.sourceBlock_.previousConnection;if(d){d=d.targetBlock();if(d){if(d.type=="exception_try"){var c=d.inputList[0].connection;Blockly.wc.FieldException.find(c,e)}}}}e.push("any");e=e.sort();var a=[];for(var b=0;b<e.length;b++){if(Blockly.Msg[e[b]]){a[b]=[Blockly.Msg[e[b]],e[b]]}else{a[b]=[e[b],e[b]]}}return a};Blockly.wc.FieldException.prototype.onItemSelected=function(d,c){var b=d.getChildCount();var a=c.getValue();if(a!==null){this.setValue(a)}};"use strict";Blockly.Block.prototype.isReporterBlock=function(){return((this.outputConnection!=null)&&(this.outputConnection))};Blockly.Block.prototype.isSensorBlock=function(){var a=["sensor_read","sensor_set","sensor_when"];return(a.indexOf(this.type)!=-1)};Blockly.Block.prototype.isHatBlock=function(){var a=["when_board_starts","when_i_receive","when_digital_pin","when_i_receive_a_lora_frame","sensor_when","execute_every","thread","mqtt_subscribe"];return(a.indexOf(this.type)!=-1)};Blockly.Block.prototype.isInHatBlock=function(){var a=["when_board_starts","when_i_receive","when_digital_pin","when_i_receive_a_lora_frame","sensor_when","execute_every","thread","mqtt_subscribe"];var b=this;do{if(a.indexOf(b.type)!=-1){return true;break}b=b.getSurroundParent()}while(b);return false};Blockly.Block.prototype.checkIsInHatBlock=function(b){if(!this.workspace.isDragging||this.workspace.isDragging()){return}if((typeof b.element!="undefined")&&(this.warning!=null)&&(b.element=="disabled")){if(b.blockId==this.id){this.setDisabled(true);return}}if((typeof b.element!="undefined")&&(b.element=="disabled")){if((b.newValue!=b.oldValue)&&(b.blockId==this.id)){this.disabledByUser=b.newValue}}if(this.isInHatBlock()){var a=(this.warning!=null);this.setWarningText(null);if(!this.isInFlyout&&a&(typeof this.disabledByUser=="undefined"?true:(!this.disabledByUser))){this.setDisabled(false)}else{if(typeof this.disabledByUser!="undefined"){this.setDisabled(this.disabledByUser)}}}else{this.setWarningText(Blockly.Msg.WARNING_NOT_IN_HAT_BLOCK);if(!this.isInFlyout&&!this.getInheritedDisabled()){this.setDisabled(true)}}};Blockly.Block.prototype.isInField=function(e,d){var b;var a;for(b=0;b<e.inputList.length;b++){if(e.inputList[b].name==d){var c=e.inputList[b].connection.targetConnection.sourceBlock_;var f=c.getDescendants();for(a=0;a<f.length;a++){if(f[a].type==this.type){return true}}}}return false};Blockly.Block.prototype.isInBlock=function(a,b){var d=this;var c=this;do{if(c.type==a){if(typeof b!="undefined"){return this.isInField(c,b)}else{return true}break}c=c.getSurroundParent()}while(c);return false};Blockly.Block.prototype.getHelpUrl=function(){var a;var b=this;if(this.isSensorBlock()){a=Code.Help.getUrl("sensors",b.sid)}else{a=Code.Help.getUrl("blocks",this.type)}return a};Blockly.Block.prototype.updateBoardAtFieldChange=function(b){var a=this;if(!a.isInFlyout){Code.workspace.blocks.addChangeListener(function(d){if((d.type==Blockly.Events.CHANGE)){if(d.blockId!=a.id){var c=Blockly.Workspace.getById(d.workspaceId);if(c.getBlockById(d.blockId).getParent()){if(c.getBlockById(d.blockId).getParent().id!=a.id){return}}else{return}}if(d.name==b){if(a.fieldTimeout){clearTimeout(a.fieldTimeout)}a.fieldTimeout=setTimeout(function(){a.value=d.newValue;var e=Blockly.Lua.blockCode(a);console.log(e);a.removeError();a.removeStart();Code.agent.send({command:"boardRunCommand",arguments:{code:btoa(e)}},function(g,f){});a.value=-1},500)}}})}};Blockly.Block.prototype.updateBoardAtBlockCreate=function(){var a=this;if(!a.isInFlyout){Code.workspace.blocks.addChangeListener(function(c){if((c.type==Blockly.Events.CREATE)){if(c.blockId!=a.id){var b=Blockly.Workspace.getById(c.workspaceId);if(b.getBlockById(c.blockId).getParent()){if(b.getBlockById(c.blockId).getParent().id!=a.id){return}}else{return}}if(a.createTimeout){clearTimeout(a.createTimeout)}a.createTimeout=setTimeout(function(){var d=Blockly.Lua.blockCode(a);a.removeError();a.removeStart();Code.agent.send({command:"boardRunCommand",arguments:{code:btoa(d)}},function(f,e){})},250)}})}};var Settings={};Settings.load=function(e){if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){var a=require("fs");var h=require("path");var d="settings.json";var c=h.join(process.cwd(),d);try{var g=a.readFileSync(c,"utf8")}catch(b){return}try{var f=JSON.parse(g);if(f.hasOwnProperty("language")){e.language=f.language}if(f.hasOwnProperty("board")){e.board=f.board}if(f.hasOwnProperty("programmingModel")){e.programmingModel=f.programmingModel}}catch(b){Code.showError(MSG.error,MSG.youHaveAnErrorInSettings+"<br><br>"+b)}}}else{e.language=jQuery("#laguagePreferences").attr("value");if(e.language==""){e.language="en"}e.programmingModel=jQuery("#programmingModelPreferences").attr("value");if(e.programmingModel==""){e.programmingModel="blocks"}}};Settings.save=function(d){if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){var a=require("fs");var e=require("path");var c="settings.json";var b=e.join(process.cwd(),c);a.writeFileSync(b,JSON.stringify(d));chrome.runtime.reload()}}else{jQuery("#laguagePreferences").attr("value",d.language);jQuery("#programmingModelPreferences").attr("value",d.programmingModel);jQuery("#preferencesForm").submit()}};function watcher(){var a=this;Blockly.Blocks.logic_compare.hasWatcher=true;Blockly.Blocks.logic_operation.hasWatcher=true;Blockly.Blocks.logic_negate.hasWatcher=true;Blockly.Blocks.logic_boolean.hasWatcher=true;Blockly.Blocks.logic_null.hasWatcher=true;Blockly.Blocks.logic_ternary.hasWatcher=true;Blockly.Blocks.math_number.hasWatcher=true;Blockly.Blocks.math_arithmetic.hasWatcher=true;Blockly.Blocks.math_single.hasWatcher=true;Blockly.Blocks.math_trig.hasWatcher=true;Blockly.Blocks.logic_ternary.hasWatcher=true;Blockly.Blocks.math_constant.hasWatcher=true;Blockly.Blocks.math_number_property.hasWatcher=true;Blockly.Blocks.math_change.hasWatcher=true;Blockly.Blocks.math_round.hasWatcher=true;Blockly.Blocks.math_on_list.hasWatcher=true;Blockly.Blocks.math_modulo.hasWatcher=true;Blockly.Blocks.math_constrain.hasWatcher=true;Blockly.Blocks.math_random_int.hasWatcher=true;Blockly.Blocks.math_random_float.hasWatcher=true;Blockly.Blocks.variables_get.hasWatcher=true;a.watcher=jQuery('<div title="" style="position:absolute;"></div>').hide().appendTo("body");jQuery(".btn-toolbar,#languageDiv,#content_blocks,#statusBar").click(function(){a.hide()});Blockly.bindEventWithChecks_(document,"mousemove",this,function(b){a.hide()});Blockly.bindEventWithChecks_(document,"dblclick",this,function(b){a.hide();a.show()});Code.workspace.blocks.addChangeListener(function(b){if((b.type==Blockly.Events.UI)&&(b.element=="selected")){a.hide()}if((b.type==Blockly.Events.CHANGE)){a.hide()}if((b.type==Blockly.Events.DELETE)){a.hide()}})}watcher.prototype.show=function(){var e=this;if(Blockly.selected){if(Blockly.selected.hasOwnProperty("hasWatcher")&&Blockly.selected.hasWatcher){var a=Blockly.selected.workspace.getSvgXY(Blockly.selected.svgPath_);var c=jQuery("#content_blocks").position().left;var b=jQuery("#content_blocks").position().top;e.watcher.css({left:c+a.x+Blockly.selected.width*Blockly.selected.workspace.scale,top:b+a.y-2,width:2,height:Blockly.selected.height*Blockly.selected.workspace.scale});var d=Blockly.Lua.blockWatcherCode(Blockly.selected);Code.agent.send({command:"boardRunCommand",arguments:{code:btoa(d)}},function(h,g){var f=atob(g.response);e.watcher.show();e.watcher.showBalloon({contents:f})})}}};watcher.prototype.hide=function(){var a=this;a.watcher.hide();a.watcher.hideBalloon()};Blockly.WorkspaceSvg.prototype.setScale=function(a){Code.watcher.hide();if(this.options.zoomOptions.maxScale&&a>this.options.zoomOptions.maxScale){a=this.options.zoomOptions.maxScale}else{if(this.options.zoomOptions.minScale&&a<this.options.zoomOptions.minScale){a=this.options.zoomOptions.minScale}}this.scale=a;this.updateGridPattern_();if(this.scrollbar){this.scrollbar.resize()}else{this.translate(this.scrollX,this.scrollY)}Blockly.hideChaff(false);if(this.flyout_){this.flyout_.reflow()}};var StorageType={None:0,Board:1,Computer:2,Cloud:3};function Storage(a){this.type=a;this.isInit=false;this.fs=null}Storage.prototype.errorHandler=function(a){var b=""};Storage.prototype.init=function(b){var a=this;if(a.isInit){b();return}if(a.type==StorageType.Board){a.isInit=true;b()}if(a.type==StorageType.Cloud){a.isInit=true;b()}if(a.type==StorageType.Computer){window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;navigator.webkitPersistentStorage.requestQuota(5*1024*1024,function(c){window.requestFileSystem(window.PERSISTENT,c,function(d){a.fs=d;a.isInit=true;b()},a.errorHandler)},function(c){})}};Storage.prototype._localListDirectories=function(e,f){var d=this;var a=[];var c;var b=function(){c.readEntries(function(h){if(!h.length){f(a.sort())}else{for(var g=0;g<h.length;g++){var j=h[g];a.push({date:"",name:j.name,size:"",type:(j.isDirectory?"d":"f")})}b()}},d.errorHandler)};if(e=="/"){c=d.fs.root.createReader();b()}else{d.fs.root.getDirectory(e,{create:false},function(g){c=g.createReader();b()})}};Storage.prototype._boardListDirectories=function(a,b){Code.agent.send({command:"boardGetDirContent",arguments:{path:a}},function(d,c){b(c)})};Storage.prototype._cloudListDirectories=function(a,b){if(a=="/"){a=""}jQuery.ajax({url:Code.server,data:{listDirectories:"",folder:a},type:"POST",success:function(d){var c=[];d=JSON.parse(d);if(!d.success){Code.showError(MSG.error,MSG.youHaveAnError+"<br><br>"+d.result,function(){});b([])}d=d.result;for(var e=0;e<d.length;e++){var f=d[e];f.name=atob(f.name);c.push(f)}b(c);return},error:function(){b([])}})};Storage.prototype._localLoad=function(a,c){var b=this;b.fs.root.getFile(a,{},function(d){d.file(function(f){var e=new FileReader();e.onloadend=function(g){c(this.result)};e.readAsText(f)},b.errorHandler)},b.errorHandler)};Storage.prototype._boardLoad=function(a,b){Code.agent.send({command:"boardReadFile",arguments:{path:a}},function(e,c){var d=atob(c.content);b(d)})};Storage.prototype._cloudLoad=function(a,b){jQuery.ajax({url:Code.server,data:{loadFile:a},type:"POST",success:function(c){c=JSON.parse(c);if(!c.success){Code.showError(MSG.error,MSG.youHaveAnError+"<br><br>"+c.result,function(){});b([])}c=c.result;b(atob(c.content));return},error:function(){b([])}})};Storage.prototype._localRemove=function(a,c){var b=this;b.fs.root.getFile(a,{create:true},function(d){d.remove(function(){c(true)},function(){c(false)})})};Storage.prototype._boardRemove=function(a,b){Code.agent.send({command:"boardRemoveFile",arguments:{path:btoa(a)}},function(d,c){b(true)})};Storage.prototype._cloudRemove=function(a,b){jQuery.ajax({url:Code.server,data:{removeFile:a},type:"POST",success:function(c){c=JSON.parse(c);if(!c.success){Code.showError(MSG.error,MSG.youHaveAnError+"<br><br>"+c.result,function(){});b(false);return}c=c.result;b(true);return},error:function(){b(false);return}})};Storage.prototype._localSave=function(a,c,d){var b=this;b.fs.root.getFile(a,{create:true},function(e){e.createWriter(function(f){f.onwriteend=function(h){d()};f.onerror=function(h){};var g=new Blob([c],{type:"plain/text"});f.write(g)},b.errorHandler)},b.errorHandler)};Storage.prototype._boardSave=function(a,b,c){Code.agent.send({command:"boardWriteFile",arguments:{path:a,content:btoa(b)}},function(e,d){c()})};Storage.prototype._cloudSave=function(a,d,b,c){a=Code.getBasename(a);jQuery.ajax({url:Code.server,data:{saveFile:btoa(a),id:d,content:btoa(b)},type:"POST",success:function(e){e=JSON.parse(e);if(!e.success){Code.showError(MSG.error,MSG.youHaveAnError+"<br><br>"+e.result,function(){});c([])}e=e.result;c();return},error:function(){c([])}});c()};Storage.prototype.listDirectories=function(b,c){var a=this;a.init(function(){if(a.type==StorageType.Board){return a._boardListDirectories(b,c)}else{if(a.type==StorageType.Computer){return a._localListDirectories(b,c)}else{if(a.type==StorageType.Cloud){return a._cloudListDirectories(b,c)}}}})};Storage.prototype.load=function(a,c){var b=this;b.init(function(){if(b.type==StorageType.Board){return b._boardLoad(a,c)}else{if(b.type==StorageType.Computer){return b._localLoad(a,c)}else{if(b.type==StorageType.Cloud){return b._cloudLoad(a,c)}}}})};Storage.prototype.save=function(a,e,c,d){var b=this;b.init(function(){if(b.type==StorageType.Board){return b._boardSave(a,c,d)}else{if(b.type==StorageType.Computer){return b._localSave(a,c,d)}else{if(b.type==StorageType.Cloud){return b._cloudSave(a,e,c,d)}}}})};Storage.prototype.remove=function(a,c){var b=this;b.init(function(){if(b.type==StorageType.Board){return b._boardRemove(a,c)}else{if(b.type==StorageType.Computer){return b._localRemove(a,c)}else{if(b.type==StorageType.Cloud){return b._cloudRemove(a,c)}}}})};"use strict";var statusType={Alert:0,Info:1,Nothing:3,Progress:4};var Status={};Status.messages=[];Status.messages["Downloading prerequisites"]={tag:"downloadingPrerequisites",type:statusType.Progress,zone:"statusBar1"};Status.messages["Uploading framework"]={tag:"uploadingFramework",type:statusType.Progress,zone:"statusBar1"};Status.messages["Downloading esptool"]={tag:"downloadingEsptool",type:statusType.Progress,zone:"statusBar1"};Status.messages["Unpacking esptool"]={tag:"unpackingEsptool",type:statusType.Progress,zone:"statusBar1"};Status.messages["Downloading firmware"]={tag:"downloadingFirmware",type:statusType.Progress,zone:"statusBar1"};Status.messages["Unpacking firmware"]={tag:"unpackingFirmware",type:statusType.Progress,zone:"statusBar1"};Status.messages["No board attached"]={tag:"noBoardAttached",type:statusType.Alert,page:"wiki/Errors:--No-board-attached",zone:"statusBar1"};Status.messages["Scanning boards"]={tag:"scanningBoards",type:statusType.Progress,zone:"statusBar1"};Status.messages["Python not found"]={tag:"pythonNotFound",type:statusType.Aler,zone:"statusBar1"};Status.messages["Reseting board"]={tag:"resetingBoard",type:statusType.Progress,zone:"statusBar1"};Status.messages["Stopping program"]={tag:"stoppingProgram",type:statusType.Progress,zone:"statusBar1"};Status.messages["Can't connect to agent"]={tag:"cannotConnectToAgent",type:statusType.Alert,page:"wiki/Errors:--Can't-connect-to-agent",zone:"statusBar1"};Status.messages["Connect a board"]={tag:"connectABoard",type:statusType.Alert,zone:"statusBar1"};Status.messages["Corrupted firmware"]={tag:"corruptedFirmware",type:statusType.Alert,zone:"statusBar1"};Status.messages["Flash error"]={tag:"flashError",type:statusType.Alert,zone:"statusBar1"};Status.messages["Whitecat N1 ESP32"]={tag:"boardAttached",type:statusType.Info,zone:"statusBar1"};Status.messages["Whitecat N1 ESP32 DEVKIT"]={tag:"boardAttached",type:statusType.Info,zone:"statusBar1"};Status.messages["ESP32 Thing"]={tag:"boardAttached",type:statusType.Info,zone:"statusBar1"};Status.messages["ESP32 Core Board"]={tag:"boardAttached",type:statusType.Info,zone:"statusBar1"};Status.messages.cloudConsoleOn={tag:"cloudConsoleOn",type:statusType.Info,zone:"statusBar2"};Status.messages.cloudConsoleOff={tag:"cloudConsoleOff",type:statusType.Info,zone:"statusBar2"};Status.current={type:statusType.Nothing,message:""};Status.show=function(h){var g=Status.messages[h];var e=statusType.Info;var i="";var a=undefined;var d="";if(typeof g!="undefined"){e=g.type;i=g.tag;d=g.zone;if(typeof g.page!="undefined"){a=g.page}}else{d="statusBar1"}if((Status.current.type!=e)||(Status.current.message!=h)){jQuery("."+d).removeClass("statusBarClick").unbind("click");Status.current.type=e;Status.current.message=h;var b=h;if(typeof(MSG[i])!="undefined"){b=MSG[i]}if(e==statusType.Progress){b=b+" ..."}var f="";switch(e){case statusType.Alert:f="warning2";break}var c;if(e==statusType.Progress){c='<span class="statusBarText noselect">'+b+"</span>"}else{c='<span class="statusBarText noselect">'+b+"</span>";if(i=="boardAttached"){c+='<span class="icon icon-arrow-down5" style="margin-right: 2px;vertical-align: text-bottom;"></span>'}if((i=="cloudConsoleOn")||(i=="cloudConsoleOff")){c+='<span class="icon icon-arrow-down5" style="margin-right: 2px;vertical-align: text-bottom;"></span>'}}if(f){c='<i class="icon icon-'+f+'"></i><span>'+c+"</span>"}if(e==statusType.Alert){jQuery("."+d).addClass("statusBarClick").bind("click",function(j){if(typeof a!="undefined"){if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){Code.Help.show("alerts",a)}else{Code.Help.show("alerts",a)}}else{Code.Help.show("alerts",a)}}})}else{if(e==statusType.Info){if(i=="boardAttached"){jQuery("."+d).addClass("statusBarClick").bind("click",function(j){jQuery("#cloudConsole").hide();jQuery("#cloudConsole").attr("data-visibe","false");if(Code.agent.version>1.2){var k=jQuery("#boardConsole").attr("data-visibe");if(typeof k=="undefined"){k=false}if((k=="")||(k=="false")){jQuery("#boardConsole").show();jQuery("#boardConsole").attr("data-visibe","true");jQuery("#boardConsole").focus()}else{jQuery("#boardConsole").hide();jQuery("#boardConsole").attr("data-visibe","false")}}else{Code.showAlert(MSG.thisFuntionRequiresUpdateAgent)}})}if((i=="cloudConsoleOn")||(i=="cloudConsoleOff")){jQuery("."+d).addClass("statusBarClick").bind("click",function(j){jQuery("#boardConsole").hide();jQuery("#boardConsole").attr("data-visibe","false");var k=jQuery("#cloudConsole").attr("data-visibe");if(typeof k=="undefined"){k=false}if((k=="")||(k=="false")){jQuery("#cloudConsole").show();jQuery("#cloudConsole").attr("data-visibe","true")}else{jQuery("#cloudConsole").hide();jQuery("#cloudConsole").attr("data-visibe","false")}})}}}if(i=="cloudConsoleOff"){jQuery("."+d).html(c).hide();jQuery("#cloudConsole").hide();jQuery("#cloudConsole").attr("data-visibe","false")}else{jQuery("."+d).html(c).show()}}};Status.hide=function(){jQuery(".statusBar1").hide();jQuery(".statusBar2").hide()};function Cloud(d,a,b){var e=this;e.username=a;if(e.username!=""){e.client=new Paho.MQTT.Client("mqtt.whitecatboard.org",9883,"/"+e.username,"web_"+parseInt(Math.random()*100,10));e.client.onConnectionLost=e.onConnectionLost;e.client.onMessageArrived=e.onMessageArrived;e.options={timeout:3,useSSL:true,cleanSession:true,onSuccess:function(){e.client.subscribe("/"+e.username+"/+",{qos:0});e.client.subscribe("/"+e.username+"/+/+",{qos:0});e.client.subscribe("/"+e.username+"/+/+/+",{qos:0});e.client.subscribe("/"+e.username+"/+/+/+/+",{qos:0})},onFailure:function(f){setTimeout(e.Connect,200)},userName:e.username,password:b};var c="";if(d=="mqtt"){c+='<table id="cloudTable" width="100%">';c+="<thead>";c+="<tr>";c+="<th>Time</th><th>Topic</th><th>Payload</th>";c+="</tr>";c+="</thead>";c+="<tbody>";c+="</thead>";c+="</table>";jQuery("#cloudConsole").html(c);jQuery("#cloudTable").DataTable({lengthMenu:[[10,25],[10,25]],order:[[0,"desc"]],columns:[{width:"5%"},{width:"20%"},{width:"75%"}]})}else{c+='<table id="cloudTable" width="100%">';c+="<thead>";c+="<tr>";c+="<th>Time</th><th>Device</th><th>Payload</th>";c+="</tr>";c+="</thead>";c+="<tbody>";c+="</thead>";c+="</table>";jQuery("#cloudConsole").html(c);jQuery("#cloudTable").DataTable({lengthMenu:[[10,25],[10,25]],order:[[0,"desc"]],columns:[{width:"5%"},{width:"20%"},{width:"75%"}]})}}}Cloud.prototype.Connect=function(){var a=this;a.client.connect(a.options)};Cloud.prototype.Disconnect=function(){var a=this;a.client.disconnect()};Cloud.prototype.onConnectionLost=function(a){var b=this;setTimeout(b.Connect,200)};Cloud.prototype.onMessageArrived=function(c){var a=c.destinationName;var e=c.payloadString;var b=jQuery("#cloudTable").DataTable();var d=a.split("/");if((d[1]=="ttn")&&(d[3]=="up")){b.row.add([jQuery.format.date(new Date(),"dd/M/yy hh:mm:ss"),a,e]).draw(false)}else{b.row.add([jQuery.format.date(new Date(),"dd/M/yy hh:mm:ss"),a,e]).draw(false)}};function Help(){this.data={}}Help.prototype.get=function(h){var e=this;if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){var a=require("fs");var g=require("path");var d="boards/defs/help.json";var c=g.join(process.cwd(),d);try{var f=a.readFileSync(c,"utf8")}catch(b){return}try{e.data=JSON.parse(f);h()}catch(b){h()}}else{jQuery.ajax({url:Code.folder+"/boards/defs/help.json",success:function(i){e.data=i;h();return},error:function(){h()}})}}else{jQuery.ajax({url:Code.folder+"/boards/defs/help.json",success:function(i){e.data=i;h();return},error:function(){h()}})}};Help.prototype._removeHandlers=function(){jQuery(".modal-body").find("a").unbind("click")};Help.prototype._addHandlers=function(){var a=this;jQuery(".modal-body").find("a").unbind("click").bind("click",function(d){var c=jQuery(d.target);var b=c.attr("href");if(b.startsWith("https://ide.whitecatboard.org/?file=")){Code.loadExample(b.replace("https://ide.whitecatboard.org/?file=",""))}else{if(b.startsWith("http:")||b.startsWith("https:")){window.open(b,"_blank")}else{b=b.replace("wiki/","wiki/"+Code.settings.language+"/");a._show(b)}}return false})};Help.prototype._show=function(a){var b=this;Code.closeDialogs();setTimeout(function(){jQuery.ajax({url:Code.server+"/"+a,type:"GET",crossDomain:true,success:function(c){bootbox.dialog({title:Blockly.Msg.HELP,message:c,closable:true,onEscape:true,size:"large"}).on("shown.bs.modal",function(d){b._addHandlers()})},error:function(){}})},500)};Help.prototype.getUrl=function(a,c){var b=this;if(typeof b.data[a]=="undefined"){return""}if(typeof b.data[a][c]!="undefined"){url=b.data[a][c]}else{url=""}url=url.replace("wiki/","wiki/"+Code.settings.language+"/");return url};Help.prototype.show=function(b,d){var c=this;if(b=="alerts"){c._show(d);return}var a=c.getUrl(b,d);if(a!=""){c._show(a)}};Help.prototype.closeAll=function(){this._removeHandlers()};"use strict";Blockly.Lua=new Blockly.Generator("Lua");Blockly.Lua.addReservedWords("_,__inext,assert,bit,colors,colours,coroutine,disk,dofile,error,fs,fetfenv,getmetatable,gps,help,io,ipairs,keys,loadfile,loadstring,math,native,next,os,paintutils,pairs,parallel,pcall,peripheral,print,printError,rawequal,rawget,rawset,read,rednet,redstone,rs,select,setfenv,setmetatable,sleep,string,table,term,textutils,tonumber,tostring,turtle,type,unpack,vector,write,xpcall,_VERSION,__indext,HTTP,and,break,do,else,elseif,end,false,for,function,if,in,local,nil,not,or,repeat,return,then,true,until,while,add,sub,mul,div,mod,pow,unm,concat,len,eq,lt,le,index,newindex,call,assert,collectgarbage,dofile,error,_G,getmetatable,inpairs,load,loadfile,next,pairs,pcall,print,rawequal,rawget,rawlen,rawset,select,setmetatable,tonumber,tostring,type,_VERSION,xpcall,require,package,string,table,math,bit32,io,file,os,debug");Blockly.Lua.ORDER_ATOMIC=0;Blockly.Lua.ORDER_HIGH=1;Blockly.Lua.ORDER_EXPONENTIATION=2;Blockly.Lua.ORDER_UNARY=3;Blockly.Lua.ORDER_MULTIPLICATIVE=4;Blockly.Lua.ORDER_ADDITIVE=5;Blockly.Lua.ORDER_CONCATENATION=6;Blockly.Lua.ORDER_RELATIONAL=7;Blockly.Lua.ORDER_AND=8;Blockly.Lua.ORDER_OR=9;Blockly.Lua.ORDER_NONE=99;Blockly.Lua.init=function(b){Blockly.Lua.blockNums=0;Blockly.Lua.blockNum=[];Blockly.Lua.blockId=[];Blockly.Lua.definitions_=Object.create(null);Blockly.Lua.functionNames_=Object.create(null);Blockly.Lua.variableDB_?Blockly.Lua.variableDB_.reset():Blockly.Lua.variableDB_=new Blockly.Names(Blockly.Lua.RESERVED_WORDS_)};Blockly.Lua.finish=function(e){var d=[],f;for(f in Blockly.Lua.definitions_){d.push(Blockly.Lua.definitions_[f])}delete Blockly.Lua.definitions_;delete Blockly.Lua.functionNames_;Blockly.Lua.variableDB_.reset();return d.join("\n\n")+"\n\n\n"+e};Blockly.Lua.scrubNakedValue=function(b){return"local _ = "+b+"\n"};Blockly.Lua.quote_=function(b){b=b.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'");return"'"+b+"'"};Blockly.Lua.scrub_=function(g,f){var j="";if(!g.outputConnection||!g.outputConnection.targetConnection){var i=g.getCommentText();(i=Blockly.utils.wrap(i,Blockly.Lua.COMMENT_WRAP-3))&&(j+=Blockly.Lua.prefixLines(i,"-- ")+"\n");for(var h=0;h<g.inputList.length;h++){g.inputList[h].type==Blockly.INPUT_VALUE&&(i=g.inputList[h].connection.targetBlock())&&(i=Blockly.Lua.allNestedComments(i))&&(j+=Blockly.Lua.prefixLines(i,"-- "))}}h=g.nextConnection&&g.nextConnection.targetBlock();h=Blockly.Lua.blockToCode(h);return j+f+h};Blockly.Lua.inTryBlock=function(b){for(b=b.previousConnection;b;){if(b=b.targetBlock()){if("exception_try"==b.type){return !0}b=b.previousConnection}}return !1};Blockly.Lua.blockStart=function(d,c){return Blockly.Lua.developerMode?Blockly.Lua.indent(d,"wcBlock.blockStart("+Blockly.Lua.blockIdToNum(c.id)+")")+"\n":""};Blockly.Lua.blockEnd=function(d,c){return Blockly.Lua.developerMode?Blockly.Lua.indent(d,"wcBlock.blockEnd("+Blockly.Lua.blockIdToNum(c.id)+")")+"\n":""};Blockly.Lua.blockError=function(e,d){var f;return Blockly.Lua.developerMode?f=""+(Blockly.Lua.indent(e,"wcBlock.blockError("+Blockly.Lua.blockIdToNum(d.id)+", err, message)")+"\n"):""};Blockly.Lua.blockErrorCatched=function(e,d){var f;return Blockly.Lua.developerMode?f=""+(Blockly.Lua.indent(e,"wcBlock.blockErrorCatched("+Blockly.Lua.blockIdToNum(d.id)+")")+"\n"):""};Blockly.Lua.tryBlock=function(g,f,j,i){var h="";Blockly.Lua.blockIdToNum(f.id);"undefined"==typeof i&&(i="");""!=i&&(h+="-- begin: "+i+"\n");!Blockly.Lua.developerMode||Blockly.Lua.inTryBlock(f)?h+=Blockly.Lua.indent(g,j):(h+=Blockly.Lua.indent(0,"try(")+"\n",h+=Blockly.Lua.indent(1,"function()")+"\n",""!=j&&(h+=Blockly.Lua.indent(2,j)),h+=Blockly.Lua.indent(1,"end,")+"\n",h+=Blockly.Lua.indent(1,"function(where, line, err, message)")+"\n",h+=Blockly.Lua.blockError(2,f),h+=Blockly.Lua.indent(1,"end")+"\n",h+=Blockly.Lua.indent(0,")"),h=Blockly.Lua.indent(g,h)+"\n");""!=i&&(h+="-- end: "+i+"\n");f.nextConnection&&f.nextConnection.targetBlock()&&(h+="\n");return h};Blockly.Lua.require=function(b){-1==codeSection.require.indexOf('require("'+b+'")')&&codeSection.require.push('require("'+b+'")')};Blockly.Lua.indent=function(e,d){for(var f=0;f<e;f++){d=Blockly.Lua.prefixLines(d,Blockly.Lua.INDENT)}return d};Blockly.Lua.blockIdToNum=function(b){"undefined"==typeof Blockly.Lua.blockNum[b]&&(Blockly.Lua.blockNums+=1,Blockly.Lua.blockNum[b]=Blockly.Lua.blockNums,Blockly.Lua.blockId[Blockly.Lua.blockNums]=b);return Blockly.Lua.blockNum[b]};Blockly.Lua.numToBlockId=function(d){try{return Blockly.Lua.blockId[d]}catch(c){return null}};"use strict";Blockly.Lua.io={};Blockly.Lua.io.helper={isDigital:function(e,d,f){return f?"setdigitalpin"==d.type&&e.getFieldValue("PIN")==d.getFieldValue("PIN"):"getdigitalpin"==d.type&&e.getFieldValue("PIN")==d.getFieldValue("PIN")},hasAncestorsDigital:function(e,d){for(var f=e.previousConnection;f;){if(f=f.targetBlock()){if(Blockly.Lua.io.helper.isDigital(e,f,d)){return !0}f=f.previousConnection}}return !1},nameDigital:function(e,d){"undefined"==typeof d&&(d="PIN");var f=Blockly.Lua.statementToCodeNoIndent(e,d)[0];"undefined"==typeof f&&(f=e.getFieldValue(d));return f},instanceDigital:function(e,d){"undefined"==typeof d&&(d="PIN");var f=Blockly.Lua.statementToCodeNoIndent(e,d)[0];"undefined"==typeof f&&(f=e.getFieldValue(d));0===f.indexOf("pio.")&&(f=f.replace("pio.",""));return"_pio_"+f},attachDigital:function(e,d){var f="";Blockly.Lua.io.helper.hasAncestorsDigital(e,d)||(f+=Blockly.Lua.indent(0,"if (("+Blockly.Lua.io.helper.instanceDigital(e)+" == nil) or ("+Blockly.Lua.io.helper.instanceDigital(e)+" == "+(d?"pio.INPUT":"pio.OUTPUT")+")) then")+"\n",f+=Blockly.Lua.indent(1,Blockly.Lua.io.helper.instanceDigital(e)+" = ")+(d?"pio.OUTPUT":"pio.INPUT")+"\n",d?(f+=Blockly.Lua.indent(1,"pio.pin.setdir(pio.OUTPUT, "+Blockly.Lua.io.helper.nameDigital(e)+")")+"\n",f+=Blockly.Lua.indent(1,"pio.pin.setpull(pio.NOPULL, "+Blockly.Lua.io.helper.nameDigital(e)+")")+"\n"):(f+=Blockly.Lua.indent(1,"pio.pin.setdir(pio.INPUT, "+Blockly.Lua.io.helper.nameDigital(e)+")")+"\n",f+=Blockly.Lua.indent(1,"pio.pin.setpull(pio.PULLUP, "+Blockly.Lua.io.helper.nameDigital(e)+")")+"\n"),f+=Blockly.Lua.indent(0,"end")+"\n\n");return f},isAnalog:function(d,c){return"getanalogpin"==c.type&&d.getFieldValue("PIN")==c.getFieldValue("PIN")},isExternalAnalog:function(d,c){return"getexternalanalogchannel"==c.type&&d.getFieldValue("UNIT")==c.getFieldValue("UNIT")&&d.getFieldValue("CHANNEL")==c.getFieldValue("CHANNEL")},hasAncestorsAnalog:function(d){for(var c=d.previousConnection;c;){if(c=c.targetBlock()){if(Blockly.Lua.io.helper.isAnalog(d,c)){return !0}c=c.previousConnection}}return !1},hasAncestorsExternalAnalog:function(d){for(var c=d.previousConnection;c;){if(c=c.targetBlock()){if(Blockly.Lua.io.helper.isExternalAnalog(d,c)){return !0}c=c.previousConnection}}return !1},nameAnalog:function(b){b=Blockly.Lua.statementToCodeNoIndent(b,"PIN")[0];0===b.indexOf("pio.")&&(b=b.replace("pio.",""));return b},nameExternalAnalog:function(d){var c=Blockly.Lua.statementToCodeNoIndent(d,"UNIT")[0];d=Blockly.Lua.statementToCodeNoIndent(d,"CHANNEL")[0];return c.replace("adc.","")+"_"+d},instanceAnalog:function(b){return"_adc_"+Blockly.Lua.io.helper.nameAnalog(b)},instanceExternalAnalog:function(b){return"_adc_"+Blockly.Lua.io.helper.nameExternalAnalog(b)},attachAnalog:function(d){var c="";Blockly.Lua.io.helper.hasAncestorsAnalog(d)||(c+=Blockly.Lua.indent(0,"if ("+Blockly.Lua.io.helper.instanceAnalog(d)+" == nil) then")+"\n",c+=Blockly.Lua.indent(1,Blockly.Lua.io.helper.instanceAnalog(d)+" = adc.attach(adc.ADC1, "+Blockly.Lua.io.helper.nameDigital(d)+", 12)")+"\n",c+=Blockly.Lua.indent(0,"end")+"\n");return c},attachExternalAnalog:function(h){var g="",l=Blockly.Lua.statementToCodeNoIndent(h,"UNIT")[0],k=Blockly.Lua.statementToCodeNoIndent(h,"CHANNEL")[0],j=12,i;for(i in Code.status.maps.externalAdcUnits){Code.status.maps.externalAdcUnits[i][0]==l.replace("adc.","")&&(j=Code.status.maps.externalAdcUnits[i][2])}Blockly.Lua.io.helper.hasAncestorsExternalAnalog(h)||(g+=Blockly.Lua.indent(0,"if ("+Blockly.Lua.io.helper.instanceExternalAnalog(h)+" == nil) then")+"\n",g+=Blockly.Lua.indent(1,Blockly.Lua.io.helper.instanceExternalAnalog(h)+" = adc.attach("+l+","+k+","+j+")")+"\n",g+=Blockly.Lua.indent(0,"end")+"\n");return g},isPwm:function(d,c){return"setpwmpin"==c.type&&d.getFieldValue("PIN")==c.getFieldValue("PIN")},hasAncestorsPwm:function(d){for(var c=d.previousConnection;c;){if(c=c.targetBlock()){if(Blockly.Lua.io.helper.isPwm(d,c)){return !0}c=c.previousConnection}}return !1},namePwm:function(b){b=Blockly.Lua.statementToCodeNoIndent(b,"PIN")[0];0===b.indexOf("pio.")&&(b=b.replace("pio.",""));return b},instancePwm:function(b){return"_pwm"+Blockly.Lua.io.helper.namePwm(b)},attachPwm:function(f){var e=Blockly.Lua.valueToCode(f,"FREQUENCY",Blockly.Lua.ORDER_NONE)||"''",h=Blockly.Lua.valueToCode(f,"DUTY",Blockly.Lua.ORDER_NONE)||"''",g="";Blockly.Lua.io.helper.hasAncestorsPwm(f)?(g+=Blockly.Lua.indent(0,Blockly.Lua.io.helper.instancePwm(f)+":setfreq("+e+")")+"\n",g+=Blockly.Lua.indent(0,Blockly.Lua.io.helper.instancePwm(f)+":setduty("+h+" * 0.01)")+"\n"):(g+=Blockly.Lua.indent(0,"if ("+Blockly.Lua.io.helper.instancePwm(f)+" == nil) then")+"\n",g+=Blockly.Lua.indent(1,Blockly.Lua.io.helper.instancePwm(f)+" = pwm.attach("+Blockly.Lua.io.helper.nameDigital(f)+", "+e+", ("+h+") * 0.01)")+"\n",g+=Blockly.Lua.indent(1,Blockly.Lua.io.helper.instancePwm(f)+":start()")+"\n",g+=Blockly.Lua.indent(0,"else")+"\n",g+=Blockly.Lua.indent(1,Blockly.Lua.io.helper.instancePwm(f)+":setfreq("+e+")")+"\n",g+=Blockly.Lua.indent(1,Blockly.Lua.io.helper.instancePwm(f)+":setduty("+h+" * 0.01)")+"\n",g+=Blockly.Lua.indent(0,"end")+"\n");return g}};Blockly.Lua.setdigitalpin=function(f){var e=f.getFieldValue("VALUE"),h="",g="";Blockly.Lua.require("block");h+=Blockly.Lua.io.helper.attachDigital(f,!0);h+=Blockly.Lua.indent(0,"pio.pin.setval("+e+", "+Blockly.Lua.io.helper.nameDigital(f)+")")+"\n";return g+=Blockly.Lua.tryBlock(0,f,h,"set digital pin "+Blockly.Lua.io.helper.nameDigital(f)+" to "+e)};Blockly.Lua.invertdigitalpin=function(e){e.getFieldValue("VALUE");var d="",f="";Blockly.Lua.require("block");d+=Blockly.Lua.io.helper.attachDigital(e,!0);d+=Blockly.Lua.indent(0,"pio.pin.inv("+Blockly.Lua.io.helper.nameDigital(e)+")")+"\n";return f+=Blockly.Lua.tryBlock(0,e,d,"invert digital pin value "+Blockly.Lua.io.helper.nameDigital(e))};Blockly.Lua.getdigitalpin=function(f){var e,h="",g="";Blockly.Lua.require("block");e=""+Blockly.Lua.io.helper.attachDigital(f,!1);e+=Blockly.Lua.indent(0,"val = pio.pin.getval("+Blockly.Lua.io.helper.nameDigital(f)+")")+"\n";h+=Blockly.Lua.indent(0,"function _getDigitalPin_"+Blockly.Lua.io.helper.nameDigital(f)+"()")+"\n";h+=Blockly.Lua.indent(1,"local val")+"\n\n";h+=Blockly.Lua.indent(1,Blockly.Lua.tryBlock(0,f,e))+"\n";h+=Blockly.Lua.indent(1,"return val")+"\n";h+=Blockly.Lua.indent(0,"end")+"\n";codeSection.functions.push(h);g+=Blockly.Lua.indent(0,"_getDigitalPin_"+Blockly.Lua.io.helper.nameDigital(f)+"()");return[g,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.getanalogpin=function(g){var f=g.getFieldValue("FORMAT"),j,i="",h="";Blockly.Lua.require("block");j=""+Blockly.Lua.io.helper.attachAnalog(g,!1);i+=Blockly.Lua.indent(0,"-- get analog pin value "+Blockly.Lua.io.helper.nameAnalog(g))+" \n";i+=Blockly.Lua.indent(0,"function _getAnalogPin_"+Blockly.Lua.io.helper.nameAnalog(g)+"_"+f+"()")+"\n";i+=Blockly.Lua.indent(1,"local raw = nil")+"\n";i+=Blockly.Lua.indent(1,"local mvolts = nil")+"\n\n";i+=Blockly.Lua.indent(1,Blockly.Lua.tryBlock(0,g,j))+"\n";i+=Blockly.Lua.indent(1,"raw, mvolts = "+Blockly.Lua.io.helper.instanceAnalog(g)+":read()")+"\n";i="mvolts"==f?i+(Blockly.Lua.indent(1,"val = mvolts")+"\n\n"):i+(Blockly.Lua.indent(1,"val = raw")+"\n\n");i+=Blockly.Lua.indent(1,"return val")+"\n";i+=Blockly.Lua.indent(0,"end")+"\n";codeSection.functions.push(i);h+=Blockly.Lua.indent(0,"_getAnalogPin_"+Blockly.Lua.io.helper.nameAnalog(g)+"_"+f+"()");return[h,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.getexternalanalogchannel=function(g){var f=g.getFieldValue("FORMAT"),j,i="",h="";Blockly.Lua.require("block");j=""+Blockly.Lua.io.helper.attachExternalAnalog(g,!1);i+=Blockly.Lua.indent(0,"function _getAnalogPin_"+Blockly.Lua.io.helper.nameExternalAnalog(g)+"_"+f+"()")+"\n";i+=Blockly.Lua.indent(1,"local raw = nil")+"\n";i+=Blockly.Lua.indent(1,"local mvolts = nil")+"\n\n";i+=Blockly.Lua.indent(1,Blockly.Lua.tryBlock(0,g,j))+"\n";i+=Blockly.Lua.indent(1,"raw, mvolts = "+Blockly.Lua.io.helper.instanceExternalAnalog(g)+":read()")+"\n";i="mvolts"==f?i+(Blockly.Lua.indent(1,"val = mvolts")+"\n\n"):i+(Blockly.Lua.indent(1,"val = raw")+"\n\n");i+=Blockly.Lua.indent(1,"return val")+"\n";i+=Blockly.Lua.indent(0,"end")+"\n";codeSection.functions.push(i);h+=Blockly.Lua.indent(0,"_getAnalogPin_"+Blockly.Lua.io.helper.nameExternalAnalog(g)+"_"+f+"()");return[h,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.output_digital_pin=function(b){b=b.getFieldValue("PIN");return["pio."+Code.status.maps.digitalPins[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.output_digital_pin_sel=function(b){b=b.getFieldValue("PIN");return["pio."+Code.status.maps.digitalPins[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.input_digital_pin=function(b){b=b.getFieldValue("PIN");return["pio."+Code.status.maps.digitalPins[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.input_digital_pin_Sel=function(b){b=b.getFieldValue("PIN");return["pio."+Code.status.maps.digitalPins[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.pwm_pins=function(b){b=b.getFieldValue("PIN");return["pio."+Code.status.maps.digitalPins[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.pwm_pins_sel=function(b){b=b.getFieldValue("PIN");return["pio."+Code.status.maps.digitalPins[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.analog_pins=function(b){b=b.getFieldValue("PIN");return["pio."+Code.status.maps.digitalPins[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.analog_pins_sel=function(b){b=b.getFieldValue("PIN");return["pio."+Code.status.maps.digitalPins[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.uart_units=function(b){b=b.getFieldValue("UNIT");return["uart."+Code.status.maps.uartUnits[b][1],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.external_analog_units=function(b){b=b.getFieldValue("UNIT");return["adc."+Code.status.maps.externalAdcUnits[b][0],Blockly.Lua.ORDER_HIGH]};Blockly.Lua.external_analog_channels=function(b){return[b.getFieldValue("CHANNEL"),Blockly.Lua.ORDER_HIGH]};Blockly.Lua.setpwmpin=function(g){var f=Blockly.Lua.valueToCode(g,"FREQUENCY",Blockly.Lua.ORDER_NONE)||"''",j=Blockly.Lua.valueToCode(g,"DUTY",Blockly.Lua.ORDER_NONE)||"''",i="",h="";Blockly.Lua.require("block");i+=Blockly.Lua.io.helper.attachPwm(g);return h+=Blockly.Lua.tryBlock(0,g,i,"set pwm pin "+Blockly.Lua.io.helper.namePwm(g)+" to freq "+f+" hz, duty ("+j+")%")};Blockly.Lua.when_digital_pin=function(g){var f=Blockly.Lua.statementToCodeNoIndent(g,"DO"),j=g.getFieldValue("WHEN"),i="",h="";Blockly.Lua.require("block");i+=Blockly.Lua.indent(0,"-- we need to wait for the completion of the board start")+"\n";i+=Blockly.Lua.indent(0,"_eventBoardStarted:wait()")+"\n\n";i+=Blockly.Lua.io.helper.attachDigital(g,!1);i+=Blockly.Lua.indent(0,"pio.pin.interrupt("+Blockly.Lua.io.helper.nameDigital(g)+", function()")+"\n";i+=Blockly.Lua.blockStart(1,g);""!=f&&(i+=Blockly.Lua.indent(1,f));i+=Blockly.Lua.blockEnd(1,g);i+=Blockly.Lua.indent(0,"end, pio.pin."+j+")")+"\n";h+=Blockly.Lua.indent(0,"thread.start(function()")+"\n";h+=Blockly.Lua.tryBlock(1,g,i);return h+=Blockly.Lua.indent(0,"end)")+"\n"};"use strict";Blockly.Lua.i2c={};Blockly.Lua.i2c.helper={isI2c:function(d,c){return("i2csetspeed"==c.type||"i2cstartcondition"==c.type||"i2cstopcondition"==c.type||"i2caddress"==c.type||"i2cread"==c.type||"i2cwrite"==c.type)&&d.getFieldValue("MODULE")==c.getFieldValue("MODULE")},hasAncestors:function(d){for(var c=d.previousConnection;c;){if(c=c.targetBlock()){if(Blockly.Lua.i2c.helper.isI2c(d,c)){return !0}c=c.previousConnection}}return !1},name:function(b){b=b.getFieldValue("MODULE");return Code.status.maps.i2cUnits[b][1]},instance:function(b){b.getFieldValue("MODULE");return"_i2c"+Blockly.Lua.i2c.helper.name(b)},attach:function(d){d.getFieldValue("MODULE");var c="";Blockly.Lua.i2c.helper.hasAncestors(d)||(c+=Blockly.Lua.indent(0,"if ("+Blockly.Lua.i2c.helper.instance(d)+" == nil) then")+"\n",c+=Blockly.Lua.indent(1,""+Blockly.Lua.i2c.helper.instance(d)+" = i2c.attach(i2c."+Blockly.Lua.i2c.helper.name(d)+", i2c.MASTER)")+"\n",c+=Blockly.Lua.indent(0,"end")+"\n\n");return c}};Blockly.Lua.i2csetspeed=function(f){f.getFieldValue("MODULE");var e=Blockly.Lua.valueToCode(f,"SPEED",Blockly.Lua.ORDER_NONE),h="",g="";Blockly.Lua.require("block");h+=Blockly.Lua.i2c.helper.attach(f);h+=Blockly.Lua.indent(0,Blockly.Lua.i2c.helper.instance(f)+":setspeed("+e+")\n");return g+=Blockly.Lua.tryBlock(0,f,h,"set speed for "+Blockly.Lua.i2c.helper.name(f)+" speed "+e+" hz")};Blockly.Lua.i2cstartcondition=function(e){e.getFieldValue("MODULE");var d="",f="";Blockly.Lua.require("block");d+=Blockly.Lua.i2c.helper.attach(e);d+=Blockly.Lua.indent(0,Blockly.Lua.i2c.helper.instance(e)+":start()\n");return f+=Blockly.Lua.tryBlock(0,e,d,"start condition for "+Blockly.Lua.i2c.helper.name(e))};Blockly.Lua.i2cstopcondition=function(e){e.getFieldValue("MODULE");var d="",f="";Blockly.Lua.require("block");d+=Blockly.Lua.i2c.helper.attach(e);d+=Blockly.Lua.indent(0,Blockly.Lua.i2c.helper.instance(e)+":stop()")+"\n";return f+=Blockly.Lua.tryBlock(0,e,d,"stop condition for "+Blockly.Lua.i2c.helper.name(e))};Blockly.Lua.i2caddress=function(g){g.getFieldValue("MODULE");var f=Blockly.Lua.valueToCode(g,"ADDRESS",Blockly.Lua.ORDER_NONE),j=g.getFieldValue("DIRECTION"),i="",h="";Blockly.Lua.require("block");i+=Blockly.Lua.i2c.helper.attach(g);i+=Blockly.Lua.indent(0,Blockly.Lua.i2c.helper.instance(g)+":address("+f+", "+("read"==j?"true":"false")+")")+"\n";return h+=Blockly.Lua.tryBlock(0,g,i,"set address "+f+" for "+Blockly.Lua.i2c.helper.name(g)+" for "+j)};Blockly.Lua.i2cread=function(f){f.getFieldValue("MODULE");var e,h="",g="";Blockly.Lua.require("block");e=""+Blockly.Lua.i2c.helper.attach(f);e+=Blockly.Lua.indent(0,"-- read from "+Blockly.Lua.i2c.helper.name(f))+"\n";e+=Blockly.Lua.indent(0,"val = "+Blockly.Lua.i2c.helper.instance(f)+":read()")+"\n";h+=Blockly.Lua.indent(0,"function _read"+Blockly.Lua.i2c.helper.name(f)+"()")+"\n";h+=Blockly.Lua.indent(1,"local val")+"\n\n";h+=Blockly.Lua.indent(1,Blockly.Lua.tryBlock(0,f,e))+"\n";h+=Blockly.Lua.indent(1,"return val")+"\n";h+=Blockly.Lua.indent(0,"end")+"\n";codeSection.functions.push(h);g+=Blockly.Lua.indent(0,"_read"+Blockly.Lua.i2c.helper.name(f)+"()")+"\n";f.nextConnection&&(g+="\n");return[g,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.i2cwrite=function(f){f.getFieldValue("MODULE");var e=Blockly.Lua.valueToCode(f,"VALUE",Blockly.Lua.ORDER_NONE),h="",g="";Blockly.Lua.require("block");h+=Blockly.Lua.i2c.helper.attach(f);h+=Blockly.Lua.indent(0,Blockly.Lua.i2c.helper.instance(f)+":write("+e+")")+"\n";return g+=Blockly.Lua.tryBlock(0,f,h,"write "+e+" to "+Blockly.Lua.i2c.helper.name(f))};"use strict";Blockly.Lua.control={};Blockly.Lua.wait_for=function(f){var e=Blockly.Lua.valueToCode(f,"TIME",Blockly.Lua.ORDER_NONE),h=f.getFieldValue("units"),g;g=""+(Blockly.Lua.indent(0,"-- wait some time")+"\n");switch(h){case"microseconds":g+="tmr.delayus(math.floor("+e+"))\r\n";break;case"milliseconds":g+="tmr.delayms(math.floor("+e+"))\r\n";break;case"seconds":g+="tmr.delay(math.floor("+e+"))\r\n"}return Blockly.Lua.postFormat(g,f)};Blockly.Lua.cpu_sleep=function(e){var d=Blockly.Lua.valueToCode(e,"SECONDS",Blockly.Lua.ORDER_NONE),f;f=""+Blockly.Lua.blockStart(0,e);f+=Blockly.Lua.indent(0,"-- sleep cpu some time")+"\n";return Blockly.Lua.postFormat(f+("os.sleep(math.floor("+d+"))"),e)};"use strict";Blockly.Lua.events={};Blockly.Lua.when_board_starts=function(e){var d=Blockly.Lua.statementToCodeNoIndent(e,"DO"),f="";""!=d&&(Blockly.Lua.addDependency("block",e),f+=Blockly.Lua.indent(0,"-- when board starts")+"\n",f+=Blockly.Lua.indent(0,"thread.start(function()")+"\n",f+=Blockly.Lua.blockStart(1,e),f+=Blockly.Lua.tryBlock(1,e,d),f+=Blockly.Lua.blockEnd(1,e)+"\n",f+=Blockly.Lua.indent(1,"-- board is started, broadcast to threads that are waiting")+"\n",f+=Blockly.Lua.indent(1,"_eventBoardStarted:broadcast(false)")+"\n",f+=Blockly.Lua.indent(0,"end)"));return Blockly.Lua.postFormat(f,e)};Blockly.Lua.thread=function(e){var d=Blockly.Lua.statementToCodeNoIndent(e,"DO"),f="";Blockly.Lua.addDependency("block",e);f+=Blockly.Lua.indent(0,"-- thread")+"\n";f+=Blockly.Lua.indent(0,"thread.start(function()")+"\n";f+=Blockly.Lua.indent(1,"_eventBoardStarted:wait()")+"\n\n";f+=Blockly.Lua.blockStart(1,e);f+=Blockly.Lua.indent(1,"while true do")+"\n";f+=Blockly.Lua.tryBlock(2,e,d);f+=Blockly.Lua.indent(1,"end")+"\n";f+=Blockly.Lua.blockEnd(1,e);f+=Blockly.Lua.indent(0,"end)");return Blockly.Lua.postFormat(f,e)};Blockly.Lua.when_i_receive=function(i){var h=Blockly.Lua.statementToCodeNoIndent(i,"DO"),n=i.getFieldValue("WHEN"),m=this.workspace.eventIndexOf(n),l="",k="",j="";Blockly.Lua.addDependency("block",i);k+=Blockly.Lua.indent(0,'-- event "'+n+'" declaration')+"\n";k+=Blockly.Lua.indent(0,"_event"+m+" = event.create()")+"\n";Blockly.Lua.addCodeToSection("events",k,i);j+=Blockly.Lua.indent(0,"-- we need to wait for the completion of the board start")+"\n";j+=Blockly.Lua.indent(0,"_eventBoardStarted:wait()")+"\n\n";j+=Blockly.Lua.indent(0,"while true do")+"\n";j+=Blockly.Lua.indent(1,'-- wait for event "'+n+'"')+"\n";j+=Blockly.Lua.indent(1,"_event"+m+":wait()")+"\n\n";j+=Blockly.Lua.blockStart(1,i);""!=h&&(j+=Blockly.Lua.indent(1,h));j+=Blockly.Lua.indent(1,"_event"+m+":done()")+"\n";j+=Blockly.Lua.blockEnd(1,i);j+=Blockly.Lua.indent(0,"end")+"\n";l+=Blockly.Lua.indent(0,"-- when I receive "+n)+"\n";l+=Blockly.Lua.indent(0,"thread.start(function()")+"\n";l+=Blockly.Lua.tryBlock(1,i,j);l+=Blockly.Lua.indent(0,"end)");return Blockly.Lua.postFormat(l,i)};Blockly.Lua.execute_every=function(h){var g=Blockly.Lua.statementToCodeNoIndent(h,"DO"),l=Blockly.Lua.statementToCodeNoIndent(h,"TIME"),k=h.getFieldValue("units"),j="",i="";Blockly.Lua.blockIdToNum(h.id);Blockly.Lua.addDependency("block",h);"seconds"==k&&(l[0]*=1000);j+=Blockly.Lua.indent(0,"-- attach timer every "+l[0]+" milliseconds")+"\n";j+=Blockly.Lua.indent(0,"thread.start(function()")+"\n";j+=Blockly.Lua.indent(1,"_eventBoardStarted:wait()")+"\n\n";j+=Blockly.Lua.indent(1,"while true do")+"\n";j+=Blockly.Lua.blockStart(2,h);""!=g&&(i+=Blockly.Lua.indent(0,g),j+=Blockly.Lua.tryBlock(2,h,i));j+=Blockly.Lua.blockEnd(2,h);j+=Blockly.Lua.indent(2,"tmr.delayms("+l[0]+")")+"\n";j+=Blockly.Lua.indent(1,"end")+"\n";j+=Blockly.Lua.indent(0,"end)");return Blockly.Lua.postFormat(j,h)};Blockly.Lua.broadcast=function(f){var e=f.getFieldValue("WHEN"),h=this.workspace.eventIndexOf(e),g="";Blockly.Lua.addDependency("block",f);g+=Blockly.Lua.indent(0,"_event"+h+':broadcast(false)  -- boardcast "'+e+'"');return Blockly.Lua.postFormat(g,f)};Blockly.Lua.broadcast_and_wait=function(f){var e=f.getFieldValue("WHEN"),h=this.workspace.eventIndexOf(e),g="";Blockly.Lua.addDependency("block",f);g+=Blockly.Lua.indent(0,"_event"+h+':broadcast(true)  -- boardcast and wait "'+e+'"');return Blockly.Lua.postFormat(g,f)};Blockly.Lua.event_is_being_processed=function(d){var c=d.getFieldValue("WHEN"),c=this.workspace.eventIndexOf(c);Blockly.Lua.addDependency("block",d);return["_event"+c+":pending()",Blockly.Lua.ORDER_HIGH]};"use strict";Blockly.Lua.variables={};Blockly.Lua.variables_get=function(b){return"undefined"==typeof Blockly.Lua.variableDB_?["",Blockly.Lua.ORDER_ATOMIC]:[Blockly.Lua.variableDB_.getName(b.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.variables_set=function(d){var c=Blockly.Lua.valueToCode(d,"VALUE",Blockly.Lua.ORDER_NONE)||"0";return"undefined"==typeof Blockly.Lua.variableDB_?["",Blockly.Lua.ORDER_ATOMIC]:Blockly.Lua.variableDB_.getName(d.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE)+" = "+c+"\n"};"use strict";Blockly.Lua.logic={};Blockly.Lua.controls_if=function(g){var f=0,j="",i,h;do{h=Blockly.Lua.valueToCode(g,"IF"+f,Blockly.Lua.ORDER_NONE)||"false",i=Blockly.Lua.statementToCode(g,"DO"+f),j+=(0<f?"else":"")+"if "+h+" then\n"+i,++f}while(g.getInput("IF"+f));g.getInput("ELSE")&&(i=Blockly.Lua.statementToCode(g,"ELSE"),j+="else\n"+i);return j+"end\n"};Blockly.Lua.controls_ifelse=Blockly.Lua.controls_if;Blockly.Lua.logic_compare=function(e){var d={EQ:"==",NEQ:"~=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")],f=Blockly.Lua.valueToCode(e,"A",Blockly.Lua.ORDER_RELATIONAL)||"0";e=Blockly.Lua.valueToCode(e,"B",Blockly.Lua.ORDER_RELATIONAL)||"0";return[f+" "+d+" "+e,Blockly.Lua.ORDER_RELATIONAL]};Blockly.Lua.logic_operation=function(g){var f="AND"==g.getFieldValue("OP")?"and":"or",j="and"==f?Blockly.Lua.ORDER_AND:Blockly.Lua.ORDER_OR,i=Blockly.Lua.valueToCode(g,"A",j);g=Blockly.Lua.valueToCode(g,"B",j);if(i||g){var h="and"==f?"true":"false";i||(i=h);g||(g=h)}else{g=i="false"}return[i+" "+f+" "+g,j]};Blockly.Lua.logic_negate=function(b){return["not "+(Blockly.Lua.valueToCode(b,"BOOL",Blockly.Lua.ORDER_UNARY)||"true"),Blockly.Lua.ORDER_UNARY]};Blockly.Lua.logic_boolean=function(b){return["TRUE"==b.getFieldValue("BOOL")?"true":"false",Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.logic_null=function(b){return["nil",Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.logic_ternary=function(e){var d=Blockly.Lua.valueToCode(e,"IF",Blockly.Lua.ORDER_AND)||"false",f=Blockly.Lua.valueToCode(e,"THEN",Blockly.Lua.ORDER_AND)||"nil";e=Blockly.Lua.valueToCode(e,"ELSE",Blockly.Lua.ORDER_OR)||"nil";return[d+" and "+f+" or "+e,Blockly.Lua.ORDER_OR]};"use strict";Blockly.Lua.MQTT={};Blockly.Lua.mqtt_publish=function(h){var g=Blockly.Lua.valueToCode(h,"TOPIC",Blockly.Lua.ORDER_NONE)||"''",l=Blockly.Lua.valueToCode(h,"PAYLOAD",Blockly.Lua.ORDER_NONE)||"''",k=h.getFieldValue("QOS"),j="";-1==codeSection.require.indexOf('require("block")')&&codeSection.require.push('require("block")');var i;i=""+Blockly.Lua.blockStart(0,h);i+=Blockly.Lua.indent(0,"-- create the MQTT client and connect, if needed")+"\n";i+=Blockly.Lua.indent(0,"_mqtt_lock:lock()")+"\n";i+=Blockly.Lua.indent(0,"if (_mqtt == nil) then")+"\n";i+=Blockly.Lua.indent(1,'_mqtt = mqtt.client("'+h.clientid+'", "'+h.host+'", '+h.port+", "+h.secure+")")+"\n";i+=Blockly.Lua.indent(1,'_mqtt:connect("'+h.username+'","'+h.password+'")')+"\n";i+=Blockly.Lua.indent(0,"end")+"\n";i+=Blockly.Lua.indent(0,"_mqtt_lock:unlock()")+"\n\n";i+=Blockly.Lua.indent(0,"-- publish to topic")+"\n";i+=Blockly.Lua.indent(0,"_mqtt:publish("+g+", "+l+", mqtt.QOS"+k+")")+"\n";i+=Blockly.Lua.blockEnd(0,h);j+=Blockly.Lua.indent(0,"-- publish to MQTT topic "+g)+"\n";return j+=Blockly.Lua.tryBlock(0,h,i)+"\n"};Blockly.Lua.mqtt_subscribe=function(h){var g=Blockly.Lua.valueToCode(h,"TOPIC",Blockly.Lua.ORDER_NONE)||"''",l=Blockly.Lua.statementToCodeNoIndent(h,"DO"),k=h.getFieldValue("QOS"),j="";-1==codeSection.require.indexOf('require("block")')&&codeSection.require.push('require("block")');var i;i=""+(Blockly.Lua.indent(0,"-- we need to wait for the completion of the board start, where")+"\n");i+=Blockly.Lua.indent(0,"-- network must be configured an started")+"\n";i+=Blockly.Lua.indent(0,"_eventBoardStarted:wait()")+"\n\n";i+=Blockly.Lua.indent(0,"-- create the MQTT client and connect, if needed")+"\n";i+=Blockly.Lua.indent(0,"_mqtt_lock:lock()")+"\n";i+=Blockly.Lua.indent(0,"if (_mqtt == nil) then")+"\n";i+=Blockly.Lua.indent(1,'_mqtt = mqtt.client("'+h.clientid+'", "'+h.host+'", '+h.port+", "+h.secure+")")+"\n";i+=Blockly.Lua.indent(1,'_mqtt:connect("'+h.username+'","'+h.password+'")')+"\n";i+=Blockly.Lua.indent(0,"end")+"\n";i+=Blockly.Lua.indent(0,"_mqtt_lock:unlock()")+"\n\n";i+=Blockly.Lua.indent(0,"-- subscribe to topic")+"\n";i+=Blockly.Lua.indent(0,"_mqtt:subscribe("+g+", mqtt.QOS"+k+", function(length, payload)")+"\n";i+=Blockly.Lua.indent(1,"-- a new message is available in length / payload arguments")+"\n";i+=Blockly.Lua.blockStart(1,h);""!=l&&(i+=Blockly.Lua.tryBlock(1,h,l));i+=Blockly.Lua.blockEnd(1,h);i+=Blockly.Lua.indent(0,"end)")+"\n";j+=Blockly.Lua.indent(0,"-- subscribe to MQTT topic "+g)+"\n";j+=Blockly.Lua.indent(0,"thread.start(function()")+"\n";j+=Blockly.Lua.tryBlock(1,h,i);return j+=Blockly.Lua.indent(0,"end)")+"\n"};var codeSection=[],codeSectionBlock=[];codeSection.require=[];codeSection.events=[];codeSection.functions=[];codeSectionBlock.functions=[];codeSection.declaration=[];codeSection.start=[];codeSection.afterStart=[];codeSection["default"]=[];var codeSectionOrder=[];codeSectionOrder.push("require");codeSectionOrder.push("events");codeSectionOrder.push("functions");codeSectionOrder.push("declaration");codeSectionOrder.push("default");codeSectionOrder.push("start");codeSectionOrder.push("afterStart");Blockly.Generator.prototype.INDENT="\t";Blockly.Generator.prototype.addCodeToSection=function(f,e,h){var g=!0;f=goog.string.trim(f);e=goog.string.trim(e);"functions"==f&&(g=-1==codeSectionBlock.functions.indexOf(h.type),codeSectionBlock.functions.push(h.type));g&&codeSection[f].push(e+"\n")};Blockly.Generator.prototype.addDependency=function(d,c){d=goog.string.trim(d);""!=d&&"0"!=d&&-1==codeSection.require.indexOf('require("'+d+'")')&&codeSection.require.push('require("'+d+'")')};Blockly.Generator.prototype.postFormat=function(d,c){d=goog.string.trim(d);d+="\n";c.nextConnection&&c.nextConnection.isConnected()&&(d+="\n");return d};Blockly.Generator.prototype.statementToCodeNoIndent=function(f,e){var h=f.getInputTargetBlock(e),g=this.blockToCode(h);goog.asserts.assertString(g,'Expecting code from statement block "%s".',h&&h.type);return g};Blockly.Generator.prototype.workspaceToCode=function(r){r||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),r=Blockly.getMainWorkspace());var q="default",p;for(p in codeSection){codeSection[p]=[]}for(p in codeSectionBlock){codeSectionBlock[p]=[]}q=p=!1;this.init(r);for(var o=r.getAllBlocks(),n=0,m;m=o[n];n++){"when_board_starts"!=m.type||m.disabled||(p=!0),("mqtt_publish"==m.type&&!m.disabled||"mqtt_subscribe"==m.type&&!m.disabled)&&m.isInHatBlock()&&(q=!0)}o=r.getTopBlocks(!0);r="";q&&(r+=Blockly.Lua.indent(0,"-- this event is for sync the mqtt client connection")+"\n",r+=Blockly.Lua.indent(0,"_mqtt_lock = thread.createmutex()")+"\n\n");r+=Blockly.Lua.indent(0,"-- this event is for sync the end of the board start with threads")+"\n";r+=Blockly.Lua.indent(0,"-- that must wait for this situation")+"\n";r+=Blockly.Lua.indent(0,"_eventBoardStarted = event.create()")+"\n";codeSection.events.push(r);for(n=0;m=o[n];n++){q="default","undefined"!==typeof m.section&&(q=m.section()),r=this.blockToCode(m),goog.isArray(r)&&(r=r[0]),r&&(m.outputConnection&&this.scrubNakedValue&&(r=this.scrubNakedValue(r)),m.isHatBlock()&&codeSection[q].push(r))}p||(r=Blockly.Lua.indent(0,"thread.start(function()")+"\n",r+=Blockly.Lua.indent(1,"-- board is started")+"\n",r+=Blockly.Lua.indent(1,"_eventBoardStarted:broadcast(false)")+"\n",r+=Blockly.Lua.indent(0,"end)")+"\n",codeSection.start.push(r));for(var l in Blockly.Lua.definitions_){codeSection.declaration.push(Blockly.Lua.definitions_[l])}delete Blockly.Lua.definitions_;delete Blockly.Lua.functionNames_;Blockly.Lua.variableDB_.reset();var j="",i="";codeSectionOrder.forEach(function(d,c){""!=codeSection[d]&&(i=codeSection[d].join("\n"),j+=i+"\n","require"==d&&(j+="\n"))});j=j.replace(/^\s+\n/,"");j=j.replace(/\n\s+$/,"\n");return j=j.replace(/[ \t]+\n/g,"\n")};Blockly.Generator.prototype.usesMQTT=function(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=Blockly.getMainWorkspace());e=e.getAllBlocks();for(var d=0,f;f=e[d];d++){if("mqtt_publish"==f.type||"mqtt_subscribe"==f.type){return !0}}return !1};Blockly.Generator.prototype.oneBlockToCode=function(d){if(!d){return""}if(d.disabled){return this.blockToCode(d.getNextBlock())}var c=this[d.type];goog.asserts.assertFunction(c,'Language "%s" does not know how to generate code for block type "%s".',this.name_,d.type);c=c.call(d,d);if(goog.isArray(c)){return goog.asserts.assert(d.outputConnection,'Expecting string from statement block "%s".',d.type),[this.scrub_(d,c[0]),c[1]]}if(goog.isString(c)){return d=d.id.replace(/\$/g,"$$$$"),this.STATEMENT_PREFIX&&(c=this.STATEMENT_PREFIX.replace(/%1/g,"'"+d+"'")+c),c}if(null===c){return""}goog.asserts.fail("Invalid code generated: %s",c)};Blockly.Generator.prototype.blockWatcherCode=function(e){var d=[],f;this.init(e.workspace);for(f in codeSection){codeSection[f]=[]}codeSection.require.push('require("block")');e=this.oneBlockToCode(e);codeSectionOrder.forEach(function(b,g){"default"!=b&&""!=codeSection[b]&&(d+=codeSection[b].join("\n")+"\n")});d+="function _code()\n";d+="local previous = wcBlock.developerMode\n";d+="wcBlock.developerMode = false\n";d=goog.isArray(e)?d+("print("+e[0]+")\n"):d+("print("+e+")\n");d+="wcBlock.developerMode = previous\n";return d+="end"};Blockly.Generator.prototype.blockCode=function(e){var d=[],f;this.init(e.workspace);for(f in codeSection){codeSection[f]=[]}codeSection.require.push('require("block")');e=this.oneBlockToCode(e);codeSectionOrder.forEach(function(b,g){"default"!=b&&""!=codeSection[b]&&(d+=codeSection[b].join("\n")+"\n")});d+="function _code()\n";d+="thread.start(function()\n";d+="local previous = wcBlock.developerMode\n";d+="wcBlock.developerMode = false\n";d=goog.isArray(e)?d+(e[0]+"\n"):d+(e+"\n");d+="wcBlock.developerMode = previous\n";d+="end)\n";return d+="end"};"use strict";Blockly.Lua.Wifi={};Blockly.Lua.wifi_start=function(e){var d="",f;f=""+Blockly.Lua.blockStart(0,e);f+=Blockly.Lua.indent(0,"net.wf.setup(net.wf.mode."+e.wtype+', "'+e.ssid+'","'+e.password+'")')+"\n";f+=Blockly.Lua.indent(0,"net.wf.start()")+"\n";f+=Blockly.Lua.blockEnd(0,e);d+=Blockly.Lua.indent(0,"-- configure wifi and start wifi")+"\n";return d+=Blockly.Lua.indent(0,Blockly.Lua.tryBlock(0,e,f))+"\n"};Blockly.Lua.wifi_stop=function(e){var d="",f;f=""+(Blockly.Lua.indent(0,"net.wf.setup(net.wf.mode."+e.wtype+', "'+e.ssid+'","'+e.password+'")')+"\n");f+=Blockly.Lua.indent(0,"net.wf.stop()")+"\n";d+=Blockly.Lua.indent(0,"-- configure wifi and stop wifi")+"\n";return d+=Blockly.Lua.indent(0,Blockly.Lua.tryBlock(0,e,f))+"\n"};"use strict";Blockly.Lua["try"]={};Blockly.Lua.exception_try=function(g){var f=Blockly.Lua.statementToCode(g,"TRY0"),j=Blockly.Lua.statementToCode(g,"CATCH0"),i=Blockly.Lua.statementToCode(g,"FINALLY0"),h;h=""+(Blockly.Lua.indent(0,"try(")+"\n");h+=Blockly.Lua.indent(1,"function()")+"\n";h+=Blockly.Lua.indent(1,f);h+=Blockly.Lua.indent(1,"end, ")+"\n";h+=Blockly.Lua.indent(1,"function(where, line, errCode, msg)")+"\n";h+=Blockly.Lua.indent(1,j);h+=Blockly.Lua.blockErrorCatched(2,g);""!=i&&(h+=Blockly.Lua.indent(1,"end, ")+"\n",h+=Blockly.Lua.indent(1,"function()")+"\n",h+=Blockly.Lua.indent(1,i));h+=Blockly.Lua.indent(1,"end")+"\n";return h+=Blockly.Lua.indent(0,")")+"\n"};Blockly.Lua.exception_catch_error=function(f){var e=Blockly.Lua.statementToCode(f,"DO"),h=f.getFieldValue("ERROR"),g="",g="any"==h?g+(Blockly.Lua.indent(0,"if (errCode ~= nil) then")+"\n"):g+(Blockly.Lua.indent(0,"if ((errCode ~= nil) and (errCode == "+h+")) then")+"\n"),g=g+Blockly.Lua.indent(0,e),g=g+Blockly.Lua.blockErrorCatched(1,f),g=g+(Blockly.Lua.indent(1,"return")+"\n");return g+=Blockly.Lua.indent(0,"end")+"\n"};Blockly.Lua.exception_raise_again=function(b){return Blockly.Lua.indent(0,'error(errCode..":"..msg)')+"\n"};"use strict";Blockly.Lua.sensors={};Blockly.Lua.sensors.helper={getInterface:function(f){for(var e="",h=f["interface"].split(","),g=0;g<h.length;g++){"GPIO"==h[g]?(""!=e&&(e+=", "),e+="pio."+Code.status.maps.digitalPins[f["interface"+g+"_unit"]][0]):"ADC"==h[g]?1==f["interface"+g+"_unit"]?(""!=e&&(e+=", "),e+="adc.ADC1, pio."+Code.status.maps.analogPins[f["interface"+g+"_subunit"]][0]):(""!=e&&(e+=", "),e+="adc."+Code.status.maps.externalAdcUnits[f["interface"+g+"_unit"]][0]+", "+f["interface"+g+"_subunit"]):"I2C"==h[g]?(""!=e&&(e+=", "),e+="i2c."+Code.status.maps.i2cUnits[f["interface"+g+"_unit"]][1]+", 0"):"UART"==h[g]?(""!=e&&(e+=", "),e+="uart."+Code.status.maps.uartUnits[f["interface"+g+"_unit"]][1]):"1-WIRE"==h[g]&&(""!=e&&(e+=", "),e+="pio."+Code.status.maps.digitalPins[f["interface"+g+"_unit"]][0]+", "+f["interface"+g+"_device"])}return e},nameSensor:function(b){return b.sid.replace(/\s|-/g,"_")},attach:function(e){var d="",f=Blockly.Lua.sensors.helper.getInterface(e),d=d+(Blockly.Lua.indent(0,"if (_"+e.name+"_"+Blockly.Lua.sensors.helper.nameSensor(e)+" == nil) then")+"\n"),d=d+(Blockly.Lua.indent(1,"_"+e.name+"_"+Blockly.Lua.sensors.helper.nameSensor(e)+' = sensor.attach("'+e.sid+'"'+(""!=f?", ":"")+f+")")+"\n");return d+=Blockly.Lua.indent(0,"end")+"\n\n"}};Blockly.Lua.sensor_read=function(f){var e=f.getFieldValue("PROVIDES");-1==codeSection.require.indexOf('require("block")')&&codeSection.require.push('require("block")');var h;h=""+(Blockly.Lua.indent(0,"function _get"+f.name+"_"+e.replace(/\s|-/g,"_")+"()")+"\n");var g;g=""+Blockly.Lua.sensors.helper.attach(f);g+=Blockly.Lua.indent(0,"value = _"+f.name+"_"+Blockly.Lua.sensors.helper.nameSensor(f)+':read("'+e+'")')+"\n";h+=Blockly.Lua.indent(1,"local value\n")+"\n";h+=Blockly.Lua.indent(0,Blockly.Lua.tryBlock(1,f,g))+"\n";h+=Blockly.Lua.indent(1,"return value\n");h+=Blockly.Lua.indent(0,"end\n");codeSection.declaration.push(h);return["_get"+f.name+"_"+e.replace(/\s|-/g,"_")+"()",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.sensor_set=function(g){var f=g.getFieldValue("PROPERTIES"),j=Blockly.Lua.valueToCode(g,"VALUE",Blockly.Lua.ORDER_NONE),i="";-1==codeSection.require.indexOf('require("block")')&&codeSection.require.push('require("block")');var h;h=""+(Blockly.Lua.indent(1,'local instance = "_'+g.name+"_"+Blockly.Lua.sensors.helper.nameSensor(g)+'"')+"\n\n");h+=Blockly.Lua.sensors.helper.attach(g);h+=Blockly.Lua.indent(1,"_"+g.name+"_"+Blockly.Lua.sensors.helper.nameSensor(g)+':set("'+f+'", '+j+")")+"\n";return i+=Blockly.Lua.indent(0,Blockly.Lua.tryBlock(0,g,h))+"\n"};Blockly.Lua.sensor_when=function(g){var f=g.getFieldValue("PROVIDES"),j=Blockly.Lua.statementToCodeNoIndent(g,"DO"),i="";-1==codeSection.require.indexOf('require("block")')&&codeSection.require.push('require("block")');var h;h=""+(Blockly.Lua.indent(0,"-- we need to wait for the completion of the board start")+"\n");h+=Blockly.Lua.indent(0,"_eventBoardStarted:wait()")+"\n\n";h+=Blockly.Lua.indent(0,Blockly.Lua.sensors.helper.attach(g));h+=Blockly.Lua.indent(0,"_"+g.name+"_"+Blockly.Lua.sensors.helper.nameSensor(g)+":callback(function(magnitude)")+"\n";h+=Blockly.Lua.indent(1,"local value = magnitude."+f)+"\n\n";h+=Blockly.Lua.indent(1,"if value == nil then return end")+"\n\n";h+=Blockly.Lua.blockStart(2,g);""!=j&&(h+=Blockly.Lua.indent(2,j));h+=Blockly.Lua.blockEnd(2,g);h+=Blockly.Lua.indent(1,"end)")+"\n";i+=Blockly.Lua.indent(0,"thread.start(function()")+"\n";i+=Blockly.Lua.tryBlock(1,g,h);return i+=Blockly.Lua.indent(0,"end)")+"\n"};"use strict";Blockly.Lua.servo={};Blockly.Lua.servo.helper={isServo:function(d,c){return"servo_move"==c.type&&d.getFieldValue("PIN")==c.getFieldValue("PIN")},hasAncestors:function(d){for(var c=d.previousConnection;c;){if(c=c.targetBlock()){if(Blockly.Lua.servo.helper.isServo(d,c)){return !0}c=c.previousConnection}}return !1},instance:function(b){return"_servo_"+Blockly.Lua.io.helper.nameDigital(b)},attach:function(d){var c="";Blockly.Lua.servo.helper.hasAncestors(d)||(c+=Blockly.Lua.indent(0,"if ("+Blockly.Lua.servo.helper.instance(d)+" == nil) then")+"\n",c+=Blockly.Lua.indent(1,Blockly.Lua.servo.helper.instance(d)+" = servo.attach("+Blockly.Lua.io.helper.nameDigital(d)+")")+"\n",c+=Blockly.Lua.indent(0,"end")+"\n\n");return c}};Blockly.Lua.servo_move=function(g){g.getFieldValue("PIN");var f=Blockly.Lua.valueToCode(g,"VALUE",Blockly.Lua.ORDER_NONE)||"''",j="",i="",h;h=""+(Blockly.Lua.indent(0,"-- servos")+"\n");h+=Blockly.Lua.indent(0,"_servo_pio = {}")+"\n";Blockly.Lua.addCodeToSection("declaration",h,g);Blockly.Lua.require("block");i+=Blockly.Lua.servo.helper.attach(g);i+=Blockly.Lua.indent(0,Blockly.Lua.servo.helper.instance(g)+":write("+f+")")+"\n";return j+=Blockly.Lua.tryBlock(0,g,i,"move servo at pin "+Blockly.Lua.io.helper.nameDigital(g)+" by "+f)};"use strict";Blockly.Lua.lists={};Blockly.Lua.lists_create_empty=function(b){return["{}",Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.lists_create_with=function(e){for(var d=Array(e.itemCount_),f=0;f<e.itemCount_;f++){d[f]=Blockly.Lua.valueToCode(e,"ADD"+f,Blockly.Lua.ORDER_NONE)||"None"}return["{"+d.join(", ")+"}",Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.lists_repeat=function(e){var d=Blockly.Lua.provideFunction_("create_list_repeated",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(item, count)","  local t = {}","  for i = 1, count do","    table.insert(t, item)","  end","  return t","end"]),f=Blockly.Lua.valueToCode(e,"ITEM",Blockly.Lua.ORDER_NONE)||"None";e=Blockly.Lua.valueToCode(e,"NUM",Blockly.Lua.ORDER_NONE)||"0";return[d+"("+f+", "+e+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_length=function(b){return["#"+(Blockly.Lua.valueToCode(b,"VALUE",Blockly.Lua.ORDER_UNARY)||"{}"),Blockly.Lua.ORDER_UNARY]};Blockly.Lua.lists_isEmpty=function(b){return["#"+(Blockly.Lua.valueToCode(b,"VALUE",Blockly.Lua.ORDER_UNARY)||"{}")+" == 0",Blockly.Lua.ORDER_RELATIONAL]};Blockly.Lua.lists_indexOf=function(e){var d=Blockly.Lua.valueToCode(e,"FIND",Blockly.Lua.ORDER_NONE)||"''",f=Blockly.Lua.valueToCode(e,"VALUE",Blockly.Lua.ORDER_NONE)||"{}";return[("FIRST"==e.getFieldValue("END")?Blockly.Lua.provideFunction_("first_index",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t, elem)","  for k, v in ipairs(t) do","    if v == elem then","      return k","    end","  end","  return 0","end"]):Blockly.Lua.provideFunction_("last_index",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t, elem)","  for i = #t, 1, -1 do","    if t[i] == elem then","      return i","    end","  end","  return 0","end"]))+"("+f+", "+d+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists.getIndex_=function(e,d,f){return"FIRST"==d?"1":"FROM_END"==d?"#"+e+" + 1 - "+f:"LAST"==d?"#"+e:"RANDOM"==d?"math.random(#"+e+")":f};Blockly.Lua.lists_getIndex=function(h){var g=h.getFieldValue("MODE")||"GET",l=h.getFieldValue("WHERE")||"FROM_START",k=Blockly.Lua.valueToCode(h,"VALUE",Blockly.Lua.ORDER_HIGH)||"{}",j=Blockly.Lua.lists.getIndex_;if("LAST"!=l&&"FROM_END"!=l&&"RANDOM"!=l||k.match(/^\w+$/)){i="GET"==g&&"FROM_END"==l?Blockly.Lua.ORDER_ADDITIVE:Blockly.Lua.ORDER_NONE;h=Blockly.Lua.valueToCode(h,"AT",i)||"1";h=j(k,l,h);if("GET"==g){return[k+"["+h+"]",Blockly.Lua.ORDER_HIGH]}l="table.remove("+k+", "+h+")";return"GET_REMOVE"==g?[l,Blockly.Lua.ORDER_HIGH]:l+"\n"}if("REMOVE"==g){var i="FROM_END"==l?Blockly.Lua.ORDER_ADDITIVE:Blockly.Lua.ORDER_NONE;h=Blockly.Lua.valueToCode(h,"AT",i)||"1";g=Blockly.Lua.variableDB_.getDistinctName("tmp_list",Blockly.Variables.NAME_TYPE);h=j(g,l,h);return g+" = "+k+"\ntable.remove("+g+", "+h+")\n"}h=Blockly.Lua.valueToCode(h,"AT",Blockly.Lua.ORDER_NONE)||"1";return[("GET"==g?Blockly.Lua.provideFunction_("list_get_"+l.toLowerCase(),["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t"+("FROM_END"==l||"FROM_START"==l?", at)":")"),"  return t["+j("t",l,"at")+"]","end"]):Blockly.Lua.provideFunction_("list_remove_"+l.toLowerCase(),["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t"+("FROM_END"==l||"FROM_START"==l?", at)":")"),"  return table.remove(t, "+j("t",l,"at")+")","end"]))+"("+k+("FROM_END"==l||"FROM_START"==l?", "+h:"")+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_setIndex=function(j){var i=Blockly.Lua.valueToCode(j,"LIST",Blockly.Lua.ORDER_HIGH)||"{}",p=j.getFieldValue("MODE")||"SET",o=j.getFieldValue("WHERE")||"FROM_START",n=Blockly.Lua.valueToCode(j,"AT",Blockly.Lua.ORDER_ADDITIVE)||"1";j=Blockly.Lua.valueToCode(j,"TO",Blockly.Lua.ORDER_NONE)||"None";var m=Blockly.Lua.lists.getIndex_,l="";if(("LAST"==o||"FROM_END"==o||"RANDOM"==o)&&!i.match(/^\w+$/)){var k=Blockly.Lua.variableDB_.getDistinctName("tmp_list",Blockly.Variables.NAME_TYPE),l=k+" = "+i+"\n",i=k}l="SET"==p?l+(i+"["+m(i,o,n)+"] = "+j):l+("table.insert("+i+", "+(m(i,o,n)+("LAST"==o?" + 1":""))+", "+j+")");return l+"\n"};Blockly.Lua.lists_getSublist=function(h){var g=Blockly.Lua.valueToCode(h,"LIST",Blockly.Lua.ORDER_NONE)||"{}",l=h.getFieldValue("WHERE1"),k=h.getFieldValue("WHERE2"),j=Blockly.Lua.valueToCode(h,"AT1",Blockly.Lua.ORDER_NONE)||"1";h=Blockly.Lua.valueToCode(h,"AT2",Blockly.Lua.ORDER_NONE)||"1";var i=Blockly.Lua.lists.getIndex_;return[Blockly.Lua.provideFunction_("list_sublist_"+l.toLowerCase()+"_"+k.toLowerCase(),["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(source"+("FROM_END"==l||"FROM_START"==l?", at1":"")+("FROM_END"==k||"FROM_START"==k?", at2":"")+")","  local t = {}","  local start = "+i("source",l,"at1"),"  local finish = "+i("source",k,"at2"),"  for i = start, finish do","    table.insert(t, source[i])","  end","  return t","end"])+"("+g+("FROM_END"==l||"FROM_START"==l?", "+j:"")+("FROM_END"==k||"FROM_START"==k?", "+h:"")+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_sort=function(e){var d=Blockly.Lua.valueToCode(e,"LIST",Blockly.Lua.ORDER_NONE)||"{}",f="1"===e.getFieldValue("DIRECTION")?1:-1;e=e.getFieldValue("TYPE");return[Blockly.Lua.provideFunction_("list_sort",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(list, typev, direction)","  local t = {}","  for n,v in pairs(list) do table.insert(t, v) end","  local compareFuncs = {","    NUMERIC = function(a, b)","      return (tonumber(tostring(a)) or 0)","          < (tonumber(tostring(b)) or 0) end,","    TEXT = function(a, b)","      return tostring(a) < tostring(b) end,","    IGNORE_CASE = function(a, b)","      return string.lower(tostring(a)) < string.lower(tostring(b)) end","  }","  local compareTemp = compareFuncs[typev]","  local compare = compareTemp","  if direction == -1","  then compare = function(a, b) return compareTemp(b, a) end","  end","  table.sort(t, compare)","  return t","end"])+"("+d+',"'+e+'", '+f+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.lists_split=function(e){var d=Blockly.Lua.valueToCode(e,"INPUT",Blockly.Lua.ORDER_NONE),f=Blockly.Lua.valueToCode(e,"DELIM",Blockly.Lua.ORDER_NONE)||"''";e=e.getFieldValue("MODE");if("SPLIT"==e){d||(d="''"),e=Blockly.Lua.provideFunction_("list_string_split",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(input, delim)","  local t = {}","  local pos = 1","  while true do","    next_delim = string.find(input, delim, pos)","    if next_delim == nil then","      table.insert(t, string.sub(input, pos))","      break","    else","      table.insert(t, string.sub(input, pos, next_delim-1))","      pos = next_delim + #delim","    end","  end","  return t","end"])}else{if("JOIN"==e){d||(d="{}"),e="table.concat"}else{throw"Unknown mode: "+e}}return[e+"("+d+", "+f+")",Blockly.Lua.ORDER_HIGH]};"use strict";Blockly.Lua.procedures={};Blockly.Lua.procedures_defreturn=function(h){var g=Blockly.Lua.variableDB_.getName(h.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),l=Blockly.Lua.statementToCode(h,"STACK");Blockly.Lua.STATEMENT_PREFIX&&(l=Blockly.Lua.prefixLines(Blockly.Lua.STATEMENT_PREFIX.replace(/%1/g,"'"+h.id+"'"),Blockly.Lua.INDENT)+l);Blockly.Lua.INFINITE_LOOP_TRAP&&(l=Blockly.Lua.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+h.id+"'")+l);var k=Blockly.Lua.valueToCode(h,"RETURN",Blockly.Lua.ORDER_NONE)||"";k?k="  return "+k+"\n":l||(l="");for(var j=[],i=0;i<h.arguments_.length;i++){j[i]=Blockly.Lua.variableDB_.getName(h.arguments_[i],Blockly.Variables.NAME_TYPE)}l="function "+g+"("+j.join(", ")+")\n"+l+k+"end\n";l=Blockly.Lua.scrub_(h,l);Blockly.Lua.definitions_["%"+g]=l;return null};Blockly.Lua.procedures_defnoreturn=Blockly.Lua.procedures_defreturn;Blockly.Lua.procedures_callreturn=function(f){for(var e=Blockly.Lua.variableDB_.getName(f.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),h=[],g=0;g<f.arguments_.length;g++){h[g]=Blockly.Lua.valueToCode(f,"ARG"+g,Blockly.Lua.ORDER_NONE)||"nil"}return[e+"("+h.join(", ")+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.procedures_callnoreturn=function(f){for(var e=Blockly.Lua.variableDB_.getName(f.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),h=[],g=0;g<f.arguments_.length;g++){h[g]=Blockly.Lua.valueToCode(f,"ARG"+g,Blockly.Lua.ORDER_NONE)||"nil"}return e+"("+h.join(", ")+")\n"};Blockly.Lua.procedures_ifreturn=function(d){var c="if "+(Blockly.Lua.valueToCode(d,"CONDITION",Blockly.Lua.ORDER_NONE)||"false")+" then\n";d.hasReturnValue_?(d=Blockly.Lua.valueToCode(d,"VALUE",Blockly.Lua.ORDER_NONE)||"nil",c+="  return "+d+"\n"):c+="  return\n";return c+"end\n"};"use strict";Blockly.Lua.lora={};Blockly.Lua.lora_configure=function(b){return"lora.attach("+b.getFieldValue("BAND")+")\n"};Blockly.Lua.lora_set_devaddr=function(b){return"lora.setDevAddr("+(Blockly.Lua.valueToCode(b,"DEVADDR",Blockly.Lua.ORDER_NONE)||"''")+")\n"};Blockly.Lua.lora_set_nwkskey=function(b){return"lora.setNwksKey("+(Blockly.Lua.valueToCode(b,"NWKSKEY",Blockly.Lua.ORDER_NONE)||"''")+")\n"};Blockly.Lua.lora_set_appskey=function(b){return"lora.setAppsKey("+(Blockly.Lua.valueToCode(b,"APPSKEY",Blockly.Lua.ORDER_NONE)||"''")+")\n"};Blockly.Lua.lora_set_deveui=function(b){return"lora.setDevEui("+(Blockly.Lua.valueToCode(b,"DEVEUI",Blockly.Lua.ORDER_NONE)||"''")+")\n"};Blockly.Lua.lora_set_appeui=function(b){return"lora.setAppEui("+(Blockly.Lua.valueToCode(b,"APPEUI",Blockly.Lua.ORDER_NONE)||"''")+")\n"};Blockly.Lua.lora_set_appkey=function(b){return"lora.setAppKey("+(Blockly.Lua.valueToCode(b,"APPKEY",Blockly.Lua.ORDER_NONE)||"''")+")\n"};Blockly.Lua.lora_set_adr=function(d){var c="true";"0"==d.getFieldValue("ON_OFF")&&(c="false");return"lora.setAdr("+c+")\n"};Blockly.Lua.lora_set_dr=function(b){return"lora.setDr("+b.getFieldValue("DR")+")\n"};Blockly.Lua.lora_set_retx=function(b){return"lora.setReTx("+b.getFieldValue("RETX")+")\n"};Blockly.Lua.when_i_receive_a_lora_frame=function(f){var e=Blockly.Lua.statementToCodeNoIndent(f,"DO"),h="",g="";-1==codeSection.require.indexOf('require("block")')&&codeSection.require.push('require("block")');h+=Blockly.Lua.indent(0,"-- we need to wait for the completion of the board start")+"\n";h+=Blockly.Lua.indent(0,"_eventBoardStarted:wait()")+"\n\n";h+=Blockly.Lua.indent(0,"lora.whenReceived(function(port, payload)")+"\n";h+=Blockly.Lua.blockStart(1,f);""!=e&&(h+=Blockly.Lua.tryBlock(1,f,e));h+=Blockly.Lua.blockEnd(1,f);h+=Blockly.Lua.indent(0,"end)")+"\n";g+=Blockly.Lua.indent(0,"-- when I receive a LoRa frame")+"\n";g+=Blockly.Lua.indent(0,"thread.start(function()")+"\n";g+=Blockly.Lua.tryBlock(1,f,h);return g+=Blockly.Lua.indent(0,"end)")+"\n"};Blockly.Lua.lora_join=function(e){var d="";-1==codeSection.require.indexOf('require("block")')&&codeSection.require.push('require("block")');var f;f=""+(Blockly.Lua.indent(0,"if (_lora == nil) then")+"\n");f+=Blockly.Lua.indent(1,"_lora = true")+"\n";f+=Blockly.Lua.indent(1,"lora.attach(lora.BAND"+e.band+")")+"\n";f+=Blockly.Lua.indent(1,'lora.setAppEui("'+e.appeui+'")')+"\n";f+=Blockly.Lua.indent(1,'lora.setAppKey("'+e.appkey+'")')+"\n";f+=Blockly.Lua.indent(1,"lora.setDr("+e.dr+")")+"\n";f+=Blockly.Lua.indent(1,"lora.setReTx("+e.retx+")")+"\n";f+=Blockly.Lua.indent(1,"\nif (os.flashEUI() == nil) then")+"\n";f+=Blockly.Lua.indent(2,'lora.setDevEui("'+e.deveui+'")')+"\n";f+=Blockly.Lua.indent(1,"end")+"\n\n";f+=Blockly.Lua.indent(0,"end")+"\n\n";f+=Blockly.Lua.blockStart(0,e);f+=Blockly.Lua.indent(0,"lora.join()")+"\n";f+=Blockly.Lua.blockEnd(0,e);d+=Blockly.Lua.indent(0,"-- lora join")+"\n";return d+=Blockly.Lua.tryBlock(0,e,f)+"\n"};Blockly.Lua.lora_tx=function(h){var g=Blockly.Lua.valueToCode(h,"PAYLOAD",Blockly.Lua.ORDER_NONE)||"''",l=Blockly.Lua.valueToCode(h,"PORT",Blockly.Lua.ORDER_NONE),k=h.getFieldValue("CONF"),j="",k="0"==k?"false":"true";-1==codeSection.require.indexOf('require("block")')&&codeSection.require.push('require("block")');var i;i=""+Blockly.Lua.blockStart(0,h);i+=Blockly.Lua.indent(0,"-- setup LoRa WAN stack, if needed")+"\n";i+=Blockly.Lua.indent(0,"if (_lora == nil) then")+"\n";i+=Blockly.Lua.indent(1,"_lora = true")+"\n";i+=Blockly.Lua.indent(1,"lora.attach(lora.BAND"+h.band+")")+"\n";"OTAA"==h.activation?(i+=Blockly.Lua.indent(1,"\nif (os.flashEUI() == nil) then")+"\n",i+=Blockly.Lua.indent(2,'lora.setDevEui("'+h.deveui+'")')+"\n",i+=Blockly.Lua.indent(1,"end")+"\n\n",i+=Blockly.Lua.indent(1,'lora.setAppEui("'+h.appeui+'")')+"\n",i+=Blockly.Lua.indent(1,'lora.setAppKey("'+h.appkey+'")')+"\n"):(i+=Blockly.Lua.indent(1,'lora.setDevAddr("'+h.devaddr+'")')+"\n",i+=Blockly.Lua.indent(1,'lora.setNwksKey("'+h.nwkskey+'")')+"\n",i+=Blockly.Lua.indent(1,'lora.setAppsKey("'+h.appskey+'")')+"\n");i+=Blockly.Lua.indent(1,"lora.setDr("+h.dr+")")+"\n";i+=Blockly.Lua.indent(1,"lora.setAdr("+h.adr+")")+"\n";i+=Blockly.Lua.indent(1,"lora.setReTx("+h.retx+")")+"\n";i+=Blockly.Lua.indent(0,"end")+"\n\n";i+=Blockly.Lua.indent(0,"-- transmit")+"\n";i+=Blockly.Lua.indent(0,"lora.tx("+k+", "+l+", "+g+")")+"\n";i+=Blockly.Lua.blockEnd(0,h);j+=Blockly.Lua.indent(0,"-- lora tx")+"\n";return j+=Blockly.Lua.tryBlock(0,h,i)+"\n"};"use strict";Blockly.Lua.math={};Blockly.Lua.math_number=function(b){b=parseFloat(b.getFieldValue("NUM"));return[b,0>b?Blockly.Lua.ORDER_UNARY:Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.math_arithmetic=function(f){var e={ADD:[" + ",Blockly.Lua.ORDER_ADDITIVE],MINUS:[" - ",Blockly.Lua.ORDER_ADDITIVE],MULTIPLY:[" * ",Blockly.Lua.ORDER_MULTIPLICATIVE],DIVIDE:[" / ",Blockly.Lua.ORDER_MULTIPLICATIVE],POWER:[" ^ ",Blockly.Lua.ORDER_EXPONENTIATION]}[f.getFieldValue("OP")],h=e[0],e=e[1],g=Blockly.Lua.valueToCode(f,"A",e)||"0";f=Blockly.Lua.valueToCode(f,"B",e)||"0";return[g+h+f,e]};Blockly.Lua.math_single=function(d){var c=d.getFieldValue("OP");if("NEG"==c){return d=Blockly.Lua.valueToCode(d,"NUM",Blockly.Lua.ORDER_UNARY)||"0",["-"+d,Blockly.Lua.ORDER_UNARY]}d="SIN"==c||"COS"==c||"TAN"==c?Blockly.Lua.valueToCode(d,"NUM",Blockly.Lua.ORDER_MULTIPLICATIVE)||"0":Blockly.Lua.valueToCode(d,"NUM",Blockly.Lua.ORDER_NONE)||"0";switch(c){case"ABS":c="math.abs("+d+")";break;case"ROOT":c="math.sqrt("+d+")";break;case"LN":c="math.log("+d+")";break;case"LOG10":c="math.log("+d+", 10)";break;case"EXP":c="math.exp("+d+")";break;case"POW10":c="10 ^ "+d;break;case"ROUND":c="math.floor("+d+" + .5)";break;case"ROUNDUP":c="math.ceil("+d+")";break;case"ROUNDDOWN":c="math.floor("+d+")";break;case"SIN":c="math.sin(math.rad("+d+"))";break;case"COS":c="math.cos(math.rad("+d+"))";break;case"TAN":c="math.tan(math.rad("+d+"))";break;case"ASIN":c="math.deg(math.asin("+d+"))";break;case"ACOS":c="math.deg(math.acos("+d+"))";break;case"ATAN":c="math.deg(math.atan("+d+"))";break;default:throw"Unknown math operator: "+c}return[c,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.math_constant=function(b){return{PI:["math.pi",Blockly.Lua.ORDER_HIGH],E:["math.exp(1)",Blockly.Lua.ORDER_HIGH],GOLDEN_RATIO:["(1 + math.sqrt(5)) / 2",Blockly.Lua.ORDER_MULTIPLICATIVE],SQRT2:["math.sqrt(2)",Blockly.Lua.ORDER_HIGH],SQRT1_2:["math.sqrt(1 / 2)",Blockly.Lua.ORDER_HIGH],INFINITY:["math.huge",Blockly.Lua.ORDER_HIGH]}[b.getFieldValue("CONSTANT")]};Blockly.Lua.math_number_property=function(f){var e=Blockly.Lua.valueToCode(f,"NUMBER_TO_CHECK",Blockly.Lua.ORDER_MULTIPLICATIVE)||"0",h=f.getFieldValue("PROPERTY"),g;if("PRIME"==h){return[Blockly.Lua.provideFunction_("math_isPrime",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(n)","  -- https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if n == 2 or n == 3 then","    return true","  end","  -- False if n is NaN, negative, is 1, or not whole.","  -- And false if n is divisible by 2 or 3.","  if not(n > 1) or n % 1 ~= 0 or n % 2 == 0 or n % 3 == 0 then","    return false","  end","  -- Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for x = 6, math.sqrt(n) + 1.5, 6 do","    if n % (x - 1) == 0 or n % (x + 1) == 0 then","      return false","    end","  end","  return true","end"])+"("+e+")",Blockly.Lua.ORDER_HIGH]}switch(h){case"EVEN":g=e+" % 2 == 0";break;case"ODD":g=e+" % 2 == 1";break;case"WHOLE":g=e+" % 1 == 0";break;case"POSITIVE":g=e+" > 0";break;case"NEGATIVE":g=e+" < 0";break;case"DIVISIBLE_BY":f=Blockly.Lua.valueToCode(f,"DIVISOR",Blockly.Lua.ORDER_MULTIPLICATIVE);if(!f||"0"==f){return["nil",Blockly.Lua.ORDER_ATOMIC]}g=e+" % "+f+" == 0"}return[g,Blockly.Lua.ORDER_RELATIONAL]};Blockly.Lua.math_change=function(d){var c=Blockly.Lua.valueToCode(d,"DELTA",Blockly.Lua.ORDER_ADDITIVE)||"0";d=Blockly.Lua.variableDB_.getName(d.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);return d+" = "+d+" + "+c+"\n"};Blockly.Lua.math_round=Blockly.Lua.math_single;Blockly.Lua.math_trig=Blockly.Lua.math_single;Blockly.Lua.math_on_list=function(e){function d(){return Blockly.Lua.provideFunction_("math_sum",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  local result = 0","  for _, v in ipairs(t) do","    result = result + v","  end","  return result","end"])}var f=e.getFieldValue("OP");e=Blockly.Lua.valueToCode(e,"LIST",Blockly.Lua.ORDER_NONE)||"{}";switch(f){case"SUM":f=d();break;case"MIN":f=Blockly.Lua.provideFunction_("math_min",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  local result = math.huge","  for _, v in ipairs(t) do","    if v < result then","      result = v","    end","  end","  return result","end"]);break;case"AVERAGE":f=Blockly.Lua.provideFunction_("math_average",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  return "+d()+"(t) / #t","end"]);break;case"MAX":f=Blockly.Lua.provideFunction_("math_max",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  local result = -math.huge","  for _, v in ipairs(t) do","    if v > result then","      result = v","    end","  end","  return result","end"]);break;case"MEDIAN":f=Blockly.Lua.provideFunction_("math_median",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  -- Source: http://lua-users.org/wiki/SimpleStats","  if #t == 0 then","    return 0","  end","  local temp={}","  for _, v in ipairs(t) do",'    if type(v) == "number" then',"      table.insert(temp, v)","    end","  end","  table.sort(temp)","  if #temp % 2 == 0 then","    return (temp[#temp/2] + temp[(#temp/2)+1]) / 2","  else","    return temp[math.ceil(#temp/2)]","  end","end"]);break;case"MODE":f=Blockly.Lua.provideFunction_("math_modes",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  -- Source: http://lua-users.org/wiki/SimpleStats","  local counts={}","  for _, v in ipairs(t) do","    if counts[v] == nil then","      counts[v] = 1","    else","      counts[v] = counts[v] + 1","    end","  end","  local biggestCount = 0","  for _, v  in pairs(counts) do","    if v > biggestCount then","      biggestCount = v","    end","  end","  local temp={}","  for k, v in pairs(counts) do","    if v == biggestCount then","      table.insert(temp, k)","    end","  end","  return temp","end"]);break;case"STD_DEV":f=Blockly.Lua.provideFunction_("math_standard_deviation",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  local m","  local vm","  local total = 0","  local count = 0","  local result","  m = #t == 0 and 0 or "+d()+"(t) / #t","  for _, v in ipairs(t) do","    if type(v) == 'number' then","      vm = v - m","      total = total + (vm * vm)","      count = count + 1","    end","  end","  result = math.sqrt(total / (count-1))","  return result","end"]);break;case"RANDOM":f=Blockly.Lua.provideFunction_("math_random_list",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return nil","  end","  return t[math.random(#t)]","end"]);break;default:throw"Unknown operator: "+f}return[f+"("+e+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.math_modulo=function(d){var c=Blockly.Lua.valueToCode(d,"DIVIDEND",Blockly.Lua.ORDER_MULTIPLICATIVE)||"0";d=Blockly.Lua.valueToCode(d,"DIVISOR",Blockly.Lua.ORDER_MULTIPLICATIVE)||"0";return[c+" % "+d,Blockly.Lua.ORDER_MULTIPLICATIVE]};Blockly.Lua.math_constrain=function(e){var d=Blockly.Lua.valueToCode(e,"VALUE",Blockly.Lua.ORDER_NONE)||"0",f=Blockly.Lua.valueToCode(e,"LOW",Blockly.Lua.ORDER_NONE)||"-math.huge";e=Blockly.Lua.valueToCode(e,"HIGH",Blockly.Lua.ORDER_NONE)||"math.huge";return["math.min(math.max("+d+", "+f+"), "+e+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.math_random_int=function(d){var c=Blockly.Lua.valueToCode(d,"FROM",Blockly.Lua.ORDER_NONE)||"0";d=Blockly.Lua.valueToCode(d,"TO",Blockly.Lua.ORDER_NONE)||"0";return["math.random("+c+", "+d+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.math_random_float=function(b){return["math.random()",Blockly.Lua.ORDER_HIGH]};"use strict";Blockly.Lua.colour={};Blockly.Lua.colour_picker=function(b){return["'"+b.getFieldValue("COLOUR")+"'",Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.colour_random=function(b){return['string.format("#%06x", math.random(0, 2^24 - 1))',Blockly.Lua.ORDER_HIGH]};Blockly.Lua.colour_rgb=function(f){var e=Blockly.Lua.provideFunction_("colour_rgb",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b)","  r = math.floor(math.min(100, math.max(0, r)) * 2.55 + .5)","  g = math.floor(math.min(100, math.max(0, g)) * 2.55 + .5)","  b = math.floor(math.min(100, math.max(0, b)) * 2.55 + .5)",'  return string.format("#%02x%02x%02x", r, g, b)',"end"]),h=Blockly.Lua.valueToCode(f,"RED",Blockly.Lua.ORDER_NONE)||0,g=Blockly.Lua.valueToCode(f,"GREEN",Blockly.Lua.ORDER_NONE)||0;f=Blockly.Lua.valueToCode(f,"BLUE",Blockly.Lua.ORDER_NONE)||0;return[e+"("+h+", "+g+", "+f+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.colour_blend=function(f){var e=Blockly.Lua.provideFunction_("colour_blend",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(colour1, colour2, ratio)","  local r1 = tonumber(string.sub(colour1, 2, 3), 16)","  local r2 = tonumber(string.sub(colour2, 2, 3), 16)","  local g1 = tonumber(string.sub(colour1, 4, 5), 16)","  local g2 = tonumber(string.sub(colour2, 4, 5), 16)","  local b1 = tonumber(string.sub(colour1, 6, 7), 16)","  local b2 = tonumber(string.sub(colour2, 6, 7), 16)","  local ratio = math.min(1, math.max(0, ratio))","  local r = math.floor(r1 * (1 - ratio) + r2 * ratio + .5)","  local g = math.floor(g1 * (1 - ratio) + g2 * ratio + .5)","  local b = math.floor(b1 * (1 - ratio) + b2 * ratio + .5)",'  return string.format("#%02x%02x%02x", r, g, b)',"end"]),h=Blockly.Lua.valueToCode(f,"COLOUR1",Blockly.Lua.ORDER_NONE)||"'#000000'",g=Blockly.Lua.valueToCode(f,"COLOUR2",Blockly.Lua.ORDER_NONE)||"'#000000'";f=Blockly.Lua.valueToCode(f,"RATIO",Blockly.Lua.ORDER_NONE)||0;return[e+"("+h+", "+g+", "+f+")",Blockly.Lua.ORDER_HIGH]};"use strict";Blockly.Lua.threads={};Blockly.Lua.thread_start=function(d){var c=Blockly.Lua.valueToCode(d,"THID",Blockly.Lua.ORDER_NONE);d=Blockly.Lua.statementToCode(d,"DO");""!=c&&(c+=" = ");return c+"thread.start(function()\r\n"+d+"end)\r\n"};Blockly.Lua.thread_create=function(d){var c=Blockly.Lua.valueToCode(d,"THID",Blockly.Lua.ORDER_NONE);d=Blockly.Lua.statementToCode(d,"DO");""!=c&&(c+=" = ");return c+"thread.create(function()\r\n"+d+"end)\r\n"};Blockly.Lua.thread_stop=function(b){b=b.getFieldValue("THID");"all"==b&&(b="");return"thread.stop("+b+")\r\n"};Blockly.Lua.thread_resume=function(b){b=b.getFieldValue("THID");"all"==b&&(b="");return"thread.resume("+b+")\r\n"};Blockly.Lua.thread_suspend=function(b){b=b.getFieldValue("THID");"all"==b&&(b="");return"thread.suspend("+b+")\r\n"};Blockly.Lua.thread_sleep=function(e){var d=e.getFieldValue("TIME"),f="";switch(e.getFieldValue("UNITS")){case"microseconds":f+="thread.sleepus("+d+")\r\n";break;case"milliseconds":f+="thread.sleepms("+d+")\r\n";break;case"seconds":f+="thread.sleep("+d+")\r\n"}return f};"use strict";Blockly.Lua.can={};Blockly.Lua.can.helper={safeName:function(b){b?(b=encodeURI(b.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(b[0])&&(b="my_"+b)):b="unnamed";return b},iscan:function(d,c){return("cansetspeed"==c.type||"cansetfilter"==c.type||"canread"==c.type||"canframewrite"==c.type)&&Blockly.Lua.can.helper.name(d)==Blockly.Lua.can.helper.name(c)},isframe:function(d,c){return"canframeset"==c.type&&Blockly.Lua.valueToCode(d,"FRAME",Blockly.Lua.ORDER_NONE)==Blockly.Lua.valueToCode(c,"FRAME",Blockly.Lua.ORDER_NONE)},hasAncestors:function(d){for(var c=d.previousConnection;c;){if(c=c.targetBlock()){if(Blockly.Lua.can.helper.iscan(d,c)){return !0}c=c.previousConnection}}return !1},hasFrameAncestors:function(d){for(var c=d.previousConnection;c;){if(c=c.targetBlock()){if(Blockly.Lua.can.helper.isframe(d,c)){return !0}c=c.previousConnection}}return !1},name:function(b){b=b.getFieldValue("MODULE");return Code.status.maps.canUnits[b]},instance:function(b){b.getFieldValue("MODULE");return"_can"+Blockly.Lua.can.helper.name(b)},attach:function(e,d){e.getFieldValue("MODULE");var f="";Blockly.Lua.can.helper.hasAncestors(e)||(f+=Blockly.Lua.indent(0,"-- attach can bus at "+d+" khz")+"\n",f+=Blockly.Lua.indent(0,"if ("+Blockly.Lua.can.helper.instance(e)+" == nil) then")+"\n",f+=Blockly.Lua.indent(1,Blockly.Lua.can.helper.instance(e)+" = true")+"\n",f+=Blockly.Lua.indent(1,"can.attach(can."+Blockly.Lua.can.helper.name(e)+", "+d+" * 1000)")+"\n",f+=Blockly.Lua.indent(0,"end")+"\n");return f},newFrame:function(e){e.getFieldValue("MODULE");var d=e.getFieldValue("FRAME"),f="";Blockly.Lua.can.helper.hasFrameAncestors(e)||(f+=Blockly.Lua.indent(0,"-- init frame "+d)+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+" = {}")+"\n\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".id = 0")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".type = can.STD")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".len = 8")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".d0 = 0")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".d1 = 0")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".d2 = 0")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".d3 = 0")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".d4 = 0")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".d5 = 0")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".d6 = 0")+"\n",f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(d)+".d7 = 0")+"\n");return f}};Blockly.Lua.cansetspeed=function(f){f.getFieldValue("MODULE");var e=Blockly.Lua.valueToCode(f,"SPEED",Blockly.Lua.ORDER_NONE),h="",g="";Blockly.Lua.require("block");h+=Blockly.Lua.can.helper.attach(f,e);""!=h&&(h+="\r\n");return g+=Blockly.Lua.tryBlock(0,f,h,"set speed for "+Blockly.Lua.can.helper.name(f)+" speed "+e+" Kbps")};Blockly.Lua.cansetfilter=function(g){g.getFieldValue("MODULE");var f=Blockly.Lua.valueToCode(g,"FROM",Blockly.Lua.ORDER_NONE),j=Blockly.Lua.valueToCode(g,"TO",Blockly.Lua.ORDER_NONE),i="",h="";Blockly.Lua.require("block");i+=Blockly.Lua.can.helper.attach(g,500);""!=i&&(i+="\r\n");i+=Blockly.Lua.indent(0,"can.addfilter(can."+Blockly.Lua.can.helper.name(g)+", "+f+", "+j+")")+"\n";return h+=Blockly.Lua.tryBlock(0,g,i,"add filter for "+Blockly.Lua.can.helper.name(g)+" from id "+f+" to id "+j)};Blockly.Lua.canread=function(g){g.getFieldValue("MODULE");var f=g.getFieldValue("FRAME"),j,i="",h="";Blockly.Lua.require("block");j=""+Blockly.Lua.can.helper.attach(g,500);""!=j&&(j+="\r\n");j+=Blockly.Lua.indent(0,"-- read from "+Blockly.Lua.can.helper.name(g))+"\n";j+=Blockly.Lua.indent(0,"id, type, len, data = can.receive(can."+Blockly.Lua.can.helper.name(g)+")")+"\n\n";j+=Blockly.Lua.indent(0,"-- unpack data")+"\n";j+=Blockly.Lua.indent(0,"d0, d1, d2, d3, d4, d5, d6, d7 = string.unpack(string.rep('B', len), data)")+"\n\n";j+=Blockly.Lua.indent(0,"-- build frame")+"\n";j+=Blockly.Lua.indent(0,"frame.id = id")+"\n";j+=Blockly.Lua.indent(0,"frame.type = type")+"\n";j+=Blockly.Lua.indent(0,"frame.len = len")+"\n";j+=Blockly.Lua.indent(0,"frame.d0 = d0")+"\n";j+=Blockly.Lua.indent(0,"frame.d1 = d1")+"\n";j+=Blockly.Lua.indent(0,"frame.d2 = d2")+"\n";j+=Blockly.Lua.indent(0,"frame.d3 = d3")+"\n";j+=Blockly.Lua.indent(0,"frame.d4 = d4")+"\n";j+=Blockly.Lua.indent(0,"frame.d5 = d5")+"\n";j+=Blockly.Lua.indent(0,"frame.d6 = d6")+"\n";j+=Blockly.Lua.indent(0,"frame.d7 = d7")+"\n";i+=Blockly.Lua.indent(0,"-- read from CAN bus into frame "+f)+"\n";i+=Blockly.Lua.indent(0,"function _read"+Blockly.Lua.can.helper.name(g)+"_"+f+"()")+"\n";i+=Blockly.Lua.indent(1,"local id, type, len")+"\n";i+=Blockly.Lua.indent(1,"local d0, d1, d2, d3, d4, d5, d6, d7 = 0")+"\n";i+=Blockly.Lua.indent(1,"local frame = {}")+"\n\n";i+=Blockly.Lua.indent(1,Blockly.Lua.tryBlock(0,g,j));i+=Blockly.Lua.indent(1,"return frame")+"\n";i+=Blockly.Lua.indent(0,"end")+"\n";codeSection.functions.push(i);return h+=f+" = "+Blockly.Lua.indent(0,"_read"+Blockly.Lua.can.helper.name(g)+"_"+f+"()")+"\n"};Blockly.Lua.canframeget=function(d){var c=d.getFieldValue("FIELD");return[d.getFieldValue("FRAME")+"."+c,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.canframeset=function(f){var e=f.getFieldValue("FIELD"),h=f.getFieldValue("FRAME"),g=Blockly.Lua.valueToCode(f,"VALUE",Blockly.Lua.ORDER_NONE);f=""+Blockly.Lua.can.helper.newFrame(f);""!=f&&(f+="\n");f+=Blockly.Lua.indent(0,"-- set "+e+" to frame")+"\n";return f+=Blockly.Lua.indent(0,Blockly.Lua.can.helper.safeName(h)+"."+e+" = "+g)+"\n"};Blockly.Lua.canframewrite=function(f){f.getFieldValue("MODULE");var e=f.getFieldValue("FRAME"),h="",g="";Blockly.Lua.require("block");h+=Blockly.Lua.can.helper.attach(f,500);""!=h&&(h+="\r\n");h+=Blockly.Lua.indent(0,"can.send(can."+Blockly.Lua.can.helper.name(f)+", "+Blockly.Lua.can.helper.safeName(e)+".id, "+Blockly.Lua.can.helper.safeName(e)+".type, "+Blockly.Lua.can.helper.safeName(e)+".len, string.pack(string.rep('B', "+Blockly.Lua.can.helper.safeName(e)+".len), "+Blockly.Lua.can.helper.safeName(e)+".d0, "+Blockly.Lua.can.helper.safeName(e)+".d1, "+Blockly.Lua.can.helper.safeName(e)+".d2, "+Blockly.Lua.can.helper.safeName(e)+".d3, "+Blockly.Lua.can.helper.safeName(e)+".d4, "+Blockly.Lua.can.helper.safeName(e)+".d5, "+Blockly.Lua.can.helper.safeName(e)+".d6, "+Blockly.Lua.can.helper.safeName(e)+".d7))")+"\n";return g+=Blockly.Lua.tryBlock(0,f,h,"write to "+Blockly.Lua.can.helper.name(f))};Blockly.Lua.cantype=function(b){return"std"==b.getFieldValue("TYPE")?["can.STD",Blockly.Lua.ORDER_HIGH]:["can.EXT",Blockly.Lua.ORDER_HIGH]};"use strict";Blockly.Lua.loops={};Blockly.Lua.CONTINUE_STATEMENT="goto continue\n";Blockly.Lua.addContinueLabel=function(b){return -1<b.indexOf(Blockly.Lua.CONTINUE_STATEMENT)?b+Blockly.Lua.INDENT+"::continue::\n":b};Blockly.Lua.controls_repeat=function(d){var c=parseInt(d.getFieldValue("TIMES"),10);d=Blockly.Lua.statementToCode(d,"DO")||"";d=Blockly.Lua.addContinueLabel(d);return"for "+Blockly.Lua.variableDB_.getDistinctName("count",Blockly.Variables.NAME_TYPE)+" = 1, "+c+" do\n"+d+"end\n"};Blockly.Lua.controls_repeat_ext=function(d){var c=Blockly.Lua.valueToCode(d,"TIMES",Blockly.Lua.ORDER_NONE)||"0",c=Blockly.isNumber(c)?parseInt(c,10):"math.floor("+c+")";d=Blockly.Lua.statementToCode(d,"DO")||"\n";d=Blockly.Lua.addContinueLabel(d);return"for "+Blockly.Lua.variableDB_.getDistinctName("count",Blockly.Variables.NAME_TYPE)+" = 1, "+c+" do\n"+d+"end\n"};Blockly.Lua.controls_whileUntil=function(f){var e="UNTIL"==f.getFieldValue("MODE"),h=Blockly.Lua.valueToCode(f,"BOOL",e?Blockly.Lua.ORDER_UNARY:Blockly.Lua.ORDER_NONE)||"false",g=Blockly.Lua.statementToCode(f,"DO")||"\n",g=Blockly.Lua.addLoopTrap(g,f.id),g=Blockly.Lua.addContinueLabel(g);e&&(h="not "+h);return"while "+h+" do\n"+g+"end\n"};Blockly.Lua.controls_for=function(i){var h=Blockly.Lua.variableDB_.getName(i.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),n=Blockly.Lua.valueToCode(i,"FROM",Blockly.Lua.ORDER_NONE)||"0",m=Blockly.Lua.valueToCode(i,"TO",Blockly.Lua.ORDER_NONE)||"0",l=Blockly.Lua.valueToCode(i,"BY",Blockly.Lua.ORDER_NONE)||"1",k=Blockly.Lua.statementToCode(i,"DO")||"\n",k=Blockly.Lua.addLoopTrap(k,i.id),k=Blockly.Lua.addContinueLabel(k);i="";var j;Blockly.isNumber(n)&&Blockly.isNumber(m)&&Blockly.isNumber(l)?(j=parseFloat(n)<=parseFloat(m),l=Math.abs(parseFloat(l)),j=(j?"":"-")+l):(i="",j=Blockly.Lua.variableDB_.getDistinctName(h+"_inc",Blockly.Variables.NAME_TYPE),i+=j+" = ",i=Blockly.isNumber(l)?i+(Math.abs(l)+"\n"):i+("math.abs("+l+")\n"),i=i+("if ("+n+") > ("+m+") then\n")+(Blockly.Lua.INDENT+j+" = -"+j+"\n"),i+="end\n");return i+("for "+h+" = "+n+", "+m+", "+j)+(" do\n"+k+"end\n")};Blockly.Lua.controls_forEach=function(e){var d=Blockly.Lua.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),f=Blockly.Lua.valueToCode(e,"LIST",Blockly.Lua.ORDER_NONE)||"{}";e=Blockly.Lua.statementToCode(e,"DO")||"\n";e=Blockly.Lua.addContinueLabel(e);return"for _, "+d+" in ipairs("+f+") do \n"+e+"end\n"};Blockly.Lua.controls_flow_statements=function(b){switch(b.getFieldValue("FLOW")){case"BREAK":return"break\n";case"CONTINUE":return Blockly.Lua.CONTINUE_STATEMENT}throw"Unknown flow statement."};"use strict";Blockly.Lua.bitlogic={};Blockly.Lua.bitlogic_msb=function(b){return["(("+("math.floor("+(Blockly.Lua.valueToCode(b,"BOOL",Blockly.Lua.ORDER_UNARY)||"true")+")")+" & 0xff00) >> 8)",Blockly.Lua.ORDER_UNARY]};Blockly.Lua.bitlogic_lsb=function(b){return["("+("math.floor("+(Blockly.Lua.valueToCode(b,"BOOL",Blockly.Lua.ORDER_UNARY)||"true")+")")+" & 0x00ff)",Blockly.Lua.ORDER_UNARY]};Blockly.Lua.bitwise_op=function(e){var d=Blockly.Lua.valueToCode(e,"OP1",Blockly.Lua.ORDER_NONE),f=Blockly.Lua.valueToCode(e,"OP2",Blockly.Lua.ORDER_NONE);e=e.getFieldValue("OP");"and"==e?(d="math.floor("+d+")",e="&",f="math.floor("+f+")"):"or"==e?(d="math.floor("+d+")",e="|",f="math.floor("+f+")"):"lshift"==e?(d="math.floor("+d+")",e="<<"):"rshift"==e?(d="math.floor("+d+")",e=">>"):"xor"==e&&(d="math.floor("+d+")",e="~",f="math.floor("+f+")");return["("+d+" "+e+" "+f+")",Blockly.Lua.ORDER_UNARY]};Blockly.Lua.bitwise_unary_op=function(d){var c=Blockly.Lua.valueToCode(d,"OP1",Blockly.Lua.ORDER_NONE);d=d.getFieldValue("OP");"not"==d&&(d="~");return["("+d+c+")",Blockly.Lua.ORDER_UNARY]};"use strict";Blockly.Lua.texts={};Blockly.Lua.text=function(b){return[Blockly.Lua.quote_(b.getFieldValue("TEXT")),Blockly.Lua.ORDER_ATOMIC]};Blockly.Lua.text_join=function(e){if(0==e.itemCount_){return["''",Blockly.Lua.ORDER_ATOMIC]}if(1==e.itemCount_){return["tostring("+(Blockly.Lua.valueToCode(e,"ADD0",Blockly.Lua.ORDER_NONE)||"''")+")",Blockly.Lua.ORDER_HIGH]}if(2==e.itemCount_){var d=Blockly.Lua.valueToCode(e,"ADD0",Blockly.Lua.ORDER_CONCATENATION)||"''";e=Blockly.Lua.valueToCode(e,"ADD1",Blockly.Lua.ORDER_CONCATENATION)||"''";return[d+" .. "+e,Blockly.Lua.ORDER_CONCATENATION]}for(var d=[],f=0;f<e.itemCount_;f++){d[f]=Blockly.Lua.valueToCode(e,"ADD"+f,Blockly.Lua.ORDER_NONE)||"''"}e="table.concat({"+d.join(", ")+"})";return[e,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_append=function(d){var c=Blockly.Lua.variableDB_.getName(d.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);d=Blockly.Lua.valueToCode(d,"TEXT",Blockly.Lua.ORDER_CONCATENATION)||"''";return c+" = "+c+" .. "+d+"\n"};Blockly.Lua.text_length=function(b){return["#"+(Blockly.Lua.valueToCode(b,"VALUE",Blockly.Lua.ORDER_UNARY)||"''"),Blockly.Lua.ORDER_UNARY]};Blockly.Lua.text_isEmpty=function(b){return["#"+(Blockly.Lua.valueToCode(b,"VALUE",Blockly.Lua.ORDER_UNARY)||"''")+" == 0",Blockly.Lua.ORDER_RELATIONAL]};Blockly.Lua.text_indexOf=function(e){var d=Blockly.Lua.valueToCode(e,"FIND",Blockly.Lua.ORDER_NONE)||"''",f=Blockly.Lua.valueToCode(e,"VALUE",Blockly.Lua.ORDER_NONE)||"''";return[("FIRST"==e.getFieldValue("END")?Blockly.Lua.provideFunction_("firstIndexOf",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, substr) ","  local i = string.find(str, substr, 1, true)","  if i == nil then","    return 0","  else","    return i","  end","end"]):Blockly.Lua.provideFunction_("lastIndexOf",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, substr)","  local i = string.find(string.reverse(str), string.reverse(substr), 1, true)","  if i then","    return #str + 2 - i - #substr","  end","  return 0","end"]))+"("+f+", "+d+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_charAt=function(e){var d=e.getFieldValue("WHERE")||"FROM_START",f=Blockly.Lua.valueToCode(e,"AT","FROM_END"==d?Blockly.Lua.ORDER_UNARY:Blockly.Lua.ORDER_NONE)||"1";e=Blockly.Lua.valueToCode(e,"VALUE",Blockly.Lua.ORDER_NONE)||"''";if("RANDOM"==d){d=Blockly.Lua.provideFunction_("text_random_letter",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str)","  local index = math.random(string.len(str))","  return string.sub(str, index, index)","end"]),e=d+"("+e+")"}else{if("FIRST"==d){f="1"}else{if("LAST"==d){f="-1"}else{if("FROM_START"!=d){if("FROM_END"==d){f="-"+f}else{throw"Unhandled option (text_charAt)."}}}}f.match(/^-?\w*$/)?e="string.sub("+e+", "+f+", "+f+")":(d=Blockly.Lua.provideFunction_("text_char_at",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, index)","  return string.sub(str, index, index)","end"]),e=d+"("+e+", "+f+")")}return[e,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_getSubstring=function(f){var e=Blockly.Lua.valueToCode(f,"STRING",Blockly.Lua.ORDER_NONE)||"''",h=f.getFieldValue("WHERE1"),g=Blockly.Lua.valueToCode(f,"AT1","FROM_END"==h?Blockly.Lua.ORDER_UNARY:Blockly.Lua.ORDER_NONE)||"1";if("FIRST"==h){h=1}else{if("FROM_START"==h){h=g}else{if("FROM_END"==h){h="-"+g}else{throw"Unhandled option (text_getSubstring)"}}}g=f.getFieldValue("WHERE2");f=Blockly.Lua.valueToCode(f,"AT2","FROM_END"==g?Blockly.Lua.ORDER_UNARY:Blockly.Lua.ORDER_NONE)||"1";if("LAST"==g){f=-1}else{if("FROM_START"!=g){if("FROM_END"==g){f="-"+f}else{throw"Unhandled option (text_getSubstring)"}}}return["string.sub("+e+", "+h+", "+f+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_changeCase=function(e){var d=e.getFieldValue("CASE");e=Blockly.Lua.valueToCode(e,"TEXT",Blockly.Lua.ORDER_NONE)||"''";if("UPPERCASE"==d){var f="string.upper"}else{"LOWERCASE"==d?f="string.lower":"TITLECASE"==d&&(f=Blockly.Lua.provideFunction_("text_titlecase",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str)","  local buf = {}","  local inWord = false","  for i = 1, #str do","    local c = string.sub(str, i, i)","    if inWord then","      table.insert(buf, string.lower(c))",'      if string.find(c, "%s") then',"        inWord = false","      end","    else","      table.insert(buf, string.upper(c))","      inWord = true","    end","  end","  return table.concat(buf)","end"]))}return[f+"("+e+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_trim=function(d){var c={LEFT:"^%s*(,-)",RIGHT:"(.-)%s*$",BOTH:"^%s*(.-)%s*$"}[d.getFieldValue("MODE")];return["string.gsub("+(Blockly.Lua.valueToCode(d,"TEXT",Blockly.Lua.ORDER_NONE)||"''")+', "'+c+'", "%1")',Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_print=function(b){return"print("+(Blockly.Lua.valueToCode(b,"TEXT",Blockly.Lua.ORDER_NONE)||"''")+")\n"};Blockly.Lua.text_prompt_ext=function(d){var c=d.getField("TEXT")?Blockly.Lua.quote_(d.getFieldValue("TEXT")):Blockly.Lua.valueToCode(d,"TEXT",Blockly.Lua.ORDER_NONE)||"''",c=Blockly.Lua.provideFunction_("text_prompt",["function "+Blockly.Lua.FUNCTION_NAME_PLACEHOLDER_+"(msg)","  io.write(msg)","  io.flush()","  return io.read()","end"])+"("+c+")";"NUMBER"==d.getFieldValue("TYPE")&&(c="tonumber("+c+", 10)");return[c,Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_prompt=Blockly.Lua.text_prompt_ext;"use strict";Blockly.Lua.textadds={};Blockly.Lua.text_pack=function(e){Blockly.Lua.valueToCode(e,"TO0",Blockly.Lua.ORDER_NONE);for(var d=[],f=0;f<e.withCount_;f++){d[f]=Blockly.Lua.valueToCode(e,"WITH"+f,Blockly.Lua.ORDER_NONE)||"''"}return["pack.pack("+d.join(", ")+")",Blockly.Lua.ORDER_HIGH]};Blockly.Lua.text_unpack=function(f){for(var e=Blockly.Lua.valueToCode(f,"FROM0",Blockly.Lua.ORDER_NONE),h="",g=0;g<f.toCount_;g++){h+=Blockly.Lua.valueToCode(f,"TO"+g,Blockly.Lua.ORDER_NONE)+", "+e+" = pack.unpack("+e+", true)\n"}return h};function board(){var a=this;a.list=[{id:"N1ESP32",desc:"Whitecat N1 ESP32"}];jQuery.ajax({url:"https://raw.githubusercontent.com/whitecatboard/Lua-RTOS-ESP32/master/boards/boards.json",success:function(b){var c=JSON.parse(b);a.list=[];c.forEach(function(e,d){var f="";if(e.brand!=""){f=e.brand+"-"}f=f+e.type;if(e.subtype!=""){f=f+"-"+e.subtype}a.list.push({id:f,desc:e.description});Status.messages[e.description]={tag:"boardAttached",type:statusType.Info,zone:"statusBar1"}})},error:function(){}})}board.prototype.getDesc=function(b){var a="";this.list.forEach(function(d,c){if(d.id==b){a=d.desc;return}});return a};board.prototype.get=function(a,h){if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){var f=require("fs");var i=require("path");var c="boards/defs/"+a+".json";var d=i.join(process.cwd(),c);try{var e=f.readFileSync(d,"utf8")}catch(g){return}try{var b=JSON.parse(e);h(b)}catch(g){h(JSON.parse("{}"))}}else{jQuery.ajax({url:Code.folder+"/boards/defs/"+a+".json",success:function(j){h(j);return},error:function(){h(JSON.parse("{}"))}})}}else{jQuery.ajax({url:Code.folder+"/boards/defs/"+a+".json",success:function(j){h(j);return},error:function(){h(JSON.parse("{}"))}})}};board.prototype.getMaps=function(c,b){var a=this;a.get(c,function(d){var e=[];if(d.hasOwnProperty("digitalPins")){e.digitalPins=d.digitalPins}if(d.hasOwnProperty("analogPins")){e.analogPins=d.analogPins}if(d.hasOwnProperty("analogPinsChannel")){e.analogPinsChannel=d.analogPinsChannel}if(d.hasOwnProperty("pwmPins")){e.pwmPins=d.pwmPins}if(d.hasOwnProperty("pwmPinsChannel")){e.pwmPinsChannel=d.pwmPinsChannel}if(d.hasOwnProperty("i2cUnits")){e.i2cUnits=d.i2cUnits}if(d.hasOwnProperty("canUnits")){e.canUnits=d.canUnits}if(d.hasOwnProperty("spiUnits")){e.spiUnits=d.spiUnits}if(d.hasOwnProperty("uartUnits")){e.uartUnits=d.uartUnits}if(d.hasOwnProperty("externalAdcUnits")){e.externalAdcUnits=d.externalAdcUnits}b(e)})};function agent(){var b=this;b.boardEvents=["boardUpgraded","boardAttached","boardDetached","boardPowerOnReset","blockStart","blockEnd","blockError","blockErrorCatched","boardUpdate","boardConsoleOut","boardRuntimeError"];b.boardCommands=["attachIde","detachIde","boardUpgrade","boardInfo","boardReset","boardStop","boardGetDirContent","boardReadFile","boardWriteFile","boardRunProgram","boardRunCommand","boardRemoveFile"];b.version="";for(var a=0;a<b.boardEvents.length;a++){b[b.boardEvents[a]+"Listeners"]=[]}for(var a=0;a<b.boardCommands.length;a++){b[b.boardCommands[a]+"Listeners"]=[]}b.controlSocket=undefined;b.controlSocketConnected=false;b.consoleUpSocket=undefined;b.consoleUpSocketConnected=false;b.consoleDownSocket=undefined;b.consoleDownSocketConnected=false}agent.prototype.controlSocketConnect=function(){var b=this;var a;if(window.MozWebSocket){window.WebSocket=window.MozWebSocket}else{if(!window.WebSocket){return}}a=new WebSocket("ws://localhost:8080");a.addEventListener("open",function(c){b.controlSocketConnected=true;b.controlSocket=a;Code.board.get(Code.settings.board,function(d){Code.agent.send({command:"attachIde",arguments:{devices:Code.devices}},function(f,e){})})});a.addEventListener("message",function(d){var e=d.data;e=e.replace('"info": , "','"');var c=JSON.parse(e);b.callListeners(c.notify,c.info)});a.addEventListener("close",function(c){b.controlSocket=undefined;if(b.controlSocketConnected){b.callListeners("boardDetached","")}b.controlSocketConnected=false;setTimeout(function(){b.controlSocketConnect()},1000)});a.addEventListener("error",function(c){Status.show("Can't connect to agent")})};agent.prototype.consoleUpSocketConnect=function(){var b=this;var a;if(window.MozWebSocket){window.WebSocket=window.MozWebSocket}else{if(!window.WebSocket){return}}a=new WebSocket("ws://localhost:8080/up");a.addEventListener("open",function(c){b.consoleUpSocketConnected=true;b.consoleUpSocket=a});a.addEventListener("message",function(c){Term.write(c.data)});a.addEventListener("close",function(c){b.consoleUpSocket=undefined;b.consoleUpSocketConnected=false;setTimeout(function(){b.consoleUpSocketConnect()},1000)});a.addEventListener("error",function(c){})};agent.prototype.consoleDownSocketConnect=function(){var b=this;var a;if(window.MozWebSocket){window.WebSocket=window.MozWebSocket}else{if(!window.WebSocket){return}}a=new WebSocket("ws://localhost:8080/down");a.addEventListener("open",function(c){b.consoleDownSocketConnected=true;b.consoleDownSocket=a});a.addEventListener("message",function(c){});a.addEventListener("close",function(c){b.consoleDownSocket=undefined;b.consoleDownSocketConnected=false;setTimeout(function(){b.consoleDownSocketConnect()},1000)});a.addEventListener("error",function(c){})};agent.prototype.callListeners=function(e,d){var c=this;var b=[];if(c.hasOwnProperty(e+"Listeners")){for(var a=0;a<c[e+"Listeners"].length;a++){b.push(a);c[e+"Listeners"][a](e,d)}for(var a=0;a<b.length;a++){if(c.boardEvents.indexOf(e)==-1){c[e+"Listeners"].splice(a,1)}}}};agent.prototype.addListener=function(c,b){var a=this;if(!a.hasOwnProperty(c+"Listeners")){throw"missingListener:"+c}a[c+"Listeners"].push(b);return a[c+"Listeners"].length};agent.prototype.send=function(b,c){var a=this;if(a.controlSocket){a.addListener(b.command,c);a.controlSocket.send(JSON.stringify(b))}else{c({})}};(function(a,d,c){var g={"function":true,object:true},f=g[typeof exports]&&exports&&!exports.nodeType&&exports,b=g[typeof module]&&module&&!module.nodeType&&module,e=f&&b&&typeof global=="object"&&global,h=b&&b.exports===f&&f;if(e&&(e.global===e||e.window===e||e.self===e)){a=e}if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define(["exports"],c);if(f&&h){c(b.exports)}}else{if(f&&b){if(h){c(b.exports)}else{c(f)}}else{c((a[d]={}))}}}(this,"luaparse",function(P){P.version="0.2.1";var aZ,ab,j;var ax=P.defaultOptions={wait:false,comments:true,scope:false,locations:false,ranges:false,onCreateNode:null,onCreateScope:null,onDestroyScope:null};var ak=1,aY=2,o=4,ag=8,aN=16,p=32,K=64,ai=128,x=256;P.tokenTypes={EOF:ak,StringLiteral:aY,Keyword:o,Identifier:ag,NumericLiteral:aN,Punctuator:p,BooleanLiteral:K,NilLiteral:ai,VarargLiteral:x};var ao=P.errors={unexpected:"unexpected %1 '%2' near '%3'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'",invalidVar:"invalid left-hand side of assignment near '%1'"};var au=P.ast={labelStatement:function(a2){return{type:"LabelStatement",label:a2}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(a2){return{type:"GotoStatement",label:a2}},returnStatement:function(a2){return{type:"ReturnStatement","arguments":a2}},ifStatement:function(a2){return{type:"IfStatement",clauses:a2}},ifClause:function(a3,a2){return{type:"IfClause",condition:a3,body:a2}},elseifClause:function(a3,a2){return{type:"ElseifClause",condition:a3,body:a2}},elseClause:function(a2){return{type:"ElseClause",body:a2}},whileStatement:function(a3,a2){return{type:"WhileStatement",condition:a3,body:a2}},doStatement:function(a2){return{type:"DoStatement",body:a2}},repeatStatement:function(a3,a2){return{type:"RepeatStatement",condition:a3,body:a2}},localStatement:function(a3,a2){return{type:"LocalStatement",variables:a3,init:a2}},assignmentStatement:function(a3,a2){return{type:"AssignmentStatement",variables:a3,init:a2}},callStatement:function(a2){return{type:"CallStatement",expression:a2}},functionStatement:function(a3,a5,a4,a2){return{type:"FunctionDeclaration",identifier:a3,isLocal:a4,parameters:a5,body:a2}},forNumericStatement:function(a4,a6,a3,a5,a2){return{type:"ForNumericStatement",variable:a4,start:a6,end:a3,step:a5,body:a2}},forGenericStatement:function(a4,a3,a2){return{type:"ForGenericStatement",variables:a4,iterators:a3,body:a2}},chunk:function(a2){return{type:"Chunk",body:a2}},identifier:function(a2){return{type:"Identifier",name:a2}},literal:function(a3,a4,a2){a3=(a3===aY)?"StringLiteral":(a3===aN)?"NumericLiteral":(a3===K)?"BooleanLiteral":(a3===ai)?"NilLiteral":"VarargLiteral";return{type:a3,value:a4,raw:a2}},tableKey:function(a2,a3){return{type:"TableKey",key:a2,value:a3}},tableKeyString:function(a2,a3){return{type:"TableKeyString",key:a2,value:a3}},tableValue:function(a2){return{type:"TableValue",value:a2}},tableConstructorExpression:function(a2){return{type:"TableConstructorExpression",fields:a2}},binaryExpression:function(a2,a5,a3){var a4=("and"===a2||"or"===a2)?"LogicalExpression":"BinaryExpression";return{type:a4,operator:a2,left:a5,right:a3}},unaryExpression:function(a2,a3){return{type:"UnaryExpression",operator:a2,argument:a3}},memberExpression:function(a4,a3,a2){return{type:"MemberExpression",indexer:a3,identifier:a2,base:a4}},indexExpression:function(a3,a2){return{type:"IndexExpression",base:a3,index:a2}},callExpression:function(a3,a2){return{type:"CallExpression",base:a3,"arguments":a2}},tableCallExpression:function(a3,a2){return{type:"TableCallExpression",base:a3,"arguments":a2}},stringCallExpression:function(a3,a2){return{type:"StringCallExpression",base:a3,argument:a2}},comment:function(a3,a2){return{type:"Comment",value:a3,raw:a2}}};function aM(a3){if(H){var a2=aI.pop();a2.complete();if(ab.locations){a3.loc=a2.loc}if(ab.ranges){a3.range=a2.range}}if(ab.onCreateNode){ab.onCreateNode(a3)}return a3}var u=Array.prototype.slice,at=Object.prototype.toString,l=function l(a5,a3){for(var a2=0,a4=a5.length;a2<a4;a2++){if(a5[a2]===a3){return a2}}return -1};function J(a6,a5,a3){for(var a2=0,a4=a6.length;a2<a4;a2++){if(a6[a2][a5]===a3){return a2}}return -1}function G(a3){var a2=u.call(arguments,1);a3=a3.replace(/%(\d)/g,function(a5,a4){return""+a2[a4-1]||""});return a3}function ae(){var a3=u.call(arguments),a2={},a6,a7;for(var a4=0,a5=a3.length;a4<a5;a4++){a6=a3[a4];for(a7 in a6){if(a6.hasOwnProperty(a7)){a2[a7]=a6[a7]}}}return a2}function W(a4){var a5=G.apply(null,u.call(arguments,1)),a3,a2;if("undefined"!==typeof a4.line){a2=a4.range[0]-a4.lineStart;a3=new SyntaxError(G("[%1:%2] %3",a4.line,a2,a5));a3.line=a4.line;a3.index=a4.range[0];a3.column=a2}else{a2=aT-aX+1;a3=new SyntaxError(G("[%1:%2] %3",n,a2,a5));a3.index=aT;a3.line=n;a3.column=a2}throw a3}function a1(a3,a2){W(a2,ao.expectedToken,a3,a2.value)}function an(a4,a3){if("undefined"===typeof a3){a3=B.value}if("undefined"!==typeof a4.type){var a2;switch(a4.type){case aY:a2="string";break;case o:a2="keyword";break;case ag:a2="identifier";break;case aN:a2="number";break;case p:a2="symbol";break;case K:a2="boolean";break;case ai:return W(a4,ao.unexpected,"symbol","nil",a3)}return W(a4,ao.unexpected,a2,a4.value,a3)}return W(a4,ao.unexpected,"symbol",a4,a3)}var aT,az,aA,B,aj,ah,n,aX;P.lex=aa;function aa(){aB();while(45===aZ.charCodeAt(aT)&&45===aZ.charCodeAt(aT+1)){ac();aB()}if(aT>=j){return{type:ak,value:"<eof>",line:n,lineStart:aX,range:[aT,aT]}}var a2=aZ.charCodeAt(aT),a3=aZ.charCodeAt(aT+1);ah=aT;if(t(a2)){return aR()}switch(a2){case 39:case 34:return Z();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return i();case 46:if(ar(a3)){return i()}if(46===a3){if(46===aZ.charCodeAt(aT+2)){return aP()}return D("..")}return D(".");case 61:if(61===a3){return D("==")}return D("=");case 62:if(61===a3){return D(">=")}if(62===a3){return D(">>")}return D(">");case 60:if(60===a3){return D("<<")}if(61===a3){return D("<=")}return D("<");case 126:if(61===a3){return D("~=")}return D("~");case 58:if(58===a3){return D("::")}return D(":");case 91:if(91===a3||61===a3){return T()}return D("[");case 47:if(47===a3){return D("//")}return D("/");case 42:case 94:case 37:case 44:case 123:case 124:case 125:case 93:case 40:case 41:case 59:case 38:case 35:case 45:case 43:return D(aZ.charAt(aT))}return an(aZ.charAt(aT))}function q(){var a2=aZ.charCodeAt(aT),a3=aZ.charCodeAt(aT+1);if(aU(a2)){if(10===a2&&13===a3){aT++}if(13===a2&&10===a3){aT++}n++;aX=++aT;return true}return false}function aB(){while(aT<j){var a2=aZ.charCodeAt(aT);if(aV(a2)){aT++}else{if(!q()){break}}}}function aR(){var a3,a2;while(aW(aZ.charCodeAt(++aT))){}a3=aZ.slice(ah,aT);if(d(a3)){a2=o}else{if("true"===a3||"false"===a3){a2=K;a3=("true"===a3)}else{if("nil"===a3){a2=ai;a3=null}else{a2=ag}}}return{type:a2,value:a3,line:n,lineStart:aX,range:[ah,aT]}}function D(a2){aT+=a2.length;return{type:p,value:a2,line:n,lineStart:aX,range:[ah,aT]}}function aP(){aT+=3;return{type:x,value:"...",line:n,lineStart:aX,range:[ah,aT]}}function Z(){var a3=aZ.charCodeAt(aT++),a5=aT,a4="",a2;while(aT<j){a2=aZ.charCodeAt(aT++);if(a3===a2){break}if(92===a2){a4+=aZ.slice(a5,aT-1)+C();a5=aT}else{if(aT>=j||aU(a2)){a4+=aZ.slice(a5,aT-1);W({},ao.unfinishedString,a4+String.fromCharCode(a2))}}}a4+=aZ.slice(a5,aT-1);return{type:aY,value:a4,line:n,lineStart:aX,range:[ah,aT]}}function T(){var a2=aG();if(false===a2){W(az,ao.expected,"[",az.value)}return{type:aY,value:a2,line:n,lineStart:aX,range:[ah,aT]}}function i(){var a4=aZ.charAt(aT),a2=aZ.charAt(aT+1);var a3=("0"===a4&&"xX".indexOf(a2||null)>=0)?I():R();return{type:aN,value:a3,line:n,lineStart:aX,range:[ah,aT]}}function I(){var a4=0,a3=1,a6=1,a8,a2,a7,a5;a5=aT+=2;if(!aD(aZ.charCodeAt(aT))){W({},ao.malformedNumber,aZ.slice(ah,aT))}while(aD(aZ.charCodeAt(aT))){aT++}a8=parseInt(aZ.slice(a5,aT),16);if("."===aZ.charAt(aT)){a2=++aT;while(aD(aZ.charCodeAt(aT))){aT++}a4=aZ.slice(a2,aT);a4=(a2===aT)?0:parseInt(a4,16)/Math.pow(16,aT-a2)}if("pP".indexOf(aZ.charAt(aT)||null)>=0){aT++;if("+-".indexOf(aZ.charAt(aT)||null)>=0){a6=("+"===aZ.charAt(aT++))?1:-1}a7=aT;if(!ar(aZ.charCodeAt(aT))){W({},ao.malformedNumber,aZ.slice(ah,aT))}while(ar(aZ.charCodeAt(aT))){aT++}a3=aZ.slice(a7,aT);a3=Math.pow(2,a3*a6)}return(a8+a4)*a3}function R(){while(ar(aZ.charCodeAt(aT))){aT++}if("."===aZ.charAt(aT)){aT++;while(ar(aZ.charCodeAt(aT))){aT++}}if("eE".indexOf(aZ.charAt(aT)||null)>=0){aT++;if("+-".indexOf(aZ.charAt(aT)||null)>=0){aT++}if(!ar(aZ.charCodeAt(aT))){W({},ao.malformedNumber,aZ.slice(ah,aT))}while(ar(aZ.charCodeAt(aT))){aT++}}return parseFloat(aZ.slice(ah,aT))}function C(){var a2=aT;switch(aZ.charAt(aT)){case"n":aT++;return"\n";case"r":aT++;return"\r";case"t":aT++;return"\t";case"v":aT++;return"\x0B";case"b":aT++;return"\b";case"f":aT++;return"\f";case"z":aT++;aB();return"";case"x":if(aD(aZ.charCodeAt(aT+1))&&aD(aZ.charCodeAt(aT+2))){aT+=3;return"\\"+aZ.slice(a2,aT)}return"\\"+aZ.charAt(aT++);default:if(ar(aZ.charCodeAt(aT))){while(ar(aZ.charCodeAt(++aT))){}return"\\"+aZ.slice(a2,aT)}return aZ.charAt(aT++)}}function ac(){ah=aT;aT+=2;var a5=aZ.charAt(aT),a4="",a7=false,a8=aT,a2=aX,a6=n;if("["===a5){a4=aG();if(false===a4){a4=a5}else{a7=true}}if(!a7){while(aT<j){if(aU(aZ.charCodeAt(aT))){break}aT++}if(ab.comments){a4=aZ.slice(a8,aT)}}if(ab.comments){var a3=au.comment(a4,aZ.slice(ah,aT));if(ab.locations){a3.loc={start:{line:a6,column:ah-a2},end:{line:n,column:aT-aX}}}if(ab.ranges){a3.range=[ah,aT]}if(ab.onCreateNode){ab.onCreateNode(a3)}aj.push(a3)}}function aG(){var a7=0,a5="",a2=false,a6,a3;aT++;while("="===aZ.charAt(aT+a7)){a7++}if("["!==aZ.charAt(aT+a7)){return false}aT+=a7+1;if(aU(aZ.charCodeAt(aT))){q()}a3=aT;while(aT<j){if(aU(aZ.charCodeAt(aT))){q()}a6=aZ.charAt(aT++);if("]"===a6){a2=true;for(var a4=0;a4<a7;a4++){if("="!==aZ.charAt(aT+a4)){a2=false}}if("]"!==aZ.charAt(aT+a7)){a2=false}}if(a2){break}}a5+=aZ.slice(a3,aT-1);aT+=a7+1;return a5}function af(){aA=az;az=B;B=aa()}function c(a2){if(a2===az.value){af();return true}return false}function r(a2){if(a2===az.value){af()}else{W(az,ao.expected,a2,az.value)}}function aV(a2){return 9===a2||32===a2||11===a2||12===a2}function aU(a2){return 10===a2||13===a2}function ar(a2){return a2>=48&&a2<=57}function aD(a2){return(a2>=48&&a2<=57)||(a2>=97&&a2<=102)||(a2>=65&&a2<=70)}function t(a2){return(a2>=65&&a2<=90)||(a2>=97&&a2<=122)||95===a2}function aW(a2){return(a2>=65&&a2<=90)||(a2>=97&&a2<=122)||95===a2||(a2>=48&&a2<=57)}function d(a2){switch(a2.length){case 2:return"do"===a2||"if"===a2||"in"===a2||"or"===a2;case 3:return"and"===a2||"end"===a2||"for"===a2||"not"===a2;case 4:return"else"===a2||"goto"===a2||"then"===a2;case 5:return"break"===a2||"local"===a2||"until"===a2||"while"===a2;case 6:return"elseif"===a2||"repeat"===a2||"return"===a2;case 8:return"function"===a2}return false}function aS(a2){if(p===a2.type){return"#-~".indexOf(a2.value)>=0}if(o===a2.type){return"not"===a2.value}return false}function aQ(a2){switch(a2.type){case"CallExpression":case"TableCallExpression":case"StringCallExpression":return true}return false}function h(a2){if(ak===a2.type){return true}if(o!==a2.type){return false}switch(a2.value){case"else":case"elseif":case"end":case"until":return true;default:return false}}var aq,aF,aL;function aJ(){var a2=Array.apply(null,aq[aF++]);aq.push(a2);if(ab.onCreateScope){ab.onCreateScope()}}function a0(){var a2=aq.pop();aF--;if(ab.onDestroyScope){ab.onDestroyScope()}}function X(a2){if(-1!==l(aq[aF],a2)){return}aq[aF].push(a2)}function Q(a2){X(a2.name);ad(a2,true)}function ad(a3,a2){if(!a2&&-1===J(aL,"name",a3.name)){aL.push(a3)}a3.isLocal=a2}function F(a2){return(-1!==l(aq[aF],a2))}var aI=[],H;function aw(){return new E(az)}function E(a2){if(ab.locations){this.loc={start:{line:a2.line,column:a2.range[0]-a2.lineStart},end:{line:0,column:0}}}if(ab.ranges){this.range=[a2.range[0],0]}}E.prototype.complete=function(){if(ab.locations){this.loc.end.line=aA.line;this.loc.end.column=aA.range[1]-aA.lineStart}if(ab.ranges){this.range[1]=aA.range[1]}};function aH(){if(H){aI.push(aw())}}function V(a2){if(H){aI.push(a2)}}function m(){af();aH();if(ab.scope){aJ()}var a2=M();if(ab.scope){a0()}if(ak!==az.type){an(az)}if(H&&!a2.length){aA=az}return aM(au.chunk(a2))}function M(a2){var a4=[],a3;while(!h(az)){if("return"===az.value){a4.push(L());break}a3=L();if(a3){a4.push(a3)}}return a4}function L(){aH();if(o===az.type){switch(az.value){case"local":af();return f();case"if":af();return s();case"return":af();return av();case"function":af();var a2=y();return Y(a2);case"while":af();return z();case"for":af();return aK();case"repeat":af();return ay();case"break":af();return b();case"do":af();return g();case"goto":af();return A()}}if(p===az.type){if(c("::")){return al()}}if(H){aI.pop()}if(c(";")){return}return U()}function al(){var a3=az.value,a2=v();if(ab.scope){X("::"+a3+"::");ad(a2,true)}r("::");return aM(au.labelStatement(a2))}function b(){return aM(au.breakStatement())}function A(){var a3=az.value,a2=v();return aM(au.gotoStatement(a2))}function g(){if(ab.scope){aJ()}var a2=M();if(ab.scope){a0()}r("end");return aM(au.doStatement(a2))}function z(){var a3=ap();r("do");if(ab.scope){aJ()}var a2=M();if(ab.scope){a0()}r("end");return aM(au.whileStatement(a3,a2))}function ay(){if(ab.scope){aJ()}var a2=M();r("until");var a3=ap();if(ab.scope){a0()}return aM(au.repeatStatement(a3,a2))}function av(){var a2=[];if("end"!==az.value){var a3=O();if(null!=a3){a2.push(a3)}while(c(",")){a3=ap();a2.push(a3)}c(";")}return aM(au.returnStatement(a2))}function s(){var a4=[],a5,a2,a3;if(H){a3=aI[aI.length-1];aI.push(a3)}a5=ap();r("then");if(ab.scope){aJ()}a2=M();if(ab.scope){a0()}a4.push(aM(au.ifClause(a5,a2)));if(H){a3=aw()}while(c("elseif")){V(a3);a5=ap();r("then");if(ab.scope){aJ()}a2=M();if(ab.scope){a0()}a4.push(aM(au.elseifClause(a5,a2)));if(H){a3=aw()}}if(c("else")){if(H){a3=new E(aA);aI.push(a3)}if(ab.scope){aJ()}a2=M();if(ab.scope){a0()}a4.push(aM(au.elseClause(a2)))}r("end");return aM(au.ifStatement(a4))}function aK(){var a4=v(),a2;if(ab.scope){aJ();Q(a4)}if(c("=")){var a9=ap();r(",");var a3=ap();var a6=c(",")?ap():null;r("do");a2=M();r("end");if(ab.scope){a0()}return aM(au.forNumericStatement(a4,a9,a3,a6,a2))}else{var a8=[a4];while(c(",")){a4=v();if(ab.scope){Q(a4)}a8.push(a4)}r("in");var a5=[];do{var a7=ap();a5.push(a7)}while(c(","));r("do");a2=M();r("end");if(ab.scope){a0()}return aM(au.forGenericStatement(a8,a5,a2))}}function f(){var a3;if(ag===az.type){var a7=[],a6=[];do{a3=v();a7.push(a3)}while(c(","));if(c("=")){do{var a5=ap();a6.push(a5)}while(c(","))}if(ab.scope){for(var a4=0,a2=a7.length;a4<a2;a4++){Q(a7[a4])}}return aM(au.localStatement(a7,a6))}if(c("function")){a3=v();if(ab.scope){Q(a3);aJ()}return Y(a3,true)}else{a1("<name>",az)}}function S(a2){if(a2.inParens||(["Identifier","MemberExpression","IndexExpression"].indexOf(a2.type)===-1)){W(az,ao.invalidVar,az.value)}}function U(){var a3=az,a6,a2;if(H){a2=aw()}a6=e();if(null==a6){return an(az)}if(",=".indexOf(az.value)>=0){var a7=[a6],a5=[],a4;S(a6);while(c(",")){a4=e();if(null==a4){a1("<expression>",az)}S(a4);a7.push(a4)}r("=");do{a4=ap();a5.push(a4)}while(c(","));V(a2);return aM(au.assignmentStatement(a7,a5))}if(aQ(a6)){V(a2);return aM(au.callStatement(a6))}return an(a3)}function v(){aH();var a2=az.value;if(ag!==az.type){a1("<name>",az)}af();return aM(au.identifier(a2))}function Y(a3,a5){var a4=[];r("(");if(!c(")")){while(true){if(ag===az.type){var a6=v();if(ab.scope){Q(a6)}a4.push(a6);if(c(",")){continue}else{if(c(")")){break}}}else{if(x===az.type){a4.push(a());r(")");break}else{a1("<name> or '...'",az)}}}}var a2=M();r("end");if(ab.scope){a0()}a5=a5||false;return aM(au.functionStatement(a3,a4,a5,a2))}function y(){var a4,a3,a2;if(H){a2=aw()}a4=v();if(ab.scope){ad(a4,F(a4.name));aJ()}while(c(".")){V(a2);a3=v();a4=aM(au.memberExpression(a4,".",a3))}if(c(":")){V(a2);a3=v();a4=aM(au.memberExpression(a4,":",a3));if(ab.scope){X("self")}}return a4}function w(){var a2=[],a3,a4;while(true){aH();if(p===az.type&&c("[")){a3=ap();r("]");r("=");a4=ap();a2.push(aM(au.tableKey(a3,a4)))}else{if(ag===az.type){if("="===B.value){a3=v();af();a4=ap();a2.push(aM(au.tableKeyString(a3,a4)))}else{a4=ap();a2.push(aM(au.tableValue(a4)))}}else{if(null==(a4=O())){aI.pop();break}a2.push(aM(au.tableValue(a4)))}}if(",;".indexOf(az.value)>=0){af();continue}break}r("}");return aM(au.tableConstructorExpression(a2))}function O(){var a2=aC(0);return a2}function ap(){var a2=O();if(null==a2){a1("<expression>",az)}else{return a2}}function aE(a3){var a2=a3.charCodeAt(0),a4=a3.length;if(1===a4){switch(a2){case 94:return 12;case 42:case 47:case 37:return 10;case 43:case 45:return 9;case 38:return 6;case 126:return 5;case 124:return 4;case 60:case 62:return 3}}else{if(2===a4){switch(a2){case 47:return 10;case 46:return 8;case 60:case 62:if("<<"===a3||">>"===a3){return 7}return 3;case 61:case 126:return 3;case 111:return 1}}else{if(97===a2&&"and"===a3){return 2}}}return 0}function aC(a8){var a4=az.value,a7,a3;if(H){a3=aw()}if(aS(az)){aH();af();var a6=aC(10);if(a6==null){a1("<expression>",az)}a7=aM(au.unaryExpression(a4,a6))}if(null==a7){a7=a();if(null==a7){a7=e()}}if(null==a7){return null}var a2;while(true){a4=az.value;a2=(p===az.type||o===az.type)?aE(a4):0;if(a2===0||a2<=a8){break}if("^"===a4||".."===a4){a2--}af();var a5=aC(a2);if(null==a5){a1("<expression>",az)}if(H){aI.push(a3)}a7=aM(au.binaryExpression(a4,a7,a5))}return a7}function e(){var a5,a4,a2;if(H){a2=aw()}if(ag===az.type){a4=az.value;a5=v();if(ab.scope){ad(a5,F(a4))}}else{if(c("(")){a5=ap();r(")");a5.inParens=true}else{return null}}var a6,a3;while(true){if(p===az.type){switch(az.value){case"[":V(a2);af();a6=ap();a5=aM(au.indexExpression(a5,a6));r("]");break;case".":V(a2);af();a3=v();a5=aM(au.memberExpression(a5,".",a3));break;case":":V(a2);af();a3=v();a5=aM(au.memberExpression(a5,":",a3));V(a2);a5=k(a5);break;case"(":case"{":V(a2);a5=k(a5);break;default:return a5}}else{if(aY===az.type){V(a2);a5=k(a5)}else{break}}}return a5}function k(a4){if(p===az.type){switch(az.value){case"(":af();var a3=[];var a5=O();if(null!=a5){a3.push(a5)}while(c(",")){a5=ap();a3.push(a5)}r(")");return aM(au.callExpression(a4,a3));case"{":aH();af();var a2=w();return aM(au.tableCallExpression(a4,a2))}}else{if(aY===az.type){return aM(au.stringCallExpression(a4,a()))}}a1("function arguments",az)}function a(){var a6=aY|aN|K|ai|x,a5=az.value,a4=az.type,a2;if(H){a2=aw()}if(a4&a6){V(a2);var a3=aZ.slice(az.range[0],az.range[1]);af();return aM(au.literal(a4,a5,a3))}else{if(o===a4&&"function"===a5){V(a2);af();if(ab.scope){aJ()}return Y(null)}else{if(c("{")){V(a2);return w()}}}}P.parse=am;function am(a3,a2){if("undefined"===typeof a2&&"object"===typeof a3){a2=a3;a3=undefined}if(!a2){a2={}}aZ=a3||"";ab=ae(ax,a2);aT=0;n=1;aX=0;j=aZ.length;aq=[[]];aF=0;aL=[];aI=[];if(ab.comments){aj=[]}if(!ab.wait){return N()}return P}P.write=aO;function aO(a2){aZ+=String(a2);j=aZ.length;return P}P.end=N;function N(a3){if("undefined"!==typeof a3){aO(a3)}if(aZ&&aZ.substr(0,2)==="#!"){aZ=aZ.replace(/^.*/,function(a4){return a4.replace(/./g," ")})}j=aZ.length;H=ab.locations||ab.ranges;B=aa();var a2=m();if(ab.comments){a2.comments=aj}if(ab.scope){a2.globals=aL}if(aI.length>0){throw new Error("Location tracking failed. This is most likely a bug in luaparse")}return a2}}));"use strict";Blockly.Blocks.factory_base={init:function(){this.setColour(120);this.appendDummyInput().appendField("name").appendField("","NAME");this.appendStatementInput("INPUTS").setCheck("Input").appendField("inputs");var a=new Blockly.FieldDropdown([["automatic inputs","AUTO"],["external inputs","EXT"],["inline inputs","INT"]]);this.appendDummyInput().appendField(a,"INLINE");a=new Blockly.FieldDropdown([["no connections","NONE"],["← left output","LEFT"],["↕ top+bottom connections","BOTH"],["↑ top connection","TOP"],["↓ bottom connection","BOTTOM"]],function(b){this.sourceBlock_.updateShape_(b);this.sourceBlock_.spawnOutputShadow_(b)});this.appendDummyInput().appendField(a,"CONNECTIONS");this.appendValueInput("TOOLTIP").setCheck("String").appendField("tooltip");this.appendValueInput("HELPURL").setCheck("String").appendField("help url");this.appendValueInput("COLOUR").setCheck("Colour").appendField("colour");this.setTooltip("Build a custom block by plugging\nfields, inputs and other blocks here.");this.setHelpUrl("https://developers.google.com/blockly/guides/create-custom-blocks/block-factory")},mutationToDom:function(){var a=document.createElement("mutation");a.setAttribute("connections",this.getFieldValue("CONNECTIONS"));return a},domToMutation:function(b){var a=b.getAttribute("connections");this.updateShape_(a)},spawnOutputShadow_:function(a){switch(a){case"LEFT":this.connectOutputShadow_("OUTPUTTYPE");break;case"TOP":this.connectOutputShadow_("TOPTYPE");this.connectOutputShadow_("PARENTTYPE");break;case"BOTTOM":this.connectOutputShadow_("BOTTOMTYPE");this.connectOutputShadow_("PARENTTYPE");break;case"BOTH":this.connectOutputShadow_("TOPTYPE");this.connectOutputShadow_("BOTTOMTYPE");this.connectOutputShadow_("PARENTTYPE");break}},connectOutputShadow_:function(b){var a=this.workspace.newBlock("type_null");a.setShadow(true);a.outputConnection.connect(this.getInput(b).connection);a.initSvg();a.render()},updateShape_:function(c){var d=this.getInput("OUTPUTTYPE");var a=this.getInput("TOPTYPE");var b=this.getInput("BOTTOMTYPE");var e=this.getInput("PARENTTYPE");if(c=="LEFT"){if(!d){this.addTypeInput_("OUTPUTTYPE","output type")}}else{if(d){this.removeInput("OUTPUTTYPE")}}if(c=="TOP"||c=="BOTH"){if(!a){this.addTypeInput_("TOPTYPE","top type")}}else{if(a){this.removeInput("TOPTYPE")}}if(c=="BOTTOM"||c=="BOTH"){if(!b){this.addTypeInput_("BOTTOMTYPE","bottom type")}}else{if(b){this.removeInput("BOTTOMTYPE")}}if(c=="TOP"||c=="BOTTOM"||c=="BOTH"){if(!e){this.addTypeInput_("PARENTTYPE","parent type")}}else{this.removeInput("PARENTTYPE")}},addTypeInput_:function(b,a){this.appendValueInput(b).setCheck("Type").appendField(a);this.moveInputBefore(b,"COLOUR")}};var FIELD_MESSAGE="fields %1 %2 %3";var FIELD_ARGS=[{type:"field_dropdown",name:"ALIGN",options:[["left","LEFT"],["right","RIGHT"],["centre","CENTRE"]]},{type:"field_dropdown",name:"SUBTYPE",options:[["Free","free"],["Output Pins","output_pins"],["Input Pins","input_pins"],["UART units","uart_units"],["Neopixel color","neopixel_color_sel"],["Display color","display_color_sel"],["Text","text"]]},{type:"input_statement",name:"FIELDS",check:"Field"}];var TYPE_MESSAGE="type %1";var TYPE_ARGS=[{type:"input_value",name:"TYPE",check:"Type",align:"RIGHT"}];Blockly.Blocks.input_value={init:function(){this.jsonInit({message0:"value input %1 shadow %2 %3",args0:[{type:"field_input",name:"INPUTNAME",text:"NAME"},{type:"field_checkbox",name:"SHADOW",checked:false},{type:"input_dummy"}],message1:FIELD_MESSAGE,args1:FIELD_ARGS,message2:TYPE_MESSAGE,args2:TYPE_ARGS,previousStatement:"Input",nextStatement:"Input",colour:210,tooltip:"A value socket for horizontal connections.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=71"})},onchange:function(){inputNameCheck(this)}};Blockly.Blocks.input_statement={init:function(){this.jsonInit({message0:"statement input %1 %2",args0:[{type:"field_input",name:"INPUTNAME",text:"NAME"},{type:"input_dummy"}],message1:FIELD_MESSAGE,args1:FIELD_ARGS,message2:TYPE_MESSAGE,args2:TYPE_ARGS,previousStatement:"Input",nextStatement:"Input",colour:210,tooltip:"A statement socket for enclosed vertical stacks.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=246"})},onchange:function(){inputNameCheck(this)}};Blockly.Blocks.input_dummy={init:function(){this.jsonInit({message0:"dummy input",message1:FIELD_MESSAGE,args1:FIELD_ARGS,previousStatement:"Input",nextStatement:"Input",colour:210,tooltip:"For adding fields on a separate row with no connections. Alignment options (left, right, centre) apply only to multi-line fields.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=293"})}};Blockly.Blocks.field_static={init:function(){this.setColour(160);this.appendDummyInput().appendField("text").appendField(new Blockly.FieldTextInput(""),"TEXT");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("Static text that serves as a label.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=88")}};Blockly.Blocks.field_input={init:function(){this.setColour(160);this.appendDummyInput().appendField("text input").appendField(new Blockly.FieldTextInput("default"),"TEXT").appendField(",").appendField(new Blockly.FieldTextInput("NAME"),"FIELDNAME");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("An input field for the user to enter text.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=319")},onchange:function(){fieldNameCheck(this)}};Blockly.Blocks.field_number={init:function(){this.setColour(160);this.appendDummyInput().appendField("numeric input").appendField(new Blockly.FieldNumber(0),"VALUE").appendField(",").appendField(new Blockly.FieldTextInput("NAME"),"FIELDNAME");this.appendDummyInput().appendField("min").appendField(new Blockly.FieldNumber(-Infinity),"MIN").appendField("max").appendField(new Blockly.FieldNumber(Infinity),"MAX").appendField("precision").appendField(new Blockly.FieldNumber(0,0),"PRECISION");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("An input field for the user to enter a number.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=319")},onchange:function(){fieldNameCheck(this)}};Blockly.Blocks.field_angle={init:function(){this.setColour(160);this.appendDummyInput().appendField("angle input").appendField(new Blockly.FieldAngle("90"),"ANGLE").appendField(",").appendField(new Blockly.FieldTextInput("NAME"),"FIELDNAME");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("An input field for the user to enter an angle.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=372")},onchange:function(){fieldNameCheck(this)}};Blockly.Blocks.field_dropdown={init:function(){this.appendDummyInput().appendField("dropdown").appendField(new Blockly.FieldTextInput("NAME"),"FIELDNAME");this.optionList_=["text","text","text"];this.updateShape_();this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setMutator(new Blockly.Mutator(["field_dropdown_option_text","field_dropdown_option_image"]));this.setColour(160);this.setTooltip("Dropdown menu with a list of options.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=386")},mutationToDom:function(b){var a=document.createElement("mutation");a.setAttribute("options",JSON.stringify(this.optionList_));return a},domToMutation:function(a){var c=JSON.parse(a.getAttribute("options"));if(typeof c=="number"){this.optionList_=[];for(var b=0;b<c;b++){this.optionList_.push("text")}}else{this.optionList_=c}this.updateShape_()},decompose:function(d){var a=d.newBlock("field_dropdown_container");a.initSvg();var c=a.getInput("STACK").connection;for(var e=0;e<this.optionList_.length;e++){var b=d.newBlock("field_dropdown_option_"+this.optionList_[e]);b.initSvg();c.connect(b.previousConnection);c=b.nextConnection}return a},compose:function(b){var c=b.getInputTargetBlock("STACK");this.optionList_.length=0;var e=[];while(c){if(c.type=="field_dropdown_option_text"){this.optionList_.push("text")}else{if(c.type=="field_dropdown_option_image"){this.optionList_.push("image")}}e.push([c.userData_,c.cpuData_]);c=c.nextConnection&&c.nextConnection.targetBlock()}this.updateShape_();for(var d=0;d<this.optionList_.length;d++){var a=e[d][0];if(a!==undefined){if(typeof a=="string"){this.setFieldValue(a||"option","USER"+d)}else{this.setFieldValue(a.src,"SRC"+d);this.setFieldValue(a.width,"WIDTH"+d);this.setFieldValue(a.height,"HEIGHT"+d);this.setFieldValue(a.alt,"ALT"+d)}this.setFieldValue(e[d][1]||"OPTIONNAME","CPU"+d)}}},saveConnections:function(a){var b=a.getInputTargetBlock("STACK");var c=0;while(b){b.userData_=this.getUserData(c);b.cpuData_=this.getFieldValue("CPU"+c);c++;b=b.nextConnection&&b.nextConnection.targetBlock()}},updateShape_:function(){var a=0;while(this.getInput("OPTION"+a)){this.removeInput("OPTION"+a);this.removeInput("OPTION_IMAGE"+a,true);a++}var c="https://www.gstatic.com/codesite/ph/images/star_on.gif";for(var a=0;a<=this.optionList_.length;a++){var b=this.optionList_[a];if(b=="text"){this.appendDummyInput("OPTION"+a).appendField("•").appendField(new Blockly.FieldTextInput("option"),"USER"+a).appendField(",").appendField(new Blockly.FieldTextInput("OPTIONNAME"),"CPU"+a)}else{if(b=="image"){this.appendDummyInput("OPTION"+a).appendField("•").appendField("image").appendField(new Blockly.FieldTextInput(c),"SRC"+a);this.appendDummyInput("OPTION_IMAGE"+a).appendField(" ").appendField("width").appendField(new Blockly.FieldNumber("15",0,NaN,1),"WIDTH"+a).appendField("height").appendField(new Blockly.FieldNumber("15",0,NaN,1),"HEIGHT"+a).appendField("alt text").appendField(new Blockly.FieldTextInput("*"),"ALT"+a).appendField(",").appendField(new Blockly.FieldTextInput("OPTIONNAME"),"CPU"+a)}}}},onchange:function(){if(this.workspace&&this.optionList_.length<1){this.setWarningText("Drop down menu must\nhave at least one option.")}else{fieldNameCheck(this)}},getUserData:function(a){if(this.optionList_[a]=="text"){return this.getFieldValue("USER"+a)}if(this.optionList_[a]=="image"){return{src:this.getFieldValue("SRC"+a),width:Number(this.getFieldValue("WIDTH"+a)),height:Number(this.getFieldValue("HEIGHT"+a)),alt:this.getFieldValue("ALT"+a)}}throw"Unknown dropdown type"}};Blockly.Blocks.field_dropdown_container={init:function(){this.setColour(160);this.appendDummyInput().appendField("add options");this.appendStatementInput("STACK");this.setTooltip("Add, remove, or reorder options\nto reconfigure this dropdown menu.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=386");this.contextMenu=false}};Blockly.Blocks.field_dropdown_option_text={init:function(){this.setColour(160);this.appendDummyInput().appendField("text option");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip("Add a new text option to the dropdown menu.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=386");this.contextMenu=false}};Blockly.Blocks.field_dropdown_option_image={init:function(){this.setColour(160);this.appendDummyInput().appendField("image option");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip("Add a new image option to the dropdown menu.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=386");this.contextMenu=false}};Blockly.Blocks.field_checkbox={init:function(){this.setColour(160);this.appendDummyInput().appendField("checkbox").appendField(new Blockly.FieldCheckbox("TRUE"),"CHECKED").appendField(",").appendField(new Blockly.FieldTextInput("NAME"),"FIELDNAME");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("Checkbox field.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=485")},onchange:function(){fieldNameCheck(this)}};Blockly.Blocks.field_colour={init:function(){this.setColour(160);this.appendDummyInput().appendField("colour").appendField(new Blockly.FieldColour("#ff0000"),"COLOUR").appendField(",").appendField(new Blockly.FieldTextInput("NAME"),"FIELDNAME");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("Colour input field.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=495")},onchange:function(){fieldNameCheck(this)}};Blockly.Blocks.field_date={init:function(){this.setColour(160);this.appendDummyInput().appendField("date").appendField(new Blockly.FieldDate(),"DATE").appendField(",").appendField(new Blockly.FieldTextInput("NAME"),"FIELDNAME");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("Date input field.")},onchange:function(){fieldNameCheck(this)}};Blockly.Blocks.field_variable={init:function(){this.setColour(160);this.appendDummyInput().appendField("variable").appendField(new Blockly.FieldTextInput("item"),"TEXT").appendField(",").appendField(new Blockly.FieldTextInput("NAME"),"FIELDNAME");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("Dropdown menu for variable names.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=510")},onchange:function(){fieldNameCheck(this)}};Blockly.Blocks.field_image={init:function(){this.setColour(160);var a="https://www.gstatic.com/codesite/ph/images/star_on.gif";this.appendDummyInput().appendField("image").appendField(new Blockly.FieldTextInput(a),"SRC");this.appendDummyInput().appendField("width").appendField(new Blockly.FieldNumber("15",0,NaN,1),"WIDTH").appendField("height").appendField(new Blockly.FieldNumber("15",0,NaN,1),"HEIGHT").appendField("alt text").appendField(new Blockly.FieldTextInput("*"),"ALT");this.setPreviousStatement(true,"Field");this.setNextStatement(true,"Field");this.setTooltip("Static image (JPEG, PNG, GIF, SVG, BMP).\nRetains aspect ratio regardless of height and width.\nAlt text is for when collapsed.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=567")}};Blockly.Blocks.type_group={init:function(){this.typeCount_=2;this.updateShape_();this.setOutput(true,"Type");this.setMutator(new Blockly.Mutator(["type_group_item"]));this.setColour(230);this.setTooltip("Allows more than one type to be accepted.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=677")},mutationToDom:function(b){var a=document.createElement("mutation");a.setAttribute("types",this.typeCount_);return a},domToMutation:function(a){this.typeCount_=parseInt(a.getAttribute("types"),10);this.updateShape_();for(var c=0;c<this.typeCount_;c++){this.removeInput("TYPE"+c)}for(var c=0;c<this.typeCount_;c++){var b=this.appendValueInput("TYPE"+c).setCheck("Type");if(c==0){b.appendField("any of")}}},decompose:function(c){var a=c.newBlock("type_group_container");a.initSvg();var b=a.getInput("STACK").connection;for(var d=0;d<this.typeCount_;d++){var e=c.newBlock("type_group_item");e.initSvg();b.connect(e.previousConnection);b=e.nextConnection}return a},compose:function(a){var e=a.getInputTargetBlock("STACK");var d=[];while(e){d.push(e.valueConnection_);e=e.nextConnection&&e.nextConnection.targetBlock()}for(var c=0;c<this.typeCount_;c++){var b=this.getInput("TYPE"+c).connection.targetConnection;if(b&&d.indexOf(b)==-1){b.disconnect()}}this.typeCount_=d.length;this.updateShape_();for(var c=0;c<this.typeCount_;c++){Blockly.Mutator.reconnect(d[c],this,"TYPE"+c)}},saveConnections:function(a){var d=a.getInputTargetBlock("STACK");var c=0;while(d){var b=this.getInput("TYPE"+c);d.valueConnection_=b&&b.connection.targetConnection;c++;d=d.nextConnection&&d.nextConnection.targetBlock()}},updateShape_:function(){for(var b=0;b<this.typeCount_;b++){if(!this.getInput("TYPE"+b)){var a=this.appendValueInput("TYPE"+b);if(b==0){a.appendField("any of")}}}while(this.getInput("TYPE"+b)){this.removeInput("TYPE"+b);b++}}};Blockly.Blocks.type_group_container={init:function(){this.jsonInit({message0:"add types %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],colour:230,tooltip:"Add, or remove allowed type.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=677"})}};Blockly.Blocks.type_group_item={init:function(){this.jsonInit({message0:"type",previousStatement:null,nextStatement:null,colour:230,tooltip:"Add a new allowed type.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=677"})}};Blockly.Blocks.type_null={valueType:null,init:function(){this.jsonInit({message0:"any",output:"Type",colour:230,tooltip:"Any type is allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}};Blockly.Blocks.type_boolean={valueType:"Boolean",init:function(){this.jsonInit({message0:"Boolean",output:"Type",colour:230,tooltip:"Booleans (true/false) are allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}};Blockly.Blocks.type_number={valueType:"Number",init:function(){this.jsonInit({message0:"Number",output:"Type",colour:230,tooltip:"Numbers (int/float) are allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}};Blockly.Blocks.type_string={valueType:"String",init:function(){this.jsonInit({message0:"String",output:"Type",colour:230,tooltip:"Strings (text) are allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}};Blockly.Blocks.type_list={valueType:"Array",init:function(){this.jsonInit({message0:"Array",output:"Type",colour:230,tooltip:"Arrays (lists) are allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}};Blockly.Blocks.type_other={init:function(){this.jsonInit({message0:"other %1",args0:[{type:"field_input",name:"TYPE",text:""}],output:"Type",colour:230,tooltip:"Custom type to allow.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=702"})}};Blockly.Blocks.colour_hue={init:function(){this.appendDummyInput().appendField("hue:").appendField(new Blockly.FieldAngle("0",this.validator),"HUE");this.setOutput(true,"Colour");this.setTooltip("Paint the block with this colour.");this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=55")},validator:function(b){var a=parseInt(b,10);if(!isNaN(a)){this.sourceBlock_.setColour(a)}},mutationToDom:function(b){var a=document.createElement("mutation");a.setAttribute("colour",this.getColour());return a},domToMutation:function(a){this.setColour(a.getAttribute("colour"))}};function fieldNameCheck(h){if(!h.workspace){return}var b=h.getFieldValue("FIELDNAME").toLowerCase();var d=0;var g=h.workspace.getAllBlocks();for(var c=0,f;f=g[c];c++){var a=f.getFieldValue("FIELDNAME");if(!f.disabled&&!f.getInheritedDisabled()&&a&&a.toLowerCase()==b){d++}}var e=(d>1)?"There are "+d+" field blocks\n with this name.":null;h.setWarningText(e)}function inputNameCheck(h){if(!h.workspace){return}var b=h.getFieldValue("INPUTNAME").toLowerCase();var d=0;var g=h.workspace.getAllBlocks();for(var c=0,f;f=g[c];c++){var a=f.getFieldValue("INPUTNAME");if(!f.disabled&&!f.getInheritedDisabled()&&a&&a.toLowerCase()==b){d++}}var e=(d>1)?"There are "+d+" input blocks\n with this name.":null;h.setWarningText(e)};function blockLibrary(){var b=this;b.libs=[];b.def={};if((typeof require!="undefined")&&(typeof require("nw.gui")!="undefined")){var a=require("fs");var e=require("path");var c="library/defs";var f=e.join(process.cwd(),c);var d=a.readdirSync(f);d.forEach(function(h,g){if(/^.+\.json$/.test(h)){var i=e.join(f,h);b.libs.push(JSON.parse(a.readFileSync(i,"utf8")))}})}}blockLibrary.prototype.update=function(){var b=this;if((typeof require!="undefined")&&(typeof require("nw.gui")!="undefined")){var a=require("fs");var e=require("path");var d="library/defs/"+b.def.name+".json";var c=e.join(process.cwd(),d);a.writeFileSync(c,JSON.stringify(b.def,function(g,f){return f},2));b.libs.forEach(function(g,f){if(g.name==b.def.name){b.libs[f]=JSON.parse(JSON.stringify(b.def))}});Code.updateToolBox()}};blockLibrary.prototype.evalTemplate=function(block,pos,op,open,template){var self=this;var code="";var id="";var prev="";var begin_ops=["$","{","@"];var end_ops=["$","}","@"];var ops=["FIELD","FUNC","CODE"];var i=0;while(i<template.length){if(begin_ops.indexOf(template.charAt(i))!=-1){var newOp=ops[begin_ops.indexOf(template.charAt(i))];if(i+1<template.length){if(template.charAt(i+1)=="("){var newPos={val:0};code=code+self.evalTemplate(block,newPos,newOp,1,template.substring(i+2));i=i+newPos.val}else{code=code+template.charAt(i);i++}}else{code=code+template.charAt(i);i++}}else{if(template.charAt(i)==")"){if(i+1<template.length){if(end_ops.indexOf(template.charAt(i+1))!=-1){if(open>0){open--;if(open==0){var val="";var id=template.substring(0,i);pos.val=i+4;try{if(op=="FUNC"){val=eval(self.evalTemplate(block,newPos,"",0,id))}else{if(op=="FIELD"){val=eval("block.getFieldValue('"+id+"')");if(val==null){val=Blockly.Lua.valueToCode(block,id,Blockly.Lua.ORDER_NONE)||"''"}}else{if(op=="CODE"){val=eval("Blockly.Lua.statementToCodeNoIndent(block,'"+id+"')")}}}}catch(e){val=eval(self.evalTemplate(block,newPos,"",0,id))}return val}}else{code=code+template.charAt(i);i++}}else{code=code+template.charAt(i);i++}}else{code=code+template.charAt(i);i++}}else{code=code+template.charAt(i);i++}}}return code};blockLibrary.prototype.createBlocks=function(d,b){var m=this;Blockly.Blocks[b.spec.type]={def:{},init:function(){this.def=JSON.parse(JSON.stringify(b));this.jsonInit(b.spec);for(var o in b.interactiveFields){this.updateBoardAtFieldChange(b.interactiveFields[o])}var p=i.find("category[id='cat"+b.parentCategory+"']");this.setColour(p.attr("colour"))},hasWatcher:b.whatcher};Blockly.Lua[b.spec.type]=function(o){var r="";var q="";for(var p in b.dependency){Blockly.Lua.addDependency(p,o)}if(typeof b.code.functions!="undefined"){r=atob(b.code.functions);while(true){var t={val:0};q=m.evalTemplate(o,t,"",0,r);if(q!=r){r=q}else{break}}if(r!=""){Blockly.Lua.addCodeToSection("functions",r+"\n",o)}}r="";q="";if(typeof b.code["default"]!="undefined"){r=atob(b.code["default"]);while(true){var t={val:0};q=m.evalTemplate(o,t,"",0,r);if(q!=r){r=q}else{break}}if(Blockly.Lua.developerMode){var s="";s+=Blockly.Lua.indent(0,"try(")+"\n";s+=Blockly.Lua.indent(1,"function()")+"\n";s+=Blockly.Lua.indent(2,r)+"\n";s+=Blockly.Lua.indent(1,"end,")+"\n";s+=Blockly.Lua.indent(1,"function(where, line, err, message)")+"\n";s+=Blockly.Lua.blockError(2,this);s+=Blockly.Lua.indent(1,"end")+"\n";s+=Blockly.Lua.indent(0,")")+"\n";r=s}}if(!o.isReporterBlock()){return Blockly.Lua.postFormat(r,o)}else{return[r,Blockly.Lua.ORDER_HIGH]}};var e=goog.dom.createDom("block");e.setAttribute("type",b.spec.type);for(var a in b.spec){if(/args[0-9]*/.test(a)){for(var n in b.spec[a]){if(b.spec[a][n].type=="input_value"){if(b.subtype[b.spec[a][n].name]=="output_pins"){var l=goog.dom.createDom("shadow");l.setAttribute("type","output_digital_pin");var j=goog.dom.createDom("value");j.setAttribute("name",b.spec[a][n].name);j.appendChild(l);e.appendChild(j)}else{if(b.subtype[b.spec[a][n].name]=="uart_units"){var l=goog.dom.createDom("shadow");l.setAttribute("type","uart_units");var j=goog.dom.createDom("value");j.setAttribute("name",b.spec[a][n].name);j.appendChild(l);e.appendChild(j)}else{if(b.subtype[b.spec[a][n].name]=="display_color_sel"){var l=goog.dom.createDom("shadow");l.setAttribute("type","display_color_sel");var j=goog.dom.createDom("value");j.setAttribute("name","COLOR");j.appendChild(l);e.appendChild(j)}else{if(b.subtype[b.spec[a][n].name]=="text"){var l=goog.dom.createDom("shadow");l.setAttribute("type","text");var j=goog.dom.createDom("value");j.setAttribute("name","TEXT");j.appendChild(l);e.appendChild(j)}else{if(b.subtype[b.spec[a][n].name]=="neopixel_color_sel"){var l=goog.dom.createDom("shadow");l.setAttribute("type","neopixel_color_sel");var j=goog.dom.createDom("value");j.setAttribute("name","COLOR");j.appendChild(l);e.appendChild(j)}else{if(typeof b.shadow[b.spec[a][n].name]!="undefined"){var h=goog.dom.createDom("field",null,b.shadow[b.spec[a][n].name].value);h.setAttribute("name",b.shadow[b.spec[a][n].name].name);var l=goog.dom.createDom("shadow");l.setAttribute("type",b.shadow[b.spec[a][n].name].type);l.appendChild(h);var j=goog.dom.createDom("value");j.setAttribute("name",b.spec[a][n].name);j.appendChild(l);e.appendChild(j)}}}}}}}}}}var i=jQuery("<toolbar>"+d+"</toolbar>");var f=i.find("category[id='cat"+b.parentCategory+"']");var g=i.find("category[id='cat"+b.category+"']");if(g.length==0){var k=b.category;if(typeof MSG["cat"+b.category]!="undefined"){k=MSG["cat"+b.category]}g=jQuery('<category id="cat'+b.category+'" colour="'+f.attr("colour")+'" name="'+k+'"></category>');var c=false;f.children().each(function(o,p){p=jQuery(p);var q=p.attr("name");if(typeof q=="undefined"){if(typeof MSG[p.attr("id")]!="undefined"){q=MSG[p.attr("id")]}else{q=p.attr("id")}}if((k<q)&&!c){g.insertBefore(p);c=true}});if(!c){f.append(g)}}if(g.find("block[type='"+b.spec.type+"']").length==0){g.append(e)}return i.html()};blockLibrary.prototype.get=function(xml,callback){var self=this;function insert(libContent){if(libContent){libContent=JSON.parse(libContent);libContent.forEach(function(lib){self.libs.push(lib)})}self.libs.forEach(function(lib,idx){lib.blocks.forEach(function(block,idx){var spec=block.spec;for(var prop in spec){if(/message[0-9]*/.test(prop)){if(block.msg[Code.settings.language][prop]!=""){block.spec[prop]=block.msg[Code.settings.language][prop]}}}if(isNaN(parseInt(spec.colour))){spec.colour=eval(spec.colour)}xml=self.createBlocks(xml,block)});if(typeof lib.messages!="undefined"){lib.messages.forEach(function(message){if(typeof message[Code.settings.language]!="undefined"){MSG[message.msgid]=message[Code.settings.language]}})}});callback(xml)}if((typeof require!="undefined")&&(typeof require("nw.gui")!="undefined")){insert(null)}else{jQuery.ajax({url:Code.folder+"/?libraries",success:function(result){insert(result);return},error:function(){callback()}})}};blockLibrary.prototype.create=function(c){if((typeof require!="undefined")&&(typeof require("nw.gui")!="undefined")){var a=require("fs");var f=require("path");var e="library/defs/"+c+".json";var d=f.join(process.cwd(),e);if(!a.existsSync(d)){a.writeFileSync(d,'{"name": "'+c+'","blocks": []}');try{self.libs.push(JSON.parse(a.readFileSync(d,"utf8")))}catch(b){return}}}};blockLibrary.prototype.getBlockDef=function(a){var b=null;this.libs.forEach(function(d,c){if(!b){d.blocks.forEach(function(f,e){if((f.spec.type==a)&&(!b)){b=f}})}});return b};"use strict";function isChrome(){var f=window.chrome,a=window.navigator,e=a.vendor,c=a.userAgent.indexOf("OPR")>-1,d=a.userAgent.indexOf("Edge")>-1,b=a.userAgent.match("CriOS");if(b){return true}else{if(f!==null&&f!==undefined&&e==="Google Inc."&&c==false&&d==false){return true}else{return false}}}Blockly.Lua.developerMode=true;var Code={};if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){Code.folder=""}else{Code.folder="https://ide.whitecatboard.org"}}else{Code.folder="https://ide.whitecatboard.org"}Code.server="https://ide.whitecatboard.org";Code.cloud=null;var blockAbstraction={Low:0,High:1};Code.blockAbstraction=blockAbstraction.High;Code.storage={};Code.minAgentVersion=2;Code.checkNewFirmwareVersion=true;Code.checkNewAgentVersion=true;Code.showCode=false;Code.storage.board=null;Code.storage.local=null;Code.storage.cloud=null;Code.Help=null;Code.defaultStatus={cpu:"ESP32",connected:false,modules:{thread:true,nvs:true,pack:true,i2c:true,can:true,pio:true,adc:true,pwm:true,tft:true,spi:true,tmr:true,uart:true,lora:true,mqtt:true,sensor:true,servo:true,net:true},maps:[],sensors:[]};Code.devices=[{vendorId:"0x10c4",productId:"0xea60",vendor:"Silicon Labs"},{vendorId:"0x403",productId:"0x6015",vendor:"FTDI"},{vendorId:"0x403",productId:"0x6001",vendor:"FTDI"},{vendorId:"0x403",productId:"0x6010",vendor:"FTDI"},{vendorId:"0x1a86",productId:"0x7523",vendor:"CH340"}];Code.status=JSON.parse(JSON.stringify(Code.defaultStatus));Code.platforms=["MacIntel","Win32","Linux x86_64"];Code.progressDialog=false;Code.currentFile={id:null,path:"/",file:"",storage:StorageType.Computer,changes:false};Code.settings={language:"en",board:"N1ESP32",programmingModel:"blocks"};Code.LANGUAGE_NAME={en:"English",ca:"Català",es:"Español"};Code.LANGUAGE_RTL=[];Code.workspace={};Code.workspace.type="blocks";Code.workspace.prevType=Code.workspace.type;Code.workspace.blocks=null;Code.workspace.editor=null;Code.workspace.block_editor=null;Code.workspace.block_editorCode=null;Code.isRtl=function(){return Code.LANGUAGE_RTL.indexOf(Code.settings.language)!=-1};Code.defaultStorage=function(){if(Code.status.connected){return StorageType.Board}else{return StorageType.Computer}};Code.setDefaultStorage=function(){Code.currentFile.id=null;Code.currentFile.path="/";Code.currentFile.file="";Code.currentFile.storage=StorageType.Computer;Code.currentFile.changes=Code.defaultStorage();Code.renderStorage(StorageType.None,Code.currentFile.path,jQuery("#targetFile"))};Code.renderStorage=function(f,c,e){if(f==StorageType.None){if(e.attr("id")=="targetFile"){e.html("");return}}if(e.attr("id")=="targetFile"){var b=c.split("/");c=b[b.length-1]}else{var b=c.split("/");c="";for(var a=0;a<b.length;a++){if(b[a]!=""){if(c!=""){c=c+"/"}c=c+b[a]}}c="/"+c;if(c!="/"){c=c+"/"}}var d="";if(f==StorageType.Board){d='<span><span class="icon icon-chip" style="font-size: 14px;" aria-hidden="true"></span></span>&nbsp;'}else{if(f==StorageType.Computer){d='<span><span class="icon icon-display" style="font-size: 14px;" aria-hidden="true"></span></span>&nbsp;'}else{if(f==StorageType.Cloud){d='<span><span class="icon icon-cloud" style="font-size: 14px;" aria-hidden="true"></span></span>&nbsp;'}}}if(e.attr("id")!="targetFile"){e.html("&nbsp;&nbsp;"+d+"&nbsp;&nbsp;"+c)}else{e.html("|&nbsp;&nbsp;"+d+c)}};Code.setCurrentStorage=function(h,e,c,g){if(typeof e=="undefined"){var b=c.split("/");var d="";var f="";for(var a=0;a<b.length-1;a++){if(b[a]!=""){d=d+"/"+b[a]}}if(d==""){d="/"}else{d=d+"/"}f=b[b.length-1];e=d;c=f}if(h!=StorageType.Cloud){Code.currentFile.path=e;Code.currentFile.id=null}else{Code.currentFile.path="";Code.currentFile.id=g;c=c.replace(/\/.*\//g,"")}Code.currentFile.file=c;Code.currentFile.storage=h;Code.currentFile.changes=false;Code.renderStorage(h,Code.getCurrentFullPath(),jQuery("#targetFile"))};Code.getCurrentFullPath=function(){var a;if(typeof Code.currentFile.path=="undefined"){Code.currentFile.path=""}a=Code.currentFile.path;a=a.replace(/[\\\/]+/g,"/");if(a.charAt(0)!="/"){a="/"+a}a+=Code.currentFile.file;a=a.replace(/[\\\/]+/g,"/");return a};Code.getBasename=function(b){var a=b.split("/");return a[a.length-1]};Code.getPathFor=function(b,a){var c;if(typeof b=="undefined"){b=""}if(b==""){c=Code.currentFile.path}else{c=b}if(typeof a=="undefined"){a=""}if(a==""){a=Code.currentFile.file}c=c.replace(/[\\\/]+/g,"/");if(c.charAt(0)!="/"){c="/"+c}if(c!="/"){c+="/"}c+=a;c=c.replace(/[\\\/]+/g,"/");return c};Code.loadBlocks=function(b){try{var d=window.sessionStorage.loadOnceBlocks}catch(c){var d=null}if("BlocklyStorage" in window&&window.location.hash.length>1){BlocklyStorage.retrieveXml(window.location.hash.substring(1))}else{if(d){delete window.sessionStorage.loadOnceBlocks;var a=Blockly.Xml.textToDom(d);Blockly.Xml.domToWorkspace(a,Code.workspace.blocks);Code.workspace.blocks.scrollCenter()}else{if(b){var a=Blockly.Xml.textToDom(b);Blockly.Xml.domToWorkspace(a,Code.workspace.blocks);Code.workspace.blocks.scrollCenter()}else{if("BlocklyStorage" in window){window.setTimeout(BlocklyStorage.restoreBlocks,0)}}}}};Code.changeLanguage=function(){if(typeof Blockly!="undefined"&&window.sessionStorage){var b=Blockly.Xml.workspaceToDom(Code.workspace.blocks);var e=Blockly.Xml.domToText(b);window.sessionStorage.loadOnceBlocks=e}var a=document.getElementById("languageMenu");var d=encodeURIComponent(a.options[a.selectedIndex].value);var c=window.location.search;if(c.length<=1){c="?lang="+d}else{if(c.match(/[?&]lang=[^&]*/)){c=c.replace(/([?&]lang=)[^&]*/,"$1"+d)}else{c=c.replace(/\?/,"?lang="+d+"&")}}Code.settings.language=d;Settings.save(Code.settings)};Code.bindClick=function(a,b){if(typeof a=="string"){a=document.getElementById(a)}a.addEventListener("click",b,true);a.addEventListener("touchend",b,true)};Code.importPrettify=function(){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("href",Code.folder+"/prettify.css");document.head.appendChild(b);var a=document.createElement("script");a.setAttribute("src",Code.folder+"/prettify.js");document.head.appendChild(a)};Code.getBBox_=function(c){var b=c.offsetHeight;var d=c.offsetWidth;var a=0;var e=0;do{a+=c.offsetLeft;e+=c.offsetTop;c=c.offsetParent}while(c);return{height:b,width:d,x:a,y:e}};Code.TABS_=["program"];Code.renderContent=function(){var a=document.getElementById("content_program");Code.tabRefresh();if(Code.workspace.type=="blocks"){jQuery("#content_block_editor").css("visibility","hidden");jQuery("#content_editor").css("visibility","hidden");jQuery("#content_blocks").css("visibility","visible");jQuery("#content_blocks").find(".injectionDiv").css("visibility","visible");jQuery("#content_block_editor").find(".injectionDiv").css("visibility","hidden");if(Code.workspace.blocks){Code.workspace.blocks.setVisible(true);Code.updateToolBox()}}else{if(Code.workspace.type=="editor"){jQuery("#content_blocks").css("visibility","hidden");jQuery("#content_editor").css("visibility","visible");jQuery("#content_block_editor").css("visibility","hidden");if(Code.workspace.blocks){Code.workspace.blocks.setVisible(false)}}else{if(Code.workspace.type=="block_editor"){Code.blocklyFactory.init();jQuery("#content_blocks").css("visibility","hidden");jQuery("#content_editor").css("visibility","hidden");jQuery("#content_block_editor").css("visibility","visible");jQuery("#content_blocks").find(".injectionDiv").css("visibility","hidden");jQuery("#content_block_editor").find(".injectionDiv").css("visibility","visible");if(Code.workspace.blocks){Code.workspace.blocks.setVisible(false)}}}}jQuery("[role='treeitem']").addClass("noselect");jQuery.contextMenu({selector:"[role='treeitem']",items:{help:{name:Blockly.Msg.HELP+" ...",callback:function(d,c){var f=jQuery(this);var g=f[0].id;function b(h){var j;if(!h){return""}for(j=0;j<h.length;j++){var k=b(h[j].children_);if(k==""){if(typeof h[j].id_!="undefined"){if(h[j].id_==g){return h[j].catId}}}else{return k}}return""}var e=b(Code.workspace.blocks.toolbox_.tree_.children_);if(e!=""){Code.Help.show("categories",e)}}}}});jQuery.contextMenu({selector:'.btn-toolbar > .btn-group > [type="button"]',items:{help:{name:Blockly.Msg.HELP+" ...",callback:function(c,b){var d=jQuery(this);var e=d[0].id;if(e!=""){Code.Help.show("ui",e)}}}},zIndex:999999});window.dispatchEvent(new Event("resize"))};Code.buildToolBox=function(c){var b="";b+='<category id="catEvents" colour="'+Blockly.Blocks.events.HUE+'"><block type="when_board_starts"></block><block type="thread"></block><block type="execute_every"><value name="TIME"><shadow type="math_number"><field name="NUM"></field></shadow></block><block type="when_i_receive"></block><block type="broadcast"></block><block type="broadcast_and_wait"></block><block type="event_is_being_processed"></block></category><category id="catControl" colour="'+Blockly.Blocks.control.HUE+'"><category id="catLoops"><block type="controls_repeat_ext"><value name="TIMES"><shadow type="math_number"><field name="NUM">10</field></shadow></value></block><block type="controls_whileUntil"></block><block type="controls_for"><value name="FROM"><shadow type="math_number"><field name="NUM">1</field></shadow></value><value name="TO"><shadow type="math_number"><field name="NUM">10</field></shadow></value><value name="BY"><shadow type="math_number"><field name="NUM">1</field></shadow></value></block><block type="controls_forEach"></block><block type="controls_flow_statements"></block></category><category id="catLogic"><block type="controls_if"></block><block type="logic_ternary"></block></category><category id="catExceptions"><block type="exception_try"></block><block type="exception_catch_error"></block><block type="exception_raise_again"></block></category><category id="catDelays"><block type="wait_for"><value name="TIME"><shadow type="math_number"><field name="NUM"></field></shadow></block><block type="cpu_sleep"><value name="SECONDS"><shadow type="math_number"><field name="NUM"></field></shadow></value></block></category></category>';b+='<category id="catOperators" colour="'+Blockly.Blocks.operators.HUE+'"><category id="catOperatorsNumeric"><block type="math_arithmetic"><value name="A"><shadow type="math_number"><field name="NUM">1</field></shadow></value><value name="B"><shadow type="math_number"><field name="NUM">1</field></shadow></value></block><block type="math_number"></block><block type="math_constant"></block><block type="math_number_property"><value name="NUMBER_TO_CHECK"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block><block type="math_single"><value name="NUM"><shadow type="math_number"><field name="NUM">9</field></shadow></value></block><block type="math_trig"><value name="NUM"><shadow type="math_number"><field name="NUM">45</field></shadow></value></block><block type="math_round"><value name="NUM"><shadow type="math_number"><field name="NUM">3.1</field></shadow></value></block><block type="math_on_list"></block><block type="math_modulo"><value name="DIVIDEND"><shadow type="math_number"><field name="NUM">64</field></shadow></value><value name="DIVISOR"><shadow type="math_number"><field name="NUM">10</field></shadow></value></block><block type="math_constrain"><value name="VALUE"><shadow type="math_number"><field name="NUM">50</field></shadow></value><value name="LOW"><shadow type="math_number"><field name="NUM">1</field></shadow></value><value name="HIGH"><shadow type="math_number"><field name="NUM">100</field></shadow></value></block><block type="math_random_int"><value name="FROM"><shadow type="math_number"><field name="NUM">1</field></shadow></value><value name="TO"><shadow type="math_number"><field name="NUM">100</field></shadow></value></block><block type="math_random_float"></block></category><category id="catOperatorsLogic"><block type="logic_compare"></block><block type="logic_operation"></block><block type="logic_negate"></block><block type="logic_boolean"></block><block type="logic_null"></block></category><category id="catOperatorsBitwise"><block type="bitwise_unary_op"><value name="OP1"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block><block type="bitwise_op"><value name="OP1"><shadow type="math_number"><field name="NUM">0</field></shadow></value><value name="OP2"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block><block type="bitlogic_msb"><value name="BOOL"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block><block type="bitlogic_lsb"><value name="BOOL"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block></category><category id="catOperatorsText"><block type="text_join"></block><block type="text_append"><value name="TEXT"><shadow type="text"></shadow></value></block><block type="text_length"><value name="VALUE"><shadow type="text"><field name="TEXT">abc</field></shadow></value></block><block type="text_isEmpty"><value name="VALUE"><shadow type="text"><field name="TEXT"></field></shadow></value></block><block type="text_indexOf"><value name="VALUE"><block type="variables_get"><field name="VAR">text</field></block></value><value name="FIND"><shadow type="text"><field name="TEXT">abc</field></shadow></value></block><block type="text_charAt"><value name="VALUE"><block type="variables_get"><field name="VAR">text</field></block></value></block><block type="text_getSubstring"><value name="STRING"><block type="variables_get"><field name="VAR">text</field></block></value></block><block type="text_changeCase"><value name="TEXT"><shadow type="text"><field name="TEXT">abc</field></shadow></value></block><block type="text_trim"><value name="TEXT"><shadow type="text"><field name="TEXT">abc</field></shadow></value></block><block type="text_print"></value></block><block type="text"></block></block></category></category><category id="catLists" colour="'+Blockly.Blocks.lists.HUE+'"><block type="lists_create_with"><mutation items="0"></mutation></block><block type="lists_create_with"></block><block type="lists_repeat"><value name="NUM"><shadow type="math_number"><field name="NUM">5</field></shadow></value></block><block type="lists_length"></block><block type="lists_isEmpty"></block><block type="lists_indexOf"><value name="VALUE"><block type="variables_get"><field name="VAR">list</field></block></value></block><block type="lists_getIndex"><value name="VALUE"><block type="variables_get"><field name="VAR">list</field></block></value></block><block type="lists_setIndex"><value name="LIST"><block type="variables_get"><field name="VAR">list</field></block></value></block><block type="lists_getSublist"><value name="LIST"><block type="variables_get"><field name="VAR">list</field></block></value></block><block type="lists_split"><value name="DELIM"><shadow type="text"><field name="TEXT">,</field></shadow></value></block></category><category id="catVariables" colour="'+Blockly.Blocks.variables.HUE+'" custom="VARIABLE"></category><category id="catFunctions" colour="290" custom="PROCEDURE"></category><sep gap="32"></sep>';if(Code.status.modules.pio||Code.status.modules.adc||Code.status.modules.pwm){b+='<category id="catIO" colour="'+Blockly.Blocks.io.HUE+'">';if(Code.status.modules.pio){b+='<block type="when_digital_pin"><value name="PIN"><shadow type="input_digital_pin"></shadow></value></block><block type="setdigitalpin"><value name="PIN"><shadow type="output_digital_pin"></shadow></value></block><block type="invertdigitalpin"><value name="PIN"><shadow type="output_digital_pin"></shadow></value></block><block type="getdigitalpin"><value name="PIN"><shadow type="input_digital_pin"></shadow></value></block>'}if(Code.status.modules.adc){b+='<block type="getanalogpin"><value name="PIN"><shadow type="analog_pins"></shadow></value></block>';if(Code.status.connected){var a=Blockly.Blocks.io.helper.getExternalAdcUnits();if(a.length>0){b+='<block type="getexternalanalogchannel"><value name="UNIT"><shadow type="external_analog_units"></shadow></value><value name="CHANNEL"><shadow type="external_analog_channels"></shadow></value></block>'}}}if(Code.status.modules.pwm){b+='<block type="setpwmpin"><value name="PIN"><shadow type="pwm_pins"></shadow></value><value name="FREQUENCY"><shadow type="math_number"><field name="NUM">1000</field></shadow></value><value name="DUTY"><shadow type="math_number"><field name="NUM">50</field></shadow></value></block>'}b+='<block type="output_digital_pin_sel"></block>';b+='<block type="input_digital_pin_sel"></block>';b+='<block type="input_digital_pin_sel"></block>';b+='<block type="pwm_pins_sel"></block>';b+='<block type="analog_pins_sel"></block>';b+="</category>"}if(Code.status.modules.i2c||Code.status.modules.can){b+='<category id="catComm" colour="'+Blockly.Blocks.io.HUE+'">';if(Code.status.modules.can){b+='<category id="catCan" colour="'+Blockly.Blocks.io.HUE+'"><block type="cansetspeed"><value name="SPEED"><shadow type="math_number"><field name="NUM">500</field></shadow></value></block><block type="cansetfilter"><value name="FROM"><shadow type="math_number"><field name="NUM">0</field></shadow></value><value name="TO"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block><block type="canframewrite"></block><block type="canread"></block><block type="canframeset"><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block><block type="canframeget"></block><block type="cantype"></block></category>'}if(Code.status.modules.i2c){b+='<category id="catI2C" colour="'+Blockly.Blocks.io.HUE+'"><block type="i2csetspeed"><value name="SPEED"><shadow type="math_number"><field name="NUM">1000</field></shadow></value></block><block type="i2cstartcondition"></block><block type="i2cstopcondition"></block><block type="i2caddress"><value name="ADDRESS"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block><block type="i2cread"></block><block type="i2cwrite"><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block></category>'}b+="</category>"}if(Code.status.modules.sensor){b+='<category id="catSensor" custom="SENSOR" colour="'+Blockly.Blocks.sensor.HUE+'">';b+='<button function="expand(1)">Expand section</button>';b+="</category>"}if(Code.status.modules.servo){b+='<category id="catActuators" colour="'+Blockly.Blocks.actuators.HUE+'">';b+='<category id="catServo" colour="'+Blockly.Blocks.actuators.HUE+'">';b+='<block type="servo_move"><value name="PIN"><shadow type="output_digital_pin"></shadow></value><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow></value></block>';b+="</category>"}b+="</category>";if(Code.status.modules.net){b+='<category id="catNET" colour="'+Blockly.Blocks.lora.HUE+'">';b+='<category id="catWIFI" custom="WIFI" colour="'+Blockly.Blocks.lora.HUE+'">';b+="</category>";b+="</category>"}if(Code.status.modules.lora){b+='<category id="catLora" custom="LORA" colour="20">';b+='<button function="expand(1)">Expand section</button>';b+="</category>"}if(Code.status.modules.mqtt){b+='<category id="catMQTT" custom="MQTT"colour="'+Blockly.Blocks.lora.HUE+'">';b+='<button function="expand(1)">Expand section</button>';b+="</category>"}Code.lib.get(b,function(d){var e=document.getElementById("toolbox");e.innerHTML=d;c()})};Code.updateToolBox=function(){Code.buildToolBox(function(){Code.initLanguage();var a=null;var b=null;if(Code.workspace.type=="block_editor"){a=document.getElementById("block_editortoolbox");b=Code.workspace.block_editor}else{if(Code.workspace.type=="blocks"){a=document.getElementById("toolbox");b=Code.workspace.blocks}}if(b){b.updateToolbox(a)}})};Code.init=function(){Code.initLanguage();var d=Code.isRtl();var a=document.getElementById("content_area");var f=function(m){var l=Code.getBBox_(a);for(var h=0;h<Code.TABS_.length;h++){var k=document.getElementById("content_"+Code.TABS_[h]);if(Code.TABS_[h]=="program"){if(Code.workspace.type=="blocks"){k=document.getElementById("content_blocks")}else{if(Code.workspace.type=="editor"){k=document.getElementById("content_editor")}else{if(Code.workspace.type=="block_editor"){k=document.getElementById("content_block_editor")}}}}var j=k;k.style.top=l.y+"px";k.style.left=l.x+"px";k.style.height=l.height+"px";k.style.height=(2*l.height-k.offsetHeight-34)+"px";k.style.width=l.width+"px";k.style.width=(2*l.width-k.offsetWidth)+"px";k=document.getElementById("languageDiv");var g=Code.getBBox_(k);k.style.position="absolute";k.style.height="38px";k.style.width=g.width+"px";k.style.top=(l.y-38)+"px";k.style.left=(l.width-l.x-g.width-10)+"px";k.style.visibility="visible";var k=document.getElementById("boardConsole");k.style.top=j.style.top;k.style.left=(parseInt(j.style.width.replace("px",""))-600)+"px";var k=document.getElementById("cloudConsole");k.style.top=j.style.top;k.style.left=(parseInt(j.style.width.replace("px",""))-800)+"px"}};window.addEventListener("resize",f,false);var c=document.getElementById("toolbox");var e=document.getElementById("block_editortoolbox");var b=document.getElementById("block_editortoolboxpreview");Code.workspace.blocks=Blockly.inject("content_blocks",{media:Code.folder+"/media/",rtl:d,toolbox:c,zoom:{controls:true,wheel:true}});Code.workspace.blocks.wcInit();Code.watcher=new watcher();Code.storage.board=new Storage(StorageType.Board);Code.storage.local=new Storage(StorageType.Computer);Code.storage.cloud=new Storage(StorageType.Cloud);Code.loadBlocks("");f();Blockly.svgResize(Code.workspace.blocks);ace.require("ace/ext/language_tools");Code.workspace.editor=ace.edit(document.getElementById("content_editor"));Code.workspace.editor.setShowPrintMargin(true);Code.workspace.editor.setPrintMarginColumn(120);Code.workspace.editor.getSession().setMode("ace/mode/lua");Code.workspace.editor.setOptions({enableBasicAutocompletion:true});Code.workspace.editor.$blockScrolling=Infinity;ace.require("ace/ext/language_tools");Code.workspace.block_editorCode=ace.edit(document.getElementById("block_editor_code"));Code.workspace.block_editorCode.setShowPrintMargin(true);Code.workspace.block_editorCode.setPrintMarginColumn(120);Code.workspace.block_editorCode.getSession().setMode("ace/mode/lua");Code.workspace.block_editorCode.setOptions({enableBasicAutocompletion:true});Code.workspace.block_editorCode.$blockScrolling=Infinity;if("BlocklyStorage" in window){BlocklyStorage.backupOnUnload(Code.workspace.blocks)}Code.bindClick("trashButton",function(){Code.discard();Code.renderContent()});if(jQuery("#developerMode").length>0){jQuery("#developerMode").removeClass("disabled");Code.bindClick("developerMode",Code.developerMode)}if(jQuery("#blockEditorButton").length>0){jQuery("#blockEditorButton").removeClass("disabled");Code.bindClick("blockEditorButton",Code.blockEditor)}if(jQuery("#previewButton").length>0){jQuery("#previewButton").removeClass("disabled");Code.bindClick("previewButton",Code.previewCode)}Code.bindClick("switchToCode",Code.switchToCode);Code.bindClick("switchToBlocks",Code.switchToBlocks);Code.bindClick("loadButton",Code.load);Code.bindClick("saveButton",Code.save);Code.bindClick("saveAsButton",Code.saveAs);Code.bindClick("stopButton",Code.stop);Code.bindClick("runButton",Code.run);Code.bindClick("rebootButton",Code.reboot);if("BlocklyStorage" in window){BlocklyStorage.HTTPREQUEST_ERROR=MSG.httpRequestError;BlocklyStorage.LINK_ALERT=MSG.linkAlert;BlocklyStorage.HASH_ERROR=MSG.hashError;BlocklyStorage.XML_ERROR=MSG.xmlError}window.setTimeout(Code.importPrettify,1)};Code.initLanguage=function(){var o=Code.isRtl();document.dir=o?"rtl":"ltr";document.head.parentElement.setAttribute("lang",Code.settings.language);var d=[];for(var b in Code.LANGUAGE_NAME){d.push([Code.LANGUAGE_NAME[b],b])}var h=function(q,i){if(q[0]>i[0]){return 1}if(q[0]<i[0]){return -1}return 0};d.sort(h);var a=document.getElementById("languageMenu");a.options.length=0;for(var e=0;e<d.length;e++){var p=d[e];var b=p[p.length-1];var g=new Option(p[0],b);if(b==Code.settings.language){g.selected=true}a.options.add(g)}a.addEventListener("change",Code.changeLanguage,true);jQuery(".tabon, .taboff").each(function(i,r){var q=jQuery(r);q.text(MSG[q.attr("id").replace("tab_","")])});if(jQuery("#developerMode").length>0){document.getElementById("developerMode").title=MSG.developerMode}document.getElementById("switchToBlocks").title=MSG.switchToBlocksTooltip;document.getElementById("switchToCode").title=MSG.switchToCodeTooltip;document.getElementById("loadButton").title=MSG.loadButtonTooltip;document.getElementById("saveButton").title=MSG.saveButtonTooltip;document.getElementById("saveAsButton").title=MSG.saveAsButtonTooltip;document.getElementById("rebootButton").title=MSG.rebootButtonTooltip;document.getElementById("stopButton").title=MSG.stopButtonTooltip;document.getElementById("runButton").title=MSG.runTooltip;document.getElementById("trashButton").title=MSG.trashTooltip;if(jQuery("#blockEditorButton").length>0){document.getElementById("blockEditorButton").title=MSG.blockEditorTooltip}if(jQuery("#developerMode").length>0){document.getElementById("previewButton").title=MSG.previewButtonTooltip;if(Blockly.Lua.developerMode){document.getElementById("developerMode").title=MSG.developerModeTooltipOff}else{document.getElementById("developerMode").title=MSG.developerModeTooltipOn}}var f=[];if(Code.status.modules.pio||Code.status.modules.adc||Code.status.modules.pwm){f.push("catIO")}if(Code.status.modules.sensor){f.push("catSensor")}f.push("catActuators");f.push("catServo");if(Code.status.modules.i2c||Code.status.modules.can){f.push("catComm")}if(Code.status.modules.i2c){f.push("catI2C")}if(Code.status.modules.can){f.push("catCan")}if(Code.status.modules.lora){f.push("catLora")}if(Code.status.modules.net){f.push("catNET");f.push("catWIFI")}if(Code.status.modules.mqtt){f.push("catMQTT")}f.push("catControl");f.push("catOperators");f.push("catOperatorsNumeric");f.push("catOperatorsLogic");f.push("catOperatorsText");f.push("catOperatorsBitwise");f.push("catExceptions");f.push("catEvents");f.push("catDelays");f.push("catLogic");f.push("catLoops");f.push("catLists");f.push("catVariables");f.push("catFunctions");for(var e=0,n;n=f[e];e++){try{document.getElementById(n).setAttribute("name",MSG[n])}catch(l){}}var k=document.getElementsByClassName("textVar");for(var e=0,c;c=k[e];e++){c.textContent=MSG.textVariable}var m=document.getElementsByClassName("listVar");for(var e=0,j;j=m[e];e++){j.textContent=MSG.listVariable}};Code.discard=function(){if(Code.workspace.type=="blocks"){var a=Code.workspace.blocks.getAllBlocks().length;if(a>0){bootbox.confirm(Blockly.Msg.DELETE_ALL_BLOCKS.replace("%1",a),function(b){if(b){Code.workspace.blocks.clear();Code.setDefaultStorage();Code.tabRefresh()}})}}else{if(Code.workspace.type=="editor"){bootbox.confirm(MSG.DELETE_EDIT_CODE,function(b){if(b){Code.workspace.editor.setValue("",-1);Code.setDefaultStorage();Code.tabRefresh()}})}}};Code.runtimeError=function(b,a,d,c){Code.showError(MSG.runtimeError,MSG.youHaveAnError+"<br><br>"+c,function(){})};Code.run=function(){var d="";Blockly.mainWorkspace.removeStarts();Blockly.mainWorkspace.removeErrors();var a=document.getElementById("content_area");var c=Code.getBBox_(a);if(Code.workspace.type=="blocks"){d=Blockly.Lua.workspaceToCode(Code.workspace.blocks)}else{if(Code.workspace.type=="editor"){d=Code.workspace.editor.getValue()}}if(Code.cloud){}function e(){var g=null;if(Blockly.Lua.usesMQTT(Code.workspace.blocks)){}Code.showProgress(MSG.sendingCode);Code.agent.send({command:"boardRunProgram",arguments:{path:"/_run.lua",code:btoa(d)}},function(i,h){Code.hideProgress()})}var b=Code.getCurrentFullPath();var f=/(?:\.([^.]+))?$/.exec(b)[1];if(typeof f=="undefined"){Code.saveAs(e)}else{e()}};Code.removeFile=function(g,c,b,f,e){var a=Code.getPathFor(c,b);var d=/(?:\.([^.]+))?$/.exec(a)[1];if(d=="xml"){Code.workspace.type="blocks"}else{if(d=="lua"){Code.workspace.type="editor"}else{return}}if(g==StorageType.Board){Code.storage.board.remove(a,function(h){e(h)})}else{if(g==StorageType.Computer){Code.storage.local.remove(a,function(h){e(h)})}else{if(g==StorageType.Cloud){Code.storage.cloud.remove(f,function(h){e(h)})}}}};Code.loadFile=function(g,d,c,f){var a=Code.getPathFor(d,c);var e=/(?:\.([^.]+))?$/.exec(a)[1];if(e=="xml"){Code.workspace.type="blocks"}else{if(e=="lua"){Code.workspace.type="editor"}else{return}}function b(i){Code.closeDialogs();if(Code.workspace.type=="blocks"){var h=Blockly.Xml.textToDom(i);h=Code.workspace.blocks.migrate(h);Code.workspace.blocks.clear();Blockly.Xml.domToWorkspace(h,Code.workspace.blocks);Blockly.resizeSvgContents(Code.workspace.blocks)}else{Code.workspace.editor.setValue(i,-1)}Code.setCurrentStorage(g,d,c,f);Code.tabRefresh();Code.renderContent();Code.workspace.blocks.scrollCenter()}Code.showProgress(MSG.downloadingFile+" "+a+" ...");if(g==StorageType.Board){Code.storage.board.load(a,function(h){b(h)})}else{if(g==StorageType.Computer){Code.storage.local.load(a,function(h){b(h)})}else{if(g==StorageType.Cloud){Code.storage.cloud.load(f,function(h){b(h)})}}}};Code.saveFile=function(h,c,a,g,b,f){var e;if(typeof c=="undefined"){e=a}else{e=Code.getPathFor(c,a)}function d(){Code.setCurrentStorage(h,c,a,g);Code.hideProgress();Code.tabRefresh();if(typeof f=="function"){f()}}Code.showProgress(MSG.sendingFile+" "+e+" ...");if(h==StorageType.Board){Code.storage.board.save(e,g,b,function(){d()})}else{if(h==StorageType.Computer){Code.storage.local.save(e,g,b,function(){d()})}else{if(h==StorageType.Cloud){Code.storage.cloud.save(a,g,b,function(){d()})}}}};Code.loadExample=function(a){function b(d){Code.closeDialogs();Code.workspace.type=="blocks";Code.workspace.blocks.clear();Code.setDefaultStorage();Code.tabRefresh();var c=Blockly.Xml.textToDom(d);c=Code.workspace.blocks.migrate(c);Code.workspace.blocks.clear();Blockly.Xml.domToWorkspace(c,Code.workspace.blocks);Blockly.resizeSvgContents(Code.workspace.blocks);Code.tabRefresh();Code.renderContent();Code.workspace.blocks.scrollCenter()}Code.storage.cloud.load(btoa(a),function(c){b(c)})};Code.load=function(){function d(g){jQuery("#selectedStorage").val(g);jQuery("#selectedId").val("")}function c(g,h){jQuery("#selectedFileName").val("");jQuery("#selectedId").val(h)}function b(h,g,i){c(h);jQuery("#selectedId").val(i);Code.loadFile(jQuery("#selectedStorage").val(),h,g,i)}var f="";if(Code.workspace.type=="blocks"){f="xml"}else{if(Code.workspace.type=="editor"){f="lua"}}var a=document.getElementById("content_area");var e=Code.getBBox_(a);bootbox.dialog({title:MSG.loadBlockTitle,message:'<div id="loadFile" style="position: relative; left: -25px;overflow: auto;width:100%;height:'+(e.height*0.5)+'px;"></div><input type="hidden" id="selectedFolder" value=""><input type="hidden" id="selectedStorage" value=""><input type="hidden" id="selectedId" value=""><input type="hidden" id="selectedFileName" value="">',buttons:{danger:{label:MSG.cancel,className:"btn-default",callback:function(){}}},closable:false,onEscape:true});Code.listDirectories(jQuery("#loadFile"),f,d,c,b)};Code.stop=function(){Blockly.mainWorkspace.removeStarts();if(Code.cloud){Status.show("cloudConsoleOff");Code.cloud.Disconnect();Code.cloud=null}Code.agent.send({command:"boardStop",arguments:{}},function(b,a){Code.renderContent()})};Code.reboot=function(){Blockly.mainWorkspace.removeErrors();Blockly.mainWorkspace.removeStarts();Code.agent.send({command:"boardReset",arguments:{}},function(b,a){Code.renderContent()})};Code.save=function(){var b;var n;var a=document.getElementById("content_area");var p=Code.getBBox_(a);if(Code.workspace.type=="blocks"){n="xml";b=Blockly.Xml.domToText(Blockly.Xml.workspaceToDom(Code.workspace.blocks))}else{if(Code.workspace.type=="editor"){n="lua";b=Code.workspace.editor.getValue()}else{if(Code.workspace.type=="block_editor"){var l=jQuery("#content_block_editor_type").val();var m=jQuery("#content_block_editor_code_section").val();for(var h in Code.lib.def.blocks){if(Code.lib.def.blocks[h].spec.type==l){var g=FactoryUtils.getRootBlock(BlockFactory.mainWorkspace);var j=btoa(Blockly.Xml.domToText(Blockly.Xml.workspaceToDom(BlockFactory.mainWorkspace)));var d=JSON.parse(FactoryUtils.getBlockDefinition(l,g,"JSON",BlockFactory.mainWorkspace));b=btoa(Code.workspace.block_editorCode.getValue());Code.lib.def.blocks[h].code[m]=b;Code.lib.def.blocks[h].xmlSpec=j;Code.lib.def.blocks[h].spec=d;Code.lib.def.blocks[h].whatcher=(g.getFieldValue("WHATCHER")=="TRUE");if(Code.lib.def.blocks[h].spec.message0==""){Code.lib.def.blocks[h].msg.en={message0:Code.lib.def.blocks[h].spec.message0};Code.lib.def.blocks[h].msg.ca={message0:Code.lib.def.blocks[h].spec.message0};Code.lib.def.blocks[h].msg.es={message0:Code.lib.def.blocks[h].spec.message0}}var f=g.getInputTargetBlock("INPUTS");while(f){if(f.type=="input_value"){if(f.getFieldValue("SHADOW")=="TRUE"){Code.lib.def.blocks[h].shadow[f.getFieldValue("INPUTNAME")]={value:"0",name:"NUM",type:"math_number"}}Code.lib.def.blocks[h].subtype[f.getFieldValue("INPUTNAME")]=f.getFieldValue("SUBTYPE")}f=f.nextConnection&&f.nextConnection.targetBlock()}Code.lib.update();break}}return}}}function k(q){jQuery("#selectedStorage").val(q);jQuery("#selectedId").val("");Code.renderStorage(q,"/",jQuery("#storageType"));jQuery("#selectedFileName").focus()}function c(q,s){var r=jQuery("#selectedStorage").val();jQuery("#selectedFolder").text(q);jQuery("#selectedFolder").val(q);jQuery("#selectedFileName").val("");jQuery("#selectedId").val(s);jQuery("#selectedFileName").focus();Code.renderStorage(r,q,jQuery("#storageType"))}function o(r,q,u){var s=/(?:\.([^.]+))?$/.exec(q)[1];q=q.replace("."+s,"");var t=jQuery("#selectedStorage").val();c(r);jQuery("#selectedFileName").val(q);jQuery("#selectedFileName").focus();jQuery("#selectedId").val(u)}var e=Code.getCurrentFullPath();var i=/(?:\.([^.]+))?$/.exec(e)[1];if(typeof i!="undefined"){Code.saveFile(Code.currentFile.storage,undefined,e,Code.currentFile.id,b)}else{e=Code.getPathFor("","unnamed."+n);bootbox.dialog({title:MSG.saveBlockTitle,message:'<div id="saveFile" style="position: relative; left: -25px;overflow: auto;width:100%;height:'+(p.height*0.5)+'px;"></div><br>'+MSG.saveAs+'&nbsp;&nbsp;<span id="storageType"></span><input type="hidden" id="selectedFolder" value="/"></input><input type="hidden" id="selectedStorage" value="0"><input type="hidden" id="selectedId" value=""><input type="text" id="selectedFileName" value="">.'+n,buttons:{danger:{label:MSG.cancel,className:"btn-default",callback:function(){}},main:{label:MSG.save,className:"btn-primary",callback:function(){var q=jQuery("#selectedFileName").val();if(q!=""){Code.saveFile(jQuery("#selectedStorage").val(),jQuery("#selectedFolder").val(),q+"."+n,jQuery("#selectedId").val(),b)}else{return false}}}},closable:false,onEscape:true});k(Code.defaultStorage());Code.listDirectories(jQuery("#saveFile"),n,k,c,o)}};Code.saveAs=function(h){var f;var g;var a=document.getElementById("content_area");var e=Code.getBBox_(a);if(Code.workspace.type=="blocks"){g="xml";f=Blockly.Xml.domToText(Blockly.Xml.workspaceToDom(Code.workspace.blocks))}else{if(Code.workspace.type=="editor"){g="lua";f=Code.workspace.editor.getValue()}}function d(i){jQuery("#selectedStorage").val(i);jQuery("#selectedId").val("");Code.renderStorage(i,"/",jQuery("#storageType"));jQuery("#selectedFileName").focus()}function c(i,k){var j=jQuery("#selectedStorage").val();jQuery("#selectedFolder").text(i);jQuery("#selectedFolder").val(i);jQuery("#selectedFileName").val("");jQuery("#selectedFileName").focus();jQuery("#selectedId").val(k);Code.renderStorage(j,i,jQuery("#storageType"))}function b(j,i,m){var k=/(?:\.([^.]+))?$/.exec(i)[1];i=i.replace("."+k,"");var l=jQuery("#selectedStorage").val();c(j);jQuery("#selectedFileName").val(i);jQuery("#selectedFileName").focus();jQuery("#selectedId").val(m)}bootbox.dialog({title:MSG.saveBlockTitle,message:'<div id="saveFile" style="position: relative; left: -25px;overflow: auto;width:100%;height:'+(e.height*0.5)+'px;"></div><br>'+MSG.saveAs+'&nbsp;&nbsp;<span id="storageType"></span><input type="hidden" id="selectedFolder" value="/"></input><input type="hidden" id="selectedStorage" value="0"><input type="hidden" id="selectedId" value=""><input type="text" id="selectedFileName" value="">.'+g,buttons:{danger:{label:MSG.cancel,className:"btn-default",callback:function(){}},main:{label:MSG.save,className:"btn-primary",callback:function(){var i=jQuery("#selectedFileName").val();if(i!=""){Code.saveFile(jQuery("#selectedStorage").val(),jQuery("#selectedFolder").val(),i+"."+g,jQuery("#selectedId").val(),f,h)}else{return false}}}},closable:false,onEscape:true});d(Code.defaultStorage());Code.listDirectories(jQuery("#saveFile"),g,d,c,b)};Code.showProgress=function(a){Code.closeDialogs();BootstrapDialog.show({message:'<div class="progress progress-striped active" style="width: 100%;"><div class="progress-bar" role="progressbar" style="width: 100%;"></div></div>',title:a,closable:false})};Code.hideProgress=function(){Code.closeDialogs()};Code.showInformation=function(a){Code.closeDialogs();setTimeout(function(){BootstrapDialog.show({message:a,title:MSG.information,closable:false,onshow:function(b){setTimeout(function(){b.close()},2500)}})},500)};Code.closeDialogs=function(){BootstrapDialog.closeAll();bootbox.hideAll();Code.Help.closeAll()};Code.showAlert=function(a){Code.closeDialogs();BootstrapDialog.show({message:a,title:MSG.alert,closable:true,onshow:function(b){setTimeout(function(){jQuery(".btn-alert-instructions").unbind("click").bind("click",function(d){b.close();var c=jQuery(d.target);if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){Code.Help.show("alerts",c.data("url"))}else{Code.Help.show("alerts",c.data("url"))}}else{Code.Help.show("alerts",c.data("url"))}})},500)}})};Code.showError=function(b,a,c){Code.closeDialogs();setTimeout(function(){bootbox.dialog({title:b,message:a,buttons:{main:{label:MSG.ok,className:"btn-primary",callback:function(){if(typeof c!=undefined){c()}}}},closable:false})},500)};Code.newFirmwareInfo=function(){Code.closeDialogs();bootbox.dialog({message:MSG.newFirmwareInstructions,title:MSG.alert,buttons:{success:{label:MSG.upgrade,className:"btn-primary",callback:function(){Code.agent.send({command:"boardUpgrade",arguments:{}},function(b,a){Code.showProgress(MSG.downloadingFirmware)})}}},closable:false,onEscape:true})};Code.newFirmware=function(){if(!Code.checkNewFirmwareVersion){return}Code.closeDialogs();bootbox.dialog({message:MSG.newFirmware,buttons:{danger:{label:MSG.notNow,className:"btn-default",callback:function(){Code.checkNewFirmwareVersion=false}},success:{label:MSG.installNow,className:"btn-primary",callback:function(){setTimeout(Code.newFirmwareInfo,500)}}},closable:false,onEscape:true})};Code.listDirectoriesUpdate=function(b,f,d,a,e){var c="";c+='<ul class="dir-entry">';a.forEach(function(k){var h=true;if(typeof e!="undefined"){h=k.name.match(new RegExp("^.*."+e+"$"))||(k.type=="d")}if(h){var j="icon-file-text2";var g=d;var i="";if(typeof k.id!="undefined"){i=k.id}else{i=""}if(k.type=="d"){j="icon-folder2";if(d!=""){g+="/"}g+=k.name}c=c+'<li class="dir-entry-'+k.type+'" data-expanded="false" data-type="'+k.type+'" data-id="'+i+'" data-path="'+g+'" data-name="'+k.name+'" data-storage="'+f+'"><span data-type="'+k.type+'" class="icon '+j+'"></span><span class="dir-label">'+k.name+"</span></li>"}});c+="</ul>";b.append(c)};Code.listDirectories=function(a,f,e,d,c){var b="";b+='<ul class="dir-entry">';b+='<li class="dir-entry-d" data-expanded="false" data-type="r" data-id data-path data-name data-storage="'+StorageType.Board+'"><span class="icon icon-chip"></span><span class="dir-label">Board</span></li>';b+='<li class="dir-entry-d" data-expanded="false" data-type="r" data-id data-path data-name data-storage="'+StorageType.Computer+'"><span class="icon icon-display"></span><span class="dir-label">Computer</span></li>';b+='<li class="dir-entry-d" data-expanded="false" data-type="r" data-id data-path data-name data-storage="'+StorageType.Cloud+'"><span class="icon icon-cloud"></span><span class="dir-label">Cloud</span></li>';b+="</ul>";a.append(b);window.dispatchEvent(new Event("resize"));a.find(".dir-entry-d, .dir-entry-f").unbind().bind("click",function(l){var k=jQuery(l.target);if(k.prop("tagName")!="LI"){k=k.closest("li")}var h=k.attr("data-type");var n=k.attr("data-storage");var g=k.attr("data-expanded");var j=k.attr("data-path");var i=k.attr("data-name");var m=k.attr("data-id");j=j.replace(/[\\\/]+/g,"/");if(j.charAt(0)!="/"){j="/"+j}if(j.charAt(j.length-1)!="/"){j=j+"/"}jQuery(".dir-entry-d[data-type='r']").each(function(o,p){var q=jQuery(p);if(!jQuery.contains(p,l.target)){q.find("ul").empty();q.attr("data-expanded","false")}});if((h=="r")||(h=="d")){if(g=="true"){k.find("ul").empty();k.attr("data-expanded","false")}else{k.attr("data-expanded","true")}if(g=="false"){if(n==StorageType.Board){Code.storage.board.listDirectories(j,function(o){Code.listDirectoriesUpdate(k,n,j,o,f);jQuery('.dir-entry-d[data-expanded="true"]').find("span[data-type='d']").removeClass("icon-folder2").addClass("icon-folder-open");jQuery('.dir-entry-d[data-expanded="false"]').find("span[data-type='d']").removeClass("icon-folder-open").addClass("icon-folder2");if(typeof e!="undefined"){e(n)}if(typeof d!="undefined"){d(j,m)}})}else{if(n==StorageType.Computer){Code.storage.local.listDirectories(j,function(o){Code.listDirectoriesUpdate(k,n,j,o,f);jQuery('.dir-entry-d[data-expanded="true"]').find("span[data-type='d']").removeClass("icon-folder2").addClass("icon-folder-open");jQuery('.dir-entry-d[data-expanded="false"]').find("span[data-type='d']").removeClass("icon-folder-open").addClass("icon-folder2");if(typeof e!="undefined"){e(n)}if(typeof d!="undefined"){d(j,m)}})}else{if(n==StorageType.Cloud){Code.storage.cloud.listDirectories(m,function(o){Code.listDirectoriesUpdate(k,n,j,o,f);jQuery('.dir-entry-d[data-expanded="true"]').find("span[data-type='d']").removeClass("icon-folder2").addClass("icon-folder-open");jQuery('.dir-entry-d[data-expanded="false"]').find("span[data-type='d']").removeClass("icon-folder-open").addClass("icon-folder2");if(typeof e!="undefined"){e(n)}if(typeof d!="undefined"){d(j,m)}})}}}}else{if(n==StorageType.Board){if(typeof e!="undefined"){e(n)}if(typeof d!="undefined"){d(j,m)}}else{if(n==StorageType.Computer){if(typeof e!="undefined"){e(n)}if(typeof d!="undefined"){d(j,m)}}else{if(n==StorageType.Cloud){if(typeof e!="undefined"){e(n)}if(typeof d!="undefined"){d(j,m)}}}}}}else{if(h=="f"){if(typeof e!="undefined"){e(n)}if(typeof c!="undefined"){c(j,i,m)}}}l.stopPropagation()});jQuery.contextMenu({selector:".dir-entry-f",items:{remove:{name:Blockly.Msg.DELETE_FILE,callback:function(i,h){var l=jQuery(this);var g;var n=l.attr("data-id");var k=l.attr("data-path");var j=l.attr("data-name");var m=l.attr("data-storage");bootbox.confirm(Blockly.Msg.DELETE_FILE_CONFIRM.replace("%1",j),function(o){if(o){Code.removeFile(m,k,j,n,function(p){if(p){Code.showInformation(Blockly.Msg.FILE_DELETED.replace("%1",j))}})}else{setTimeout(function(){jQuery("body").addClass("modal-open")},500)}})}}}})};Code.tabRefresh=function(){if(Code.workspace.type=="blocks"){jQuery("#blockEditorButton, #previewButton, #developerMode, #switchToCode, #trashButton, #loadButton, #saveButton,  #saveAsButton, #rebootButton, #stopButton, #runButton").removeClass("disabled");jQuery("#switchToBlocks").addClass("disabled")}else{if(Code.workspace.type=="editor"){jQuery("#switchToBlocks, #trashButton, #loadButton, #saveButton, #saveAsButton, #rebootButton, #stopButton, #runButton").removeClass("disabled");jQuery("#developerMode,#previewButton, #blockEditorButton, #switchToCode").addClass("disabled")}else{if(Code.workspace.type=="block_editor"){jQuery("#blockEditorButton, #saveButton").removeClass("disabled");jQuery("#trashButton, #loadButton, #previewButton, #developerMode, #switchToCode, #switchToBlocks, #saveAsButton, #rebootButton, #stopButton, #runButton").addClass("disabled")}}}if(!Code.status.connected){jQuery("#loadButton, #saveButton, #saveAsButton, #stopButton, #runButton, #rebootButton").addClass("disabled")}else{if(Code.workspace.type!="block_editor"){jQuery("#stopButton, #runButton, #rebootButton").removeClass("disabled")}}if(Code.showCode){jQuery("#developerMode").removeClass("disabled");jQuery("#previewButton").removeClass("disabled");jQuery("#saveButton").addClass("disabled");jQuery("#saveAsButton").addClass("disabled");jQuery("#rebootButton").addClass("disabled");jQuery("#stopButton").addClass("disabled");jQuery("#runButton").addClass("disabled");jQuery("#loadButton").addClass("disabled");jQuery("#blockEditorButton").addClass("disabled");jQuery("#trashButton").addClass("disabled");jQuery("#switchToBlocks").addClass("disabled");jQuery("#switchToCode").addClass("disabled")}};Code.developerMode=function(){if(jQuery("#developerMode").hasClass("on")){jQuery("#developerMode").removeClass("on");jQuery("#developerMode").find(".icon").addClass("off");Blockly.Lua.developerMode=false}else{jQuery("#developerMode").addClass("on");jQuery("#developerMode").find(".icon").removeClass("off");Blockly.Lua.developerMode=true}Code.workspace.editor.setValue(Blockly.Lua.workspaceToCode(Code.workspace.blocks),-1);Code.workspace.editor.focus();Code.renderContent()};Code.blockEditor=function(){if(Code.workspace.type=="block_editor"){Code.workspace.type="blocks"}else{Code.workspace.type="block_editor"}Code.renderContent()};Code.previewCode=function(){Code.showCode=!Code.showCode;if(Code.showCode){Code.workspace.type="editor";Code.workspace.prevType=Code.workspace.type;Code.workspace.editor.setValue(Blockly.Lua.workspaceToCode(Code.workspace.blocks),-1);Code.workspace.editor.focus();Code.renderContent()}else{Code.workspace.type="blocks";Code.workspace.prevType=Code.workspace.type;Code.workspace.editor.setValue("",-1);Code.workspace.editor.focus();Code.renderContent()}};Code.switchToCode=function(){function a(){Code.setDefaultStorage();Code.settings.programmingModel="lua";Settings.save(Code.settings);Code.workspace.blocks.clear();Code.workspace.type="editor";Code.workspace.prevType=Code.workspace.type;Code.workspace.editor.setValue("",-1);Code.workspace.editor.focus();Code.renderContent()}bootbox.dialog({title:MSG.information,message:MSG.switchToCodeWarning,buttons:{danger:{label:MSG.no,className:"btn-default",callback:function(){}},success:{label:MSG.yes,className:"btn-primary",callback:function(){a()}}},closable:false,onEscape:true})};Code.switchToBlocks=function(){function a(){Code.setDefaultStorage();Code.settings.programmingModel="blocks";Settings.save(Code.settings);Code.workspace.blocks.clear();Code.workspace.type="blocks";Code.workspace.prevType=Code.workspace.type;Code.workspace.editor.setValue("",-1);Code.workspace.editor.focus();Code.renderContent()}bootbox.dialog({title:MSG.information,message:MSG.switchToBlocksWarning,buttons:{danger:{label:MSG.no,className:"btn-default",callback:function(){}},success:{label:MSG.yes,className:"btn-primary",callback:function(){a()}}},closable:false,onEscape:true})};Code.setup=function(){Code.agent.addListener("boardPowerOnReset",function(b,a){Blockly.mainWorkspace.removeErrors();Blockly.mainWorkspace.removeStarts();Code.status=JSON.parse(JSON.stringify(Code.defaultStatus));Code.board.getMaps(Code.settings.board,function(c){Code.status.maps=c});Code.renderContent()});Code.agent.addListener("boardAttached",function(b,a){Blockly.mainWorkspace.removeErrors();Blockly.mainWorkspace.removeStarts();Status.hide();Code.status=JSON.parse(JSON.stringify(Code.defaultStatus));Code.status=a.info;Code.settings.board=a.info.board;Status.show(Code.board.getDesc(Code.settings.board));Code.board.getMaps(Code.settings.board,function(c){Code.status.maps=c;Code.status.connected=true;Code.status.firmware=a.info.os+"-"+a.info.version.replace(" ","-")+"-"+a.info.build;Code.renderContent()});if((Code.agent.version=="")||(Code.agent.version<Code.minAgentVersion)){if(Code.checkNewAgentVersion){Code.showAlert(MSG.pleaseUpgradeAgent)}Code.checkNewAgentVersion=false}else{if(Code.agent.version>1.2){if(a.newBuild){Code.newFirmware()}}}});Code.agent.addListener("boardConsoleOut",function(b,a){Term.write(atob(a.content))});Code.agent.addListener("attachIde",function(b,a){if(!a.hasOwnProperty("agent-version")){Code.showAlert(MSG.pleaseUpgradeAgent)}else{Code.agent.version=parseFloat(a["agent-version"]);if(Code.agent.version>1.2){Code.agent.consoleUpSocketConnect();Code.agent.consoleDownSocketConnect()}}});Code.agent.addListener("boardDetached",function(b,a){Blockly.mainWorkspace.removeErrors();Blockly.mainWorkspace.removeStarts();Status.show("Connect a board");Code.status=JSON.parse(JSON.stringify(Code.defaultStatus));Code.board.getMaps(Code.settings.board,function(c){Code.status.maps=c;Code.renderContent()})});Code.agent.addListener("boardUpgraded",function(b,a){Blockly.mainWorkspace.removeErrors();Blockly.mainWorkspace.removeStarts();Code.hideProgress();Code.tabRefresh()});Code.agent.addListener("blockStart",function(d,b){if(Code.workspace.type=="blocks"){var c=atob(b.block).replace(/\0/g,"");var d=Blockly.Lua.numToBlockId(c);if(d){var a=Blockly.mainWorkspace.getBlockById(d);if((a.type=="cpu_sleep")||(a.type=="when_board_starts")){Blockly.mainWorkspace.removeStarts()}a.addStart()}}});Code.agent.addListener("blockEnd",function(d,b){if(Code.workspace.type=="blocks"){var c=atob(b.block).replace(/\0/g,"");var d=Blockly.Lua.numToBlockId(c);if(d){var a=Blockly.mainWorkspace.getBlockById(d);a.removeStart()}}});Code.agent.addListener("blockError",function(e,c){if(Code.workspace.type=="blocks"){Blockly.mainWorkspace.removeStarts();Blockly.mainWorkspace.removeErrors();var d=atob(c.block).replace(/\0/g,"");var e=Blockly.Lua.numToBlockId(d);if(e){var b=Blockly.mainWorkspace.getBlockById(Blockly.Lua.numToBlockId(d));var a=atob(c.error);b.addError();b.setWarningText(a)}}});Code.agent.addListener("blockErrorCatched",function(b,a){if(Code.workspace.type=="blocks"){Blockly.mainWorkspace.removeStarts();Blockly.mainWorkspace.removeErrors()}});Code.agent.addListener("boardUpdate",function(b,a){Blockly.mainWorkspace.removeErrors();Blockly.mainWorkspace.removeStarts();if(Code.agent.version>1.2){a.what=atob(a.what)}Status.show(a.what)});Code.agent.addListener("boardRuntimeError",function(b,a){a.message=atob(a.message);Code.runtimeError(a.where,a.line,a.exception,a.message)});if(typeof ide_init==="function"){ide_init()}Settings.load(Code.settings);Blockly.Blocks.operators={};if(Code.settings.programmingModel=="blocks"){Code.workspace.type="blocks"}else{if(Code.settings.programmingModel=="lua"){Code.workspace.type="editor"}}Blockly.Blocks.variables.HUE="#ee7d16";Blockly.Blocks.lists.HUE="#cc5b22";Blockly.Blocks.control.HUE="#e1a91a";Blockly.Blocks.events.HUE="#c88330";Blockly.Blocks.sensor.HUE="#2ca5e2";Blockly.Blocks.operators.HUE="#5cb712";Blockly.Blocks.i2c.HUE=Blockly.Blocks.io.HUE;Blockly.Blocks.can.HUE=Blockly.Blocks.io.HUE;Blockly.Blocks.actuators.HUE="#4a6cd4";Blockly.Blocks["try"].HUE=Blockly.Blocks.control.HUE;Blockly.Blocks.loops.HUE=Blockly.Blocks.control.HUE;Blockly.Blocks.logic.HUE=Blockly.Blocks.control.HUE;Blockly.Blocks.constant.HUE="#cccccc";Blockly.Blocks.texts.HUE=Blockly.Blocks.operators.HUE;Blockly.Blocks.math.HUE=Blockly.Blocks.operators.HUE;jQuery.getScript("msg/wc/"+Code.settings.language+".js",function(){jQuery.getScript("msg/js/"+Code.settings.language+".js",function(){Code.board.getMaps(Code.settings.board,function(a){Code.status.maps=a;Code.Help.get(function(){Code.buildToolBox(function(){Code.init();Term.init();Code.renderContent();Code.agent.controlSocketConnect();if(typeof ide_post_init==="function"){ide_post_init()}})})})})})};window.addEventListener("load",function(){$.ajax({xhrFields:{withCredentials:true}});Code.Help=new Help();Code.agent=new agent();Code.board=new board();Code.lib=new blockLibrary();Code.blocklyFactory=null;if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){Code.blocklyFactory=new AppController()}}Code.setup()});if(typeof require!="undefined"){if(typeof require("nw.gui")!="undefined"){var gui=require("nw.gui");var win=gui.Window.get();win.on("close",function(a){Code.agent.send({command:"detachIde",arguments:{}},function(c,b){});win.close(true)})}else{appWin.addEventListener("close",function(){Code.agent.send({command:"detachIde",arguments:{}},function(b,a){})})}}else{setInterval(function(){jQuery.ajax({url:Code.server,data:{alive:""},type:"POST",success:function(a){a=JSON.parse(a);if(!a.success){}return},error:function(){}})},1000*60*5);window.addEventListener("close",function(){Code.agent.send({command:"detachIde",arguments:{}},function(b,a){})})};